{"categories":[],"posts":[{"content":"å®ä¾‹ ä¸‹é¢æ˜¯ä¸¤ä¸ªç®€å•çš„å®ä¾‹ï¼Œç›®çš„æ˜¯è·å–ä¸€ä¸ªå•è¯çš„è¯æ ¹ï¼Œå¹¶è‡ªåŠ¨è¯†åˆ«å¤§å°å†™ã€‚ä¸€ä¸ªä½¿ç”¨çš„æ˜¯SimpleCoreNLPAPIç®€å•å®ç°ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯é€šè¿‡å®Œæ•´çš„Pipelineæ¥å®ç°ã€‚\nSimpleCoreNPL //ç›´æ¥è·å–ä¸€ä¸ªå•è¯çš„è¯æ ¹ï¼Œä½†æ˜¯æ­¤æ–¹æ³•ä¸ä¼šè‡ªåŠ¨è¯†åˆ«å¤§å°å†™ String tokenLemma = new Sentence(\u0026quot;Cyberpunk\u0026quot;).lemma(0); //ç›´æ¥è·å–ä¸€ä¸ªå•è¯çš„è¯æ ¹ï¼Œå¹¶ä¸”è¯†åˆ«å¤§å°å†™ Properties properties = PropertiesUtils.asProperties( \u0026quot;language\u0026quot;, \u0026quot;english\u0026quot;, \u0026quot;ssplit.isOneSentence\u0026quot;, \u0026quot;true\u0026quot;, \u0026quot;tokenize.class\u0026quot;, \u0026quot;PTBTokenizer\u0026quot;, \u0026quot;tokenize.language\u0026quot;, \u0026quot;en\u0026quot;, \u0026quot;mention.type\u0026quot;, \u0026quot;dep\u0026quot;, \u0026quot;coref.mode\u0026quot;, \u0026quot;statistical\u0026quot;, \u0026quot;coref.md.type\u0026quot;, \u0026quot;dep\u0026quot;, //è¿™ä¸ªå±æ€§å®ç°äº†è‡ªåŠ¨è¯†åˆ«å¤§å°å†™ï¼Œåˆ æ‰è¿™ä¸ªå±æ€§å°±è·Ÿä¸Šé¢æ–¹æ³•å®Œå…¨ä¸€æ · \u0026quot;truecase.overwriteText\u0026quot;,\u0026quot;true\u0026quot; ); List\u0026lt;String\u0026gt; matting = new Sentence(\u0026quot;Has\u0026quot;).lemmas(properties);  Pipeline Properties properties = PropertiesUtils.asProperties(\u0026quot;annotators\u0026quot;, \u0026quot;tokenize,ssplit,pos,lemma,truecase\u0026quot;); StanfordCoreNLP pipeline = new StanfordCoreNLP(properties); Annotation tokenAnnotation = new Annotation(\u0026quot;Has have HAVE\u0026quot;); pipeline.annotate(tokenAnnotation); List\u0026lt;CoreMap\u0026gt; list = tokenAnnotation.get(SentencesAnnotation.class); pipeline.prettyPrint(tokenAnnotation,System.out);  ä¸Šé¢çš„ä¾‹å­å¯ä»¥å¯¹æ•´å¥è¯è¿›è¡Œè§£æï¼Œæœ€åæ‰“å°çš„ç»“æœæ˜¯å…¶ä¸­æ¯ä¸ªå•è¯çš„åˆ†æç»“æœã€‚åˆ†æç»“æœçš„æ ¼å¼æ˜¯æ¯ä¸ªå±æ€§éƒ½å¯¹åº”äº†ä¸€ä¸ªç»“æœï¼Œæ¯”å¦‚lemmaè¯æ ¹å¯¹åº”ä¸€ä¸ªç»“æœï¼Œtruecaseå¤§å°å†™å¯¹åº”ä¸€ä¸ªç»“æœï¼Œå¯ä»¥ç›´æ¥è·å–ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œé‡å†™åˆå¹¶ç­‰æ“ä½œï¼Œå…·ä½“ä¸å±•å¼€ï¼Œå‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚\n å…³äºæ›´å¤šå¯ç”¨å±æ€§ï¼Œå¯ä»¥å‚è€ƒall annotator\n ","id":0,"section":"posts","summary":"å®ä¾‹ ä¸‹é¢æ˜¯ä¸¤ä¸ªç®€å•çš„å®ä¾‹ï¼Œç›®çš„æ˜¯è·å–ä¸€ä¸ªå•è¯çš„è¯æ ¹ï¼Œå¹¶è‡ªåŠ¨è¯†åˆ«å¤§å°å†™ã€‚ä¸€ä¸ªä½¿ç”¨çš„æ˜¯SimpleCoreNLPAPIç®€å•å®ç°ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯é€šè¿‡å®Œ","tags":["npl"],"title":"Standford npl ä½¿ç”¨è¯´æ˜","uri":"https://www.mingaccount.com/2021/03/standford-npl/","year":"2021"},{"content":"The ASCII letter \u0026ldquo;P\u0026rdquo; is next in upper or lower case. There are then four sections, each consisting of a number and a suffix.\nThe sections have suffixes in ASCII of \u0026ldquo;D\u0026rdquo;, \u0026ldquo;H\u0026rdquo;, \u0026ldquo;M\u0026rdquo; and \u0026ldquo;S\u0026rdquo; for days, hours, minutes and seconds, accepted in upper or lower case. The suffixes must occur in order.\nThe ASCII letter \u0026ldquo;T\u0026rdquo; must occur before the first occurrence, if any, of an hour, minute or second section. At least one of the four sections must be present, and if \u0026ldquo;T\u0026rdquo; is present there must be at least one section after the \u0026ldquo;T\u0026rdquo;. The number part of each section must consist of one or more ASCII digits. The number may be prefixed by the ASCII negative or positive symbol. The number of days, hours and minutes must parse to an long. The number of seconds must parse to an long with optional fraction. The decimal point may be either a dot or a comma. The fractional part may have from zero to 9 digits.\nExamples:\n \u0026quot;PT20.345S\u0026quot; -- parses as \u0026quot;20.345 seconds\u0026quot;\r\u0026quot;PT15M\u0026quot; -- parses as \u0026quot;15 minutes\u0026quot; (where a minute is 60 seconds)\r\u0026quot;PT10H\u0026quot; -- parses as \u0026quot;10 hours\u0026quot; (where an hour is 3600 seconds)\r\u0026quot;P2D\u0026quot; -- parses as \u0026quot;2 days\u0026quot; (where a day is 24 hours or 86400 seconds)\r\u0026quot;P2DT3H4M\u0026quot; -- parses as \u0026quot;2 days, 3 hours and 4 minutes\u0026quot;\r ","id":1,"section":"posts","summary":"The ASCII letter \u0026ldquo;P\u0026rdquo; is next in upper or lower case. There are then four sections, each consisting of a number and a suffix.\nThe sections have suffixes in ASCII of \u0026ldquo;D\u0026rdquo;, \u0026ldquo;H\u0026rdquo;, \u0026ldquo;M\u0026rdquo; and \u0026ldquo;S\u0026rdquo; for days, hours, minutes and seconds, accepted in upper or lower case. The suffixes must occur in order.\nThe ASCII letter \u0026ldquo;T\u0026rdquo; must occur before the first occurrence, if any, of an hour, minute or second section.","tags":["protocol"],"title":"Duration format PnDTnHnMn.nS ISO-8601","uri":"https://www.mingaccount.com/2021/02/duration-format/","year":"2021"},{"content":"æœ€ç®€å•çš„æ–¹å¼ï¼Œæ˜¯ç›´æ¥åœ¨èµ„æºç›®å½•ä¸‹æ–°å»ºschema.sqlå’Œdata.sql\n schema.sqlä»£è¡¨DDL data.sqlä»£è¡¨DML  é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ç¨‹åºåˆå§‹åŒ–çš„æ—¶å€™ä¼šä¸ºé›†æˆæ•°æ®åº“æ‰§è¡Œï¼Œå¦‚æœéœ€è¦ä¸ºspring.datasourceä¸­å®šä¹‰çš„æ•°æ®åº“æ‰§è¡Œï¼Œéœ€è¦ä¿®æ”¹ä»¥ä¸‹å±æ€§ï¼š\nspring.datasource.initialization-mode=always\r å¦‚æœæœ‰å¤šä¸ªç‰ˆæœ¬çš„åˆå§‹åŒ–è„šæœ¬ï¼Œé‚£ä¹ˆspring-bootè¿˜æä¾›äº†åˆ†ç±»ã€‚éœ€è¦ä½ çš„sqlè„šæœ¬æŒ‰ç…§å¦‚ä¸‹è§„åˆ™å‘½åï¼š\n schema-${platform}.sql data-${platform}.sql  åŒæ—¶éœ€è¦åœ¨å±æ€§ä¸­é…ç½®\nspring.datasource.platform=\r é»˜è®¤æƒ…å†µä¸‹ï¼Œè„šæœ¬æ‰§è¡Œå¤±è´¥ä¼šå¯¼è‡´spring-bootå¯åŠ¨å¤±è´¥ï¼Œå¯ä»¥é€šè¿‡é…ç½®å±æ€§è·³è¿‡ï¼š\nspring.datasource.continue-on-error=\r  æ›´å¤šåˆå§‹åŒ–è„šæœ¬æ–¹å¼å‚è€ƒhowto-database-initialization\n ","id":2,"section":"posts","summary":"æœ€ç®€å•çš„æ–¹å¼ï¼Œæ˜¯ç›´æ¥åœ¨èµ„æºç›®å½•ä¸‹æ–°å»ºschema.sqlå’Œdata.sql schema.sqlä»£è¡¨DDL data.sqlä»£è¡¨DML é»˜è®¤æƒ…å†µä¸‹","tags":["spring"],"title":"Spring boot å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–sqlè„šæœ¬","uri":"https://www.mingaccount.com/2020/11/spring-boot-schema/","year":"2020"},{"content":"Hyper-v powershell admin\nEnable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All\r  Install Hyper-V on Windows 10\n Containers Prep windows for containers\n","id":3,"section":"posts","summary":"Hyper-v powershell admin Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All Install Hyper-V on Windows 10 Containers Prep windows for containers","tags":["windows"],"title":"å¯ç”¨Windows Hyper-vå’Œcontainers","uri":"https://www.mingaccount.com/2020/10/windows-hyper-v-and-container/","year":"2020"},{"content":"èƒŒæ™¯ï¼šwindows npm installå¤±è´¥ é”™è¯¯ä¿¡æ¯ï¼špngquant failed to build, make sure that libpng-dev is installed è§£å†³æ–¹æ¡ˆ npm install --global windows-build-tools å¦‚æœä»ç„¶å¤±è´¥ï¼Œå‚è€ƒgithubå›ç­”\n","id":4,"section":"posts","summary":"èƒŒæ™¯ï¼šwindows npm installå¤±è´¥ é”™è¯¯ä¿¡æ¯ï¼špngquant failed to build, make sure that libpng-dev is installed è§£å†³æ–¹æ¡ˆ npm install --global windows-build-tools å¦‚æœä»ç„¶å¤±è´¥ï¼Œå‚è€ƒgithubå›ç­”","tags":["windows","npm"],"title":"Windows CMD é”™è¯¯pngquant failed to build, make sure that libpng-dev is installed","uri":"https://www.mingaccount.com/2020/10/windows-npm-exception/","year":"2020"},{"content":"å®Œæ•´å¼‚å¸¸ OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443\r è§£å†³æ–¹æ¡ˆ å¦‚æœæŒ‚ç€tzï¼Œéœ€è¦è®¾ç½®ä¸€ä¸‹ä»£ç†\ngit config --global http.proxy \u0026quot;127.0.0.1:1080\u0026quot;\rgit config --global https.proxy \u0026quot;127.0.0.1:1080\u0026quot;\r å…³æ‰tzçš„è¯ï¼Œéœ€è¦å–æ¶ˆä»£ç†\ngit config --global --unset http.proxy\rgit config --global --unset https.proxy\r ä¸Šé¢çš„è§£å†³æ–¹æ¡ˆå¦‚æœè¡Œä¸é€šå»ºè®®é‡å¯ï¼Œå¤šå°è¯•å‡ æ¬¡pushğŸ‘\n","id":5,"section":"posts","summary":"å®Œæ•´å¼‚å¸¸ OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443 è§£å†³æ–¹æ¡ˆ å¦‚æœæŒ‚ç€tzï¼Œéœ€è¦è®¾ç½®ä¸€ä¸‹ä»£ç† git config --global http.proxy \u0026quot;127.0.0.1:1080\u0026quot; git config --global https.proxy \u0026quot;127.0.0.1:1080\u0026quot; å…³æ‰tzçš„è¯ï¼Œéœ€è¦å–æ¶ˆä»£ç† git config --global --unset http.proxy git config --global --unset https.proxy ä¸Šé¢çš„è§£å†³æ–¹æ¡ˆ","tags":["git"],"title":"git push å¼‚å¸¸SSL_connect: SSL_ERROR_SYSCALL","uri":"https://www.mingaccount.com/2020/09/git-push-exception-ssl-error/","year":"2020"},{"content":"WSL ubuntu20.04å®˜æ–¹é—®é¢˜ï¼Œä¸ºäº†ç¨³å®šæ¨è18.04\nå‚è€ƒå®˜æ–¹è¯´æ˜\n","id":6,"section":"posts","summary":"WSL ubuntu20.04å®˜æ–¹é—®é¢˜ï¼Œä¸ºäº†ç¨³å®šæ¨è18.04 å‚è€ƒå®˜æ–¹è¯´æ˜","tags":["windows"],"title":"WIN10 UBUNTU å¼‚å¸¸ï¼šsleep: cannot read realtime clock: Invalid argument","uri":"https://www.mingaccount.com/2020/08/wsl-exception/","year":"2020"},{"content":"å½“æå–å­—æ®µä¸ºDateç±»å‹æ—¶ï¼Œextractåªèƒ½è¯»å–å¹´æœˆæ—¥ï¼Œæå–æ—¶åˆ†ç§’ä¼šæŠ¥é”™\nè¦æå–å¹´æœˆæ—¥ï¼Œéœ€è¦å°†Dateç±»å‹è½¬ä¸ºtimestamp\n","id":7,"section":"posts","summary":"å½“æå–å­—æ®µä¸ºDateç±»å‹æ—¶ï¼Œextractåªèƒ½è¯»å–å¹´æœˆæ—¥ï¼Œæå–æ—¶åˆ†ç§’ä¼šæŠ¥é”™ è¦æå–å¹´æœˆæ—¥ï¼Œéœ€è¦å°†Dateç±»å‹è½¬ä¸ºtimestamp","tags":["oracle"],"title":"Oracle extractå‡½æ•°æå–æ—¶åˆ†ç§’çš„é—®é¢˜","uri":"https://www.mingaccount.com/2020/07/oracle-extract/","year":"2020"},{"content":"Settingä¸­æœ‰ä¸ªé€‰é¡¹setRenderSchema(true)ï¼Œä½†æ˜¯è¿™ç§åªé€‚ç”¨äºè¡¨æ˜¯ç”±JOOQä»£ç ç”Ÿæˆå™¨ç”Ÿæˆçš„è¡¨å¯¹è±¡ã€‚\nå¦‚æœæ˜¯è‡ªå·±å£°æ˜çš„è¡¨å¯¹è±¡ï¼ˆDSL.table()ï¼‰ï¼Œæƒ³è¦è®©JOOQåœ¨æ¸²æŸ“æ—¶è‡ªå·±åŠ ä¸Šschemaï¼Œç¨å¾®éº»çƒ¦ä¸€ç‚¹ã€‚\nè¿™é‡Œå‡è®¾éœ€è¦åŠ ä¸Šçš„é»˜è®¤schemaä¸ºï¼šliuneng\nSettings settings = new Settings()\r.withRenderMapping(new RenderMapping()\r.withSchemata(new MappedSchema().withInput(\u0026quot;\u0026quot;).withOutput(\u0026quot;liuneng\u0026quot;)));\r è¿™æ ·è®¾ç½®å,JOOQåœ¨æ¸²æŸ“è¡¨åçš„æ—¶å€™ä¼šæŠŠæœªè®¾ç½®schemaçš„è¡¨ï¼Œç»Ÿä¸€åŠ ä¸Šliunengï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªå‰æï¼Œä½ çš„è¡¨å¿…é¡»è¦æŒ‰ç…§ä»¥ä¸‹æ–¹å¼å£°æ˜ï¼š\nDSL.table(name(\u0026quot;my_table\u0026quot;))\r ","id":8,"section":"posts","summary":"Settingä¸­æœ‰ä¸ªé€‰é¡¹setRenderSchema(true)ï¼Œä½†æ˜¯è¿™ç§åªé€‚ç”¨äºè¡¨æ˜¯ç”±JOOQä»£ç ç”Ÿæˆå™¨ç”Ÿæˆçš„è¡¨å¯¹è±¡ã€‚ å¦‚æœæ˜¯è‡ªå·±å£°æ˜çš„è¡¨","tags":["jooq"],"title":"JOOQé»˜è®¤schema","uri":"https://www.mingaccount.com/2020/07/jooq-default-schema/","year":"2020"},{"content":"Restart-Service LxssManager\r ","id":9,"section":"posts","summary":"Restart-Service LxssManager","tags":["windows"],"title":"win10 linuxå­ç³»ç»Ÿå¦‚ä½•é‡å¯","uri":"https://www.mingaccount.com/2020/07/wsl-restart/","year":"2020"},{"content":"éœ€æå‰è®¾ç½®BreakAfterAcquireFailureä¸ºtrueï¼Œä¸ç„¶è¿æ¥é‡è¯•æ¬¡æ•°é™åˆ¶æ— æ•ˆ è¿˜éœ€è¦è®¾ç½®FailFastä¸ºtrueï¼Œä¸ç„¶åŸå§‹çº¿ç¨‹ä¼šä¸€ç›´é˜»å¡\ndataSource.setBreakAfterAcquireFailure(true);\rdataSource.setFailFast(true);\rdataSource.setConnectionErrorRetryAttempts(3);\r ","id":10,"section":"posts","summary":"éœ€æå‰è®¾ç½®BreakAfterAcquireFailureä¸ºtrueï¼Œä¸ç„¶è¿æ¥é‡è¯•æ¬¡æ•°é™åˆ¶æ— æ•ˆ è¿˜éœ€è¦è®¾ç½®FailFastä¸ºtrueï¼Œä¸ç„¶åŸå§‹","tags":["druid"],"title":"Druidæ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œæ— é™å°è¯•é—®é¢˜","uri":"https://www.mingaccount.com/2020/06/druid-connection-retry/","year":"2020"},{"content":"åŸå› æ˜¯hiveç‰ˆæœ¬å¤ªè€ï¼Œä¸èƒ½è¯†åˆ«integerï¼Œåªèƒ½è¯†åˆ«int\nå®˜æ–¹è¯´æ˜\nç”Ÿæ•ˆç‰ˆæœ¬æ˜¯0.8.0\n","id":11,"section":"posts","summary":"åŸå› æ˜¯hiveç‰ˆæœ¬å¤ªè€ï¼Œä¸èƒ½è¯†åˆ«integerï¼Œåªèƒ½è¯†åˆ«int å®˜æ–¹è¯´æ˜ ç”Ÿæ•ˆç‰ˆæœ¬æ˜¯0.8.0","tags":["hive"],"title":"hive cast( as integer)æŠ¥é”™ in primitive type specification","uri":"https://www.mingaccount.com/2020/05/hive-cast-exception/","year":"2020"},{"content":"ç”¨sparkå†™csvçš„æ—¶å€™ç¢°è§ä¸€ä¸ªé—®é¢˜ï¼ŒjoinåæœªåŒ¹é…çš„å•å…ƒåº”è¯¥æ˜¯nullï¼Œä½†æ˜¯sparkå†™å‡ºæ¥å…¨éƒ¨éƒ½ä¸º\u0026quot;\u0026quot;\nF23338994668,F23338994669,F23338995220\r12,1,1\r1,7,\u0026quot;\u0026quot;\r13,1,1\r6,1,1\r16,1,1\r åœ¨ä¹‹åhiveåŠ è½½çš„æ—¶å€™ï¼Œç”±äºè¯¥åˆ—æ˜¯æ•°å­—ç±»å‹ï¼Œç©ºå­—ç¬¦æ— æ³•åŒ¹é…æ•°å­—å­—æ®µç±»å‹ï¼Œå¯¼è‡´æœ‰ç©ºä¸²çš„æ•´è¡Œéƒ½å±•ç¤ºä¸ºnull\nF23338994668,F23338994669,F23338995220\r12,1,1\r,,,\r13,1,1\r6,1,1\r16,1,1\r è¿½è¸ªä»£ç å‘ç°åœ¨æœªå†™å…¥ä¹‹å‰ï¼Œsqlæ²¡æœ‰é—®é¢˜ï¼Œä¹Ÿæ²¡æœ‰æ‰§è¡Œna().fill()æ“ä½œï¼Œä½†åœ¨writeè¿‡åï¼Œnullå°±å˜æˆäº†\u0026quot;\u0026quot;\nè§£å†³åŠæ³•ï¼Œåœ¨sparkDF.writeä¹‹å‰è¿½åŠ é…ç½®.config(\u0026ldquo;emptyValue\u0026rdquo;,\u0026quot;\u0026quot;)å³å¯\n","id":12,"section":"posts","summary":"ç”¨sparkå†™csvçš„æ—¶å€™ç¢°è§ä¸€ä¸ªé—®é¢˜ï¼ŒjoinåæœªåŒ¹é…çš„å•å…ƒåº”è¯¥æ˜¯nullï¼Œä½†æ˜¯sparkå†™å‡ºæ¥å…¨éƒ¨éƒ½ä¸º\u0026quot;\u0026quot; F23338994668,F23338994669,F23338995220 12,1,1 1,7,\u0026quot;\u0026quot; 13,1,1 6,1,1","tags":["spark"],"title":"spark datasetå†™csvçš„æ—¶å€™å°†nullå€¼å†™ä¸ºç©ºå­—ç¬¦ä¸²","uri":"https://www.mingaccount.com/2020/05/spark-write-null-to-empty-str/","year":"2020"},{"content":"spark decimalåˆ—è¿›è¡Œè®¡ç®—æ—¶ï¼Œå¯èƒ½ä¸¢å¤±ç²¾åº¦\nåœ¨é»˜è®¤æƒ…å†µä¸‹[spark.sql.decimalOperations.allowPrecisionLoss]é…ç½®ä¸ºtrueï¼Œä¼šå¯¼è‡´ç²¾åº¦ä¸¢å¤±çš„åˆ—å±•ç¤ºä¸ºnull\nä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¿®æ”¹sparké…ç½®å³å¯è§£å†³ï¼š\nspark.sql.decimalOperations.allowPrecisionLoss=false\r å‚è€ƒå®˜æ–¹è¯´æ˜\nä½†æ˜¯åœ¨å¦‚ä¸‹ä¾‹å­ä¸­è¿˜ä¼šå‡ºç°ç»“æœåˆ—ä¸ºnullçš„æƒ…å†µï¼š\nIF(column1 IS NULL,0,column1) - IF(column2 IS NULL,0,column2)\r å»æ‰IFåˆ¤æ–­ï¼Œå°±èƒ½æ­£å¸¸è·å–ç»“æœ\n","id":13,"section":"posts","summary":"spark decimalåˆ—è¿›è¡Œè®¡ç®—æ—¶ï¼Œå¯èƒ½ä¸¢å¤±ç²¾åº¦ åœ¨é»˜è®¤æƒ…å†µä¸‹[spark.sql.decimalOperations.allowPrecision","tags":["spark"],"title":"sparkç²¾åº¦ä¸¢å¤±ï¼Œå¯¼è‡´åˆ—æŸ¥è¯¢ä¸ºnullçš„è§£å†³åŠæ³•","uri":"https://www.mingaccount.com/2020/04/spark-precision-loss/","year":"2020"},{"content":"å®ç°æ–¹å¼æ˜¯è‡ªå®šä¹‰è§¦å‘å™¨\ndrop trigger if exists trigger_name;\rdelimiter |\rCREATE TRIGGER trigger_name BEFORE INSERT ON table_name\rFOR EACH ROW BEGIN\rdeclare original_column_name varchar(255);\rdeclare column_name_counter int;\rset original_column_name = new.column_name;\rset column_name_counter = 1;\rwhile exists (select true from pc_volumes where name = new.column_name) do\rset new.column_name = concat(original_column_name, '-', column_name_counter);\rset column_name_counter = column_name_counter + 1;\rend while;\rEND;\r|\rdelimiter ;\r ","id":14,"section":"posts","summary":"å®ç°æ–¹å¼æ˜¯è‡ªå®šä¹‰è§¦å‘å™¨ drop trigger if exists trigger_name; delimiter | CREATE TRIGGER trigger_name BEFORE INSERT ON table_name FOR EACH ROW BEGIN declare original_column_name varchar(255); declare column_name_counter int; set original_column_name = new.column_name; set column_name_counter = 1; while exists (select true from pc_volumes where name = new.column_name) do set new.column_name = concat(original_column_name, '-', column_name_counter); set column_name_counter = column_name_counter + 1; end while; END; |","tags":["mysql"],"title":"Mysqlæ’å…¥é‡å¤å€¼è¿½åŠ åç¼€","uri":"https://www.mingaccount.com/2020/04/mysql-duplicate-value-add-appendix/","year":"2020"},{"content":"ä¸€ã€æ‰“å¼€sbtå®‰è£…è·¯å¾„æ‰¾åˆ°conf\\sbtconfig.txtï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»“åº“æ–‡ä»¶åœ°å€ -Dsbt.repository.config=%SBT_HOME/sbt/conf/repository.properties\r äºŒã€åœ¨å¯¹åº”ç›®å½•åˆ›å»ºrepository.propertiesï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹ [repositories]\rlocal\raliyun-nexus: http://maven.aliyun.com/nexus/content/groups/public/ ibiblio-maven: http://maven.ibiblio.org/maven2/\rtypesafe-ivy: https://dl.bintray.com/typesafe/ivy-releases/, [organization]/[module]/(scala_[scalaVersion]/)(sbt_[sbtVersion]/)[revision]/[type]s/[artifact](-[classifier]).[ext]\ruk-repository: http://uk.maven.org/maven2/\rjboss-repository: http://repository.jboss.org/nexus/content/groups/public/\rtypesafe: http://repo.typesafe.com/typesafe/ivy-releases/, [organization]/[module]/(scala_[scalaVersion]/)(sbt_[sbtVersion]/)[revision]/[type]s/[artifact](-[classifier]).[ext], bootOnly\rsonatype-oss-releases\rmaven-central\rsonatype-oss-snapshots\r ä¸‰ã€åŒæ—¶åœ¨~/.sbt(windowsåœ¨â€œç”¨æˆ·/.sbtâ€)ä¸‹åˆ›å»ºæ–‡ä»¶repositoriesï¼Œå¹¶æ·»åŠ ä¸Šé¢çš„å†…å®¹ ","id":15,"section":"posts","summary":"ä¸€ã€æ‰“å¼€sbtå®‰è£…è·¯å¾„æ‰¾åˆ°conf\\sbtconfig.txtï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»“åº“æ–‡ä»¶åœ°å€ -Dsbt.repository.config=%SBT_HOME/sbt/conf/repository.properties äºŒã€åœ¨å¯¹åº”ç›®å½•åˆ›å»ºrepository.prop","tags":["scala"],"title":"SBTä»“åº“é•œåƒé…ç½®","uri":"https://www.mingaccount.com/2020/02/sbt-repository-mirror/","year":"2020"},{"content":"è¿™é‡Œä¸»è¦å‚ç…§NameCheapï¼Œå…¶ä»–åŸŸåæœåŠ¡å•†å¤§åŒå°å¼‚ host:\n@ä»£è¡¨åœ¨æµè§ˆå™¨è¾“å…¥yourdomain.tldæƒ³è·³è½¬åˆ°çš„åœ°å€\nwwwä»£è¡¨åœ¨æµè§ˆå™¨è¾“å…¥www.yourdomain.tldæƒ³è·³è½¬åˆ°çš„åœ°å€\nè·³è½¬åˆ°æŒ‡å®šIP    type host target     A Record @ 11.22.33.44   A Record www 11.22.33.44    è·³è½¬åˆ°æŒ‡å®šåŸŸå    type host target     CNAME Record @ [name].github.io   CNAME Record www [name].github.io    NameCheapçš„è¯¦ç»†è¯´æ˜\n","id":16,"section":"posts","summary":"è¿™é‡Œä¸»è¦å‚ç…§NameCheapï¼Œå…¶ä»–åŸŸåæœåŠ¡å•†å¤§åŒå°å¼‚ host: @ä»£è¡¨åœ¨æµè§ˆå™¨è¾“å…¥yourdomain.tldæƒ³è·³è½¬åˆ°çš„åœ°å€ wwwä»£è¡¨åœ¨æµè§ˆå™¨è¾“å…¥w","tags":["website build"],"title":"æ€ä¹ˆç»™è‡ªå·±çš„åŸŸåæŒ‡å®šIP","uri":"https://www.mingaccount.com/2020/02/how-to-bind-ip-to-domain/","year":"2020"},{"content":"select\ra.date\r, a.measure\r, case\rwhen b.measure is null\ror b.measure=0\rthen null\relse concat( cast( cast((if(a.measure is null, 0, a.measure)-if(b.measure is null,0,b.measure))*100/b.measure as decimal(10,2))ã€€as string)ã€€,'%')\rend as ratio_column\rfrom\rtest_table a\rleft join\rtest_table b\ron\r(\rto_date(from_unixtime(unix_timestamp(concat(a.date,''),'yyyyMM'),'yyyy-MM-dd HH:mm:ss')) = add_months(to_date(from_unixtime(unix_timestamp(concat(b.date,''),'yyyyMM'),'yyyy-MM-dd HH:mm:ss')),+1)\rand 1 = 1\r)\r æé†’ï¼š ã€€1. ç¬¬ä¸€ä¸ªjoinæ¡ä»¶çš„\u0026rsquo;yyyyMM\u0026rsquo;å¯ä»¥æ ¹æ®å­—æ®µdateçš„å…·ä½“æ ¼å¼æ”¹å˜ï¼Œ\u0026lsquo;yyyy-MM-dd HH:mm:ss\u0026rsquo;ä¸éœ€è¦æ”¹å˜\nã€€2. è¯¥åŒç¯æ¯”æ²¡æœ‰ä»»ä½•åˆ†ç»„å’Œæ±‡æ€»ï¼Œæ‰€ä»¥ä¸€æ—¦dateå­—æ®µæœ‰é‡å¤å€¼ï¼Œå¾ˆå®¹æ˜“å‡ºç°ç¬›å¡å°”ç§¯ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ç¡®ä¿joinæ¡ä»¶èƒ½å¤Ÿç¡®å®šä¸€æ¡æ•°æ®åœ¨è¡¨ä¸­çš„å”¯ä¸€æ€§\n","id":17,"section":"posts","summary":"select a.date , a.measure , case when b.measure is null or b.measure=0 then null else concat( cast( cast((if(a.measure is null, 0, a.measure)-if(b.measure is null,0,b.measure))*100/b.measure as decimal(10,2)) as string) ,'%') end as ratio_column from test_table a left join test_table b on ( to_date(from_unixtime(unix_timestamp(concat(a.date,''),'yyyyMM'),'yyyy-MM-dd HH:mm:ss')) = add_months(to_date(from_unixtime(unix_timestamp(concat(b.date,''),'yyyyMM'),'yyyy-MM-dd HH:mm:ss')),+1) and 1 = 1 ) æé†’ï¼š 1. ç¬¬ä¸€ä¸ªjoinæ¡ä»¶çš„\u0026rsqu","tags":["hive"],"title":"HiveåŒç¯æ¯”å®ç°","uri":"https://www.mingaccount.com/2020/02/hive-ratio-implement/","year":"2020"},{"content":"hiveçš„æ—¥æœŸæ ¼å¼å¯ç”±Stringç±»å‹ä¿å­˜ï¼Œåªèƒ½è¯†åˆ«ä¸¤ç§æ ¼å¼yyyy-MM-ddå’Œyyyy-MM-dd HH:mm:ssã€‚\nåªè¦å°†æ—¥æœŸè½¬ä¸ºè¿™ä¸¤ç§æ ¼å¼hiveå°±èƒ½è¯†åˆ«ä¸ºæ—¥æœŸã€‚ä¹Ÿå°±æ˜¯ä¸ç®¡to_dateã€to_charéƒ½æ˜¯å°†æ—¥æœŸæ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚\nunix_timestamp(æ—¥æœŸå­—ç¬¦ä¸²,æ—¥æœŸæ ¼å¼) è¿”å›æ—¥æœŸæ—¶é—´æˆ³\nfrom_unixtime(æ—¥æœŸæ—¶é—´æˆ³,æ—¥æœŸæ ¼å¼) è¿”å›æ—¥æœŸå­—ç¬¦ä¸²\nto_dateï¼Œto_charéƒ½ç”¨çš„ä¸€ä¸ªå…¬å¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯to_dateçš„ç›®æ ‡æ—¥æœŸæ ¼å¼æ˜¯å†™æ­»çš„\n1.to_date\nfrom_unixtime(unix_timestamp(æ¥æºæ—¥æœŸï¼Œæ¥æºæ—¥æœŸæ ¼å¼),\u0026lsquo;yyyy-MM-dd HH:mm:ss\u0026rsquo;)\nä¾‹ï¼š\nfrom_unixtime(unix_timestamp('2020/02/03 17:35:00','yyyy/MM/dd HH-mm-ss'),'yyyy-MM-dd HH:mm:ss')\r 2.to_char\nfrom_unixtime(unix_timestamp(æ¥æºæ—¥æœŸï¼Œæ¥æºæ—¥æœŸæ ¼å¼),ç›®æ ‡æ—¥æœŸæ ¼å¼)\nä¾‹ï¼š\nfrom_unixtime(unix_timestamp('2020/02/03 17:35:00','yyyy/MM/dd HH-mm-ss'),'yyyy-MM-dd HH:mm:ss')\r ","id":18,"section":"posts","summary":"hiveçš„æ—¥æœŸæ ¼å¼å¯ç”±Stringç±»å‹ä¿å­˜ï¼Œåªèƒ½è¯†åˆ«ä¸¤ç§æ ¼å¼yyyy-MM-ddå’Œyyyy-MM-dd HH:mm:ssã€‚ åªè¦å°†æ—¥æœŸè½¬ä¸ºè¿™ä¸¤ç§","tags":["hive"],"title":"Hiveä¸­çš„to_dateå’Œto_char","uri":"https://www.mingaccount.com/2020/02/hive-todate-tochar/","year":"2020"},{"content":"String.format(\u0026quot;(?\u0026lt;![\\\\u4E00-\\\\u9FA5aa-zA-Z0-9_])%s(?![\\\\u4E00-\\\\u9FA5a-zA-Z0-9_])\u0026quot;,\u0026quot;ç‹¬ç«‹å­—ç¬¦ä¸ä¸ä»»ä½•å…¶ä»–å­—ç¬¦ç›¸è¿\u0026quot;)\r ","id":19,"section":"posts","summary":"String.format(\u0026quot;(?\u0026lt;![\\\\u4E00-\\\\u9FA5aa-zA-Z0-9_])%s(?![\\\\u4E00-","tags":["regexp"],"title":"åƒIDEAä¸€æ ·åŒ¹é…ä¸€ä¸ªWORDS","uri":"https://www.mingaccount.com/2020/01/regex-match-words-like-idea/","year":"2020"},{"content":"æ ¹æ®ç‰ˆæœ¬ä¸åŒï¼Œå®˜æ–¹æ–‡æ¡£æœ‰è¯¦ç»†è¯´æ˜\nä½¿ç”¨å‚ç…§æ–‡æ¡£\næŸ¥è¯¢ç»“æœå¯¹ç…§æ–‡æ¡£\n","id":20,"section":"posts","summary":"æ ¹æ®ç‰ˆæœ¬ä¸åŒï¼Œå®˜æ–¹æ–‡æ¡£æœ‰è¯¦ç»†è¯´æ˜ ä½¿ç”¨å‚ç…§æ–‡æ¡£ æŸ¥è¯¢ç»“æœå¯¹ç…§æ–‡æ¡£","tags":["mysql"],"title":"Mysql Explainç”¨æ³•è¯¦è§£","uri":"https://www.mingaccount.com/2019/12/mysql-explain/","year":"2019"},{"content":"åˆ‡è®°ï¼ï¼ï¼ï¼ï¼\næ²¡æœ‰æ¯”å®˜ç½‘æ•™ç¨‹æ›´è¯¦ç»†ï¼Œæ›´é è°±çš„æ•™ç¨‹ï¼ï¼ï¼ï¼ï¼\nå…¶ä»–çš„åŸºæœ¬éƒ½æ˜¯å®˜ç½‘çš„ç¿»è¯‘ï¼Œä½†æ˜¯å®˜ç½‘çš„æ•™ç¨‹æ˜¯å®æ—¶æ›´æ–°çš„ï¼Œè¦æ˜¯ä¸æ³¨æ„ç‰ˆæœ¬ï¼Œå‘æ ¹æœ¬å°±è¸©ä¸å®Œï¼ï¼ï¼\né™„ä¸Šå®˜ç½‘éƒ¨ç½²æ•™ç¨‹ï¼š\nhttps://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html\n$\\color{#DAA520}{å•èŠ‚ç‚¹çš„å®‰è£…åªéœ€è¦å…³æ³¨ä¸¤ä¸ªç‚¹ï¼š}$\n1.linuxå®‰è£…çš„javaç‰ˆæœ¬ï¼Œå„ä¸ªç‰ˆæœ¬çš„hadoopå¯¹javaç‰ˆæœ¬æ˜¯è¦æ±‚çš„ï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š https://cwiki.apache.org/confluence/display/HADOOP/Hadoop+Java+Versions\nã€€2.åœ¨å¤šæ¬¡æ‰§è¡Œhdfs dfs -formatåï¼Œnamenodeå’Œdatanodeçš„clusteridå¯èƒ½å¯¹ä¸ä¸Šï¼Œåœ¨formatä¹‹å‰éœ€è¦åˆ é™¤tmp/hadoop-hadoopç›®å½•\n","id":21,"section":"posts","summary":"åˆ‡è®°ï¼ï¼ï¼ï¼ï¼ æ²¡æœ‰æ¯”å®˜ç½‘æ•™ç¨‹æ›´è¯¦ç»†ï¼Œæ›´é è°±çš„æ•™ç¨‹ï¼ï¼ï¼ï¼ï¼ å…¶ä»–çš„åŸºæœ¬éƒ½æ˜¯å®˜ç½‘çš„ç¿»è¯‘ï¼Œä½†æ˜¯å®˜ç½‘çš„æ•™ç¨‹æ˜¯å®æ—¶æ›´æ–°çš„ï¼Œè¦æ˜¯ä¸æ³¨æ„ç‰ˆæœ¬ï¼Œå‘æ ¹æœ¬å°±è¸©ä¸","tags":["hadoop"],"title":"Hadoopå®‰è£…è¸©å‘","uri":"https://www.mingaccount.com/2019/12/hadoop-shit/","year":"2019"},{"content":"Springä¾èµ–æ³¨å…¥æ–¹å¼  ç›´æ¥ä¿®é¥°æˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯æé†’ä¸æ¨èçš„æƒ…å†µ  @RestController\rpublic class TestController{\r@Autowired\rprivate TestService testService;\r}\r ä¿®é¥°æ„é€ å‡½æ•°ï¼Œ@Autowiredå¯çœç•¥  @RestController\rpublic class TestController{\rprivate TestService testService;\rpublic TestController(TestService testService) {\rthis.testService = testService;\r}\r}\r ä¿®é¥°setterå‡½æ•°ï¼Œ@Autowiredå¯çœç•¥  @RestController\rpublic class TestController{\rprivate TestService testService;\rpublic void SetTestService(TestService testService) {\rthis.testService = testService;\r}\r}\r ä¸æ¨èç›´æ¥ä¿®é¥°çš„åŸå›   @Autowiredä¸èƒ½ä½œç”¨åœ¨finalçš„æˆå‘˜å˜é‡ä¸Š ç›´æ¥ä¿®é¥°æˆå‘˜å˜é‡ä¼šå¯¼è‡´å˜é‡ç›´æ¥ä¾èµ–Springå®¹å™¨ï¼Œè„±ç¦»Springå®¹å™¨å°±æ— æ³•åˆå§‹åŒ–ï¼Œç„¶è€Œé€šè¿‡æ„é€ å‡½æ•°æˆ–setterå‡½æ•°çš„æ–¹å¼éƒ½æ˜¯å¯ä»¥è„±ç¦»Springå®¹å™¨çš„ä½¿ç”¨çš„ ç›´æ¥ä¿®é¥°çš„æ–¹å¼ä¼šè®©ä½ å¿½ç•¥å½“å‰ç±»æœ‰å¤šå°‘ä¾èµ–ï¼Œä¸åˆ©äºä»£ç é‡æ„å’Œä¼˜åŒ–  ","id":22,"section":"posts","summary":"Springä¾èµ–æ³¨å…¥æ–¹å¼ ç›´æ¥ä¿®é¥°æˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯æé†’ä¸æ¨èçš„æƒ…å†µ @RestController public class TestController{ @Autowired private TestService testService; } ä¿®é¥°æ„é€ å‡½æ•°ï¼Œ@Autowiredå¯çœç•¥ @RestController public class TestController{ private TestService testService; public TestController(TestService","tags":["spring"],"title":"@Autowiredæ³¨è§£ç›´æ¥ä¿®é¥°åœ¨æˆå‘˜å˜é‡æ—¶æé†’Field injection is not recommended","uri":"https://www.mingaccount.com/2019/12/field-injection-not-recommended/","year":"2019"},{"content":"é¦–å…ˆç¡®ä¿å®‰è£…SSH serverï¼š\nsudo apt-get install openssh-server\r å¯åŠ¨SSH server:\nsudo service ssh start\r#æ£€æŸ¥sshæ˜¯å¦æ­£å¸¸å¯åŠ¨\rssh localhost\r å®‰è£…åï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç™»é™†æœ¬æœºï¼š\nssh localhost\r æ­¤æ—¶ä¼šæœ‰SSHé¦–æ¬¡ç™»é™†æç¤ºï¼Œè¾“å…¥ yes ã€‚ç„¶åæŒ‰æç¤ºè¾“å…¥å¯†ç  hadoopï¼Œè¿™æ ·å°±ç™»é™†åˆ°æœ¬æœºäº†ã€‚\nä½†è¿™æ ·ç™»é™†æ˜¯éœ€è¦æ¯æ¬¡è¾“å…¥å¯†ç çš„ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®æˆSSHæ— å¯†ç ç™»é™†ã€‚\næœ‰ä»¥ä¸‹ä¸¤ç§å®ç°æ–¹æ³•ï¼š\nã€€ä¸€ã€é¦–å…ˆé€€å‡ºåˆšæ‰çš„ sshï¼Œå°±å›åˆ°äº†æˆ‘ä»¬åŸå…ˆçš„ç»ˆç«¯çª—å£ï¼Œç„¶ååˆ©ç”¨ ssh-keygen ç”Ÿæˆå¯†é’¥ï¼Œå¹¶å°†å¯†é’¥åŠ å…¥åˆ°æˆæƒä¸­ï¼š\n# é€€å‡ºåˆšæ‰çš„ ssh localhost\rexit\r# è‹¥æ²¡æœ‰è¯¥ç›®å½•ï¼Œè¯·å…ˆæ‰§è¡Œä¸€æ¬¡ssh localhost\rcd ~/.ssh/\r# ä¼šæœ‰æç¤ºï¼Œéƒ½æŒ‰å›è½¦å°±å¯\rssh-keygen -t rsa\r# åŠ å…¥æˆæƒ\rcat ./id_rsa.pub \u0026gt;\u0026gt; ./authorized_keys  ã€€äºŒã€ã€€#1\rssh localhost\r #2\rssh-keygen -t dsa -P '' -f ~/.ssh/id_dsa\rcat ~/.ssh/id_dsa.pub \u0026gt;\u0026gt; ~/.ssh/authorized_keys\r #3\rssh localhost\r #4 è¦ä¿è¯ï¼š~/.sshéœ€è¦æ˜¯700æƒé™ authorized_keyséœ€è¦æ˜¯644æƒé™\rchmod 700 ~/.ssh\rchmod 644 ~/.ssh/authorized_keys\r #5 æ­¤æ—¶è¿›å…¥åˆ°~/.sshç›®å½•ä¸‹ï¼Œä¼šçœ‹åˆ°å¤šäº†ä¸€ä¸ªæ–‡ä»¶know_hostsæ–‡ä»¶\r #6 é€€å‡ºexitï¼Œé‡æ–°æ‰“å¼€shell\r #7.æœ€åssh localhostéªŒè¯ä¸€ä¸‹\r ã€€","id":23,"section":"posts","summary":"é¦–å…ˆç¡®ä¿å®‰è£…SSH serverï¼š sudo apt-get install openssh-server å¯åŠ¨SSH server: sudo service ssh start #æ£€æŸ¥sshæ˜¯å¦æ­£å¸¸å¯åŠ¨ ssh localhost å®‰è£…åï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç™»é™†æœ¬æœºï¼š ssh localhost æ­¤æ—¶ä¼šæœ‰SSH","tags":["hadoop"],"title":"Hadoop ssh localhost æ— å¯†ç ç™»å½•","uri":"https://www.mingaccount.com/2019/12/hadoop-ssh-local-host-no-paw/","year":"2019"},{"content":"å®Œæ•´å¼‚å¸¸ [42611][-604] The length, precision, or scale attribute for column, distinct type, structured type, array type, attribute of structured type, routine, cast target type, type mapping, or global variable \u0026quot;decimal(38, 2)\u0026quot; is not valid.. SQLCODE=-604, SQLSTATE=42611, DRIVER=4.26.14 [56098][-727] An error occurred during implicit system action type \u0026quot;2\u0026quot;. Information returned for the error includes SQLCODE \u0026quot;-604\u0026quot;, SQLSTATE \u0026quot;42611\u0026quot; and message tokens \u0026quot;decimal(38, 2)\u0026quot;.. SQLCODE=-727, SQLSTATE=56098, DRIVER=4.26.14\r æŠ¥é”™sql SELECT cast(a as decimal(38,2)) from table\r æŠ¥é”™åŸå›  DECIMAL (p, s) p = 1 to 31; s = 1 to 31\n","id":24,"section":"posts","summary":"å®Œæ•´å¼‚å¸¸ [42611][-604] The length, precision, or scale attribute for column, distinct type, structured type, array type, attribute of structured type, routine, cast target type, type mapping, or global variable \u0026quot;decimal(38, 2)\u0026quot; is not valid.. SQLCODE=-604, SQLSTATE=42611, DRIVER=4.26.14 [56098][-727] An error occurred during implicit system action type \u0026quot;2\u0026quot;. Information returned for the error includes SQLCODE \u0026quot;-604\u0026quot;, SQLSTATE \u0026quot;42611\u0026quot; and message tokens \u0026quot;decimal(38, 2)\u0026quot;.. SQLCODE=-727, SQLSTATE=56098, DRIVER=4.26.14 æŠ¥é”™","tags":["db2"],"title":"db2 cast decimalå¼‚å¸¸","uri":"https://www.mingaccount.com/2019/11/db2-cast-decimal-exception/","year":"2019"},{"content":"å®Œæ•´å¼‚å¸¸  Arithmetic overflow or other arithmetic exception occurred.. SQLCODE=-802, SQLSTATE=22003, DRIVER=4.26.14\n æŠ¥é”™sql SELECT SUM(C_1788) FROM table\r c_1788åˆ—æ˜¯integerç±»å‹\næŠ¥é”™åŸå›  c_1788åˆ—æ•°å€¼é•¿åº¦ä¸º9ï¼Œsumå€¼è‚¯å®šæº¢å‡º\n","id":25,"section":"posts","summary":"å®Œæ•´å¼‚å¸¸ Arithmetic overflow or other arithmetic exception occurred.. SQLCODE=-802, SQLSTATE=22003, DRIVER=4.26.14 æŠ¥é”™sql SELECT SUM(C_1788) FROM table c_1788åˆ—æ˜¯integerç±»å‹ æŠ¥é”™åŸå›  c_1788åˆ—æ•°å€¼é•¿åº¦ä¸º9ï¼Œsumå€¼è‚¯å®šæº¢å‡º","tags":["db2"],"title":"db2 sumå‡½æ•°æŠ¥é”™Arithmetic overflow...","uri":"https://www.mingaccount.com/2019/11/db2sumerror/","year":"2019"},{"content":"è¯¦ç»†å¼‚å¸¸ Docker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock  è§£å†³æ–¹æ¡ˆ sudo usermod -a -G docker jenkins  åŸå› æ˜¯jenkinsç”¨æˆ·è¿˜æ²¡æœ‰è¢«åŠ åˆ°dockerç»„é‡Œé¢\n å‚è€ƒstackoverflow\n ","id":26,"section":"posts","summary":"è¯¦ç»†å¼‚å¸¸ Docker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock è§£å†³æ–¹æ¡ˆ sudo usermod -a -G docker jenkins åŸå› æ˜¯jenkinsç”¨æˆ·è¿˜æ²¡æœ‰è¢«åŠ åˆ°dockerç»„é‡Œé¢ å‚è€ƒstackoverflo","tags":["jenkins"],"title":"Docker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock","uri":"https://www.mingaccount.com/2019/11/jenkins-docker-command-permission-denied/","year":"2019"},{"content":"èƒŒæ™¯ åœ¨execute shellä¸­å†™çš„å‘½ä»¤è€æ˜¯å‡ºé”™ï¼Œå„ç§æƒé™é—®é¢˜ï¼Œä½†æ˜¯ç›´æ¥åœ¨ç›®æ ‡æ–‡ä»¶å¤¹é‡Œæ‰§è¡Œå‘½ä»¤åˆæ²¡æœ‰é—®é¢˜ã€‚\nåŸå›  ä¸»è¦å°±æ˜¯ç”¨æˆ·æƒé™çš„é—®é¢˜ï¼Œåˆ‡æ¢åˆ°jenkinsç”¨æˆ·æ“ä½œå³å¯su - jenkins\n","id":27,"section":"posts","summary":"èƒŒæ™¯ åœ¨execute shellä¸­å†™çš„å‘½ä»¤è€æ˜¯å‡ºé”™ï¼Œå„ç§æƒé™é—®é¢˜ï¼Œä½†æ˜¯ç›´æ¥åœ¨ç›®æ ‡æ–‡ä»¶å¤¹é‡Œæ‰§è¡Œå‘½ä»¤åˆæ²¡æœ‰é—®é¢˜ã€‚ åŸå›  ä¸»è¦å°±æ˜¯ç”¨æˆ·æƒé™çš„é—®é¢˜ï¼Œåˆ‡æ¢åˆ°","tags":["jenkins","maven","git"],"title":"jenkinsæ‰¾ä¸åˆ°æœ¬åœ°ä»“åº“ä¸­çš„jaråŒ…","uri":"https://www.mingaccount.com/2019/10/jenkins-mavne-local-artifact/","year":"2019"},{"content":"ä½œè€…ï¼šå­¤ç‹¬çƒŸ\né“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/73260510\næ¥æºï¼šçŸ¥ä¹\nè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nOKï¼Œå…·ä½“æœ‰ä¸‹é¢è¿™äº›é—®é¢˜\n1.ä¸ºä»€ä¹ˆä¸€å®šè¦è®¾ä¸€ä¸ªä¸»é”®ï¼Ÿ\n2.ä½ ä»¬ä¸»é”®æ˜¯ç”¨è‡ªå¢è¿˜æ˜¯UUID?\n3.ä¸»é”®ä¸ºä»€ä¹ˆä¸æ¨èæœ‰ä¸šåŠ¡å«ä¹‰?\n4.è¡¨ç¤ºæšä¸¾çš„å­—æ®µä¸ºä»€ä¹ˆä¸ç”¨enumç±»å‹ï¼Ÿ\n5.è´§å¸å­—æ®µç”¨ä»€ä¹ˆç±»å‹? 6.æ—¶é—´å­—æ®µç”¨ä»€ä¹ˆç±»å‹?\n7.ä¸ºä»€ä¹ˆä¸ç›´æ¥å­˜å‚¨å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰å¤§å®¹é‡å†…å®¹?\n8.å­—æ®µä¸ºä»€ä¹ˆè¦å®šä¹‰ä¸ºNOT NULL?\nå…¶å®ä¸Šé¢è¿™äº›é—®é¢˜ï¼Œæˆ‘æœ€æ—©æƒ³æ³•æ˜¯ï¼Œæ¯ä¸ªé—®é¢˜éƒ½å¯ä»¥å•°å—¦å‡ºä¸€ç¯‡æ–‡ç« ã€‚åæ¥ç”±äºè‰¯å¿ƒå‘ç°ï¼ŒçƒŸå“¥å°±å†³å®šç”¨ä¸€ç¯‡æ–‡ç« å°†è¿™äº›é—®é¢˜éƒ½è®²æ˜ç™½ã€‚ å½“ç„¶ï¼Œæˆ‘ç»™çš„å›ç­”å¯èƒ½å¹¶éæ ‡å‡†ç­”æ¡ˆï¼Œæ¯•ç«Ÿæ˜¯è‡ªå·±çš„ä¸€äº›å·¥ä½œæ€»ç»“ã€‚å„ä½è¯»è€…æœ‰æ›´å¥½çš„å›ç­”ï¼Œä¹Ÿæ¬¢è¿äº¤æµï¼\nè¿™é‡Œæˆ‘è¦è¯´ä¸€ä¸‹ï¼Œæˆ‘ç”¨mysqlåªç”¨è¿‡innodbå­˜å‚¨å¼•æ“ï¼Œå…¶ä»–çš„å¼•æ“çœŸæ²¡ç”¨è¿‡ã€‚å› æ­¤æˆ‘çš„å›ç­”ï¼Œéƒ½æ˜¯åŸºäºinnodbå­˜å‚¨å¼•æ“ä¸­çš„ã€‚\næ­£æ–‡ é—®é¢˜1:ä¸ºä»€ä¹ˆä¸€å®šè¦è®¾ä¸€ä¸ªä¸»é”®ï¼Ÿ å›ç­”:å› ä¸ºä½ ä¸è®¾ä¸»é”®çš„æƒ…å†µä¸‹ï¼Œinnodbä¹Ÿä¼šå¸®ä½ ç”Ÿæˆä¸€ä¸ªéšè—åˆ—ï¼Œä½œä¸ºè‡ªå¢ä¸»é”®ã€‚æ‰€ä»¥å•¦ï¼Œåæ­£éƒ½è¦ç”Ÿæˆä¸€ä¸ªä¸»é”®ï¼Œé‚£ä½ è¿˜ä¸å¦‚è‡ªå·±æŒ‡å®šä¸€ä¸ªä¸»é”®ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œå°±èƒ½æ˜¾å¼çš„ç”¨ä¸Šä¸»é”®ç´¢å¼•ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ï¼\né—®é¢˜2:ä¸»é”®æ˜¯ç”¨è‡ªå¢è¿˜æ˜¯UUID? å›ç­”:è‚¯å®šç­”è‡ªå¢å•Šã€‚innodb ä¸­çš„ä¸»é”®æ˜¯èšç°‡ç´¢å¼•ã€‚å¦‚æœä¸»é”®æ˜¯è‡ªå¢çš„ï¼Œé‚£ä¹ˆæ¯æ¬¡æ’å…¥æ–°çš„è®°å½•ï¼Œè®°å½•å°±ä¼šé¡ºåºæ·»åŠ åˆ°å½“å‰ç´¢å¼•èŠ‚ç‚¹çš„åç»­ä½ç½®ï¼Œå½“ä¸€é¡µå†™æ»¡ï¼Œå°±ä¼šè‡ªåŠ¨å¼€è¾Ÿä¸€ä¸ªæ–°çš„é¡µã€‚å¦‚æœä¸æ˜¯è‡ªå¢ä¸»é”®ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šåœ¨ä¸­é—´æ’å…¥ï¼Œå°±ä¼šå¼•å‘é¡µçš„åˆ†è£‚ï¼Œäº§ç”Ÿå¾ˆå¤šè¡¨ç¢ç‰‡ï¼ã€‚\nä¸Šé¢é‚£å¥è¯çœ‹ä¸æ‡‚æ²¡äº‹ï¼Œå¤§ç™½è¯ä¸€å¥å°±æ˜¯:ç”¨è‡ªå¢æ’å…¥æ€§èƒ½å¥½ï¼\nå¦å¤–ï¼Œé™„ä¸€ä¸ªæµ‹è¯•è¡¨ç»™ä½ ä»¬ï¼Œè¡¨åå¸¦uuidçš„å°±æ˜¯ç”¨uuidä½œä¸ºä¸»é”®ã€‚å¤§å®¶çœ‹ä¸€ä¸‹å°±çŸ¥é“æ€§èƒ½å·®è·äº†:\nå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“ä¸»é”®æ˜¯UUIDçš„æ—¶å€™ï¼Œæ’å…¥æ—¶é—´æ›´é•¿ï¼Œè€Œä¸”å ç”¨ç©ºé—´æ›´å¤§ï¼\npsï¼šè¿™ä¸ªé—®é¢˜ï¼Œä½ è¦æ˜¯èƒ½æŠŠUUIDè®²å‡ºåˆç†çš„ç†ç”±ä¹Ÿè¡Œã€‚\né—®é¢˜3:ä¸»é”®ä¸ºä»€ä¹ˆä¸æ¨èæœ‰ä¸šåŠ¡å«ä¹‰? å›ç­”:æœ‰å¦‚ä¸‹ä¸¤ä¸ªåŸå› \n å› ä¸ºä»»ä½•æœ‰ä¸šåŠ¡å«ä¹‰çš„åˆ—éƒ½æœ‰æ”¹å˜çš„å¯èƒ½æ€§,ä¸»é”®ä¸€æ—¦å¸¦ä¸Šäº†ä¸šåŠ¡å«ä¹‰ï¼Œé‚£ä¹ˆä¸»é”®å°±æœ‰å¯èƒ½å‘ç”Ÿå˜æ›´ã€‚ä¸»é”®ä¸€æ—¦å‘ç”Ÿå˜æ›´ï¼Œè¯¥æ•°æ®åœ¨ç£ç›˜ä¸Šçš„å­˜å‚¨ä½ç½®å°±ä¼šå‘ç”Ÿå˜æ›´ï¼Œæœ‰å¯èƒ½ä¼šå¼•å‘é¡µåˆ†è£‚ï¼Œäº§ç”Ÿç©ºé—´ç¢ç‰‡ã€‚ å¸¦æœ‰ä¸šåŠ¡å«ä¹‰çš„ä¸»é”®ï¼Œä¸ä¸€å®šæ˜¯é¡ºåºè‡ªå¢çš„ã€‚é‚£ä¹ˆå°±ä¼šå¯¼è‡´æ•°æ®çš„æ’å…¥é¡ºåºï¼Œå¹¶ä¸èƒ½ä¿è¯åé¢æ’å…¥æ•°æ®çš„ä¸»é”®ä¸€å®šæ¯”å‰é¢çš„æ•°æ®å¤§ã€‚å¦‚æœå‡ºç°äº†ï¼Œåé¢æ’å…¥æ•°æ®çš„ä¸»é”®æ¯”å‰é¢çš„å°ï¼Œå°±æœ‰å¯èƒ½å¼•å‘é¡µåˆ†è£‚ï¼Œäº§ç”Ÿç©ºé—´ç¢ç‰‡ã€‚  é—®é¢˜4:è¡¨ç¤ºæšä¸¾çš„å­—æ®µä¸ºä»€ä¹ˆä¸ç”¨enumç±»å‹ï¼Ÿ å›ç­”:åœ¨å·¥ä½œä¸­è¡¨ç¤ºæšä¸¾çš„å­—æ®µï¼Œä¸€èˆ¬ç”¨tinyintç±»å‹ã€‚\né‚£ä¸ºä»€ä¹ˆä¸ç”¨enumç±»å‹å‘¢ï¼Ÿä¸‹é¢ä¸¤ä¸ªåŸå› \n(1)ENUMç±»å‹çš„ORDER BYæ“ä½œæ•ˆç‡ä½ï¼Œéœ€è¦é¢å¤–æ“ä½œ\n(2)å¦‚æœæšä¸¾å€¼æ˜¯æ•°å€¼ï¼Œæœ‰é™·é˜± ä¸¾ä¸ªä¾‹å­ï¼Œè¡¨ç»“æ„å¦‚ä¸‹\nCREATE TABLE test (foobar ENUM('0', '1', '2'));\r æ­¤æ—¶ï¼Œä½ æ‰§è¡Œè¯­å¥\nmysql\u0026gt; INSERT INTO test VALUES (1);\r æŸ¥è¯¢å‡ºçš„ç»“æœä¸º\nå°±äº§ç”Ÿäº†ä¸€ä¸ªå‘çˆ¹çš„ç»“æœã€‚ æ’å…¥è¯­å¥åº”è¯¥åƒä¸‹é¢è¿™ä¹ˆå†™ï¼Œæ’å…¥çš„æ‰æ˜¯1\nmysql\u0026gt; INSERT INTO test VALUES (`1`);\r é—®é¢˜5:è´§å¸å­—æ®µç”¨ä»€ä¹ˆç±»å‹? å›ç­”:å¦‚æœè´§å¸å•ä½æ˜¯åˆ†ï¼Œå¯ä»¥ç”¨Intç±»å‹ã€‚å¦‚æœåšæŒç”¨å…ƒï¼Œç”¨Decimalã€‚\nåƒä¸‡ä¸è¦ç­”floatå’Œdoubleï¼Œå› ä¸ºfloatå’Œdoubleæ˜¯ä»¥äºŒè¿›åˆ¶å­˜å‚¨çš„ï¼Œæ‰€ä»¥æœ‰ä¸€å®šçš„è¯¯å·®ã€‚ æ‰“ä¸ªæ¯”æ–¹ï¼Œä½ å»ºä¸€ä¸ªåˆ—å¦‚ä¸‹\nCREATE TABLE `t` (\r`price` float(10,2) DEFAULT NULL,\r) ENGINE=InnoDB DEFAULT CHARSET=utf8\r ç„¶åinsertç»™priceåˆ—ä¸€ä¸ªæ•°æ®ä¸º1234567.23ï¼Œä½ ä¼šå‘ç°æ˜¾ç¤ºå‡ºæ¥çš„æ•°æ®å˜ä¸º1234567.25ï¼Œç²¾åº¦å¤±å‡†ï¼\né—®é¢˜6:æ—¶é—´å­—æ®µç”¨ä»€ä¹ˆç±»å‹? å›ç­”:æ­¤é¢˜æ— å›ºå®šç­”æ¡ˆï¼Œåº”ç»“åˆè‡ªå·±é¡¹ç›®èƒŒæ™¯æ¥ç­”ï¼æŠŠç†ç”±è®²æ¸…æ¥šå°±è¡Œï¼\n(1)varcharï¼Œå¦‚æœç”¨varcharç±»å‹æ¥å­˜æ—¶é—´ï¼Œä¼˜ç‚¹åœ¨äºæ˜¾ç¤ºç›´è§‚ã€‚ä½†æ˜¯å‘çš„åœ°æ–¹ä¹Ÿæ˜¯æŒºå¤šçš„ã€‚æ¯”å¦‚ï¼Œæ’å…¥çš„æ•°æ®æ²¡æœ‰æ ¡éªŒï¼Œä½ å¯èƒ½æŸå¤©å°±å‘ç°ä¸€æ¡æ•°æ®ä¸º2013111çš„æ•°æ®ï¼Œè¯·é—®è¿™æ˜¯ä»£è¡¨2013å¹´1æœˆ11æ—¥ï¼Œè¿˜æ˜¯2013å¹´11æœˆ1æ—¥ï¼Ÿ å…¶æ¬¡ï¼Œåšæ—¶é—´æ¯”è¾ƒè¿ç®—ï¼Œä½ éœ€è¦ç”¨STR_TO_DATEç­‰å‡½æ•°å°†å…¶è½¬åŒ–ä¸ºæ—¶é—´ç±»å‹ï¼Œä½ ä¼šå‘ç°è¿™ä¹ˆå†™æ˜¯æ— æ³•å‘½ä¸­ç´¢å¼•çš„ã€‚æ•°æ®é‡ä¸€å¤§ï¼Œæ˜¯ä¸ªå‘ï¼\n(2)timestampï¼Œè¯¥ç±»å‹æ˜¯å››ä¸ªå­—èŠ‚çš„æ•´æ•°ï¼Œå®ƒèƒ½è¡¨ç¤ºçš„æ—¶é—´èŒƒå›´ä¸º1970-01-01 08:00:01åˆ°2038-01-19 11:14:07ã€‚2038å¹´ä»¥åçš„æ—¶é—´ï¼Œæ˜¯æ— æ³•ç”¨timestampç±»å‹å­˜å‚¨çš„ã€‚ ä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªä¼˜åŠ¿ï¼Œtimestampç±»å‹æ˜¯å¸¦æœ‰æ—¶åŒºä¿¡æ¯çš„ã€‚ä¸€æ—¦ä½ ç³»ç»Ÿä¸­çš„æ—¶åŒºå‘ç”Ÿæ”¹å˜ï¼Œä¾‹å¦‚ä½ ä¿®æ”¹äº†æ—¶åŒº\nSET TIME_ZONE = \u0026ldquo;america/new_york\u0026rdquo;; ä½ ä¼šå‘ç°ï¼Œé¡¹ç›®ä¸­çš„è¯¥å­—æ®µçš„å€¼è‡ªå·±ä¼šå‘ç”Ÿå˜æ›´ã€‚è¿™ä¸ªç‰¹æ€§ç”¨æ¥åšä¸€äº›å›½é™…åŒ–å¤§é¡¹ç›®ï¼Œè·¨æ—¶åŒºçš„åº”ç”¨æ—¶ï¼Œç‰¹åˆ«æ³¨æ„ï¼\n(3)datetimeï¼Œdatetimeå‚¨å­˜å ç”¨8ä¸ªå­—èŠ‚ï¼Œå®ƒå­˜å‚¨çš„æ—¶é—´èŒƒå›´ä¸º1000-01-01 00:00:00 ~ 9999-12-31 23:59:59ã€‚æ˜¾ç„¶ï¼Œå­˜å‚¨æ—¶é—´èŒƒå›´æ›´å¤§ã€‚ä½†æ˜¯å®ƒå‘çš„åœ°æ–¹åœ¨äºï¼Œä»–å­˜å‚¨çš„æ˜¯æ—¶é—´ç»å¯¹å€¼ï¼Œä¸å¸¦æœ‰æ—¶åŒºä¿¡æ¯ã€‚å¦‚æœä½ æ”¹å˜æ•°æ®åº“çš„æ—¶åŒºï¼Œè¯¥é¡¹çš„å€¼ä¸ä¼šè‡ªå·±å‘ç”Ÿå˜æ›´ï¼\n(4)bigintï¼Œä¹Ÿæ˜¯8ä¸ªå­—èŠ‚ï¼Œè‡ªå·±ç»´æŠ¤ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè¡¨ç¤ºèŒƒå›´æ¯”timestampå¤§å¤šäº†ï¼Œå°±æ˜¯è¦è‡ªå·±ç»´æŠ¤ï¼Œä¸å¤§æ–¹ä¾¿ã€‚\né—®é¢˜7:ä¸ºä»€ä¹ˆä¸ç›´æ¥å­˜å‚¨å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰å¤§å®¹é‡å†…å®¹? å›ç­”:æˆ‘ä»¬åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéƒ½æ˜¯ç”¨HDFSæ¥å­˜å‚¨æ–‡ä»¶ã€‚ç„¶åmysqlä¸­ï¼Œåªå­˜æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ã€‚mysqlä¸­æœ‰ä¸¤ä¸ªå­—æ®µç±»å‹è¢«ç”¨æ¥è®¾è®¡å­˜æ”¾å¤§å®¹é‡æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯textå’Œblobç±»å‹ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨ç”Ÿäº§ä¸­ï¼ŒåŸºæœ¬ä¸ç”¨è¿™ä¸¤ä¸ªç±»å‹ï¼\nä¸»è¦åŸå› æœ‰å¦‚ä¸‹ä¸¤ç‚¹\n(1)Mysqlå†…å­˜ä¸´æ—¶è¡¨ä¸æ”¯æŒTEXTã€BLOBè¿™æ ·çš„å¤§æ•°æ®ç±»å‹ï¼Œå¦‚æœæŸ¥è¯¢ä¸­åŒ…å«è¿™æ ·çš„æ•°æ®ï¼Œåœ¨æ’åºç­‰æ“ä½œæ—¶ï¼Œå°±ä¸èƒ½ä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨ï¼Œå¿…é¡»ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨è¿›è¡Œã€‚å¯¼è‡´æŸ¥è¯¢æ•ˆç‡ç¼“æ…¢\n(2)binlogå†…å®¹å¤ªå¤šã€‚å› ä¸ºä½ æ•°æ®å†…å®¹æ¯”è¾ƒå¤§ï¼Œå°±ä¼šé€ æˆbinlogå†…å®¹æ¯”è¾ƒå¤šã€‚å¤§å®¶ä¹ŸçŸ¥é“ï¼Œä¸»ä»åŒæ­¥æ˜¯é binlogè¿›è¡ŒåŒæ­¥ï¼Œbinlogå¤ªå¤§äº†ï¼Œå°±ä¼šå¯¼è‡´ä¸»ä»åŒæ­¥æ•ˆç‡é—®é¢˜ï¼\nå› æ­¤ï¼Œä¸æ¨èä½¿ç”¨textå’Œblobç±»å‹ï¼\né—®é¢˜8:å­—æ®µä¸ºä»€ä¹ˆè¦å®šä¹‰ä¸ºNOT NULL? å›ç­”:OKï¼Œè¿™é—®é¢˜ä»ä¸¤ä¸ªè§’åº¦æ¥ç­”\n(1)ç´¢å¼•æ€§èƒ½ä¸å¥½\nMysqléš¾ä»¥ä¼˜åŒ–å¼•ç”¨å¯ç©ºåˆ—æŸ¥è¯¢ï¼Œå®ƒä¼šä½¿ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡å’Œå€¼æ›´åŠ å¤æ‚ã€‚å¯ç©ºåˆ—éœ€è¦æ›´å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œè¿˜éœ€è¦mysqlå†…éƒ¨è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚å¯ç©ºåˆ—è¢«ç´¢å¼•åï¼Œæ¯æ¡è®°å½•éƒ½éœ€è¦ä¸€ä¸ªé¢å¤–çš„å­—èŠ‚ï¼Œè¿˜èƒ½å¯¼è‡´MYisam ä¸­å›ºå®šå¤§å°çš„ç´¢å¼•å˜æˆå¯å˜å¤§å°çš„ç´¢å¼•ã€‚ â€”â€” å‡ºè‡ªã€Šé«˜æ€§èƒ½mysqlç¬¬äºŒç‰ˆã€‹\r (2)æŸ¥è¯¢ä¼šå‡ºç°ä¸€äº›ä¸å¯é¢„æ–™çš„ç»“æœ è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¤§å®¶å°±æ‡‚äº†ã€‚å‡è®¾ï¼Œè¡¨ç»“æ„å¦‚ä¸‹\ncreate table table_2 (\r`id` INT (11) NOT NULL,\rname varchar(20)\r)\r è¡¨æ•°æ®æ˜¯è¿™æ ·çš„\nä½ æ‰§è¡Œè¯­å¥\nselect count(name) from table_2;\r ä½ ä¼šå‘ç°ç»“æœä¸ºéNULLçš„æ€»æ•°\nç±»ä¼¼çš„æŸ¥è¯¢é—®é¢˜ï¼Œå…¶å®æœ‰å¾ˆå¤šï¼Œä¸ä¸€ä¸€åˆ—ä¸¾ã€‚ è®°ä½ï¼Œå› ä¸ºnullåˆ—çš„å­˜åœ¨ï¼Œä¼šå‡ºç°å¾ˆå¤šå‡ºäººæ„æ–™çš„ç»“æœï¼Œä»è€Œæµªè´¹å¼€å‘æ—¶é—´å»æ’æŸ¥Bug.\n","id":28,"section":"posts","summary":"ä½œè€…ï¼šå­¤ç‹¬çƒŸ é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/73260510 æ¥æºï¼šçŸ¥ä¹ è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·","tags":["mysql"],"title":"[è½¬]Mysqlè¡¨è®¾è®¡æ³¨æ„äº‹é¡¹","uri":"https://www.mingaccount.com/2019/10/mysql-table-design/","year":"2019"},{"content":"è½¬è‡ªå…¬ä¼—å·â€œå­¤ç‹¬çƒŸâ€\nå¼•è¨€ æˆ‘ä»¬å…ˆæ¥è®²ä¸€ä¸ªæ®µå­\né¢è¯•å®˜ï¼šâ€œæœ‰å¹¶å‘çš„ç»éªŒæ²¡ï¼Ÿâ€ åº”è˜è€…ï¼šâ€œæœ‰ä¸€ç‚¹ã€‚â€ é¢è¯•å®˜ï¼šâ€œé‚£ä½ ä»¬ä¸ºäº†å¤„ç†å¹¶å‘ï¼Œåšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿâ€ åº”è˜è€…ï¼šâ€œå‰åç«¯åˆ†ç¦»å•Šï¼Œé™æµå•Šï¼Œåˆ†åº“åˆ†è¡¨å•Šã€‚ã€‚â€ é¢è¯•å®˜:\u0026quot;è°ˆè°ˆåˆ†åº“åˆ†è¡¨å§ï¼Ÿ\u0026quot; åº”è˜è€…ï¼šâ€œbalaã€‚balaã€‚balaã€‚ã€‚â€ é¢è¯•å®˜å¿ƒç†æ´»åŠ¨:è¿™ä¸ªä»å…„è®²çš„æ€ä¹ˆè¿™ä¹ˆåƒç½‘ä¸Šçš„åšå®¢æŠ„çš„ï¼Œå®¹æˆ‘å†é—®é—®ã€‚\ré¢è¯•å®˜:â€œä½ ä»¬åˆ†åº“åˆ†è¡¨åï¼Œå¦‚ä½•éƒ¨ç½²ä¸Šçº¿çš„ï¼Ÿâ€ åº”è˜è€…ï¼šâ€œè¿™ï¼ï¼ï¼ï¼ï¼ï¼â€\r ä¸è¦æƒŠè®¶ï¼Œæˆ‘å†™è¿™ç¯‡æ–‡ç« å‰ï¼Œæˆ‘ç‰¹æ„å»ç½‘ä¸Šçœ‹äº†ä¸‹åˆ†åº“åˆ†è¡¨çš„æ–‡ç« ï¼Œå¾ˆç¥å¥‡çš„æ˜¯ï¼Œéƒ½åœ¨è®²æ€ä¹ˆè¿›è¡Œåˆ†åº“åˆ†è¡¨ï¼Œå´ä¸è¯´åˆ†å®Œä»¥åï¼Œæ€ä¹ˆéƒ¨ç½²ä¸Šçº¿çš„ã€‚è¿™æ ·åœ¨é¢è¯•çš„æ—¶å€™å°±æ¯”è¾ƒå°´å°¬äº†ã€‚\nä½ ä»¬è‡ªå·±æ‘¸ç€è‰¯å¿ƒæƒ³ä¸€ä¸‹ï¼Œå¦‚æœä½ çœŸçš„åšè¿‡åˆ†åº“åˆ†è¡¨ï¼Œä½ ä¼šä¸çŸ¥é“å¦‚ä½•éƒ¨ç½²çš„ä¹ˆï¼Ÿå› æ­¤æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•éƒ¨ç½²å§ã€‚\nps:æˆ‘å‘ç°ä¸€ä¸ªå¾ˆç¥å¥‡çš„ç°è±¡ã€‚å› ä¸ºå¾ˆå¤šå…¬å¸ç”¨çš„æŠ€æœ¯æ¯”è¾ƒlowï¼Œé‚£ä¹ˆä¸€äº›æ±‚èŒè€…ä¸ºäº†æé«˜è‡ªå·±çš„ç«äº‰åŠ›ï¼Œå°±ä¼šå°†ä¸€äº›é«˜å¤§ä¸Šçš„æŠ€æœ¯å†™è¿›è‡ªå·±çš„lowé¡¹ç›®ä¸­ã€‚ç„¶åå‘¢ï¼Œä»–å‡ºå»é¢è¯•å®³æ€•ç¢°åˆ°ä»è¿™ä¸ªå…¬å¸å‡ºæ¥çš„äººï¼Œæ¯•ç«Ÿä»è¿™ä¸ªå…¬å¸å‡ºæ¥çš„äººï¼Œä¸€å®šçŸ¥é“è‡ªå·±ä»¥å‰å…¬å¸çš„é¡¹ç›®æƒ…å½¢ã€‚å› æ­¤ä¸ºäº†åœ†è°ï¼Œä»–å°±ä¼šè¯´ï¼šâ€œä»–ä»¬ä»äº‹çš„æ˜¯è¿™ä¸ªå…¬å¸çš„è€é¡¹ç›®æ”¹é€ å·¥ä½œï¼Œç”¨äº†å¾ˆå¤šæ–°æŠ€æœ¯è¿›å»ï¼â€\né‚£ä¹ˆï¼Œè¯·ä½ å¥½å¥½æ€è€ƒä¸€ä¸‹ï¼Œä½ ä»¬çš„è€ç³»ç»Ÿæ˜¯å¦‚ä½•å¹³æ»‘å‡çº§ä¸ºæ–°ç³»ç»Ÿçš„ï¼\nå¦‚ä½•éƒ¨ç½² åœæœºéƒ¨ç½²æ³• å¤§è‡´æ€è·¯å°±æ˜¯ï¼ŒæŒ‚ä¸€ä¸ªå…¬å‘Šï¼ŒåŠå¤œåœæœºå‡çº§ï¼Œç„¶ååŠå¤œæŠŠæœåŠ¡åœäº†ï¼Œè·‘æ•°æ®è¿ç§»ç¨‹åºï¼Œè¿›è¡Œæ•°æ®è¿ç§»ã€‚\næ­¥éª¤å¦‚ä¸‹:\n(1)å‡ºä¸€ä¸ªå…¬å‘Šï¼Œæ¯”å¦‚â€œä»Šæ™š00:00ï½6:00è¿›è¡Œåœæœºç»´æŠ¤ï¼Œæš‚åœæœåŠ¡â€\n(2)å†™ä¸€ä¸ªè¿ç§»ç¨‹åºï¼Œè¯»db-oldæ•°æ®åº“ï¼Œé€šè¿‡ä¸­é—´ä»¶å†™å…¥æ–°åº“db-new1å’Œdb-new2ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤º\n(3)æ ¡éªŒè¿ç§»å‰åä¸€è‡´æ€§ï¼Œæ²¡é—®é¢˜å°±åˆ‡è¯¥éƒ¨åˆ†ä¸šåŠ¡åˆ°æ–°åº“ã€‚\né¡ºä¾¿ç§‘æ™®ä¸€ä¸‹ï¼Œè¿™ä¸ªä¸­é—´ä»¶ã€‚ç°åœ¨æµè¡Œçš„åˆ†åº“åˆ†è¡¨çš„ä¸­é—´ä»¶æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯proxyå½¢å¼çš„ï¼Œä¾‹å¦‚mycatï¼Œæ˜¯éœ€è¦é¢å¤–éƒ¨ç½²ä¸€å°æœåŠ¡å™¨çš„ã€‚è¿˜æœ‰ä¸€ç§æ˜¯clientå½¢å¼çš„ï¼Œä¾‹å¦‚å½“å½“å‡ºçš„Sharding-JDBCï¼Œå°±æ˜¯ä¸€ä¸ªjaråŒ…ï¼Œä½¿ç”¨èµ·æ¥ååˆ†è½»ä¾¿ã€‚æˆ‘ä¸ªäººåå‘Sharding-JDBCï¼Œè¿™ç§æ–¹å¼ï¼Œæ— éœ€é¢å¤–éƒ¨ç½²ï¼Œæ— å…¶ä»–ä¾èµ–ï¼ŒDBAä¹Ÿæ— éœ€æ”¹å˜åŸæœ‰çš„è¿ç»´æ–¹å¼ã€‚\nè¯„ä»·ï¼š\nå¤§å®¶ä¸è¦è§‰å¾—è¿™ç§æ–¹æ³•lowï¼Œæˆ‘å…¶å®ä¸€ç›´è§‰å¾—è¿™ç§æ–¹æ³•å¯é æ€§å¾ˆå¼ºã€‚è€Œä¸”æˆ‘ç›¸ä¿¡å„ä½è¯»è€…æ‰€åœ¨çš„å…¬å¸ä¸€å®šä¸æ˜¯ä»€ä¹ˆå¾ˆç‰›é€¼çš„äº’è”ç½‘å…¬å¸ï¼Œå¦‚æœä½ ä»¬çš„äº§å“å‡Œæ™¨1ç‚¹çš„ç”¨æˆ·æ´»è·ƒæ•°è¿˜æœ‰è¶…è¿‡1000çš„ï¼Œä½ ä»¬æ¡ä¸ªçˆªï¼æ¯•ç«Ÿä¸æ˜¯æ‰€æœ‰äººéƒ½åœ¨ä»€ä¹ˆç”µå•†å…¬å¸çš„ï¼Œå¤§éƒ¨åˆ†äº§å“åŠå¤œéƒ½æ²¡å•¥æµé‡ã€‚æ‰€ä»¥æ­¤æ–¹æ¡ˆï¼Œå¹¶éæ²¡æœ‰å¯å–ä¹‹å¤„ã€‚\nä½†æ˜¯æ­¤æ–¹æ¡ˆæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œç´¯ï¼ä¸æ­¢èº«ä½“ç´¯ï¼Œå¿ƒä¹Ÿç´¯ï¼ä½ æƒ³æƒ³çœ‹ï¼Œæœ¬æ¥å®šå…­ç‚¹ç»“æŸï¼Œä½ äº”ç‚¹æŠŠæ•°æ®åº“è¿ç§»å¥½ï¼Œä½†æ˜¯ä¸çŸ¥æ€ä¹ˆæ»´ï¼Œç¨‹åºåˆ‡æ–°åº“å°±æ˜¯æœ‰ç‚¹é—®é¢˜ã€‚äºæ˜¯ï¼Œçœ¼ç…ç€å¤©å°±è¦äº®äº†ï¼Œèµ¶ç´§æŠŠæ•°æ®åº“åˆ‡å›è€åº“ã€‚ç¬¬äºŒä¸ªæ™šä¸Šç»§ç»­è¿™ä¹ˆå¹²ï¼Œç®€ç›´æ˜¯èº«å¿ƒä¿±ç–²ã€‚\npsï¼šè¿™é‡Œæ•™å¤§å®¶ä¸€äº›æŠ€å·§å•Šï¼Œå¦‚æœä½ çœŸçš„æ²¡åšè¿‡åˆ†åº“åˆ†è¡¨ï¼Œåˆæƒ³å¹ä¸€æ³¢ï¼Œæ¶¨ä¸€ä¸‹å·¥èµ„ï¼Œå»ºè®®ç­”è¿™ä¸ªæ–¹æ¡ˆã€‚å› ä¸ºè¿™ä¸ªæ–¹æ¡ˆæ¯”è¾ƒlowï¼Œlowåˆ°æ²¡ä»€ä¹ˆä¸œè¥¿å¯ä»¥æ·±æŒ–çš„ï¼Œæ‰€ä»¥ç­”è¿™ä¸ªæ–¹æ¡ˆï¼Œæ¯”è¾ƒé è°±ã€‚\nå¦å¤–ï¼Œå¦‚æœé¢è¯•å®˜çš„é—®é¢˜æ˜¯\nä½ ä»¬æ€ä¹ˆè¿›è¡Œåˆ†åº“åˆ†è¡¨çš„ï¼Ÿ è¿™ä¸ªé—®é¢˜é—®çš„å¾ˆæ³›ï¼Œæ‰€ä»¥å›ç­”è¿™ä¸ªé—®é¢˜å»ºè®®è‡ªå·±ä¸»åŠ¨æŠŠåˆ†è¡¨çš„ç­–ç•¥ï¼Œä»¥åŠå¦‚ä½•éƒ¨ç½²çš„æ–¹æ³•è®²å‡ºæ¥ã€‚å› ä¸ºè¿™ä¹ˆç­”ï¼Œæ˜¾å¾—ä¸¥è°¨ä¸€äº›ã€‚\nä¸è¿‡ï¼Œå¾ˆå¤šé¢è¯•å®˜ä¸ºäº†å–å¼„è‡ªå·±çš„æŠ€æœ¯ï¼Œå–œæ¬¢è¿™ä¹ˆé—®\nåˆ†è¡¨æœ‰å“ªäº›ç­–ç•¥å•Šï¼Ÿä½ ä»¬ç”¨å“ªç§å•Šï¼Ÿ okã€‚ã€‚è¿™ä¸ªé—®é¢˜å…·ä½“æŒ‡å‘äº†åˆ†åº“åˆ†è¡¨çš„æŸä¸ªæ–¹å‘äº†ï¼Œä½ ä¸è¦ä¸»åŠ¨ç­”å¦‚ä½•è¿›è¡Œéƒ¨ç½²çš„ã€‚ç­‰é¢è¯•å®˜é—®ä½ ï¼Œä½ å†ç­”ã€‚å¦‚æœé¢è¯•å®˜æ²¡é—®ï¼Œåœ¨é¢è¯•æœ€åä¸€ä¸ªç¯èŠ‚ï¼Œé¢è¯•å®˜ä¼šè®©ä½ é—®è®©å‡ ä¸ªé—®é¢˜ã€‚ä½ å°±é—®\nä½ åˆšæ‰åˆšå¥½æœ‰æåˆ°åˆ†åº“åˆ†è¡¨çš„ç›¸å…³é—®é¢˜ï¼Œæˆ‘ä»¬å½“æ—¶éƒ¨ç½²çš„æ—¶å€™ï¼Œå…ˆåœæœºã€‚ç„¶ååŠå¤œè¿ç§»æ•°æ®ï¼Œç„¶åç¬¬äºŒå¤©å°†æµé‡åˆ‡åˆ°æ–°åº“ï¼Œè¿™ç§æ–¹æ¡ˆå¤ªç´¯ï¼Œä¸çŸ¥é“è´µå…¬å¸æœ‰æ²¡æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹æ¡ˆï¼Ÿ é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œé¢è¯•å®˜ä¼šæœ‰ä¸¤ç§å›ç­”ã€‚ç¬¬ä¸€ç§ï¼Œé¢è¯•å®˜ç¡¬ç€å¤´çš®éšä¾¿æ‰¯ã€‚ç¬¬äºŒç§ï¼Œé¢è¯•å®˜çœŸçš„åšè¿‡ï¼Œæ®å®å›ç­”ã€‚è®°ä½ï¼Œé¢è¯•å®˜æ€ä¹ˆå›ç­”çš„ä¸é‡è¦ã€‚é‡ç‚¹çš„æ˜¯ï¼Œä½ è¿™ä¸ªé—®é¢˜å‡ºå»ï¼Œä¼šç»™é¢è¯•å®˜ä¸€ç§é”™è§‰:\u0026ldquo;è¿™ä¸ªå°ä¼™å­çœŸçš„åšè¿‡åˆ†åº“åˆ†è¡¨ã€‚\u0026rdquo;\nå¦‚æœä½ æ‹…å¿ƒè¿›å»äº†ï¼ŒçœŸæ´¾ä½ å»åšåˆ†åº“åˆ†è¡¨æ€ä¹ˆåŠï¼ŸOKï¼Œä¸è¦æ€•ã€‚æˆ‘èµŒä½ è¯•ç”¨æœŸç¢°ä¸åˆ°è¿™ä¸ªæ´»ã€‚å› ä¸ºèƒ½è¿›è¡Œåˆ†åº“åˆ†è¡¨ï¼Œå¿…å®šå¯¹ä¸šåŠ¡éå¸¸ç†Ÿã€‚è¿˜åœ¨è¯•ç”¨æœŸçš„ä½ ï¼Œå¿…å®šå¯¹ä¸šåŠ¡ä¸ç†Ÿï¼Œå¦‚æœé¢†å¯¼ç»™ä½ è¿™ç§æ´»ï¼Œæˆ‘åªèƒ½è¯´ä»–æœ‰ä¸€é¢—å¤§å¿ƒè„ã€‚\nokï¼ŒæŒ‡ç‚¹åˆ°è¿™é‡Œã€‚é¢è¯•æœ¬æ¥å°±æ˜¯ä¸€åœºæ–—æ™ºæ–—å‹‡çš„è¿‡ç¨‹ï¼Œæ‰¯è¿œäº†ï¼Œå›åˆ°æˆ‘ä»¬çš„ä¸»é¢˜ã€‚\nåŒå†™éƒ¨ç½²æ³•(ä¸€) è¿™ä¸ªå°±æ˜¯ä¸åœæœºéƒ¨ç½²æ³•ï¼Œè¿™é‡Œæˆ‘éœ€è¦å…ˆå¼•è¿›ä¸¤ä¸ªæ¦‚å¿µ:å†å²æ•°æ®å’Œå¢é‡æ•°æ®ã€‚\nå‡è®¾ï¼Œæˆ‘ä»¬æ˜¯å¯¹ä¸€å¼ å«åštest_tbçš„è¡¨è¿›è¡Œæ‹†åˆ†ï¼Œå› ä¸ºä½ è¦è¿›è¡ŒåŒå†™ï¼Œç³»ç»Ÿé‡Œå¤´å’Œtest_tbè¡¨æœ‰å…³çš„ä¸šåŠ¡ä¹‹å‰å¿…å®šä¼šåŠ å…¥ä¸€æ®µåŒå†™ä»£ç ï¼ŒåŒæ—¶å¾€è€åº“å’Œæ–°åº“ä¸­å†™ï¼Œç„¶åè¿›è¡Œéƒ¨ç½²ï¼Œé‚£ä¹ˆ\nå†å²æ•°æ®:åœ¨è¯¥æ¬¡éƒ¨ç½²å‰ï¼Œæ•°æ®åº“è¡¨test_tbçš„æœ‰å…³æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå†å²æ•°æ®ã€‚\nå¢é‡æ•°æ®:åœ¨è¯¥æ¬¡éƒ¨ç½²åï¼Œæ•°æ®åº“è¡¨test_tbçš„æ–°äº§ç”Ÿçš„æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå¢é‡æ•°æ®ã€‚\nç„¶åè¿ç§»æµç¨‹å¦‚ä¸‹\n(1)å…ˆè®¡ç®—ä½ è¦è¿ç§»çš„é‚£å¼ è¡¨çš„max(ä¸»é”®)ã€‚åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œåªè¿ç§»db-oldä¸­test_tbè¡¨é‡Œï¼Œä¸»é”®å°ç­‰äºè¯¥max(ä¸»é”®)çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å†å²æ•°æ®ã€‚\nè¿™é‡Œæœ‰ç‰¹æ®Šæƒ…å†µï¼Œå¦‚æœä½ çš„è¡¨ç”¨çš„æ˜¯uuidï¼Œæ²¡æ³•æ±‚å‡ºmax(ä¸»é”®)ï¼Œé‚£å°±ä»¥åˆ›å»ºæ—¶é—´ä½œä¸ºåˆ’åˆ†å†å²æ•°æ®å’Œå¢é‡æ•°æ®çš„ä¾æ®ã€‚å¦‚æœä½ çš„è¡¨ç”¨çš„æ˜¯uuid,åˆæ²¡æœ‰åˆ›å»ºæ—¶é—´è¿™ä¸ªå­—æ®µï¼Œæˆ‘ç›¸ä¿¡æœºæ™ºçš„ä½ ï¼Œä¸€å®šæœ‰åŠæ³•åŒºåˆ†å‡ºå†å²æ•°æ®å’Œå¢é‡æ•°æ®ã€‚\n(2)åœ¨ä»£ç ä¸­ï¼Œä¸test_tbæœ‰å…³çš„ä¸šåŠ¡ï¼Œå¤šåŠ ä¸€æ¡å¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­å‘æ¶ˆæ¯çš„ä»£ç ï¼Œå°†æ“ä½œçš„sqlå‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œè‡³äºæ¶ˆæ¯ä½“å¦‚ä½•ç»„è£…ï¼Œå¤§å®¶è‡ªè¡Œè€ƒè™‘ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªå‘å†™è¯·æ±‚çš„sqlï¼Œåªå‘å†™è¯·æ±‚çš„sqlï¼Œåªå‘å†™è¯·æ±‚çš„sqlã€‚é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼\nåŸå› æœ‰äºŒ:\n(1)åªæœ‰å†™è¯·æ±‚çš„sqlå¯¹æ¢å¤æ•°æ®æ‰æœ‰ç”¨ã€‚\n(2)ç³»ç»Ÿä¸­ï¼Œç»å¤§éƒ¨åˆ†çš„ä¸šåŠ¡éœ€æ±‚æ˜¯è¯»è¯·æ±‚ï¼Œå†™è¯·æ±‚æ¯”è¾ƒå°‘ã€‚\næ³¨æ„äº†ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬ä¸æ¶ˆè´¹æ¶ˆæ¯é˜Ÿåˆ—é‡Œçš„æ•°æ®ã€‚æˆ‘ä»¬åªå‘å†™è¯·æ±‚ï¼Œæ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆæ¯å †ç§¯æƒ…å†µä¸ä¼šå¤ªä¸¥é‡ï¼\n(3)ç³»ç»Ÿä¸Šçº¿ã€‚å¦å¤–ï¼Œå†™ä¸€æ®µè¿ç§»ç¨‹åºï¼Œè¿ç§»db-oldä¸­test_tbè¡¨é‡Œï¼Œä¸»é”®å°äºè¯¥max(ä¸»é”®)çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å†å²æ•°æ®ã€‚\nä¸Šé¢æ­¥éª¤(1)ï½æ­¥éª¤(3)çš„è¿‡ç¨‹å¦‚ä¸‹\nç­‰åˆ°db-oldä¸­çš„å†å²æ•°æ®è¿ç§»å®Œæ¯•ï¼Œåˆ™å¼€å§‹è¿ç§»å¢é‡æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¶ˆæ¯é˜Ÿåˆ—é‡Œçš„æ•°æ®ã€‚\n(4)å°†è¿ç§»ç¨‹åºä¸‹çº¿ï¼Œå†™ä¸€æ®µè®¢é˜…ç¨‹åºè®¢é˜…æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ•°æ®\n(5)è®¢é˜…ç¨‹åºå°†è®¢é˜…åˆ°åˆ°æ•°æ®ï¼Œé€šè¿‡ä¸­é—´ä»¶å†™å…¥æ–°åº“\n(6)æ–°è€åº“ä¸€è‡´æ€§éªŒè¯ï¼Œå»é™¤ä»£ç ä¸­çš„åŒå†™ä»£ç ï¼Œå°†æ¶‰åŠåˆ°test_tbè¡¨çš„è¯»å†™æ“ä½œï¼ŒæŒ‡å‘æ–°åº“ã€‚\nä¸Šé¢æ­¥éª¤(4)ï½æ­¥éª¤(6)çš„è¿‡ç¨‹å¦‚ä¸‹\nè¿™é‡Œå¤§å®¶å¯èƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨æ­¥éª¤(1)ï½æ­¥éª¤(3),ç³»ç»Ÿå¯¹å†å²æ•°æ®è¿›è¡Œæ“ä½œï¼Œä¼šé€ æˆä¸ä¸€è‡´çš„é—®é¢˜ä¹ˆï¼Ÿ\nOKï¼Œä¸ä¼šã€‚è¿™é‡Œæˆ‘ä»¬å¯¹deleteæ“ä½œå’Œupdateæ“ä½œåšåˆ†æï¼Œå› ä¸ºåªæœ‰è¿™ä¸¤ä¸ªæ“ä½œæ‰ä¼šé€ æˆå†å²æ•°æ®å˜åŠ¨ï¼Œinsertè¿›å»çš„æ•°æ®éƒ½æ˜¯å±äºå¢é‡æ•°æ®ã€‚\n(1)å¯¹db-oldä¸­test_tbè¡¨çš„å†å²æ•°æ®å‘å‡ºdeleteæ“ä½œï¼Œæ•°æ®è¿˜æœªåˆ é™¤ï¼Œå°±è¢«è¿ç§»ç¨‹åºç»™è¿èµ°äº†ã€‚æ­¤æ—¶deleteæ“ä½œåœ¨æ¶ˆæ¯é˜Ÿåˆ—é‡Œè¿˜æœ‰è®°å½•ï¼ŒåæœŸè®¢é˜…ç¨‹åºè®¢é˜…åˆ°è¯¥deleteæ“ä½œï¼Œå¯ä»¥è¿›è¡Œåˆ é™¤ã€‚\n(2)å¯¹db-oldä¸­test_tbè¡¨çš„å†å²æ•°æ®å‘å‡ºdeleteæ“ä½œï¼Œæ•°æ®å·²ç»åˆ é™¤ï¼Œè¿ç§»ç¨‹åºè¿ä¸èµ°è¯¥è¡Œæ•°æ®ã€‚æ­¤æ—¶deleteæ“ä½œåœ¨æ¶ˆæ¯é˜Ÿåˆ—é‡Œè¿˜æœ‰è®°å½•ï¼ŒåæœŸè®¢é˜…ç¨‹åºè®¢é˜…åˆ°è¯¥deleteæ“ä½œï¼Œå†æ‰§è¡Œä¸€æ¬¡deleteï¼Œå¹¶ä¸ä¼šå¯¹ä¸€è‡´æ€§æœ‰å½±å“ã€‚\nå¯¹updateçš„æ“ä½œç±»ä¼¼ï¼Œä¸èµ˜è¿°ã€‚\nåŒå†™éƒ¨ç½²æ³•(äºŒ) ä¸Šé¢çš„æ–¹æ³•æœ‰ä¸€ä¸ªç¡¬ä¼¤ï¼Œæ³¨æ„æˆ‘æœ‰ä¸€å¥è¯\n(2)åœ¨ä»£ç ä¸­ï¼Œä¸test_tbæœ‰å…³çš„ä¸šåŠ¡ï¼Œå¤šåŠ ä¸€æ¡å¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­å‘æ¶ˆæ¯çš„ä»£ç ï¼Œå°†æ“ä½œçš„sqlå‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œè‡³äºæ¶ˆæ¯ä½“å¦‚ä½•ç»„è£…ï¼Œå¤§å®¶è‡ªè¡Œè€ƒè™‘ã€‚\nå¤§å®¶æƒ³ä¸€ä¸‹ï¼Œè¿™ä¹ˆåšï¼Œæ˜¯ä¸æ˜¯é€ æˆäº†ä¸¥é‡çš„ä»£ç å…¥ä¾µã€‚å°†éä¸šåŠ¡ä»£ç åµŒå…¥ä¸šåŠ¡ä»£ç ï¼Œè¿™ä¹ˆåšï¼ŒåæœŸåˆ ä»£ç çš„æ—¶å€™ç‰¹åˆ«ç´¯ã€‚\næœ‰æ²¡ä»€ä¹ˆæ–¹æ³•ï¼Œå¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜çš„?\næœ‰çš„ï¼Œè®¢é˜…binlogæ—¥å¿—ã€‚å…³äºbinlogæ—¥å¿—ï¼Œæˆ‘å°½é‡ä¸‹å‘¨å†™ä¸€ç¯‡ã€Šç ”å‘åº”è¯¥æŒæ¡çš„binlogçŸ¥è¯†ã€‹ï¼Œè¿™è¾¹æˆ‘å°±ä»‹ç»ä¸€ä¸‹ä½œç”¨\nè®°å½•æ‰€æœ‰æ•°æ®åº“è¡¨ç»“æ„å˜æ›´ï¼ˆä¾‹å¦‚CREATEã€ALTER TABLEâ€¦ï¼‰ä»¥åŠè¡¨æ•°æ®ä¿®æ”¹ï¼ˆINSERTã€UPDATEã€DELETEâ€¦ï¼‰çš„äºŒè¿›åˆ¶æ—¥å¿—ã€‚binlogä¸ä¼šè®°å½•SELECTå’ŒSHOWè¿™ç±»æ“ä½œï¼Œå› ä¸ºè¿™ç±»æ“ä½œå¯¹æ®æœ¬èº«å¹¶æ²¡æœ‰ä¿®æ”¹ã€‚\nè¿˜è®°å¾—æˆ‘ä»¬åœ¨åŒå†™éƒ¨ç½²æ³•(ä¸€)é‡Œä»‹ç»çš„ï¼Œå¾€æ¶ˆæ¯é˜Ÿåˆ—é‡Œå‘çš„æ¶ˆæ¯ï¼Œéƒ½æ˜¯å†™æ“ä½œçš„æ¶ˆæ¯ã€‚è€Œbinlogæ—¥å¿—è®°å½•çš„ä¹Ÿæ˜¯å†™æ“ä½œã€‚æ‰€ä»¥è®¢é˜…è¯¥æ—¥å¿—ï¼Œä¹Ÿèƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚\näºæ˜¯æ­¥éª¤å¦‚ä¸‹\n(1)æ‰“å¼€binlogæ—¥å¿—ï¼Œç³»ç»Ÿæ­£å¸¸ä¸Šçº¿å°±å¥½\n(2)è¿˜æ˜¯å†™ä¸€ä¸ªè¿ç§»ç¨‹åºï¼Œè¿ç§»å†å²æ•°æ®ã€‚æ­¥éª¤å’Œä¸Šé¢ç±»ä¼¼ï¼Œä¸å•°å—¦äº†ã€‚\næ­¥éª¤(1)~æ­¥éª¤(2)æµç¨‹å›¾å¦‚ä¸‹\n(3)å†™ä¸€ä¸ªè®¢é˜…ç¨‹åºï¼Œè®¢é˜…binlog(mysqlä¸­æœ‰canalã€‚è‡³äºoracleä¸­ï¼Œå¤§å®¶å°±éšç¼˜è‡ªå·±å†™å§)ã€‚ç„¶åå°†è®¢é˜…åˆ°çš„æ•°æ®é€šè¿‡ä¸­é—´ä»¶ï¼Œå†™å…¥æ–°åº“ã€‚\n(4)æ£€éªŒä¸€è‡´æ€§ï¼Œæ²¡é—®é¢˜å°±åˆ‡åº“ã€‚\næ­¥éª¤(3)~æ­¥éª¤(4)æµç¨‹å›¾å¦‚ä¸‹\næ€ä¹ˆéªŒæ•°æ®ä¸€è‡´æ€§\nè¿™é‡Œå¤§æ¦‚ä»‹ç»ä¸€ä¸‹å§ï¼Œè¿™ç¯‡çš„ç¯‡å¹…å¤ªé•¿äº†ï¼Œå¤§å®¶å¿ƒé‡Œæœ‰åº•å°±è¡Œã€‚\n(1)å…ˆéªŒæ•°é‡æ˜¯å¦ä¸€è‡´ï¼Œå› ä¸ºéªŒæ•°é‡æ¯”è¾ƒå¿«ã€‚\nè‡³äºéªŒå…·ä½“çš„å­—æ®µï¼Œæœ‰ä¸¤ç§æ–¹æ³•:\n(2.1)æœ‰ä¸€ç§æ–¹æ³•æ˜¯ï¼ŒåªéªŒå…³é”®æ€§çš„å‡ ä¸ªå­—æ®µæ˜¯å¦ä¸€è‡´ã€‚\n(2.2)è¿˜æœ‰ä¸€ç§æ˜¯ ï¼Œä¸€æ¬¡å–50æ¡(ä¸ä¸€å®š50æ¡ï¼Œå…·ä½“è‡ªå·±å®šï¼Œæˆ‘åªæ˜¯ä¸¾ä¾‹),ç„¶ååƒæ‹¼å­—ç¬¦ä¸²ä¸€æ ·ï¼Œæ‹¼åœ¨ä¸€èµ·ã€‚ç”¨md5è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°ä¸€ä¸²æ•°å€¼ã€‚æ–°åº“ä¸€æ ·å¦‚æ³•ç‚®åˆ¶ï¼Œä¹Ÿå¾—åˆ°ä¸€ä¸²æ•°å€¼ï¼Œæ¯”è¾ƒä¸¤ä¸²æ•°å€¼æ˜¯å¦ä¸€è‡´ã€‚å¦‚æœä¸€è‡´ï¼Œç»§ç»­æ¯”è¾ƒä¸‹50æ¡æ•°æ®ã€‚å¦‚æœå‘ç°ä¸ä¸€è‡´ï¼Œç”¨äºŒåˆ†æ³•ç¡®å®šä¸ä¸€è‡´çš„æ•°æ®åœ¨0-25æ¡ï¼Œè¿˜æ˜¯26æ¡-50æ¡ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ‰¾å‡ºä¸ä¸€è‡´çš„æ•°æ®ï¼Œè¿›è¡Œè®°å½•å³å¯ã€‚\nokï¼Œå•°å—¦å®Œæ¯•ã€‚\n","id":29,"section":"posts","summary":"è½¬è‡ªå…¬ä¼—å·â€œå­¤ç‹¬çƒŸâ€ å¼•è¨€ æˆ‘ä»¬å…ˆæ¥è®²ä¸€ä¸ªæ®µå­ é¢è¯•å®˜ï¼šâ€œæœ‰å¹¶å‘çš„ç»éªŒæ²¡ï¼Ÿâ€ åº”è˜è€…ï¼šâ€œæœ‰ä¸€ç‚¹ã€‚â€ é¢è¯•å®˜ï¼šâ€œé‚£ä½ ä»¬ä¸ºäº†å¤„ç†å¹¶å‘ï¼Œåšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿâ€ åº”è˜","tags":["mysql"],"title":"[è½¬]åˆ†åº“åˆ†è¡¨å¦‚ä½•éƒ¨ç½²ä¸Šçº¿","uri":"https://www.mingaccount.com/2019/10/divide-table-how-to-deploy/","year":"2019"},{"content":"è½¬è‡ªå¾®ä¿¡å…¬ä¼—å·â€œå­¤ç‹¬çƒŸâ€\nç®€å•ç‰ˆ\næˆ‘ä»¬å…ˆæ˜ç™½ä¸€ç‚¹ï¼Œåœ¨mysqlä¸­ï¼ŒIntæ•´å‹çš„èŒƒå›´å¦‚ä¸‹\næˆ‘ä»¬ä»¥æ— ç¬¦å·æ•´å‹ä¸ºä¾‹ï¼Œå­˜å‚¨èŒƒå›´ä¸º0ï½4294967295ï¼Œçº¦43äº¿ï¼æˆ‘ä»¬å…ˆè¯´ä¸€ä¸‹ï¼Œä¸€æ—¦è‡ªå¢idè¾¾åˆ°æœ€å¤§å€¼ï¼Œæ­¤æ—¶æ•°æ®ç»§ç»­æ’å…¥æ˜¯ä¼šæŠ¥ä¸€ä¸ªä¸»é”®å†²çªå¼‚å¸¸å¦‚ä¸‹æ‰€ç¤º\n//Duplicate entry \u0026lsquo;4294967295\u0026rsquo; for key \u0026lsquo;PRIMARY\u0026rsquo;\né‚£è§£å†³æ–¹æ³•ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼Œå°†Intç±»å‹æ”¹ä¸ºBigIntç±»å‹ï¼ŒBigIntçš„èŒƒå›´å¦‚ä¸‹\nå°±ç®—ä½ æ¯ç§’10000æ¡æ•°æ®ï¼Œè·‘100å¹´ï¼Œå•è¡¨çš„æ•°æ®ä¹Ÿæ‰\n10000243600365100=31536000000000\nè¿™æ•°å­—è·ç¦»BigIntçš„ä¸Šé™è¿˜å·®çš„è¿œï¼Œå› æ­¤ä½ å°†è‡ªå¢IDè®¾ä¸ºBigIntç±»å‹ï¼Œä½ æ˜¯ä¸ç”¨è€ƒè™‘è‡ªå¢IDè¾¾åˆ°æœ€å¤§å€¼è¿™ä¸ªé—®é¢˜ï¼\nç„¶è€Œï¼Œå¦‚æœä½ åœ¨é¢è¯•ä¸­çš„å›ç­”å¦‚æœæ˜¯\nä½ :\u0026quot;ç®€å•å•Šï¼ŒæŠŠè‡ªå¢ä¸»é”®çš„ç±»å‹æ”¹ä¸ºBigIntç±»å‹å°±å¥½äº†ï¼\u0026quot; æ¥ä¸‹æ¥ï¼Œé¢è¯•å®˜å¯ä»¥é—®ä½ ä¸€ä¸ªæ›´å‘çš„é—®é¢˜ï¼ é¢è¯•å®˜:\u0026quot;ä½ åœ¨çº¿ä¸Šæ€ä¹ˆä¿®æ”¹åˆ—çš„æ•°æ®ç±»å‹çš„ï¼Ÿ\u0026quot; ä½ :\u0026quot;whatï¼æˆ‘è¿˜æ˜¯å›ç­‰é€šçŸ¥å§ï¼\u0026quot;  æ€ä¹ˆæ”¹\nç›®å‰ä¸šå†…åœ¨çº¿ä¿®æ”¹è¡¨ç»“æ„çš„æ–¹æ¡ˆï¼Œæ®æˆ‘äº†è§£ï¼Œä¸€èˆ¬æœ‰å¦‚ä¸‹ä¸‰ç§\næ–¹å¼ä¸€:ä½¿ç”¨mysql5.6+æä¾›çš„åœ¨çº¿ä¿®æ”¹åŠŸèƒ½\næ‰€è°“çš„mysqlè‡ªå·±æä¾›çš„åŠŸèƒ½ä¹Ÿå°±æ˜¯mysqlè‡ªå·±åŸç”Ÿçš„è¯­å¥ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦ä¿®æ”¹åŸå­—æ®µåç§°åŠç±»å‹ã€‚\nmysql\u0026gt; ALTER TABLE table_name CHANGE old_field_name new_field_name field_type;\r é‚£ä¹ˆï¼Œåœ¨mysql5.5è¿™ä¸ªç‰ˆæœ¬ä¹‹å‰ï¼Œè¿™æ˜¯é€šè¿‡ä¸´æ—¶è¡¨æ‹·è´çš„æ–¹å¼å®ç°çš„ã€‚æ‰§è¡ŒALTERè¯­å¥åï¼Œä¼šæ–°å»ºä¸€ä¸ªå¸¦æœ‰æ–°ç»“æ„çš„ä¸´æ—¶è¡¨ï¼Œå°†åŸè¡¨æ•°æ®å…¨éƒ¨æ‹·è´åˆ°ä¸´æ—¶è¡¨ï¼Œç„¶åRenameï¼Œå®Œæˆåˆ›å»ºæ“ä½œã€‚è¿™ä¸ªæ–¹å¼è¿‡ç¨‹ä¸­ï¼ŒåŸè¡¨æ˜¯å¯è¯»çš„ï¼Œä¸å¯å†™ã€‚\nåœ¨5.6+å¼€å§‹ï¼Œmysqlæ”¯æŒåœ¨çº¿ä¿®æ”¹æ•°æ®åº“è¡¨ï¼Œåœ¨ä¿®æ”¹è¡¨çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹ç»å¤§éƒ¨åˆ†æ“ä½œï¼ŒåŸè¡¨å¯è¯»ï¼Œä¹Ÿå¯ä»¥å†™ã€‚\né‚£ä¹ˆï¼Œå¯¹äºä¿®æ”¹åˆ—çš„æ•°æ®ç±»å‹è¿™ç§æ“ä½œï¼ŒåŸè¡¨è¿˜èƒ½å†™ä¹ˆï¼Ÿæ¥æ¥æ¥ï¼ŒçƒŸå“¥ç‰¹æ„å»å®˜ç½‘æ‰¾äº†mysql8.0ç‰ˆæœ¬çš„ä¸€å¼ å›¾\nå¦‚å›¾æ‰€ç¤ºï¼Œå¯¹äºä¿®æ”¹æ•°æ®ç±»å‹è¿™ç§æ“ä½œï¼Œæ˜¯ä¸æ”¯æŒå¹¶å‘çš„DMLæ“ä½œï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ ç›´æ¥ä½¿ç”¨ALTERè¿™æ ·çš„è¯­å¥åœ¨çº¿ä¿®æ”¹è¡¨æ•°æ®ç»“æ„ï¼Œä¼šå¯¼è‡´è¿™å¼ è¡¨æ— æ³•è¿›è¡Œæ›´æ–°ç±»æ“ä½œ(DELETEã€UPDATEã€DELETE)ã€‚\nå› æ­¤ï¼Œç›´æ¥ALTERæ˜¯ä¸è¡Œæ»´ï¼\né‚£æˆ‘ä»¬åªèƒ½ç”¨æ–¹å¼äºŒæˆ–è€…æ–¹å¼ä¸‰\næ–¹å¼äºŒ:å€ŸåŠ©ç¬¬ä¸‰æ–¹å·¥å…· ä¸šå†…æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·å¯ä»¥æ”¯æŒåœ¨çº¿ä¿®æ”¹è¡¨ç»“æ„ï¼Œä½¿ç”¨è¿™äº›ç¬¬ä¸‰å‘å·¥å…·ï¼Œèƒ½å¤Ÿè®©ä½ åœ¨æ‰§è¡ŒALTERæ“ä½œçš„æ—¶å€™ï¼Œè¡¨ä¸ä¼šé˜»å¡ï¼æ¯”è¾ƒå‡ºåçš„æœ‰ä¸¤ä¸ª\npt-online-schema-changeï¼Œç®€ç§°pt-osc\nGitHubæ­£å¼å®£å¸ƒä»¥å¼€æºçš„æ–¹å¼å‘å¸ƒçš„å·¥å…·ï¼Œåä¸ºgh-ost\nä»¥pt-oscä¸ºä¾‹ï¼Œå®ƒçš„åŸç†å¦‚ä¸‹\n1ã€åˆ›å»ºä¸€ä¸ªæ–°çš„è¡¨ï¼Œè¡¨ç»“æ„ä¸ºä¿®æ”¹åçš„æ•°æ®è¡¨ï¼Œç”¨äºä»æºæ•°æ®è¡¨å‘æ–°è¡¨ä¸­å¯¼å…¥æ•°æ®ã€‚\n2ã€åˆ›å»ºè§¦å‘å™¨ï¼Œç”¨äºè®°å½•ä»æ‹·è´æ•°æ®å¼€å§‹ä¹‹åï¼Œå¯¹æºæ•°æ®è¡¨ç»§ç»­è¿›è¡Œæ•°æ®ä¿®æ”¹çš„æ“ä½œè®°å½•ä¸‹æ¥ï¼Œç”¨äºæ•°æ®æ‹·è´ç»“æŸåï¼Œæ‰§è¡Œè¿™äº›æ“ä½œï¼Œä¿è¯æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚\n3ã€æ‹·è´æ•°æ®ï¼Œä»æºæ•°æ®è¡¨ä¸­æ‹·è´æ•°æ®åˆ°æ–°è¡¨ä¸­ã€‚\n4ã€renameæºæ•°æ®è¡¨ä¸ºoldè¡¨ï¼ŒæŠŠæ–°è¡¨renameä¸ºæºè¡¨åï¼Œå¹¶å°†oldè¡¨åˆ é™¤ã€‚\n5ã€åˆ é™¤è§¦å‘å™¨ã€‚\nç„¶è€Œè¿™ä¸¤ä¸ªæœ‰æ„(KENG)æ€(B)çš„å·¥å…·ï¼Œå±…ç„¶ã€‚ã€‚ã€‚å±…ç„¶ã€‚ã€‚ã€‚å”‰ï¼å¦‚æœä½ çš„è¡¨é‡Œæœ‰è§¦å‘å™¨å’Œå¤–é”®ï¼Œè¿™ä¸¤ä¸ªå·¥å…·æ˜¯ä¸è¡Œæ»´ï¼\nå¦‚æœçœŸç¢°ä¸Šäº†æ•°æ®åº“é‡Œæœ‰è§¦å‘å™¨å’Œå¤–é”®ï¼Œåªèƒ½ç¡¬æ äº†ï¼Œè¯·çœ‹æ–¹å¼ä¸‰\næ–¹å¼ä¸‰:æ”¹ä»åº“è¡¨ç»“æ„ï¼Œç„¶åä¸»ä»åˆ‡æ¢\næ­¤æ³•æå…¶éº»çƒ¦ï¼Œéœ€è¦ä¸“ä¸šæ°´å¹³çš„é€‰æ‰‹è¿›è¡Œæ“ä½œã€‚å› ä¸ºæˆ‘ä»¬çš„mysqlæ¶æ„ä¸€èˆ¬æ˜¯è¯»å†™åˆ†ç¦»æ¶æ„ï¼Œä»æœºæ˜¯ç”¨æ¥è¯»çš„ã€‚æˆ‘ä»¬ç›´æ¥åœ¨ä»åº“ä¸Šè¿›è¡Œè¡¨ç»“æ„ä¿®æ”¹ï¼Œä¸ä¼šé˜»å¡ä»åº“çš„è¯»æ“ä½œã€‚æ”¹å®Œä¹‹åï¼Œè¿›è¡Œä¸»ä»åˆ‡æ¢å³å¯ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸»ä»åˆ‡æ¢è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæœ‰æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼\né«˜æ·±ç‰ˆ\nå…¶å®ç­”å®Œä¸Šé¢çš„é—®é¢˜åï¼Œè¿™ç¯‡æ–‡ç« å·®ä¸å¤šå®Œäº†ã€‚ä½†æ˜¯ï¼Œè¿˜è®°å¾—æˆ‘åœ¨å¼€å¤´è¯´çš„ä¹ˆã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„(KENG)æ€(B)çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\nå‡è®¾å•Šï¼Œä½ çš„è¡¨é‡Œçš„è‡ªå¢å­—æ®µä¸ºæœ‰ç¬¦å·çš„Intç±»å‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ çš„å­—æ®µèŒƒå›´ä¸º-2147483648åˆ°2147483648ã€‚\nä¸€åˆ‡åˆé‚£ä¹ˆåˆšå¥½ï¼Œä½ çš„è‡ªå¢IDæ˜¯ä»0å¼€å§‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç°åœ¨ä½ çš„å¯ä»¥ç”¨çš„èŒƒå›´ä¸º0ï½2147483648ã€‚\næˆ‘ä»¬æ˜ç¡®ä¸€ç‚¹ï¼Œè¡¨ä¸­çœŸå®çš„æ•°æ®IDï¼Œè‚¯å®šä¼šå‡ºç°ä¸€äº›æ„å¤–ï¼ŒIDä¸ä¸€å®šæ˜¯è¿ç»­çš„ã€‚ä¾‹å¦‚ï¼Œæœ‰å¦‚ä¸‹æƒ…å½¢çš„å‡ºç°\nCREATE TABLE `t` ( `id` int(11) NOT NULL AUTO_INCREMENT, PRIMARY KEY (`id`), ) ENGINE=InnoDB;  æ‰§è¡Œä¸‹åˆ—SQL\ninsert into t values(null);\r// æ’å…¥çš„è¡Œæ˜¯ (1)\rbegin;\rinsert into t values(null);\rrolllack;\rinsert into t values(null);\r// æ’å…¥çš„è¡Œæ˜¯ (3)\r å› æ­¤ï¼Œè¡¨ä¸­çš„çœŸå®idå¿…ç„¶ä¼šå‡ºç°æ–­ç»­çš„æƒ…å†µã€‚\nå¥½ï¼Œé‚£è¿™ä¼šä½ çš„è‡ªå¢ä¸»é”®idçš„æ•°æ®èŒƒå›´ä¸º0ï½2147483648ï¼Œä¹Ÿå°±æ˜¯å•è¡¨21äº¿æ¡æ•°æ®ï¼è€ƒè™‘idä¼šå‡ºç°æ–­ç»­ï¼ŒçœŸå®æ•°æ®é¡¶å¤š18äº¿æ¡å§ã€‚\nè€å“¥ï¼Œéƒ½å•è¡¨18äº¿æ¡äº†ï¼Œè¿˜ä¸åˆ†åº“åˆ†è¡¨ï¼Ÿä½ ä¸€æ—¦åˆ†åº“åˆ†è¡¨äº†ï¼Œå°±ä¸èƒ½ä¾èµ–äºæ¯ä¸ªè¡¨çš„è‡ªå¢IDæ¥å…¨å±€å”¯ä¸€æ ‡è¯†è¿™äº›æ•°æ®äº†ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦æä¾›ä¸€ ä¸ªå…¨å±€å”¯ä¸€çš„IDå·ç”Ÿæˆç­–ç•¥æ¥æ”¯æŒåˆ†åº“åˆ†è¡¨çš„ç¯å¢ƒã€‚\nå› æ­¤åœ¨å®é™…ä¸­ï¼Œä½ æ ¹æœ¬ç­‰ä¸åˆ°è‡ªå¢ä¸»é”®ç”¨å®Œåˆ°æƒ…å½¢ï¼å› æ­¤ï¼Œä½ éœ€è¦å…³æ³¨çš„æ–‡ç« åº”è¯¥æ˜¯åˆ†åº“åˆ†è¡¨åå¦‚ä½•éƒ¨ç½²ä¸Šçº¿\næ‰€ä»¥ï¼Œä¸“ä¸šç‰ˆå›ç­”å¦‚ä¸‹\né¢è¯•å®˜:\u0026quot;é‚£è‡ªå¢ä¸»é”®è¾¾åˆ°æœ€å¤§å€¼äº†ï¼Œç”¨å®Œäº†æ€ä¹ˆåŠï¼Ÿ\u0026quot; ä½ :\u0026quot;è¿™é—®é¢˜æ²¡é‡åˆ°è¿‡ï¼Œå› ä¸ºè‡ªå¢ä¸»é”®æˆ‘ä»¬ç”¨intç±»å‹ï¼Œä¸€èˆ¬è¾¾ä¸åˆ°æœ€å¤§å€¼ï¼Œæˆ‘ä»¬å°±åˆ†åº“åˆ†è¡¨äº†ï¼Œæ‰€ä»¥ä¸æ›¾é‡è§è¿‡ï¼\u0026quot;  ","id":30,"section":"posts","summary":"è½¬è‡ªå¾®ä¿¡å…¬ä¼—å·â€œå­¤ç‹¬çƒŸâ€ ç®€å•ç‰ˆ æˆ‘ä»¬å…ˆæ˜ç™½ä¸€ç‚¹ï¼Œåœ¨mysqlä¸­ï¼ŒIntæ•´å‹çš„èŒƒå›´å¦‚ä¸‹ æˆ‘ä»¬ä»¥æ— ç¬¦å·æ•´å‹ä¸ºä¾‹ï¼Œå­˜å‚¨èŒƒå›´ä¸º0ï½4294967295ï¼Œ","tags":["mysql"],"title":"[è½¬]è‡ªå¢ä¸»é”®ç”¨å®Œäº†è¯¥æ€ä¹ˆåŠ","uri":"https://www.mingaccount.com/2019/10/auto-increment-id-is-dry/","year":"2019"},{"content":"Docker Registryè´Ÿè´£ä¿å­˜ç®¡ç†é•œåƒï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤å®˜æ–¹çš„Docker Hubï¼Œä½†éœ€è¦ç™»å½•ï¼Œå¹¶ä¸”æ˜¯å…¬å¼€çš„ã€‚\nç§æœ‰çš„Registryï¼Œä¸»è¦ä¸‹é¢ä¸¤ç§ï¼š\n Docker Registryï¼ˆDockerå®˜æ–¹æä¾›çš„é•œåƒï¼‰   å®‰è£…æ­¥éª¤å‚è€ƒinstall Docker Registry\n  Harbor(ä¼ä¸šçº§Registryï¼Œæä¾›æƒé™ç®¡ç†å’Œå›¾å½¢åŒ–ç•Œé¢)   å®‰è£…æ­¥éª¤å‚è€ƒinstall Harbor Registry\n ","id":31,"section":"posts","summary":"Docker Registryè´Ÿè´£ä¿å­˜ç®¡ç†é•œåƒï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤å®˜æ–¹çš„Docker Hubï¼Œä½†éœ€è¦ç™»å½•ï¼Œå¹¶ä¸”æ˜¯å…¬å¼€çš„ã€‚ ç§æœ‰çš„Registryï¼Œä¸»è¦ä¸‹é¢ä¸¤ç§ï¼š Docker","tags":["docker"],"title":"Docker Registry","uri":"https://www.mingaccount.com/2019/09/docker-registry/","year":"2019"},{"content":"æ‰§è¡Œè½¬æ¢å‘½ä»¤ gradle init\r é—®é¢˜ ideaæ„å»ºæ§åˆ¶å°ä¹±ç  èœå• Help-\u0026gt;Edit Custom VM Options\næ·»åŠ ä»¥ä¸‹VMå‚æ•°\n-Dfile.encoding=utf-8\r gradle buildå¤±è´¥  ideaæ¸…é™¤æ‰€æœ‰å¤±æ•ˆç¼“å­˜ File-\u0026gt;invalidate caches/restart gradleè¾“å‡ºç›®å½•é»˜è®¤ä¸ºbuildè·Ÿmavençš„outæœ‰åŒºåˆ«ï¼Œç¡®ä¿project structureä¸­é…ç½®æ­£ç¡® mavenä¸­å¦‚æœæœ‰ä¾èµ–lombokï¼Œå…‰é é»˜è®¤initå‘½ä»¤ç”Ÿæˆçš„lombokä¾èµ–æ˜¯ä¸å¤Ÿçš„ï¼Œéœ€è¦é‡æ–°é…ç½®lombokä¾èµ–ï¼š  dependencies {\rcompileOnly 'org.projectlombok:lombok:1.18.16'\rannotationProcessor 'org.projectlombok:lombok:1.18.16'\rtestCompileOnly 'org.projectlombok:lombok:1.18.16'\rtestAnnotationProcessor 'org.projectlombok:lombok:1.18.16'\r}\r  å¼•ç”¨è‡ªlombok gradle\n ","id":32,"section":"posts","summary":"æ‰§è¡Œè½¬æ¢å‘½ä»¤ gradle init é—®é¢˜ ideaæ„å»ºæ§åˆ¶å°ä¹±ç  èœå• Help-\u0026gt;Edit Custom VM Options æ·»åŠ ä»¥ä¸‹VMå‚æ•° -Dfile.encoding=utf-8 gradle buildå¤±è´¥ ideaæ¸…é™¤æ‰€æœ‰å¤±æ•ˆç¼“å­˜ File-\u0026gt;invalidate caches/restart gradleè¾“å‡ºç›®å½•é»˜è®¤","tags":["gradle"],"title":"Mavené¡¹ç›®è½¬ä¸ºGradle","uri":"https://www.mingaccount.com/2019/09/gradle-init/","year":"2019"},{"content":"\u0026ldquo;\\ufeff\u0026quot;æ˜¯UTF-8 BOMç¼–ç çš„æ–‡ä»¶å¤´ï¼Œä»£è¡¨è¯¥æ–‡ä»¶æŒ‰ç…§ä»€ä¹ˆå­—èŠ‚é¡ºåºæ’åº\nè°ƒç”¨javaçš„å·¥å…·ç±» [UnicodeInputStream]å³å¯è§£å†³è¿™ä¸ªé—®é¢˜\n//ç¬¬äºŒä¸ªå‚æ•°targetEncodingä¸ºnullæ—¶åœ¨getDetectedEncodingæ–¹æ³•ä¸­ä¼šè‡ªåŠ¨æ£€æµ‹ç¼–ç ç±»å‹\rUnicodeInputStream unicodeInputStream = new UnicodeInputStream(inputStream, null);\rString enc = unicodeInputStream.getDetectedEncoding();\r//UnicodeInputStreamå†…éƒ¨ç”±PushbackInputStreamå®ç°ï¼Œè·³è¿‡äº†æ— æ„ä¹‰çš„æ–‡ä»¶å¤´\rbufferedReader = new BufferedReader(new InputStreamReader(unicodeInputStream, enc));\r ","id":33,"section":"posts","summary":"\u0026ldquo;\\ufeff\u0026quot;æ˜¯UTF-8 BOMç¼–ç çš„æ–‡ä»¶å¤´ï¼Œä»£è¡¨è¯¥æ–‡ä»¶æŒ‰ç…§ä»€ä¹ˆå­—èŠ‚é¡ºåºæ’åº è°ƒç”¨javaçš„å·¥å…·ç±» [UnicodeIn","tags":["java"],"title":"Javaè¯»å–æ–‡ä»¶å†…å®¹æ–‡ä»¶å¤´æœ‰ï»¿","uri":"https://www.mingaccount.com/2019/09/java-stream-bom/","year":"2019"},{"content":"åŸå› æ˜¯sparkæœ‰ä¸¤ä¸ªæ–‡ä»¶å¤´\nã€€[file://]ä»£è¡¨æœ¬åœ°\nã€€[hdfs://]ä»£è¡¨hdfsè·¯å¾„\nå¦‚æœè·¯å¾„æ²¡æœ‰æ–‡ä»¶å¤´ï¼Œsparkä¼šå°†è¯¥è·¯å¾„é»˜è®¤æ·»åŠ ä¸Š\u0026quot;hdfs://\u0026quot;\næ‰€ä»¥å¦‚æœè¦è®¿é—®æœ¬åœ°csvæ–‡ä»¶ï¼Œéœ€è¦ç¡®ä¿è·¯å¾„å‰é¢æœ‰\u0026quot;file://\u0026quot;\n//javaä»£ç ï¼Œå‘Šè¯‰sparkè¿™æ˜¯æœ¬åœ°æ–‡ä»¶\r\u0026quot;file:///\u0026quot; + url\r ","id":34,"section":"posts","summary":"åŸå› æ˜¯sparkæœ‰ä¸¤ä¸ªæ–‡ä»¶å¤´ [file://]ä»£è¡¨æœ¬åœ° [hdfs://]ä»£è¡¨hdfsè·¯å¾„ å¦‚æœè·¯å¾„æ²¡æœ‰æ–‡ä»¶å¤´ï¼Œsparkä¼šå°†è¯¥è·¯å¾„é»˜è®¤æ·»åŠ ä¸Š\u0026","tags":["spark"],"title":"SparkSession.read().csv()æ— æ³•å®šä½æœ¬åœ°æ–‡ä»¶çš„é—®é¢˜","uri":"https://www.mingaccount.com/2019/09/spark-session-cant-read-local-file/","year":"2019"},{"content":"æ­£ç¡®çš„è°ƒç”¨æ–¹å¼ä¸ºï¼š\n@Component\rpublic class IconProperties {\r@Value(\u0026quot;${icon.url}\u0026quot;)\rprivate String url;\r}\rpublic class test{\r@Autowired\rIconProperties icon;\rpublic void test(){ String url = icon.url; }\r}\r è¿™é‡Œæœ‰ä¸‰ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼š\n1.@Valueèµ‹å€¼æ˜¯å¦æ­£ç¡®\n2.IconPropertiesæ˜¯å¦æœ‰@Componentï¼Œæˆ–è€…å…¶ä»–ä»£è¡¨ç€è¯¥ç±»äº¤äºSpringå®¹å™¨ç®¡ç†çš„æ³¨è§£\n3.åœ¨è°ƒç”¨å‚æ•°æ—¶é€šè¿‡@Autowiredå®ä¾‹åŒ–ç±»æ¥è°ƒå–\n","id":35,"section":"posts","summary":"æ­£ç¡®çš„è°ƒç”¨æ–¹å¼ä¸ºï¼š @Component public class IconProperties { @Value(\u0026quot;${icon.url}\u0026quot;) private String url; } public class test{ @Autowired IconProperties icon; public void test(){ String url = icon.url; } } è¿™é‡Œæœ‰ä¸‰ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼š 1.@Valueèµ‹å€¼æ˜¯å¦æ­£ç¡® 2.IconProp","tags":["spring"],"title":"Spring @Valueæ³¨è§£æ— æ³•æ­£ç¡®èµ‹å€¼é—®é¢˜","uri":"https://www.mingaccount.com/2019/09/spring-value-anno-cant-set-value/","year":"2019"},{"content":"åŸºäºSpring çš„@Transactionalæ³¨è§£ï¼ŒJOOQå¯ä»¥éå¸¸ç®€å•çš„å®ç°äº‹åŠ¡ç®¡ç†ï¼Œè¯¦ç»†å‚è€ƒJOOQ-Spring Transactional Management\nè¿™é‡Œä¸»è¦è®¨è®ºå¦‚Springæ³¨è§£ä¸èƒ½ä»‹å…¥çš„æƒ…å†µï¼Œæˆ–è€…äº‹åŠ¡èŒƒå›´å°äºæ–¹æ³•\ncreate.transaction(configuration -\u0026gt; { AuthorRecord author = DSL.using(configuration) .insertInto(AUTHOR, AUTHOR.FIRST_NAME, AUTHOR.LAST_NAME) .values(\u0026quot;George\u0026quot;, \u0026quot;Orwell\u0026quot;) .returning() .fetchOne(); DSL.using(configuration) .insertInto(BOOK, BOOK.AUTHOR_ID, BOOK.TITLE) .values(author.getId(), \u0026quot;1984\u0026quot;) .values(author.getId(), \u0026quot;Animal Farm\u0026quot;) .execute(); // Implicit commit executed here });  æ³¨æ„ä¸Šé¢ä¾‹å­ä¸­çš„createè™½ç„¶å°±æ˜¯ä¸€ä¸ªDslContextï¼Œä½†æ˜¯ä½ ä¸èƒ½ç›´æ¥ç”¨äºå®ç°ä¸­ï¼Œéœ€è¦è·å–åˆ°ä»–çš„configurationï¼Œé‡æ–°æ„é€ ä¸€ä¸ª\n è¯¦ç»†å‚è€ƒJooq Transactional Management\n ","id":36,"section":"posts","summary":"åŸºäºSpring çš„@Transactionalæ³¨è§£ï¼ŒJOOQå¯ä»¥éå¸¸ç®€å•çš„å®ç°äº‹åŠ¡ç®¡ç†ï¼Œè¯¦ç»†å‚è€ƒJOOQ-Spring Transactional Management è¿™é‡Œä¸»è¦è®¨è®ºå¦‚Sp","tags":["jooq","transactional"],"title":"JOOQäº‹åŠ¡å¤„ç†","uri":"https://www.mingaccount.com/2019/08/jooq-transaction/","year":"2019"},{"content":"delimiter // #å®šä¹‰æ ‡è¯†ç¬¦ä¸ºåŒæ–œæ \rdrop procedure if exists test; #å¦‚æœå­˜åœ¨testå­˜å‚¨è¿‡ç¨‹åˆ™åˆ é™¤\rcreate procedure test() #åˆ›å»ºæ— å‚å­˜å‚¨è¿‡ç¨‹,åç§°ä¸ºtest\rbegin\rdeclare i int; #ç”³æ˜å˜é‡\rset i = 0; #å˜é‡èµ‹å€¼\rwhile i \u0026lt; 50 do #ç»“æŸå¾ªç¯çš„æ¡ä»¶: å½“iå¤§äº10æ—¶è·³å‡ºwhileå¾ªç¯\rINSERT INTO table_test\r( name\r)\rVALUES\r(\r'123'\r);\rSET i=i+1;ã€€#å¾ªç¯æ¡ä»¶ä¸èƒ½ä¸¢\rend while; #ç»“æŸwhileå¾ªç¯\rselect * from test; #æŸ¥çœ‹testè¡¨æ•°æ®\rend\r// #ç»“æŸå®šä¹‰è¯­å¥\rcall test(); #è°ƒç”¨å­˜å‚¨è¿‡ç¨‹\r ä»¥ä¸Šæ˜¯mysqlå¾ªç¯è¯­å¥ï¼Œä½†æˆ‘åœ¨æ‰§è¡Œçš„æ—¶å€™å¿˜äº†åŠ ä¸ŠSET å¾ªç¯æ¡ä»¶ï¼Œå¯¼è‡´SQLæ— é™å¾ªç¯å¾€è¡¨é‡Œæ’å…¥æ•°æ®\nè¿™ç§æƒ…å†µå…‰æ˜¯å…³é—­SQLçª—å£ï¼Œæ˜¯ä¸ç®¡ç”¨çš„ï¼ŒSQLä¼šåœ¨åå°ç»§ç»­è¿è¡Œï¼Œéœ€è¦æ‰¾åˆ°å¯¹åº”çº¿ç¨‹ï¼Œæ‰‹åŠ¨æ€æ­»\n#å±•ç¤ºæ‰€æœ‰è¿è¡Œä¸­çš„çº¿ç¨‹ï¼Œçº¿ç¨‹ä¿¡æ¯é‡Œä¼šå±•ç¤ºå¯¹åº”SQL\rSHOW PROCESSLIST;\r#æ€æ‰å¯¹åº”çº¿ç¨‹id\rKILL 123456;\r ","id":37,"section":"posts","summary":"delimiter // #å®šä¹‰æ ‡è¯†ç¬¦ä¸ºåŒæ–œæ  drop procedure if exists test; #å¦‚æœå­˜åœ¨testå­˜å‚¨è¿‡ç¨‹åˆ™åˆ é™¤ create procedure test() #åˆ›å»ºæ— å‚å­˜å‚¨è¿‡ç¨‹,åç§°ä¸ºtest begin declare i int; #ç”³æ˜å˜é‡ set i = 0; #å˜é‡èµ‹","tags":["mysql"],"title":"Mysqlå¾ªç¯è¯­å¥ï¼Œæ­»å¾ªç¯è§£å†³åŠæ³•","uri":"https://www.mingaccount.com/2019/08/mysql-dead-cycle/","year":"2019"},{"content":"Jenkinsfile pipeline {\ragent any\rstages {\rstage('Test') {\rsteps {\rsh './mvnw test'\r}\r}\r}\rpost {\ralways {\rjunit 'target/surefire-reports/*.xml'\r}\r}\r}\r å¼‚å¸¸ ./mvnw: Permission denied\r è§£å†³æ–¹æ¡ˆ git update-index --chmod +x mvnw  ","id":38,"section":"posts","summary":"Jenkinsfile pipeline { agent any stages { stage('Test') { steps { sh './mvnw test' } } } post { always { junit 'target/surefire-reports/*.xml' } } } å¼‚å¸¸ ./mvnw: Permission denied è§£å†³æ–¹æ¡ˆ git update-index --chmod +x mvnw","tags":["jenkins","git"],"title":"jenkins sh permission denied","uri":"https://www.mingaccount.com/2019/08/jenkins-sh-permission-denied/","year":"2019"},{"content":"é—®é¢˜ æœ€è¿‘é¡¹ç›®å°ç»„åœ¨é‡æ–°è§„åˆ’å·¥ç¨‹çš„ä¸šåŠ¡ç¼“å­˜ï¼Œå…¶ä¸­æ¶‰åŠåˆ°éƒ¨åˆ†ä»£ç é‡æ„ï¼Œè¿‡ç¨‹ä¸­å‘ç°æœ‰äº›å·¥å…·ç±»ä¸­çš„é™æ€æ–¹æ³•éœ€è¦ä¾èµ–åˆ«çš„å¯¹è±¡å®ä¾‹ï¼ˆè¯¥å®ä¾‹å·²é…ç½®åœ¨xmlæˆSpring beanï¼Œéé™æ€å¯ä»¥ç”¨@AutowiredåŠ è½½æ­£å¸¸ä½¿ç”¨ï¼‰ï¼Œè€Œæˆ‘ä»¬çŸ¥é“ï¼Œç±»åŠ è½½åé™æ€æˆå‘˜æ˜¯åœ¨å†…å­˜çš„å…±äº«åŒºï¼Œé™æ€æ–¹æ³•é‡Œé¢çš„å˜é‡å¿…ç„¶è¦ä½¿ç”¨é™æ€æˆå‘˜å˜é‡ï¼Œè¿™å°±æœ‰äº†å¦‚ä¸‹ä»£ç ï¼š\n@Component\rpublic class TestClass {\r@Autowired\rprivate static AutowiredTypeComponent component;\r// è°ƒç”¨é™æ€ç»„ä»¶çš„æ–¹æ³•\rpublic static void testMethod() {\rcomponent.callTestMethod();\r}\r}\r ç¼–è¯‘æ­£å¸¸ï¼Œä½†è¿è¡Œæ—¶æŠ¥java.lang.NullPointerException: nullå¼‚å¸¸ï¼Œæ˜¾ç„¶åœ¨è°ƒç”¨testMethod()æ–¹æ³•æ—¶ï¼Œcomponentå˜é‡è¿˜æ²¡è¢«åˆå§‹åŒ–ï¼ŒæŠ¥NPEã€‚\nåŸå›  æ‰€ä»¥ï¼Œåœ¨Springframeworké‡Œï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½@Autowiredä¸€ä¸ªé™æ€å˜é‡ï¼Œä½¿ä¹‹æˆä¸ºä¸€ä¸ªSpring beançš„ã€‚ä¸ºä»€ä¹ˆï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå› ä¸ºå½“ç±»åŠ è½½å™¨åŠ è½½é™æ€å˜é‡æ—¶ï¼ŒSpringä¸Šä¸‹æ–‡å°šæœªåŠ è½½ã€‚æ‰€ä»¥ç±»åŠ è½½å™¨ä¸ä¼šåœ¨beanä¸­æ­£ç¡®æ³¨å…¥é™æ€ç±»ï¼Œå¹¶ä¸”ä¼šå¤±è´¥ã€‚\nè§£å†³æ–¹æ¡ˆ æ–¹å¼ä¸€ å°†@Autowired æ³¨è§£åˆ°ç±»çš„æ„é€ å‡½æ•°ä¸Šã€‚å¾ˆå¥½ç†è§£ï¼ŒSpringæ‰«æåˆ°AutowiredTypeComponentçš„beanï¼Œç„¶åèµ‹ç»™é™æ€å˜é‡componentã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š\n@Component\rpublic class TestClass {\rprivate static AutowiredTypeComponent component;\r@Autowired\rpublic TestClass(AutowiredTypeComponent component) {\rTestClass.component = component;\r}\r// è°ƒç”¨é™æ€ç»„ä»¶çš„æ–¹æ³•\rpublic static void testMethod() {\rcomponent.callTestMethod();\r}\r}\r æ–¹å¼äºŒ ç»™é™æ€ç»„ä»¶åŠ setteræ–¹æ³•ï¼Œå¹¶åœ¨è¿™ä¸ªæ–¹æ³•ä¸ŠåŠ ä¸Š@Autowiredã€‚Springèƒ½æ‰«æåˆ°AutowiredTypeComponentçš„beanï¼Œç„¶åé€šè¿‡setteræ–¹æ³•æ³¨å…¥ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š\n@Component\rpublic class TestClass {\rprivate static AutowiredTypeComponent component;\r@Autowired\rpublic void setComponent(AutowiredTypeComponent component){\rTestClass.component = component;\r}\r// è°ƒç”¨é™æ€ç»„ä»¶çš„æ–¹æ³•\rpublic static void testMethod() {\rcomponent.callTestMethod();\r}\r}\r æ–¹å¼ä¸‰ å®šä¹‰ä¸€ä¸ªé™æ€ç»„ä»¶ï¼Œå®šä¹‰ä¸€ä¸ªéé™æ€ç»„ä»¶å¹¶åŠ ä¸Š@Autowiredæ³¨è§£ï¼Œå†å®šä¹‰ä¸€ä¸ªåˆå§‹åŒ–ç»„ä»¶çš„æ–¹æ³•å¹¶åŠ ä¸Š@PostConstructæ³¨è§£ã€‚è¿™ä¸ªæ³¨è§£æ˜¯JavaEEå¼•å…¥çš„ï¼Œä½œç”¨äºservletç”Ÿå‘½å‘¨æœŸçš„æ³¨è§£ï¼Œä½ åªéœ€è¦çŸ¥é“ï¼Œç”¨å®ƒæ³¨è§£çš„æ–¹æ³•åœ¨æ„é€ å‡½æ•°ä¹‹åå°±ä¼šè¢«è°ƒç”¨ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š\n@Component\rpublic class TestClass {\rprivate static AutowiredTypeComponent component;\r@Autowired\rprivate AutowiredTypeComponent autowiredComponent;\r@PostConstruct\rprivate void beforeInit() {\rcomponent = this.autowiredComponent;\r}\r// è°ƒç”¨é™æ€ç»„ä»¶çš„æ–¹æ³•\rpublic static void testMethod() {\rcomponent.callTestMethod();\r}\r}\r æ–¹å¼å›› ç›´æ¥ç”¨Springæ¡†æ¶å·¥å…·ç±»è·å–beanï¼Œå®šä¹‰æˆå±€éƒ¨å˜é‡ä½¿ç”¨ã€‚ä½†æœ‰å¼Šç«¯ï¼šå¦‚æœè¯¥ç±»ä¸­æœ‰å¤šä¸ªé™æ€æ–¹æ³•å¤šæ¬¡ç”¨åˆ°è¿™ä¸ªç»„ä»¶åˆ™æ¯æ¬¡éƒ½è¦è¿™æ ·è·å–ï¼Œä¸ªäººä¸æ¨èè¿™ç§æ–¹å¼ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š\npublic class TestClass {\r// è°ƒç”¨é™æ€ç»„ä»¶çš„æ–¹æ³•\rpublic static void testMethod() {\rAutowiredTypeComponent component = SpringApplicationContextUtil.getBean(\u0026quot;component\u0026quot;);\rcomponent.callTestMethod();\r}\r}\r åŸæ–‡ï¼šhttps://blog.csdn.net/RogueFist/article/details/79575665\n","id":39,"section":"posts","summary":"é—®é¢˜ æœ€è¿‘é¡¹ç›®å°ç»„åœ¨é‡æ–°è§„åˆ’å·¥ç¨‹çš„ä¸šåŠ¡ç¼“å­˜ï¼Œå…¶ä¸­æ¶‰åŠåˆ°éƒ¨åˆ†ä»£ç é‡æ„ï¼Œè¿‡ç¨‹ä¸­å‘ç°æœ‰äº›å·¥å…·ç±»ä¸­çš„é™æ€æ–¹æ³•éœ€è¦ä¾èµ–åˆ«çš„å¯¹è±¡å®ä¾‹ï¼ˆè¯¥å®ä¾‹å·²é…ç½®åœ¨xml","tags":["spring"],"title":"[è½¬]Springä¸­ä½¿ç”¨@Autowiredæ³¨è§£é™æ€å®ä¾‹å¯¹è±¡","uri":"https://www.mingaccount.com/2019/07/spring-autowired-static-object/","year":"2019"},{"content":"1.æ•°æ®åº“urlåè¿½åŠ \n\u0026amp;serverTimezone=Asia/Shanghai\r 2.ä¿®æ”¹æ•°æ®åº“é»˜è®¤æ—¶åŒº\nshow variables like \u0026quot;%time_zone%\u0026quot;;#æŸ¥è¯¢å½“å‰æ—¶åŒº\rset global time_zone = '+8:00'; #ä¿®æ”¹mysqlå…¨å±€æ—¶åŒºä¸ºåŒ—äº¬æ—¶é—´ï¼Œå³æˆ‘ä»¬æ‰€åœ¨çš„ä¸œ8åŒº\rset time_zone = '+8:00'; #ä¿®æ”¹å½“å‰ä¼šè¯æ—¶åŒº\rflush privileges; #ç«‹å³ç”Ÿæ•ˆ\r ","id":40,"section":"posts","summary":"1.æ•°æ®åº“urlåè¿½åŠ  \u0026amp;serverTimezone=Asia/Shanghai 2.ä¿®æ”¹æ•°æ®åº“é»˜è®¤æ—¶åŒº show variables like \u0026quot;%time_zone%\u0026quot;;#æŸ¥è¯¢å½“å‰æ—¶åŒº set global time_zone = '+8:00'; #ä¿®æ”¹mysql","tags":["mysql"],"title":"Mysql æ—¥æœŸTIMESTAMPç±»å‹æ’å…¥ï¼Œä¸ç³»ç»Ÿæ—¶é—´æœ‰å·®å¼‚","uri":"https://www.mingaccount.com/2019/07/mysql-timestamp-time-zone/","year":"2019"},{"content":"Googleç¿»è¯‘ GET http://translate.google.cn/translate_a/single?client=gtx\u0026amp;dt=t\u0026amp;dj=1\u0026amp;ie=UTF-8\u0026amp;sl=auto\u0026amp;tl=zh_CN\u0026amp;q=hence\r è¿”å›ç¤ºä¾‹\n{\r\u0026quot;sentences\u0026quot;: [\r{\r\u0026quot;trans\u0026quot;: \u0026quot;å› æ­¤\u0026quot;,\r\u0026quot;orig\u0026quot;: \u0026quot;hence\u0026quot;,\r\u0026quot;backend\u0026quot;: 10\r}\r],\r\u0026quot;src\u0026quot;: \u0026quot;en\u0026quot;,\r\u0026quot;confidence\u0026quot;: 1.0,\r\u0026quot;spell\u0026quot;: {},\r\u0026quot;ld_result\u0026quot;: {\r\u0026quot;srclangs\u0026quot;: [\r\u0026quot;en\u0026quot;\r],\r\u0026quot;srclangs_confidences\u0026quot;: [\r1.0\r],\r\u0026quot;extended_srclangs\u0026quot;: [\r\u0026quot;en\u0026quot;\r]\r}\r}\r å¾®è½¯ç¿»è¯‘ GET http://api.microsofttranslator.com/v2/Http.svc/Translate?appId=AFC76A66CF4F434ED080D245C30CF1E71C22959C\u0026amp;from=\u0026amp;to=zh-Hans\u0026amp;text=hence\r è¿”å›ç¤ºä¾‹\n\u0026lt;string xmlns=\u0026quot;http://schemas.microsoft.com/2003/10/Serialization/\u0026quot;\u0026gt;å› æ­¤\u0026lt;/string\u0026gt;\r æœ‰é“ç¿»è¯‘ GET http://fanyi.youdao.com/translate?\u0026amp;doctype=json\u0026amp;type=AUTO\u0026amp;i=hence\r è¿”å›ç¤ºä¾‹\n{\r\u0026quot;type\u0026quot;: \u0026quot;EN2ZH_CN\u0026quot;,\r\u0026quot;errorCode\u0026quot;: 0,\r\u0026quot;elapsedTime\u0026quot;: 1,\r\u0026quot;translateResult\u0026quot;: [\r[\r{\r\u0026quot;src\u0026quot;: \u0026quot;hence\u0026quot;,\r\u0026quot;tgt\u0026quot;: \u0026quot;å› æ­¤\u0026quot;\r}\r]\r]\r}\r ","id":41,"section":"posts","summary":"Googleç¿»è¯‘ GET http://translate.google.cn/translate_a/single?client=gtx\u0026amp;dt=t\u0026amp;dj=1\u0026amp;ie=UTF-8\u0026amp;sl=auto\u0026amp;tl=zh_CN\u0026amp;q=hence è¿”å›ç¤ºä¾‹ { \u0026quot;sentences\u0026quot;: [ { \u0026quot;trans\u0026quot;: \u0026quot;å› æ­¤\u0026quot;, \u0026quot;orig\u0026quot;: \u0026quot;hence\u0026quot;, \u0026quot;backend\u0026quot;: 10 } ], \u0026quot;src\u0026quot;: \u0026quot;en\u0026quot;, \u0026quot;confidence\u0026quot;: 1.0, \u0026quot;spell\u0026quot;: {}, \u0026quot;ld_result\u0026quot;: { \u0026quot;srclangs\u0026quot;: [ \u0026quot;en\u0026quot; ], \u0026quot;srclangs_confidences\u0026quot;: [ 1.0 ], \u0026quot;extended_srclangs\u0026quot;: [ \u0026quot;en\u0026quot; ] } } å¾®è½¯ç¿»è¯‘ GET http://api.microsofttranslator.com/v2/Http.svc/Translate?appId=AFC76A66CF4F434ED080D245C30CF1E71C22959C\u0026amp;from=\u0026amp;to=zh-Hans\u0026amp;text=hence è¿”å›","tags":["api"],"title":"å…è´¹APIæ”¶é›†","uri":"https://www.mingaccount.com/2019/07/free-translate-api/","year":"2019"},{"content":"public class EncryptUtils {\rprivate static final String SECRET_KEY_1 = \u0026quot;YIORGA4dBYp6y7u8\u0026quot;;\rprivate static final String SECRET_KEY_2 = \u0026quot;C6B8r5y7u7Uh37Sy\u0026quot;;\rprivate IvParameterSpec ivParameterSpec;\rprivate SecretKeySpec secretKeySpec;\rprivate Cipher cipher;\rpublic EncryptUtils() throws UnsupportedEncodingException, NoSuchPaddingException, NoSuchAlgorithmException {\rivParameterSpec = new IvParameterSpec(SECRET_KEY_1.getBytes(\u0026quot;UTF-8\u0026quot;));\rsecretKeySpec = new SecretKeySpec(SECRET_KEY_2.getBytes(\u0026quot;UTF-8\u0026quot;), \u0026quot;AES\u0026quot;);\rcipher = Cipher.getInstance(\u0026quot;AES/CBC/PKCS5PADDING\u0026quot;);\r}\r/**\r* Encrypt the string with this internal algorithm.\r*\r* @param toBeEncrypt string object to be encrypt.\r* @return returns encrypted string.\r* @throws NoSuchPaddingException\r* @throws NoSuchAlgorithmException\r* @throws InvalidAlgorithmParameterException\r* @throws InvalidKeyException\r* @throws BadPaddingException\r* @throws IllegalBlockSizeException\r*/\rpublic String encrypt(String toBeEncrypt) throws NoSuchPaddingException, NoSuchAlgorithmException,\rInvalidAlgorithmParameterException, InvalidKeyException, BadPaddingException, IllegalBlockSizeException {\rcipher.init(Cipher.ENCRYPT_MODE, secretKeySpec, ivParameterSpec);\rbyte[] encrypted = cipher.doFinal(toBeEncrypt.getBytes());\rreturn Base64.encodeBase64String(encrypted);\r}\r/**\r* Decrypt this string with the internal algorithm. The passed argument should be encrypted using\r* {@link #encrypt(String) encrypt} method of this class.\r*\r* @param encrypted encrypted string that was encrypted using {@link #encrypt(String) encrypt} method.\r* @return decrypted string.\r* @throws InvalidAlgorithmParameterException\r* @throws InvalidKeyException\r* @throws BadPaddingException\r* @throws IllegalBlockSizeException\r*/\rpublic String decrypt(String encrypted) throws InvalidAlgorithmParameterException, InvalidKeyException,\rBadPaddingException, IllegalBlockSizeException {\rcipher.init(Cipher.DECRYPT_MODE, secretKeySpec, ivParameterSpec);\rbyte[] decryptedBytes = cipher.doFinal(Base64.decodeBase64(encrypted));\rreturn new String(decryptedBytes);\r}\r}\r ","id":42,"section":"posts","summary":"public class EncryptUtils { private static final String SECRET_KEY_1 = \u0026quot;YIORGA4dBYp6y7u8\u0026quot;; private static final String SECRET_KEY_2 = \u0026quot;C6B8r5y7u7Uh37Sy\u0026quot;; private IvParameterSpec ivParameterSpec; private SecretKeySpec secretKeySpec; private Cipher cipher; public EncryptUtils() throws UnsupportedEncodingException, NoSuchPaddingException, NoSuchAlgorithmException { ivParameterSpec = new IvParameterSpec(SECRET_KEY_1.getBytes(\u0026quot;UTF-8\u0026quot;)); secretKeySpec = new SecretKeySpec(SECRET_KEY_2.getBytes(\u0026quot;UTF-8\u0026quot;), \u0026quot;AES\u0026quot;); cipher = Cipher.getInstance(\u0026quot;AES/CBC/PKCS5PADDING\u0026quot;); } /** * Encrypt the string with this internal algorithm. * * @param toBeEncrypt string object to be encrypt. * @return returns encrypted string.","tags":["java"],"title":"JavaåŠ å¯†ç±»Cipherçš„ä½¿ç”¨","uri":"https://www.mingaccount.com/2019/07/java-cipher/","year":"2019"},{"content":"é…ç½®æœ‰@ConfigurationProperties æ³¨è§£çš„ç±»ï¼Œæœ‰å¦‚ä¸‹æç¤º spring boot configuration annotation processor not found in classpath\npomè¿½åŠ é…ç½®å¦‚ä¸‹ä¾èµ–å³å¯\n\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;spring-boot-configuration-processor\u0026lt;/artifactId\u0026gt;\r\u0026lt;optional\u0026gt;true\u0026lt;/optional\u0026gt;\r\u0026lt;/dependency\u0026gt;\r ","id":43,"section":"posts","summary":"é…ç½®æœ‰@ConfigurationProperties æ³¨è§£çš„ç±»ï¼Œæœ‰å¦‚ä¸‹æç¤º spring boot configuration annotation processor not found in classpath pomè¿½åŠ é…ç½®å¦‚ä¸‹ä¾èµ–å³å¯ \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-configuration-processor\u0026lt;/artifactId\u0026gt; \u0026lt;optional\u0026gt;true\u0026lt;/optional\u0026gt; \u0026lt;/dependency\u0026gt;","tags":["spring"],"title":"spring boot configuration annotation processor not found in classpath","uri":"https://www.mingaccount.com/2019/07/spring-boot-configuration-exception/","year":"2019"},{"content":"é…ç½®å¤æ‚ï¼Œæ¯”è¾ƒè‡ƒè‚¿ï¼Œæ¨èä½¿ç”¨ideaçš„æ’ä»¶easyCode\npom.xmlé…ç½®ï¼š\n\u0026lt;!-- mybatisè‡ªåŠ¨ç”Ÿæˆ start --\u0026gt;\r\u0026lt;plugin\u0026gt;\r\u0026lt;groupId\u0026gt;org.mybatis.generator\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;mybatis-generator-maven-plugin\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1.3.2\u0026lt;/version\u0026gt;\r\u0026lt;configuration\u0026gt;\r\u0026lt;!--é…ç½®æ–‡ä»¶çš„ä½ç½®--\u0026gt;\r\u0026lt;configurationFile\u0026gt;src/main/resources/generatorConfig.xml\u0026lt;/configurationFile\u0026gt;\r\u0026lt;verbose\u0026gt;true\u0026lt;/verbose\u0026gt;\r\u0026lt;overwrite\u0026gt;true\u0026lt;/overwrite\u0026gt;\r\u0026lt;/configuration\u0026gt;\r\u0026lt;executions\u0026gt;\r\u0026lt;execution\u0026gt;\r\u0026lt;id\u0026gt;Generate MyBatis Artifacts\u0026lt;/id\u0026gt;\r\u0026lt;goals\u0026gt;\r\u0026lt;goal\u0026gt;generate\u0026lt;/goal\u0026gt;\r\u0026lt;/goals\u0026gt;\r\u0026lt;/execution\u0026gt;\r\u0026lt;/executions\u0026gt;\r\u0026lt;dependencies\u0026gt;\r\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;org.mybatis.generator\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;mybatis-generator-core\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1.3.2\u0026lt;/version\u0026gt;\r\u0026lt;/dependency\u0026gt;\r\u0026lt;/dependencies\u0026gt;\r\u0026lt;/plugin\u0026gt;\r\u0026lt;!-- mybatisè‡ªåŠ¨ç”Ÿæˆ end --\u0026gt;\r é…ç½®æ–‡ä»¶generatorConfig.xmlï¼š\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE generatorConfiguration\rPUBLIC \u0026quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\u0026quot;\r\u0026quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\u0026quot;\u0026gt;\r\u0026lt;generatorConfiguration\u0026gt;\r\u0026lt;classPathEntry location=\u0026quot;/Program Files/IBM/SQLLIB/java/db2java.zip\u0026quot; /\u0026gt;\r\u0026lt;context id=\u0026quot;DB2Tables\u0026quot; targetRuntime=\u0026quot;MyBatis3\u0026quot;\u0026gt;\r\u0026lt;!--optional,æ—¨åœ¨åˆ›å»ºclassæ—¶ï¼Œå¯¹æ³¨é‡Šè¿›è¡Œæ§åˆ¶--\u0026gt; \u0026lt;commentGenerator\u0026gt; \u0026lt;property name=\u0026quot;suppressDate\u0026quot; value=\u0026quot;true\u0026quot; /\u0026gt; \u0026lt;!-- æ˜¯å¦å»é™¤è‡ªåŠ¨ç”Ÿæˆçš„æ³¨é‡Š trueï¼šæ˜¯ ï¼š false:å¦ --\u0026gt; \u0026lt;property name=\u0026quot;suppressAllComments\u0026quot; value=\u0026quot;true\u0026quot; /\u0026gt; \u0026lt;/commentGenerator\u0026gt;\r\u0026lt;jdbcConnection driverClass=\u0026quot;COM.ibm.db2.jdbc.app.DB2Driver\u0026quot;\rconnectionURL=\u0026quot;jdbc:db2:TEST\u0026quot;\ruserId=\u0026quot;db2admin\u0026quot;\rpassword=\u0026quot;db2admin\u0026quot;\u0026gt;\r\u0026lt;/jdbcConnection\u0026gt;\r\u0026lt;javaTypeResolver \u0026gt;\r\u0026lt;property name=\u0026quot;forceBigDecimals\u0026quot; value=\u0026quot;false\u0026quot; /\u0026gt;\r\u0026lt;/javaTypeResolver\u0026gt;\r\u0026lt;javaModelGenerator targetPackage=\u0026quot;test.model\u0026quot; targetProject=\u0026quot;\\MBGTestProject\\src\u0026quot;\u0026gt;\r\u0026lt;property name=\u0026quot;enableSubPackages\u0026quot; value=\u0026quot;true\u0026quot; /\u0026gt;\r\u0026lt;property name=\u0026quot;trimStrings\u0026quot; value=\u0026quot;true\u0026quot; /\u0026gt;\r\u0026lt;/javaModelGenerator\u0026gt;\r\u0026lt;sqlMapGenerator targetPackage=\u0026quot;test.xml\u0026quot; targetProject=\u0026quot;\\MBGTestProject\\src\u0026quot;\u0026gt;\r\u0026lt;property name=\u0026quot;enableSubPackages\u0026quot; value=\u0026quot;true\u0026quot; /\u0026gt;\r\u0026lt;/sqlMapGenerator\u0026gt;\r\u0026lt;javaClientGenerator type=\u0026quot;XMLMAPPER\u0026quot; targetPackage=\u0026quot;test.dao\u0026quot; targetProject=\u0026quot;\\MBGTestProject\\src\u0026quot;\u0026gt;\r\u0026lt;property name=\u0026quot;enableSubPackages\u0026quot; value=\u0026quot;true\u0026quot; /\u0026gt;\r\u0026lt;/javaClientGenerator\u0026gt;\r\u0026lt;table schema=\u0026quot;DB2ADMIN\u0026quot; tableName=\u0026quot;ALLTYPES\u0026quot; domainObjectName=\u0026quot;Customer\u0026quot; \u0026gt;\r\u0026lt;property name=\u0026quot;useActualColumnNames\u0026quot; value=\u0026quot;true\u0026quot;/\u0026gt;\r\u0026lt;generatedKey column=\u0026quot;ID\u0026quot; sqlStatement=\u0026quot;DB2\u0026quot; identity=\u0026quot;true\u0026quot; /\u0026gt;\r\u0026lt;columnOverride column=\u0026quot;DATE_FIELD\u0026quot; property=\u0026quot;startDate\u0026quot; /\u0026gt;\r\u0026lt;ignoreColumn column=\u0026quot;FRED\u0026quot; /\u0026gt;\r\u0026lt;columnOverride column=\u0026quot;LONG_VARCHAR_FIELD\u0026quot; jdbcType=\u0026quot;VARCHAR\u0026quot; /\u0026gt;\r\u0026lt;/table\u0026gt;\r\u0026lt;/context\u0026gt;\r\u0026lt;/generatorConfiguration\u0026gt;\r é…ç½®æ–‡ä»¶çš„æ³¨æ„äº‹é¡¹ï¼š è¿™ä¸ªæ–‡ä»¶æŒ‡å®šå¾—äº‹DB2çš„é©±åŠ¨ï¼Œä¹Ÿå¯ä»¥é…ç½®å…¶ä»–é©±åŠ¨çš„è·¯å¾„ã€‚\n \u0026ldquo;Java Type Resolver\u0026quot;çš„å±æ€§force bigDecimalä¸ºfalse - è¿™æ„å‘³ç€æ•´å½¢ï¼ˆShort,Integer,Long,etc.)åœ¨å¯èƒ½çš„æƒ…å†µä¸‹å°†ä¼šè¢«æ›¿æ¢ã€‚è¿™ä¸ªå±æ€§æ˜¯ä¸ºäº†æ›´å¥½åœ°å¤„ç†æ•°æ®åº“çš„DECIMALå’ŒNUMERICç±»å‹çš„åˆ—ã€‚ \u0026ldquo;javaModelGenerator\u0026quot;çš„å±æ€§\u0026quot;enableSubPackages\u0026quot;ä¸ºtrueã€‚è¿™æ„å‘³ç€ç”Ÿæˆçš„POç±»å°†ä¼šè¢«æ”¾åˆ°\u0026quot;test.model.db2admin\u0026quot;è¿™ä¸ªç›®å½•ä¸‹ï¼ˆå› ä¸ºè¡¨æ˜¯åœ¨DB2ADMINè¿™ä¸ªschemaä¸‹ï¼‰ã€‚å¦‚æœ\u0026quot;enableSubPackage\u0026quot;å±æ€§ä¸ºfalseï¼Œè¿™ä¸ªåŒ…å°±ä¼šå˜ä¸º\u0026quot;test.model\u0026rdquo;ã€‚åŒæ ·åœ¨\u0026quot;javaModelGenerator\u0026quot;å±æ€§ä¸‹çš„\u0026quot;trimStrings\u0026quot;æ„å‘³ç€åœ¨è®¾ç½®poçš„ä»»ä½•å­—ç¬¦ä¸²å±æ€§æ—¶ä¼šè°ƒç”¨trimæ–¹æ³•ï¼Œè¿™åœ¨æ•°æ®åº“è¿”å›åˆ—ä¿¡æ¯ä¸­æœ‰ç©ºå­—ç¬¦ä¸²æ—¶ä¼šæœ‰ç”¨åˆ°ã€‚ \u0026ldquo;sqlMapGenerator\u0026quot;çš„å±æ€§\u0026quot;enableSubPackages\u0026rdquo;ï¼Œè·Ÿ\u0026quot;javaModelGenerator\u0026quot;çš„å±æ€§\u0026quot;enableSubPackages\u0026quot;åŸç†ç›¸åŒã€‚ \u0026ldquo;javaClientGeneratorçš„å±æ€§\u0026quot;enableSubPackages\u0026rdquo;ï¼Œè·Ÿ\u0026quot;javaModelGenerator\u0026quot;çš„å±æ€§\u0026quot;enableSubPackages\u0026quot;åŸç†ç›¸åŒã€‚DAOçš„ç”Ÿæˆå™¨ä¼šç”Ÿæˆmapperæ¥å£ï¼Œå®ƒä¸ºMyBatiså¼•ç”¨äº†ä¸€ä¸ªXMLçš„é…ç½®ã€‚ è¿™ä¸ªæ–‡ä»¶åªæŒ‡å®šäº†ä¸€ä¸ªè¡¨å°†è¢«å†…çœï¼Œä½†ä¹Ÿå¯ä»¥æŒ‡å®šå¤šä¸ªã€‚å…³äºæŒ‡å®šè¡¨çš„æ³¨æ„äº‹é¡¹å¦‚ä¸‹ï¼š  ç”Ÿæˆçš„POçš„åç§°å°†åŸºäºCustomer(CustomerKey,Customer,CustoerMapper,etc.)-è€Œä¸æ˜¯åŸºäºè¡¨åã€‚ \u0026ldquo;useActualColumnNames\u0026quot;å±æ€§ã€‚å¦‚æœè¿™ä¸ªå±æ€§è®¾ä¸ºfalseï¼ˆæˆ–è€…æœªè¢«æŒ‡å®šï¼‰ï¼ŒMBGå°†ä¼šå–åˆ—çš„é©¼å³°å‘½åã€‚æ— è®ºä½•æ€»æƒ…å†µPOçš„åˆ—æ˜éƒ½ä¼šè¢«å±æ€§è¦†ç›–ã€‚ åˆ—æœ‰ä¸€ä¸ª\u0026quot;generatedKey\u0026rdquo;ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ ‡è¯†åˆ—ï¼Œè€Œä¸”\u0026quot;sqlStatement\u0026quot;æ˜¯DB2ã€‚MBGä¼šåœ¨ç”Ÿæˆè¯­å¥æ—¶ç”Ÿæˆä¸€ä¸ªå…ƒç´ ï¼Œä»¥ä¾¿æ–°ç”Ÿæˆçš„keyèƒ½å¤Ÿè¢«è¿”å›ï¼ˆä½¿ç”¨DB2ç‰¹å®šçš„SQL)ã€‚ \u0026ldquo;columnOverrid\u0026quot;å±æ€§ä¸­çš„\u0026quot;date_field\u0026quot;å°†æ˜ å°„åˆ°å±æ€§\u0026quot;startDate\u0026rdquo;ã€‚è¿™å›è¦†ç›–é»˜è®¤çš„\u0026quot;useActualColumnNames\u0026quot;å±æ€§æ‰€è®¾å®šçš„è§„åˆ™ã€‚ \u0026ldquo;ignoredColumn\u0026quot;å±æ€§ä¸­çš„\u0026quot;FRED\u0026quot;å­—æ®µå°†è¢«å¿½ç•¥ï¼Œæ²¡æœ‰SQLä¼šåˆ—å‡ºè¿™ä¸ªå­—æ®µï¼Œä¹Ÿæ²¡æœ‰Javaå±æ€§å°†è¢«ç”Ÿæˆã€‚ \u0026ldquo;LONG_VARCHAR_FIELD\u0026quot;å°†è¢«å½“ä½œä¸€ä¸ª\u0026quot;VARCHAR\u0026quot;å¤„ç†ï¼Œå¿½ç•¥æ‰å®ƒå®é™…çš„æ•°æ®ç±»å‹ã€‚    ï¼ˆåŸæ–‡ï¼‰Important notes about this file follow:  The file specifies that the legacy DB2 CLI driver will be used to connect to the database, and also specifies where the driver can be found. The Java Type Resolver should not force the use of BigDecimal fields - this means that integral types (Short, Integer, Long, etc.) will be substituted if possible. This feature is an attempt to make database DECIMAL and NUMERIC columns easier to deal with. The Java model generator should use sub-packages. This means that the generated model objects will be placed in a package called test.model.db2admin in this case (because the table is in the DB2ADMIN schema). If the enableSubPackages attribute was set to false, then the package would be test.model. The Java model generator should also trim strings. This means that the setters for any String properties will call the trim function - this is useful if your database might return blank characters at the end of character columns. The SQL Map generator should use sub-packages. This means that the generated XML files will be placed in a package called test.xml.db2admin in this case (because the table is in the DB2ADMIN schema). If the enableSubPackages attribute was set to false, then the package would be test.xml. The DAO generator should use sub-packages. This means that the generated DAO classes will be placed in a package called test.dao.db2admin in this case (because the table is in the DB2ADMIN schema). If the enableSubPackages attribute was set to false, then the package would be test.dao. The DAO generator should generate mapper interfaces that reference an XML configuration for MyBatis. The file specifies only one table will be introspected, but many more could be specified. Important notes about the specified table include: The generated objects will be based on the name Customer (CustomerKey, Customer, CustomerMapper, etc.) - rather than on the table name. Actual column names will be used as properties. If this property were set to false (or not specified), then MBG would attempt to camel case the column names. In either case, the name can be overridden by the element The column has a generated key, it is an identity column, and the database type is DB2. This will cause MBG to generate the proper element in the generated statement so that the newly generated key can be returned (using DB2 specific SQL). The column DATE_FIELD will be mapped to a property called startDate. This will override the default property which would be DATE_FIELD in this case, or dateFieldif the useActualColumnNames property was set to false. The column FRED will be ignored. No SQL will list the field, and no Java property will be generated. The column LONG_VARCHAR_FIELD will be treated as a VARCHAR field, regardless of the actual data type.  ","id":44,"section":"posts","summary":"é…ç½®å¤æ‚ï¼Œæ¯”è¾ƒè‡ƒè‚¿ï¼Œæ¨èä½¿ç”¨ideaçš„æ’ä»¶easyCode pom.xmlé…ç½®ï¼š \u0026lt;!-- mybatisè‡ªåŠ¨ç”Ÿæˆ start --\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.generator\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-generator-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.3.2\u0026lt;/version\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;!--é…ç½®æ–‡ä»¶çš„","tags":["mybatis"],"title":"Mybatis Generatoré…ç½®","uri":"https://www.mingaccount.com/2019/07/mybatis-generator/","year":"2019"},{"content":"é—®é¢˜æ˜¯ç”±mysqlçš„ç¼–ç é—®é¢˜é€ æˆï¼Œå› ä¸ºå»ºè¡¨çš„æ—¶å€™æ²¡æœ‰æŒ‡å®šutf-8ä½œä¸ºå­—ç¬¦é›† å»ºè®®é‡æ–°å»ºè¡¨ï¼Œæˆ–è€…ç›´æ¥è°ƒæ•´å¯¹åº”å­—æ®µçš„å­—ç¬¦é›†\n1.ä¿®æ”¹mysqlç¼–ç çš„ ã€€æŸ¥çœ‹mysqlçš„å­—ç¬¦é›†ï¼š\nshow variables where Variable_name like '%char%';\r ã€€ä¿®æ”¹mysqlçš„å­—ç¬¦é›†ï¼šã€€mysql\u0026gt; set character_set_client=utf8;\rmysql\u0026gt; set character_set_connection=utf8;\rmysql\u0026gt; set character_set_database=utf8;\rmysql\u0026gt; set character_set_results=utf8;\rmysql\u0026gt; set character_set_server=utf8;\rmysql\u0026gt; set character_set_system=utf8;\rmysql\u0026gt; set collation_connection=utf8;\rmysql\u0026gt; set collation_database=utf8;\rmysql\u0026gt; set collation_server=utf8;\r 2.ä¿®æ”¹æ•°æ®åº“çš„ç¼–ç  ã€€æŸ¥çœ‹æ•°æ®åº“çš„å­—ç¬¦é›†ï¼š\nshow create database enterprises;\r ã€€ä¿®æ”¹æ•°æ®åº“çš„å­—ç¬¦é›†ï¼š\nalter database enterprises character set utf8\r 3.ä¿®æ”¹è¡¨çš„ç¼–ç  ã€€æŸ¥çœ‹è¡¨çš„å­—ç¬¦é›†ï¼š\n#ä½äºå»ºè¡¨è¯­å¥çš„æœ«å°¾\rshow create table employees;\r ã€€ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†ï¼š\nalter table employees character set utf8\r ã€€ä¿®æ”¹å­—æ®µçš„å­—ç¬¦é›†ï¼š\nalter table employees change name name char(10) character set utf-8;\r ","id":45,"section":"posts","summary":"é—®é¢˜æ˜¯ç”±mysqlçš„ç¼–ç é—®é¢˜é€ æˆï¼Œå› ä¸ºå»ºè¡¨çš„æ—¶å€™æ²¡æœ‰æŒ‡å®šutf-8ä½œä¸ºå­—ç¬¦é›† å»ºè®®é‡æ–°å»ºè¡¨ï¼Œæˆ–è€…ç›´æ¥è°ƒæ•´å¯¹åº”å­—æ®µçš„å­—ç¬¦é›† 1.ä¿®æ”¹mysqlç¼–ç ","tags":["mysql"],"title":"mySql æ’å…¥ä¸­æ–‡å¼‚å¸¸ Incorrect string value: '***' for column","uri":"https://www.mingaccount.com/2019/07/mysql-insert-chinese-exception/","year":"2019"},{"content":"ç®€ä»‹ Nexus repository Managerå¯ä»¥ä½œä¸ºMavençš„ç§æœï¼Œæ„å‘³ç€åœ¨Mavenä¸­å¤®ä»“åº“å’Œä½ æœ¬åœ°é¡¹ç›®ä¹‹é—´å¤šäº†ä¸€å±‚ä»£ç†ã€‚åœ¨æœ¬åœ°è®¿é—®å·²ç»åŠ è½½è¿‡çš„jaråŒ…æ—¶ï¼Œç§æœä¸éœ€è¦å†é‡æ–°ä»ä¸­å¤®ä»“åº“ä¸‹è½½ï¼Œç›´æ¥å†…ç½‘ä¼ è¾“ç»™æœ¬åœ°é¡¹ç›®ã€‚å¦‚æœç§æœä¸­æ²¡æœ‰ï¼Œå†ä»ä¸­å¤®ä»“åº“ä¸­ä¸‹è½½ã€‚æ­¤å¤–ï¼Œå› ä¸ºæ˜¯ç§æœï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨mvn deployå‘½ä»¤ï¼Œå°†æœ¬åœ°åŒ…æ¨åˆ°ç§æœä¸­ï¼Œä¾¿äºå¤ç”¨å’Œç‰ˆæœ¬ç®¡ç†ã€‚\n ä¸‹è½½å’Œæ–‡æ¡£å‚è€ƒnexus oss doc\n maven deploy maven deployå‘½ä»¤æ˜¯å°†æœ¬åœ°é¡¹ç›®ç”Ÿæˆçš„jaråŒ…æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡pom.xmlä¸­çš„\u0026lt;distributionManagement \u0026gt;å°†è¿œç¨‹ä»“åº“é…ç½®ä¸ºnexus\n å‚è€ƒmaven distributionManagement\n ","id":46,"section":"posts","summary":"ç®€ä»‹ Nexus repository Managerå¯ä»¥ä½œä¸ºMavençš„ç§æœï¼Œæ„å‘³ç€åœ¨Mavenä¸­å¤®ä»“åº“å’Œä½ æœ¬åœ°é¡¹ç›®ä¹‹é—´å¤šäº†ä¸€å±‚ä»£ç†ã€‚åœ¨æœ¬åœ°è®¿é—®å·²ç»åŠ è½½è¿‡çš„jaråŒ…æ—¶ï¼Œç§","tags":["nexus","maven"],"title":"nexusç®€ä»‹","uri":"https://www.mingaccount.com/2019/07/nexus/","year":"2019"},{"content":"val ç²¾ç®€å˜é‡ä¿®é¥°ï¼Œç±»ä¼¼Scalaï¼Œä½†æ˜¯é»˜è®¤è¿½åŠ äº†finalä¿®é¥°ç¬¦ val list = new ArrayList\u0026lt;String\u0026gt;();\r//ç­‰åŒäº\rfinal ArrayList\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;String\u0026gt;();\r var ç²¾ç®€å˜é‡ä¿®é¥°ï¼Œç±»ä¼¼Scalaï¼Œä¿®é¥°å˜é‡ val list = new ArrayList\u0026lt;String\u0026gt;();\r//ç­‰åŒäº\rArrayList\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;String\u0026gt;();\r NonNull ä¿®é¥°æ–¹æ³•æˆ–è€…æ„é€ æ–¹æ³•çš„å‚æ•°ï¼Œä»¥åŠæˆå‘˜å˜é‡ public NonNullExample(@NonNull Person person) {\rsuper(\u0026quot;Hello\u0026quot;);\rthis.name = person.getName();\r}\r//ç­‰åŒäº\rpublic NonNullExample(@NonNull Person person) {\rsuper(\u0026quot;Hello\u0026quot;);\rif (person == null) {\rthrow new NullPointerException(\u0026quot;person is marked @NonNull but is null\u0026quot;);\r}\rthis.name = person.getName();\r}\r Cleanup ä¿®é¥°å±€éƒ¨å˜é‡ï¼Œç”¨äºå…³é—­èµ„æº é»˜è®¤è§¦å‘ä¿®é¥°å˜é‡çš„closeæ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰closeæ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šå…³é—­æ–¹æ³•çš„åç§° ä½†æ˜¯è¦æ±‚å…³é—­æ–¹æ³•ä¸èƒ½æœ‰å‚æ•°\n@Cleanup(\u0026quot;dispose\u0026quot;) org.eclipse.swt.widgets.CoolBar bar = new CoolBar(parent, 0);\r import lombok.Cleanup;\rimport java.io.*;\rpublic class CleanupExample {\rpublic static void main(String[] args) throws IOException {\r@Cleanup InputStream in = new FileInputStream(args[0]);\r@Cleanup OutputStream out = new FileOutputStream(args[1]);\rbyte[] b = new byte[10000];\rwhile (true) {\rint r = in.read(b);\rif (r == -1) break;\rout.write(b, 0, r);\r}\r}\r}\r ç­‰åŒäº\n import java.io.*;\rpublic class CleanupExample {\rpublic static void main(String[] args) throws IOException {\rInputStream in = new FileInputStream(args[0]);\rtry {\rOutputStream out = new FileOutputStream(args[1]);\rtry {\rbyte[] b = new byte[10000];\rwhile (true) {\rint r = in.read(b);\rif (r == -1) break;\rout.write(b, 0, r);\r}\r} finally {\rif (out != null) {\rout.close();\r}\r}\r} finally {\rif (in != null) {\rin.close();\r}\r}\r}\r}\r Getter/Setter ä¿®é¥°æˆå‘˜å˜é‡æˆ–è€…ç±»ï¼Œå·²ç”ŸæˆGetSetæ–¹æ³•  å½“ä¿®é¥°ç±»æ—¶ï¼Œå°†ç”Ÿæˆç±»ä¸­æ‰€æœ‰çš„éé™æ€æˆå‘˜å˜é‡çš„Get/Setç±» Getter/Setteréƒ½æœ‰AccessLevelå‚æ•°ï¼Œå¯è®¾ç½®ç”Ÿæˆçš„æ–¹æ³•çš„ä¿®é¥°ç¬¦(PUBLIC, PROTECTED, PACKAGE, and PRIVATE) å¦‚æœç±»è¢«æ³¨è§£ä¿®é¥°ï¼Œä½†æ˜¯æŸä¸ªæˆå‘˜å˜é‡ä¸æƒ³ç”Ÿæˆæ–¹æ³•ï¼Œå¯ä»¥è®¾ç½®AccessLevelå‚æ•°å€¼ä¸ºNONE  import lombok.AccessLevel;\rimport lombok.Getter;\rimport lombok.Setter;\rpublic class GetterSetterExample {\r/**\r* Age of the person. Water is wet.\r* * @param age New value for this person's age. Sky is blue.\r* @return The current value of this person's age. Circles are round.\r*/\r@Getter @Setter private int age = 10;\r/**\r* Name of the person.\r* -- SETTER --\r* Changes the name of this person.\r* * @param name The new value.\r*/\r@Setter(AccessLevel.PROTECTED) private String name;\r@Override public String toString() {\rreturn String.format(\u0026quot;%s (age: %d)\u0026quot;, name, age);\r}\r}\r ç­‰åŒäº\n public class GetterSetterExample {\r/**\r* Age of the person. Water is wet.\r*/\rprivate int age = 10;\r/**\r* Name of the person.\r*/\rprivate String name;\r@Override public String toString() {\rreturn String.format(\u0026quot;%s (age: %d)\u0026quot;, name, age);\r}\r/**\r* Age of the person. Water is wet.\r*\r* @return The current value of this person's age. Circles are round.\r*/\rpublic int getAge() {\rreturn age;\r}\r/**\r* Age of the person. Water is wet.\r*\r* @param age New value for this person's age. Sky is blue.\r*/\rpublic void setAge(int age) {\rthis.age = age;\r}\r/**\r* Changes the name of this person.\r*\r* @param name The new value.\r*/\rprotected void setName(String name) {\rthis.name = name;\r}\r}\r ToString ä¿®é¥°ç±»å’Œæ–¹æ³•ï¼Œé‡å†™toStringæ–¹æ³•  é»˜è®¤æ ¼å¼ç±»å(å­—æ®µå€¼1ï¼Œå­—æ®µå€¼2) å¯é€šè¿‡è®¾ç½®includeFieldNames=trueï¼Œåœ¨å­—æ®µå€¼å‰é¢åŠ ä¸Šå­—æ®µå: é»˜è®¤æ‰€æœ‰éé™æ€å­—æ®µéƒ½ä¼šè¢«æ‰“å°ï¼Œå¯ä»¥é€šè¿‡æ³¨è§£@ToString.Excludeæ¥æ’é™¤å­—æ®µ å¦‚æœåªå±•ç¤ºç›®æ ‡å­—æ®µï¼Œå¯ä»¥åœ¨ç±»çš„æ³¨è§£ä¸Šè¿½åŠ å‚æ•°onlyExplicitlyIncluded=trueï¼Œç„¶ååœ¨å­—æ®µä¸ŠåŠ æ³¨è§£ToString.Include å¦‚æœéœ€è¦æ‰“å°çˆ¶ç±»çš„å­—æ®µï¼Œå¯ä»¥è®¾ç½®å‚æ•°callSuper=true æ‰“å°æ–¹æ³•çš„è¾“å‡ºï¼Œåœ¨æ–¹æ³•ä¸Šè¿½åŠ æ³¨è§£ToString.Includeï¼Œæ³¨æ„å¿…é¡»æ˜¯éé™æ€æ–¹æ³•ï¼Œå¹¶ä¸”æ²¡æœ‰å‚æ•°  import lombok.ToString;\r@ToString\rpublic class ToStringExample {\rprivate static final int STATIC_VAR = 10;\rprivate String name;\rprivate Shape shape = new Square(5, 10);\rprivate String[] tags;\r@ToString.Exclude private int id;\rpublic String getName() {\rreturn this.name;\r}\r@ToString(callSuper=true, includeFieldNames=true)\rpublic static class Square extends Shape {\rprivate final int width, height;\rpublic Square(int width, int height) {\rthis.width = width;\rthis.height = height;\r}\r}\r}\r ç­‰åŒäº\n import java.util.Arrays;\rpublic class ToStringExample {\rprivate static final int STATIC_VAR = 10;\rprivate String name;\rprivate Shape shape = new Square(5, 10);\rprivate String[] tags;\rprivate int id;\rpublic String getName() {\rreturn this.name;\r}\rpublic static class Square extends Shape {\rprivate final int width, height;\rpublic Square(int width, int height) {\rthis.width = width;\rthis.height = height;\r}\r@Override public String toString() {\rreturn \u0026quot;Square(super=\u0026quot; + super.toString() + \u0026quot;, width=\u0026quot; + this.width + \u0026quot;, height=\u0026quot; + this.height + \u0026quot;)\u0026quot;;\r}\r}\r@Override public String toString() {\rreturn \u0026quot;ToStringExample(\u0026quot; + this.getName() + \u0026quot;, \u0026quot; + this.shape + \u0026quot;, \u0026quot; + Arrays.deepToString(this.tags) + \u0026quot;)\u0026quot;;\r}\r}\r EqualsAndHashCode ç”Ÿæˆequalså’ŒhashCodeæ–¹æ³•  é»˜è®¤ä½¿ç”¨éé™æ€å’Œétransientä¿®é¥°çš„å­—æ®µ æ’é™¤æŒ‡å®šå­—æ®µï¼šæ³¨è§£@EqualsAndHashCode.Exclude åªé€‰æ‹©æŒ‡å®šå­—æ®µï¼šç±»æ³¨è§£@EqualsAndHashCode(onlyExplicitlyIncluded = true)ï¼Œå’Œå­—æ®µæ³¨è§£@EqualsAndHashCode.Include å¦‚æœåŒ…å«éObjectçˆ¶ç±»ï¼Œè®¾ç½®å±æ€§callSuper=true  import lombok.EqualsAndHashCode;\r@EqualsAndHashCode\rpublic class EqualsAndHashCodeExample {\rprivate transient int transientVar = 10;\rprivate String name;\rprivate double score;\r@EqualsAndHashCode.Exclude private Shape shape = new Square(5, 10);\rprivate String[] tags;\r@EqualsAndHashCode.Exclude private int id;\rpublic String getName() {\rreturn this.name;\r}\r@EqualsAndHashCode(callSuper=true)\rpublic static class Square extends Shape {\rprivate final int width, height;\rpublic Square(int width, int height) {\rthis.width = width;\rthis.height = height;\r}\r}\r}\r ç­‰åŒäº\n import java.util.Arrays;\rpublic class EqualsAndHashCodeExample {\rprivate transient int transientVar = 10;\rprivate String name;\rprivate double score;\rprivate Shape shape = new Square(5, 10);\rprivate String[] tags;\rprivate int id;\rpublic String getName() {\rreturn this.name;\r}\r@Override public boolean equals(Object o) {\rif (o == this) return true;\rif (!(o instanceof EqualsAndHashCodeExample)) return false;\rEqualsAndHashCodeExample other = (EqualsAndHashCodeExample) o;\rif (!other.canEqual((Object)this)) return false;\rif (this.getName() == null ? other.getName() != null : !this.getName().equals(other.getName())) return false;\rif (Double.compare(this.score, other.score) != 0) return false;\rif (!Arrays.deepEquals(this.tags, other.tags)) return false;\rreturn true;\r}\r@Override public int hashCode() {\rfinal int PRIME = 59;\rint result = 1;\rfinal long temp1 = Double.doubleToLongBits(this.score);\rresult = (result*PRIME) + (this.name == null ? 43 : this.name.hashCode());\rresult = (result*PRIME) + (int)(temp1 ^ (temp1 \u0026gt;\u0026gt;\u0026gt; 32));\rresult = (result*PRIME) + Arrays.deepHashCode(this.tags);\rreturn result;\r}\rprotected boolean canEqual(Object other) {\rreturn other instanceof EqualsAndHashCodeExample;\r}\rpublic static class Square extends Shape {\rprivate final int width, height;\rpublic Square(int width, int height) {\rthis.width = width;\rthis.height = height;\r}\r@Override public boolean equals(Object o) {\rif (o == this) return true;\rif (!(o instanceof Square)) return false;\rSquare other = (Square) o;\rif (!other.canEqual((Object)this)) return false;\rif (!super.equals(o)) return false;\rif (this.width != other.width) return false;\rif (this.height != other.height) return false;\rreturn true;\r}\r@Override public int hashCode() {\rfinal int PRIME = 59;\rint result = 1;\rresult = (result*PRIME) + super.hashCode();\rresult = (result*PRIME) + this.width;\rresult = (result*PRIME) + this.height;\rreturn result;\r}\rprotected boolean canEqual(Object other) {\rreturn other instanceof Square;\r}\r}\r}\r @NoArgsConstructor, @RequiredArgsConstructor, @AllArgsConstructor ç”Ÿæˆæ„é€ å‡½æ•°  NoArgsConstructor æ³¨æ„æœ‰å‚æ•°è¢«finalä¿®é¥°çš„æƒ…å†µï¼Œéœ€è¦åŠ ä¸Šå‚æ•°(force = true) RequiredArgsConstructor åªå¯¹ä¸¤ç±»å˜é‡æœ‰æ•ˆï¼Œä¸€ç§æ˜¯finalä¿®é¥°çš„å¹¶ä¸”æ²¡æœ‰åˆå§‹åŒ–çš„å˜é‡ï¼Œå¦å¤–ä¸€ç±»æ˜¯NonNullæ³¨è§£ä¿®é¥°å¹¶ä¸”æ²¡æœ‰åˆå§‹åŒ–çš„å˜é‡ AllArgsConstructor ç”Ÿæˆä¸€ä¸ªåŒ…æ‹¬æ‰€æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œå¹¶ä¸”æœ‰NonNullæ³¨è§£çš„ä¼šè¿›è¡Œéç©ºæ£€æŸ¥ @RequiredArgsConstructor(staticName=\u0026quot;of\u0026quot;) ç”Ÿæˆä¸€ä¸ªç§æœ‰çš„æ„é€ æ–¹æ³•ï¼Œå¹¶æä¾›ä¸€ä¸ªé™æ€æ–¹æ³•ofåŒ…è£…ç§æœ‰æ„é€ æ–¹æ³• ä»¥ä¸Šæ³¨è§£åªå¯¹éstaticå­—æ®µç”Ÿæ•ˆ  import lombok.AccessLevel;\rimport lombok.RequiredArgsConstructor;\rimport lombok.AllArgsConstructor;\rimport lombok.NonNull;\r@RequiredArgsConstructor(staticName = \u0026quot;of\u0026quot;)\r@AllArgsConstructor(access = AccessLevel.PROTECTED)\rpublic class ConstructorExample\u0026lt;T\u0026gt; {\rprivate int x, y;\r@NonNull private T description;\r@NoArgsConstructor\rpublic static class NoArgsExample {\r@NonNull private String field;\r}\r}\r ç­‰åŒäº\n public class ConstructorExample\u0026lt;T\u0026gt; {\rprivate int x, y;\r@NonNull private T description;\rprivate ConstructorExample(T description) {\rif (description == null) throw new NullPointerException(\u0026quot;description\u0026quot;);\rthis.description = description;\r}\rpublic static \u0026lt;T\u0026gt; ConstructorExample\u0026lt;T\u0026gt; of(T description) {\rreturn new ConstructorExample\u0026lt;T\u0026gt;(description);\r}\r@java.beans.ConstructorProperties({\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;, \u0026quot;description\u0026quot;})\rprotected ConstructorExample(int x, int y, T description) {\rif (description == null) throw new NullPointerException(\u0026quot;description\u0026quot;);\rthis.x = x;\rthis.y = y;\rthis.description = description;\r}\rpublic static class NoArgsExample {\r@NonNull private String field;\rpublic NoArgsExample() {\r}\r}\r}\r Data å¤§é›†åˆ  ç›¸å½“äºä¸€ä¸ªå¿«æ·æ–¹å¼ï¼ŒåŒ…æ‹¬ä¹‹å‰çš„toString,EqualsAndHashCode,æ‰€æœ‰å­—æ®µçš„Getter,éfinalå­—æ®µçš„Setterï¼Œå’ŒRequiredArgsConstructor Dataæ— æ³•åƒå•ä¸ªæ³¨è§£ä¸€æ ·æ·»åŠ è‡ªå®šä¹‰å±æ€§ï¼Œä½†æ˜¯å¯ä»¥å†æ¬¡è¿½åŠ å•ä¸ªæ³¨è§£ï¼Œä»¥è¦†ç›–Dataå¯¹åº”çš„æ–¹æ³• å¦‚æœæœ‰ä»»ä½•åŒåçš„æ–¹æ³•å­˜åœ¨ï¼ŒDataä¸ä¼šå†ç”Ÿæˆå¯¹åº”çš„æ–¹æ³• å¦‚æœæœ‰ä»»æ„ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼ŒDataæ³¨è§£å°†ä¸ä¼šç”ŸæˆRequiredArgsConstructorå¯¹åº”çš„æ„é€ æ–¹æ³•  import lombok.AccessLevel;\rimport lombok.Setter;\rimport lombok.Data;\rimport lombok.ToString;\r@Data public class DataExample {\rprivate final String name;\r@Setter(AccessLevel.PACKAGE) private int age;\rprivate double score;\rprivate String[] tags;\r@ToString(includeFieldNames=true)\r@Data(staticConstructor=\u0026quot;of\u0026quot;)\rpublic static class Exercise\u0026lt;T\u0026gt; {\rprivate final String name;\rprivate final T value;\r}\r}\r ç­‰åŒäº\n import java.util.Arrays;\rpublic class DataExample {\rprivate final String name;\rprivate int age;\rprivate double score;\rprivate String[] tags;\rpublic DataExample(String name) {\rthis.name = name;\r}\rpublic String getName() {\rreturn this.name;\r}\rvoid setAge(int age) {\rthis.age = age;\r}\rpublic int getAge() {\rreturn this.age;\r}\rpublic void setScore(double score) {\rthis.score = score;\r}\rpublic double getScore() {\rreturn this.score;\r}\rpublic String[] getTags() {\rreturn this.tags;\r}\rpublic void setTags(String[] tags) {\rthis.tags = tags;\r}\r@Override public String toString() {\rreturn \u0026quot;DataExample(\u0026quot; + this.getName() + \u0026quot;, \u0026quot; + this.getAge() + \u0026quot;, \u0026quot; + this.getScore() + \u0026quot;, \u0026quot; + Arrays.deepToString(this.getTags()) + \u0026quot;)\u0026quot;;\r}\rprotected boolean canEqual(Object other) {\rreturn other instanceof DataExample;\r}\r@Override public boolean equals(Object o) {\rif (o == this) return true;\rif (!(o instanceof DataExample)) return false;\rDataExample other = (DataExample) o;\rif (!other.canEqual((Object)this)) return false;\rif (this.getName() == null ? other.getName() != null : !this.getName().equals(other.getName())) return false;\rif (this.getAge() != other.getAge()) return false;\rif (Double.compare(this.getScore(), other.getScore()) != 0) return false;\rif (!Arrays.deepEquals(this.getTags(), other.getTags())) return false;\rreturn true;\r}\r@Override public int hashCode() {\rfinal int PRIME = 59;\rint result = 1;\rfinal long temp1 = Double.doubleToLongBits(this.getScore());\rresult = (result*PRIME) + (this.getName() == null ? 43 : this.getName().hashCode());\rresult = (result*PRIME) + this.getAge();\rresult = (result*PRIME) + (int)(temp1 ^ (temp1 \u0026gt;\u0026gt;\u0026gt; 32));\rresult = (result*PRIME) + Arrays.deepHashCode(this.getTags());\rreturn result;\r}\rpublic static class Exercise\u0026lt;T\u0026gt; {\rprivate final String name;\rprivate final T value;\rprivate Exercise(String name, T value) {\rthis.name = name;\rthis.value = value;\r}\rpublic static \u0026lt;T\u0026gt; Exercise\u0026lt;T\u0026gt; of(String name, T value) {\rreturn new Exercise\u0026lt;T\u0026gt;(name, value);\r}\rpublic String getName() {\rreturn this.name;\r}\rpublic T getValue() {\rreturn this.value;\r}\r@Override public String toString() {\rreturn \u0026quot;Exercise(name=\u0026quot; + this.getName() + \u0026quot;, value=\u0026quot; + this.getValue() + \u0026quot;)\u0026quot;;\r}\rprotected boolean canEqual(Object other) {\rreturn other instanceof Exercise;\r}\r@Override public boolean equals(Object o) {\rif (o == this) return true;\rif (!(o instanceof Exercise)) return false;\rExercise\u0026lt;?\u0026gt; other = (Exercise\u0026lt;?\u0026gt;) o;\rif (!other.canEqual((Object)this)) return false;\rif (this.getName() == null ? other.getValue() != null : !this.getName().equals(other.getName())) return false;\rif (this.getValue() == null ? other.getValue() != null : !this.getValue().equals(other.getValue())) return false;\rreturn true;\r}\r@Override public int hashCode() {\rfinal int PRIME = 59;\rint result = 1;\rresult = (result*PRIME) + (this.getName() == null ? 43 : this.getName().hashCode());\rresult = (result*PRIME) + (this.getValue() == null ? 43 : this.getValue().hashCode());\rreturn result;\r}\r}\r}\r Valueä¿®é¥°ç±»ï¼Œç”Ÿæˆä¸€ä¸ªfinalç±»ï¼Œå¹¶ä¸”æˆå‘˜å˜é‡å…¨æ˜¯private finalä¿®é¥°  Valueæ˜¯ä¸ªå¿«æ·æ–¹å¼ï¼Œå®Œæ•´çš„æ³¨è§£ï¼šfinal @ToString @EqualsAndHashCode @AllArgsConstructor @FieldDefaults(makeFinal = true, level = AccessLevel.PRIVATE) @Getter  åœ¨ä¿®é¥°ç±»å’Œæˆå‘˜å˜é‡çš„åŒæ—¶ï¼ŒValueä¼šç”ŸæˆtoStringã€equalsã€hashCodeæ–¹æ³•ï¼Œè¿˜æœ‰åŒ…æ‹¬æ‰€æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ä»¥åŠæ‰€æœ‰æˆå‘˜å˜é‡çš„getæ–¹æ³• å¦‚æœæœ‰ä»»ä½•è‡ªå®šä¹‰çš„æ„é€ æ–¹æ³•ï¼ŒValueå°†ä¸ä¼šå†ç”Ÿæˆä¸€ä¸ªæ‰€æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•  import lombok.AccessLevel;\rimport lombok.experimental.NonFinal;\rimport lombok.experimental.Value;\rimport lombok.experimental.Wither;\rimport lombok.ToString;\r@Value public class ValueExample {\rString name;\r@Wither(AccessLevel.PACKAGE) @NonFinal int age;\rdouble score;\rprotected String[] tags;\r@ToString(includeFieldNames=true)\r@Value(staticConstructor=\u0026quot;of\u0026quot;)\rpublic static class Exercise\u0026lt;T\u0026gt; {\rString name;\rT value;\r}\r}\r ç­‰åŒäº\n import java.util.Arrays;\rpublic final class ValueExample {\rprivate final String name;\rprivate int age;\rprivate final double score;\rprotected final String[] tags;\r@java.beans.ConstructorProperties({\u0026quot;name\u0026quot;, \u0026quot;age\u0026quot;, \u0026quot;score\u0026quot;, \u0026quot;tags\u0026quot;})\rpublic ValueExample(String name, int age, double score, String[] tags) {\rthis.name = name;\rthis.age = age;\rthis.score = score;\rthis.tags = tags;\r}\rpublic String getName() {\rreturn this.name;\r}\rpublic int getAge() {\rreturn this.age;\r}\rpublic double getScore() {\rreturn this.score;\r}\rpublic String[] getTags() {\rreturn this.tags;\r}\r@java.lang.Override\rpublic boolean equals(Object o) {\rif (o == this) return true;\rif (!(o instanceof ValueExample)) return false;\rfinal ValueExample other = (ValueExample)o;\rfinal Object this$name = this.getName();\rfinal Object other$name = other.getName();\rif (this$name == null ? other$name != null : !this$name.equals(other$name)) return false;\rif (this.getAge() != other.getAge()) return false;\rif (Double.compare(this.getScore(), other.getScore()) != 0) return false;\rif (!Arrays.deepEquals(this.getTags(), other.getTags())) return false;\rreturn true;\r}\r@java.lang.Override\rpublic int hashCode() {\rfinal int PRIME = 59;\rint result = 1;\rfinal Object $name = this.getName();\rresult = result * PRIME + ($name == null ? 43 : $name.hashCode());\rresult = result * PRIME + this.getAge();\rfinal long $score = Double.doubleToLongBits(this.getScore());\rresult = result * PRIME + (int)($score \u0026gt;\u0026gt;\u0026gt; 32 ^ $score);\rresult = result * PRIME + Arrays.deepHashCode(this.getTags());\rreturn result;\r}\r@java.lang.Override\rpublic String toString() {\rreturn \u0026quot;ValueExample(name=\u0026quot; + getName() + \u0026quot;, age=\u0026quot; + getAge() + \u0026quot;, score=\u0026quot; + getScore() + \u0026quot;, tags=\u0026quot; + Arrays.deepToString(getTags()) + \u0026quot;)\u0026quot;;\r}\rValueExample withAge(int age) {\rreturn this.age == age ? this : new ValueExample(name, age, score, tags);\r}\rpublic static final class Exercise\u0026lt;T\u0026gt; {\rprivate final String name;\rprivate final T value;\rprivate Exercise(String name, T value) {\rthis.name = name;\rthis.value = value;\r}\rpublic static \u0026lt;T\u0026gt; Exercise\u0026lt;T\u0026gt; of(String name, T value) {\rreturn new Exercise\u0026lt;T\u0026gt;(name, value);\r}\rpublic String getName() {\rreturn this.name;\r}\rpublic T getValue() {\rreturn this.value;\r}\r@java.lang.Override\rpublic boolean equals(Object o) {\rif (o == this) return true;\rif (!(o instanceof ValueExample.Exercise)) return false;\rfinal Exercise\u0026lt;?\u0026gt; other = (Exercise\u0026lt;?\u0026gt;)o;\rfinal Object this$name = this.getName();\rfinal Object other$name = other.getName();\rif (this$name == null ? other$name != null : !this$name.equals(other$name)) return false;\rfinal Object this$value = this.getValue();\rfinal Object other$value = other.getValue();\rif (this$value == null ? other$value != null : !this$value.equals(other$value)) return false;\rreturn true;\r}\r@java.lang.Override\rpublic int hashCode() {\rfinal int PRIME = 59;\rint result = 1;\rfinal Object $name = this.getName();\rresult = result * PRIME + ($name == null ? 43 : $name.hashCode());\rfinal Object $value = this.getValue();\rresult = result * PRIME + ($value == null ? 43 : $value.hashCode());\rreturn result;\r}\r@java.lang.Override\rpublic String toString() {\rreturn \u0026quot;ValueExample.Exercise(name=\u0026quot; + getName() + \u0026quot;, value=\u0026quot; + getValue() + \u0026quot;)\u0026quot;;\r}\r}\r}\r Builder æ„é€ è€…æ¨¡å¼ç”Ÿæˆå®ä½“ç±»ï¼Œå¯ä¿®é¥°ç±»ï¼Œæ„é€ æ–¹æ³•å’Œä¸€èˆ¬æ–¹æ³• ç±»ä¼¼\nPerson.builder().name(\u0026quot;Adam Savage\u0026quot;).city(\u0026quot;San Francisco\u0026quot;).job(\u0026quot;Mythbusters\u0026quot;).job(\u0026quot;Unchained Reaction\u0026quot;).build();\r  å½“ä¸€ä¸ªæ–¹æ³•è¢«Builderæ³¨è§£ä¿®é¥°ï¼ˆä»¥ä¸‹ç®€ç§°target)ï¼Œä¼šæœ‰ä¸ƒä¸ªè¦ç´ ç”Ÿæˆ  ä¸€ä¸ªå†…éƒ¨é™æ€ç±»å«åš FooBuilder ï¼Œæœ‰ç€å’Œé™æ€æ–¹æ³•ä¸€æ ·çš„ç±»å‹å‚æ•°(ä»¥ä¸‹ç®€ç§°builder) åœ¨builderé‡Œï¼Œtargetæ–¹æ³•çš„æ¯ä¸€ä¸ªå‚æ•°éƒ½å¯¹åº”äº†ä¸€ä¸ªç§æœ‰çš„éé™æ€éfinalçš„æˆå‘˜å˜é‡ åœ¨builderé‡Œï¼ŒåŒ…å«ä¸€ä¸ªpackageèŒƒå›´çš„ç§æœ‰æ— å‚çš„ç©ºæ„é€ æ–¹æ³• åœ¨builderé‡Œï¼Œæ¯ä¸€ä¸ªtargetçš„å‚æ•°éƒ½å¯¹åº”äº†ä¸€ä¸ªç±»ä¼¼setterçš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸ªsetteræ–¹æ³•è·Ÿtargetæ–¹æ³•çš„å‚æ•°åä¸€æ ·ï¼Œå¹¶ä¸”è¿”å›äº†builderè‡ªèº«ï¼Œä»¥å½¢æˆé“¾å¼ç»“æ„ åœ¨builderé‡Œï¼ŒåŒ…å«ä¸€ä¸ªbuildæ–¹æ³•ï¼Œç”¨å¯¹åº”çš„å‚æ•°è°ƒç”¨targetæ–¹æ³•ï¼Œæœ€ç»ˆç”Ÿæˆtargetæ–¹æ³•çš„è¿”å›å€¼ åœ¨builderé‡Œï¼ŒåŒ…å«ä¸€ä¸ªåˆç†çš„toStringå®ç° åœ¨targetæ–¹æ³•æ‰€åœ¨çš„ç±»ï¼Œä¼šåŒ…å«ä¸€ä¸ªbuilderæ–¹æ³•ï¼Œä»–ä¼šåˆ›å»ºç±»builderçš„å®ä¾‹   ä»¥ä¸Šçš„7ä¸ªè¦ç´ å¦‚æœåœ¨æ£€æµ‹åˆ°æœ‰åŒåçš„è¦ç´ æ—¶ä¼šè‡ªåŠ¨è·³è¿‡ï¼ˆåªå¯¹æ¯”åç§°ï¼‰ å½“Builderä½œç”¨äºç±»æ—¶ï¼Œè¯·ç¡®ä¿è¯¥ç±»æ²¡æœ‰ä»»ä½•æ˜¾æ€§çš„æ„é€ å‡½æ•°ã€‚å¦‚æœæœ‰ä»»æ„æ˜¾æ€§æ„é€ å‡½æ•°ï¼Œè¯·ç›´æ¥å°†Builderä½œç”¨äºæ„é€ å‡½æ•°ä¸Š å½“Builderå’ŒValueåŒæ—¶ä½œç”¨äºä¸€ä¸ªç±»æ—¶ï¼ŒBuilderæƒ³è¦ç”Ÿæˆçš„PackageèŒƒå›´çš„æ„é€ å‡½æ•°ä¼šè¦†ç›–Valueæƒ³è¦ç”Ÿæˆçš„privateèŒƒå›´çš„æ„é€ å‡½æ•° å¦‚æœå‚æ•°çš„å€¼éœ€è¦ä»æŸä¸ªå­—æ®µæˆ–è€…æ–¹æ³•è·å–ï¼Œå¯ä»¥åœ¨å­—æ®µæˆ–è€…å‚æ•°ä¸Šæ·»åŠ æ³¨è§£@Builder.ObtainVia(method = \u0026quot;\u0026quot;) Builderå¯é…ç½®çš„æ–¹é¢åŒ…æ‹¬  é™æ€å†…éƒ¨ç±»çš„åç§°(é»˜è®¤æ˜¯type + \u0026ldquo;Builder\u0026rdquo;) buildæ–¹æ³•çš„åç§° builderæ–¹æ³•çš„åç§° æ˜¯å¦éœ€è¦toBuilder()æ–¹æ³• ç”Ÿæˆå…ƒç´ çš„è®¿é—®èŒƒå›´ å¦‚æœä½ çš„æ„é€ é“¾æ–¹æ³•éœ€è¦ä¸€ä¸ªå‰ç¼€ï¼Œæ¯”å¦‚Person.builder().setName   å…³äºä»¥ä¸Šé…ç½®é¡¹ï¼Œä¸‹é¢æ˜¯ä¸ªå®ä¾‹\n@Builder(builderClassName = \u0026quot;HelloWorldBuilder\u0026quot;, buildMethodName = \u0026quot;execute\u0026quot;, builderMethodName = \u0026quot;helloWorld\u0026quot;, toBuilder = true, access = AccessLevel.PRIVATE, setterPrefix = \u0026quot;set\u0026quot;) å½“Builderæ³¨è§£ä½œç”¨äºç±»ï¼ŒæŸäº›æˆå‘˜å˜é‡ä¸éœ€è¦setçš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®æˆå‘˜å˜é‡é»˜è®¤å€¼\næˆå‘˜å˜é‡ä¸Šç”¨æ³¨è§£@Builder.Defaultå®ç°\n@Builder.Default private final long created = System.currentTimeMillis(); @Singular æ³¨è§£ä½œç”¨äºå‚æ•°æˆ–è€…æˆå‘˜å˜é‡æ—¶ï¼Œä¼šå§å¯¹åº”å‚æ•°å½“åšé›†åˆã€‚  ä¸ä¼šç”Ÿæˆsetterè€Œä¼šç”Ÿæˆä¸¤ä¸ªadderæ–¹æ³•ï¼Œä¸€ä¸ªæ–°å¢å•ä¸ªï¼Œä¸€ä¸ªæ–°å¢æ•´ä¸ªé›†åˆ è¿˜ä¼šç”Ÿæˆä¸€ä¸ªclearæ–¹æ³•ï¼Œä¸€æ—¦buildæ–¹æ³•è¢«è°ƒç”¨ï¼Œç”Ÿæˆçš„é›†åˆä¸èƒ½å†è¢«ä¿®æ”¹ å¯æŒ‡å®šæ–°å¢å•ä¸ªçš„æ–¹æ³•å@Singular(\u0026quot;axis\u0026quot;) List\u0026lt;Line\u0026gt; axes; å¦‚æœè¿½åŠ çš„é›†åˆä¸ºnullä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¯è®¾ç½®å¿½ç•¥ç©ºé›†åˆ@Singular(ignoreNullCollections = true)    import lombok.Builder;\rimport lombok.Singular;\rimport java.util.Set;\r@Builder\rpublic class BuilderExample {\r@Builder.Default private long created = System.currentTimeMillis();\rprivate String name;\rprivate int age;\r@Singular private Set\u0026lt;String\u0026gt; occupations;\r}\r ç­‰åŒäº\n import java.util.Set;\rpublic class BuilderExample {\rprivate long created;\rprivate String name;\rprivate int age;\rprivate Set\u0026lt;String\u0026gt; occupations;\rBuilderExample(String name, int age, Set\u0026lt;String\u0026gt; occupations) {\rthis.name = name;\rthis.age = age;\rthis.occupations = occupations;\r}\rprivate static long $default$created() {\rreturn System.currentTimeMillis();\r}\rpublic static BuilderExampleBuilder builder() {\rreturn new BuilderExampleBuilder();\r}\rpublic static class BuilderExampleBuilder {\rprivate long created;\rprivate boolean created$set;\rprivate String name;\rprivate int age;\rprivate java.util.ArrayList\u0026lt;String\u0026gt; occupations;\rBuilderExampleBuilder() {\r}\rpublic BuilderExampleBuilder created(long created) {\rthis.created = created;\rthis.created$set = true;\rreturn this;\r}\rpublic BuilderExampleBuilder name(String name) {\rthis.name = name;\rreturn this;\r}\rpublic BuilderExampleBuilder age(int age) {\rthis.age = age;\rreturn this;\r}\rpublic BuilderExampleBuilder occupation(String occupation) {\rif (this.occupations == null) {\rthis.occupations = new java.util.ArrayList\u0026lt;String\u0026gt;();\r}\rthis.occupations.add(occupation);\rreturn this;\r}\rpublic BuilderExampleBuilder occupations(Collection\u0026lt;? extends String\u0026gt; occupations) {\rif (this.occupations == null) {\rthis.occupations = new java.util.ArrayList\u0026lt;String\u0026gt;();\r}\rthis.occupations.addAll(occupations);\rreturn this;\r}\rpublic BuilderExampleBuilder clearOccupations() {\rif (this.occupations != null) {\rthis.occupations.clear();\r}\rreturn this;\r}\rpublic BuilderExample build() {\r// complicated switch statement to produce a compact properly sized immutable set omitted.\rSet\u0026lt;String\u0026gt; occupations = ...;\rreturn new BuilderExample(created$set ? created : BuilderExample.$default$created(), name, age, occupations);\r}\r@java.lang.Override\rpublic String toString() {\rreturn \u0026quot;BuilderExample.BuilderExampleBuilder(created = \u0026quot; + this.created + \u0026quot;, name = \u0026quot; + this.name + \u0026quot;, age = \u0026quot; + this.age + \u0026quot;, occupations = \u0026quot; + this.occupations + \u0026quot;)\u0026quot;;\r}\r}\r}\r SneakyThrows checked Exceptionä¸ç”¨å†try catch ä¸æ¨è\nSynchronized ç”¨æˆ·æˆå‘˜æ–¹æ³•æˆ–è€…é™æ€æ–¹æ³• å…³é”®å­—synchronizedé”çš„æ˜¯thisï¼Œä½†æ˜¯è¯¥æ³¨è§£é”çš„æ˜¯ä¸åŒçš„å¯¹è±¡\nimport lombok.Synchronized;\rpublic class SynchronizedExample {\rprivate final Object readLock = new Object();\r@Synchronized\rpublic static void hello() {\rSystem.out.println(\u0026quot;world\u0026quot;);\r}\r@Synchronized\rpublic int answerToLife() {\rreturn 42;\r}\r@Synchronized(\u0026quot;readLock\u0026quot;)\rpublic void foo() {\rSystem.out.println(\u0026quot;bar\u0026quot;);\r}\r}\r ç­‰åŒäº\n public class SynchronizedExample {\rprivate static final Object $LOCK = new Object[0];\rprivate final Object $lock = new Object[0];\rprivate final Object readLock = new Object();\rpublic static void hello() {\rsynchronized($LOCK) {\rSystem.out.println(\u0026quot;world\u0026quot;);\r}\r}\rpublic int answerToLife() {\rsynchronized($lock) {\rreturn 42;\r}\r}\rpublic void foo() {\rsynchronized(readLock) {\rSystem.out.println(\u0026quot;bar\u0026quot;);\r}\r}\r}\r Withç”¨äºæˆå‘˜å˜é‡æˆ–è€…ç±»ä¸Šï¼Œè¡¨ç¤ºå¯ä¿®æ”¹ç±»ä¸­çš„ä»»ä½•æˆ–è€…æŒ‡å®šå­—æ®µï¼Œå³ä½¿è¯¥å­—æ®µæ˜¯final å…¶å®å°±æ˜¯cloneäº†ä¸€ä¸ªå½“å‰ç±»ï¼Œå¹¶ä¿®æ”¹å¯¹åº”æˆå‘˜å˜é‡çš„å€¼\nimport lombok.AccessLevel;\rimport lombok.NonNull;\rimport lombok.With;\rpublic class WithExample {\r@With(AccessLevel.PROTECTED) @NonNull private final String name;\r@With private final int age;\rpublic WithExample(String name, int age) {\rif (name == null) throw new NullPointerException();\rthis.name = name;\rthis.age = age;\r}\r}\r import lombok.NonNull;\rpublic class WithExample {\rprivate @NonNull final String name;\rprivate final int age;\rpublic WithExample(String name, int age) {\rif (name == null) throw new NullPointerException();\rthis.name = name;\rthis.age = age;\r}\rprotected WithExample withName(@NonNull String name) {\rif (name == null) throw new java.lang.NullPointerException(\u0026quot;name\u0026quot;);\rreturn this.name == name ? this : new WithExample(name, age);\r}\rpublic WithExample withAge(int age) {\rreturn this.age == age ? this : new WithExample(name, age);\r}\r}\r Getter(lazy=true) ä¿®é¥°private final æˆå‘˜å˜é‡ï¼Œè·å–ä¸€æ¬¡ï¼Œå¹¶ç¼“å­˜ï¼Œä¹‹åéƒ½å–ç¼“å­˜ å½“ä¸€ä¸ªæˆå‘˜å˜é‡çš„è®¡ç®—éœ€è¦æ¶ˆè€—å¤§é‡èµ„æºï¼Œå¯ä»¥å°†å®ƒè®¾ç½®ä¸ºprivate finalï¼Œå¹¶åŠ ä¸Šè¯¥æ³¨è§£\nè¿™ä¸ªæ³¨è§£ä¼šåœ¨ç¬¬ä¸€æ¬¡è®¡ç®—åç¼“å­˜ç»“æœï¼Œä»–è¦æ±‚è®¡ç®—æ–¹æ³•æ˜¯éçº¿ç¨‹å®‰å…¨çš„\nimport lombok.Getter;\rpublic class GetterLazyExample {\r@Getter(lazy=true) private final double[] cached = expensive();\rprivate double[] expensive() {\rdouble[] result = new double[1000000];\rfor (int i = 0; i \u0026lt; result.length; i++) {\rresult[i] = Math.asin(i);\r}\rreturn result;\r}\r}\r ç­‰åŒäº\n public class GetterLazyExample {\rprivate final java.util.concurrent.AtomicReference\u0026lt;java.lang.Object\u0026gt; cached = new java.util.concurrent.AtomicReference\u0026lt;java.lang.Object\u0026gt;();\rpublic double[] getCached() {\rjava.lang.Object value = this.cached.get();\rif (value == null) {\rsynchronized(this.cached) {\rvalue = this.cached.get();\rif (value == null) {\rfinal double[] actualValue = expensive();\rvalue = actualValue == null ? this.cached : actualValue;\rthis.cached.set(value);\r}\r}\r}\rreturn (double[])(value == this.cached ? null : value);\r}\rprivate double[] expensive() {\rdouble[] result = new double[1000000];\rfor (int i = 0; i \u0026lt; result.length; i++) {\rresult[i] = Math.asin(i);\r}\rreturn result;\r}\r}\r Logä¿®é¥°ç±»ï¼Œå¢åŠ æˆå‘˜å˜é‡log å¤šä¸ªæ³¨è§£ï¼Œä»¥é€‚é…å¤šç§Logger:\n @CommonsLog\nprivate static final org.apache.commons.logging.Log log = org.apache.commons.logging.LogFactory.getLog(LogExample.class); @Flogger\nprivate static final com.google.common.flogger.FluentLogger log = com.google.common.flogger.FluentLogger.forEnclosingClass(); @JBossLog private static final org.jboss.logging.Logger log = org.jboss.logging.Logger.getLogger(LogExample.class); @Log\nprivate static final java.util.logging.Logger log = java.util.logging.Logger.getLogger(LogExample.class.getName()); @Log4j\nprivate static final org.apache.log4j.Logger log = org.apache.log4j.Logger.getLogger(LogExample.class); @Log4j2\nprivate static final org.apache.logging.log4j.Logger log = org.apache.logging.log4j.LogManager.getLogger(LogExample.class); @Slf4j\nprivate static final org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(LogExample.class); @XSlf4j\nprivate static final org.slf4j.ext.XLogger log = org.slf4j.ext.XLoggerFactory.getXLogger(LogExample.class); @CustomLog\nå¯è‡ªå®šä¹‰logï¼Œè¯¦æƒ…å‚è€ƒç»“å°¾çš„å®˜æ–¹é“¾æ¥  import lombok.extern.java.Log;\rimport lombok.extern.slf4j.Slf4j;\r@Log\rpublic class LogExample {\rpublic static void main(String... args) {\rlog.severe(\u0026quot;Something's wrong here\u0026quot;);\r}\r}\r@Slf4j\rpublic class LogExampleOther {\rpublic static void main(String... args) {\rlog.error(\u0026quot;Something else is wrong here\u0026quot;);\r}\r}\r@CommonsLog(topic=\u0026quot;CounterLog\u0026quot;)\rpublic class LogExampleCategory {\rpublic static void main(String... args) {\rlog.error(\u0026quot;Calling the 'CounterLog' with a message\u0026quot;);\r}\r}\r ç›¸å½“äº\n public class LogExample {\rprivate static final java.util.logging.Logger log = java.util.logging.Logger.getLogger(LogExample.class.getName());\rpublic static void main(String... args) {\rlog.severe(\u0026quot;Something's wrong here\u0026quot;);\r}\r}\rpublic class LogExampleOther {\rprivate static final org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(LogExampleOther.class);\rpublic static void main(String... args) {\rlog.error(\u0026quot;Something else is wrong here\u0026quot;);\r}\r}\rpublic class LogExampleCategory {\rprivate static final org.apache.commons.logging.Log log = org.apache.commons.logging.LogFactory.getLog(\u0026quot;CounterLog\u0026quot;);\rpublic static void main(String... args) {\rlog.error(\u0026quot;Calling the 'CounterLog' with a message\u0026quot;);\r}\r}\r  è¯¦ç»†å‚è€ƒ lombokå®˜æ–¹æ–‡æ¡£\n ","id":47,"section":"posts","summary":"val ç²¾ç®€å˜é‡ä¿®é¥°ï¼Œç±»ä¼¼Scalaï¼Œä½†æ˜¯é»˜è®¤è¿½åŠ äº†finalä¿®é¥°ç¬¦ val list = new ArrayList\u0026lt;String\u0026gt;(); //ç­‰åŒäº final ArrayList\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;String\u0026gt;(); var ç²¾ç®€å˜é‡ä¿®é¥°ï¼Œç±»ä¼¼Scalaï¼Œä¿®é¥°å˜é‡ val list =","tags":["lombok","java"],"title":"lombokè¯¦è§£","uri":"https://www.mingaccount.com/2019/07/lombok/","year":"2019"},{"content":"é—®é¢˜èƒŒæ™¯ é¡¹ç›®çš„ä¸¤ä¸ªä¾èµ–ï¼ŒåŒ…å«äº†åŒä¸€ä¸ªè·¯å¾„ï¼Œç„¶è€Œå› ä¸ºé¡¹ç›®åŸå› è¿˜ä¸èƒ½åˆ é™¤å…¶ä¸­ä»»ä½•ä¸€ä¸ª\nä»£ç åœ¨æœ¬åœ°å’Œçº¿ä¸Šéƒ½èƒ½æ­£å¸¸é€šè¿‡ç¼–è¯‘\nä½†æ˜¯ä¸€æ‰§è¡Œåˆ°å¯¹åº”ä»£ç å°±ä¼šæŠ›å‡ºå¦‚ä¸‹error:\n java.lang.NoClassDefFoundError:\r é—®é¢˜åŸå›  è·Ÿè¸ªä»£ç åå¾—çŸ¥ï¼ŒæŠ¥é”™ä»£ç å¼•ç”¨çš„æ˜¯pomä¸­çš„ç¬¬äºŒä¸ªä¾èµ–\rå¼•ç”¨ä½ç½®ä½äºç¬¬ä¸€ä¸ª\rç„¶è€Œmavençš„é€»è¾‘æ˜¯è°çš„\u0026lt;dependency\u0026gt;åœ¨å‰ï¼Œå°±ä¼˜å…ˆé€‰æ‹©å“ªä¸ªä¾èµ–\r è§£å†³æ–¹æ¡ˆ è°ƒæ•´\u0026lt;dependency\u0026gt;çš„é¡ºåºï¼Œå¾—ä»¥è§£å†³ ","id":48,"section":"posts","summary":"é—®é¢˜èƒŒæ™¯ é¡¹ç›®çš„ä¸¤ä¸ªä¾èµ–ï¼ŒåŒ…å«äº†åŒä¸€ä¸ªè·¯å¾„ï¼Œç„¶è€Œå› ä¸ºé¡¹ç›®åŸå› è¿˜ä¸èƒ½åˆ é™¤å…¶ä¸­ä»»ä½•ä¸€ä¸ª ä»£ç åœ¨æœ¬åœ°å’Œçº¿ä¸Šéƒ½èƒ½æ­£å¸¸é€šè¿‡ç¼–è¯‘ ä½†æ˜¯ä¸€æ‰§è¡Œåˆ°å¯¹åº”ä»£ç å°±ä¼šæŠ›å‡º","tags":["maven"],"title":"Maven jaråŒ…å†²çªå¯¼è‡´NoClassDefFoundError","uri":"https://www.mingaccount.com/2019/07/maven-jar-clash/","year":"2019"},{"content":"åœ¨åä½œå¼€å‘æ—¶ï¼Œä»æ¥å£è·å–åˆ°çš„jsonå®ä½“éƒ¨åˆ†ä¸ºç©ºï¼Œä½†æ˜¯åœ¨è°ƒè¯•æ—¶å‘ç°åŸå¯¹è±¡æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯ç»è¿‡è§£ææˆä¸ºjsonåï¼Œéƒ¨åˆ†å±æ€§å˜ä¸ºï¼š\n\u0026ldquo;$ref\u0026rdquo;:\u0026quot;$.*******â€œ\næ”¹å˜è§£ææ–¹å¼ä¸ºGsoné—®é¢˜è§£å†³ï¼Œç»æŸ¥æ˜¯fastjsonåœ¨è§£æjsonæ—¶ï¼Œä¼šå°†jsonä¸­ç›¸åŒçš„å†…å®¹æ”¹ä¸ºå¼•ç”¨å¯¼è‡´\nè¿™ä¹ˆåšçš„åŸå› æ˜¯é˜²æ­¢å®ä½“ç±»ä¸­æœ‰è‡ªå¼•ç”¨ï¼Œè§£æçš„æ—¶å€™å‡ºç°æ­»å¾ªç¯ï¼Œä»è€Œå¯¼è‡´æ ˆå†…å­˜æº¢å‡º\nå¯ä»¥é€šè¿‡è®¾ç½®å–æ¶ˆfastjsonçš„å¼•ç”¨ï¼Œä½†æ˜¯å¯èƒ½å‡ºç°å†…å­˜æº¢å‡ºé£é™©ï¼Œéœ€è¦è‡ªè¡Œè¯„ä¼°\nJSONArray.toJSONString(jsonArray, SerializerFeature.DisableCircularReferenceDetect);\rJSONObject.parse(JSONArray.toJSONString(jsonArray, SerializerFeature.DisableCircularReferenceDetect));\r ","id":49,"section":"posts","summary":"åœ¨åä½œå¼€å‘æ—¶ï¼Œä»æ¥å£è·å–åˆ°çš„jsonå®ä½“éƒ¨åˆ†ä¸ºç©ºï¼Œä½†æ˜¯åœ¨è°ƒè¯•æ—¶å‘ç°åŸå¯¹è±¡æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯ç»è¿‡è§£ææˆä¸ºjsonåï¼Œéƒ¨åˆ†å±æ€§å˜ä¸ºï¼š \u0026ldquo","tags":["java"],"title":"FastJsonè§£æç»“æœéƒ¨åˆ†å±æ€§ä¸ºnullçš„é—®é¢˜","uri":"https://www.mingaccount.com/2019/07/fastjson-undes-property-isnull/","year":"2019"},{"content":"spark sqlä¹Ÿæ”¯æŒå‡½æ•°ï¼Œä½†ä¸é€šå¸¸çš„æ•°æ®åº“å‡½æ•°æœ‰äº›åŒºåˆ«ï¼Œé™„ä¸Šå®˜æ–¹apiæ–‡æ¡£ï¼Œä»¥ä½œå¤‡å¿˜ï¼š\nhttp://spark.apache.org/docs/latest/api/sql/index.html#acos\n","id":50,"section":"posts","summary":"spark sqlä¹Ÿæ”¯æŒå‡½æ•°ï¼Œä½†ä¸é€šå¸¸çš„æ•°æ®åº“å‡½æ•°æœ‰äº›åŒºåˆ«ï¼Œé™„ä¸Šå®˜æ–¹apiæ–‡æ¡£ï¼Œä»¥ä½œå¤‡å¿˜ï¼š http://spark.apache.org/docs/latest/api/sql/index.html#acos","tags":["spark"],"title":"SparkSqlå‡½æ•°æ–‡æ¡£","uri":"https://www.mingaccount.com/2019/07/spark-sql-api/","year":"2019"},{"content":"æ–¹æ³•ä¸€ï¼šç›´æ¥é€šè¿‡å‘½ä»¤å¯¼å…¥æœ¬åœ°åŒ… mvn install:install-file -Dfile=your-artifact-1.0.jar \\\r[-DpomFile=your-pom.xml] \\\r[-Dsources=src.jar] \\\r[-Djavadoc=apidocs.jar] \\\r[-DgroupId=org.some.group] \\\r[-DartifactId=your-artifact] \\\r[-Dversion=1.0] \\\r[-Dpackaging=jar] \\\r[-Dclassifier=sources] \\\r[-DgeneratePom=true] \\\r[-DcreateChecksum=true]\r æ–¹æ³•äºŒï¼šé€šè¿‡pluginå¯¼å…¥æœ¬åœ°åŒ… pomè®¾ç½® \u0026lt;plugins\u0026gt;\r\u0026lt;plugin\u0026gt;\r\u0026lt;groupId\u0026gt;org.apache.maven.plugins\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;maven-install-plugin\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;2.5.1\u0026lt;/version\u0026gt;\r\u0026lt;executions\u0026gt;\r\u0026lt;execution\u0026gt;\r\u0026lt;id\u0026gt;install-jar-lib\u0026lt;/id\u0026gt;\r\u0026lt;goals\u0026gt;\r\u0026lt;goal\u0026gt;install-file\u0026lt;/goal\u0026gt;\r\u0026lt;/goals\u0026gt;\r\u0026lt;!--åœ¨mvn packageçš„æ—¶å€™å°†jaråŒ…è¿½åŠ åˆ°æœ¬åœ°ä»“åº“ï¼Œå¯ä¿®æ”¹ä¸ºvalidateï¼Œä»¥çº¿ä¸Šå®¹å™¨ç¼–è¯‘æ‰§è¡Œçš„mvnå‘½ä»¤ä¸ºå‡†--\u0026gt;\r\u0026lt;phase\u0026gt; process-resources\u0026lt;/phase\u0026gt;\r\u0026lt;configuration\u0026gt;\r\u0026lt;groupId\u0026gt;custom\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;custom\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1.0\u0026lt;/version\u0026gt;\r\u0026lt;packaging\u0026gt;jar\u0026lt;/packaging\u0026gt;\r\u0026lt;file\u0026gt;${project.basedir}/src/main/resources/lib/custom.jar\u0026lt;/file\u0026gt;\r\u0026lt;generatePom\u0026gt;true\u0026lt;/generatePom\u0026gt;\r\u0026lt;/configuration\u0026gt;\r\u0026lt;/execution\u0026gt;\r\u0026lt;/executions\u0026gt;\r\u0026lt;/plugin\u0026gt;\r\u0026lt;/plugins\u0026gt;\r ç„¶ååŠ ä¸Šä¾èµ–\n\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;custom\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;custom\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1.0\u0026lt;/version\u0026gt;\r\u0026lt;systemPath\u0026gt;${project.basedir}/src/main/resources/lib/custom.jar\u0026lt;/systemPath\u0026gt;\r\u0026lt;scope\u0026gt;system\u0026lt;/scope\u0026gt;\r\u0026lt;/dependency\u0026gt;\r å¯èƒ½é‡åˆ°çš„é—®é¢˜  æœ¬åœ°ç¼–è¯‘ä¸é€šè¿‡   æœ¬åœ°ç¯å¢ƒæ‰§è¡Œä¸€ä¸‹mvn process-resources(å¯¹åº”pomå¡«å†™çš„\u0026lt;phase\u0026gt;)\r çº¿ä¸Šç¼–è¯‘ä¸é€šè¿‡   æ£€æŸ¥\u0026lt;phase\u0026gt;ä¸­çš„mvnè¯­å¥\r æœ¬åœ°å’Œçº¿ä¸Šç¯å¢ƒç¼–è¯‘éƒ½é€šè¿‡ï¼Œä½†æ˜¯æ‰§è¡Œåˆ°å¯¹åº”ä»£ç å°±æŠ¥é”™ï¼Œæç¤ºæ‰¾ä¸åˆ°ç±»   ç¡®ä¿\u0026lt;dependency\u0026gt;æ­£ç¡®å¡«å†™ï¼Œå¦‚æœæœ‰å¤šä¸ªmoduleä½¿ç”¨ï¼Œ\u0026lt;plugin\u0026gt;å¯ä»¥åªå†™ä¸€æ¬¡ï¼Œä½†æ˜¯æ¯ä¸ªmoduleéƒ½è¦å¡«å†™å¯¹åº”\u0026lt;dependency\u0026gt;\rå¦‚æœå¯¼å…¥çš„æœ¬åœ°åŒ…ä¸ç°æœ‰åŒ…å†²çªä¹Ÿä¼šå‡ºç°è¿™ç§é—®é¢˜ï¼Œå¦‚æœä»¥æœ¬åœ°åŒ…ä¸ºå‡†ï¼Œéœ€è¦ä¿è¯æœ¬åœ°åŒ…çš„\u0026lt;dependency\u0026gt;åœ¨æ–‡æœ¬é¡ºåºä¸Šè¦å…ˆäºå·²æœ‰çš„åŒ…\r ","id":51,"section":"posts","summary":"æ–¹æ³•ä¸€ï¼šç›´æ¥é€šè¿‡å‘½ä»¤å¯¼å…¥æœ¬åœ°åŒ… mvn install:install-file -Dfile=your-artifact-1.0.jar \\ [-DpomFile=your-pom.xml] \\ [-Dsources=src.jar] \\ [-Djavadoc=apidocs.jar] \\ [-DgroupId=org.some.group] \\ [-DartifactId=your-artifact] \\ [-Dversion=1.0] \\ [-Dpackaging=jar] \\ [-Dclassifier=sources] \\ [-DgeneratePom=true] \\ [-DcreateChecksum=true] æ–¹æ³•äºŒï¼šé€šè¿‡pluginå¯¼å…¥æœ¬åœ°åŒ… pomè®¾ç½® \u0026lt;plugins\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.apache.maven.plugins\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;maven-install-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.5.1\u0026lt;/version\u0026gt; \u0026lt;executions\u0026gt; \u0026lt;execution\u0026gt; \u0026lt;id\u0026gt;install-jar-lib\u0026lt;/id\u0026gt; \u0026lt;goals\u0026gt; \u0026lt;goal\u0026gt;install-file\u0026lt;/goal\u0026gt;","tags":["maven"],"title":"Mavenå¦‚ä½•æ­£ç¡®å¯¼å…¥æœ¬åœ°åŒ…ï¼Œä¿è¯åœ¨çº¿ä¸Šæ­£å¸¸è¿è¡Œ","uri":"https://www.mingaccount.com/2019/06/maven-how-to-import-local-jar/","year":"2019"},{"content":"è„šæœ¬ï¼š\nwget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh \u0026amp;\u0026amp; chmod +x bbr.sh \u0026amp;\u0026amp; ./bbr.sh\r æŸ¥çœ‹ç»“æœï¼š\nsysctl net.ipv4.tcp_available_congestion_control\r ","id":52,"section":"posts","summary":"è„šæœ¬ï¼š wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh \u0026amp;\u0026amp; chmod +x bbr.sh \u0026amp;\u0026amp; ./bbr.sh æŸ¥çœ‹ç»“æœï¼š sysctl net.ipv4.tcp_available_congestion_control","tags":["linux"],"title":"ä¸ºæœåŠ¡å¼€å¯BBRåŠ é€Ÿ","uri":"https://www.mingaccount.com/2019/05/server-bbr/","year":"2019"},{"content":"","id":53,"section":"posts","summary":"","tags":["scala"],"title":"ScalaåŸºç¡€ç±»ç»“æ„å›¾","uri":"https://www.mingaccount.com/2019/05/scala-base-class-stucture/","year":"2019"},{"content":"è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ç”±å…¶ç¬¬ä¸€ä¸ªå­—ç¬¦å†³å®š\nä»¥ä¸‹åˆ—å‡ºçš„å­—ç¬¦æŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½çš„é¡ºåºæ’åˆ—\n (all letters) | ^ \u0026amp; \u0026lt; \u0026gt; = !   + -\n* / %\n(all other special characters)\n","id":54,"section":"posts","summary":"è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ç”±å…¶ç¬¬ä¸€ä¸ªå­—ç¬¦å†³å®š ä»¥ä¸‹åˆ—å‡ºçš„å­—ç¬¦æŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½çš„é¡ºåºæ’åˆ— (all letters) | ^ \u0026amp; \u0026lt; \u0026gt; = ! + - * / % (all other special characters)","tags":["scala"],"title":"Scalaè¿ç®—ç¬¦ä¼˜å…ˆé¡ºåº","uri":"https://www.mingaccount.com/2019/05/scala-operation-order/","year":"2019"},{"content":"ç®€ä»‹ Bucket4j æ˜¯ä¸€ä¸ªåŸºäºä»¤ç‰Œæ¡¶ç®—æ³•çš„é™æµå·¥å…·\n å®˜ç½‘git hub\n å®ä¾‹ ä¸‹é¢å®ä¾‹çš„åœºæ™¯æ˜¯ï¼Œé™åˆ¶è¢«ç¬¬ä¸‰æ–¹è°ƒç”¨çš„é¢‘ç‡ï¼Œæ¯ä¸ªappåœ¨ä¸€ä¸ªç§’é’Ÿä¹‹å†…åªèƒ½æœ‰10æ¬¡è¯·æ±‚ï¼Œä½†æ˜¯å…è®¸æš‚æ—¶çš„è¿‡è½½ï¼Œç¬æ—¶æœ€å¤§çš„è®¿é—®é‡æ˜¯50ã€‚\nimport io.github.bucket4j.Bucket4j;\rpublic class ThrottlingFilter implements javax.servlet.Filter {\rprivate Bucket createNewBucket() {\rlong overdraft = 50; Refill refill = Refill.greedy(10, Duration.ofSeconds(1));\rBandwidth limit = Bandwidth.classic(overdraft, refill);\rreturn Bucket4j.builder().addLimit(limit).build();\r}\r@Override\rpublic void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\rHttpServletRequest httpRequest = (HttpServletRequest) servletRequest;\rHttpSession session = httpRequest.getSession(true);\rString appKey = SecurityUtils.getThirdPartyAppKey();\rBucket bucket = (Bucket) session.getAttribute(\u0026quot;throttler-\u0026quot; + appKey);\rif (bucket == null) {\rbucket = createNewBucket();\rsession.setAttribute(\u0026quot;throttler-\u0026quot; + appKey, bucket);\r}\r// tryConsume returns false immediately if no tokens available with the bucket\rHttpServletResponse httpResponse = (HttpServletResponse) servletResponse;\rConsumptionProbe probe = bucket.tryConsumeAndReturnRemaining(1);\rif (probe.isConsumed()) {\r// the limit is not exceeded\rhttpResponse.setHeader(\u0026quot;X-Rate-Limit-Remaining\u0026quot;, \u0026quot;\u0026quot; + probe.getRemainingTokens());\rfilterChain.doFilter(servletRequest, servletResponse);\r} else {\r// limit is exceeded\rHttpServletResponse httpResponse = (HttpServletResponse) servletResponse;\rhttpResponse.setStatus(429);\rhttpResponse.setHeader(\u0026quot;X-Rate-Limit-Retry-After-Seconds\u0026quot;, \u0026quot;\u0026quot; + TimeUnit.NANOSECONDS.toSeconds(probe.getNanosToWaitForRefill()));\rhttpResponse.setContentType(\u0026quot;text/plain\u0026quot;);\rhttpResponse.getWriter().append(\u0026quot;Too many requests\u0026quot;);\r}\r}\r}\r  æ›´å¤šå®ä¾‹å‚è€ƒBucket4j examples\n ","id":55,"section":"posts","summary":"ç®€ä»‹ Bucket4j æ˜¯ä¸€ä¸ªåŸºäºä»¤ç‰Œæ¡¶ç®—æ³•çš„é™æµå·¥å…· å®˜ç½‘git hub å®ä¾‹ ä¸‹é¢å®ä¾‹çš„åœºæ™¯æ˜¯ï¼Œé™åˆ¶è¢«ç¬¬ä¸‰æ–¹è°ƒç”¨çš„é¢‘ç‡ï¼Œæ¯ä¸ªappåœ¨ä¸€ä¸ªç§’é’Ÿä¹‹å†…åªèƒ½æœ‰10æ¬¡è¯·æ±‚ï¼Œä½†æ˜¯","tags":["website build","java"],"title":"Bucket4j å®ä¾‹","uri":"https://www.mingaccount.com/2019/04/bucket4j-example/","year":"2019"},{"content":"åˆ¤æ–­ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„åˆæ³•æ€§ä»…ä»…é€šè¿‡åç¼€åæ˜¯å®Œå…¨ä¸å¤Ÿçš„ï¼Œè°ä¹Ÿä¸çŸ¥é“åç¼€åæ˜¯å¦è¢«æ›´æ”¹ï¼ŒæœåŠ¡å™¨ä¿å­˜ä¸€ä¸ªä¸çŸ¥é“çœŸå®ç±»å‹çš„æ–‡ä»¶æœ‰æå¤§çš„é£é™©ã€‚\nå› æ­¤éœ€è¦åå°è¿›è¡Œè¿›ä¸€æ­¥çš„æ–‡ä»¶ç±»å‹æ ¡éªŒï¼Œè¿™é‡Œæœ‰ä¸¤ç§æƒ…å†µï¼š\nã€€1ï¼‰ä¸€èˆ¬çš„æ–‡ä»¶ç±»å‹ä¾‹å¦‚ï¼šjpgã€pngã€xlsxç­‰ç­‰æ˜¯æœ‰å›ºå®šæ–‡ä»¶å¤´çš„ï¼Œæå–å‡ºç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶å¤´ä¸å›ºå®šæ–‡ä»¶å¤´è¿›è¡Œå¯¹æ¯”ï¼Œå°±å¯ä»¥å¾—åˆ°æ–‡ä»¶çš„å‡†ç¡®ç±»å‹ã€‚\nã€€2ï¼‰æ–‡æœ¬æ–‡ä»¶ï¼štxtã€csvç­‰ç­‰ã€‚æ–‡æœ¬æ–‡ä»¶å…·æœ‰ç‰¹æ®Šæ€§ï¼Œæ–‡æœ¬å¤´æ— æ˜æ˜¾æ ‡å¿—ã€‚ä½†æ˜¯æ–‡æœ¬æ–‡ä»¶ç™¾åˆ†ç™¾å…·æœ‰ä¸šåŠ¡ç‰¹æ®Šæ€§ã€‚å¯ä»¥åœ¨å¯¹æ–‡æœ¬è¿›è¡Œæ ¼å¼éªŒè¯æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºç›®æ ‡ç±»å‹ï¼›æˆ–è€…é€šè¿‡ç¼–ç æ ¡éªŒï¼Œçœ‹æ–‡æœ¬æ˜¯å¦æ­£ç¡®ç¼–ç ï¼Œæ˜¯å¦æœ‰ä¹±ç å­˜åœ¨ï¼ˆæ­£ç¡®ç¼–è¾‘çš„æ–‡ä»¶ï¼Œä¸å¯èƒ½å­˜åœ¨ä¹±ç ï¼‰ï¼Œæœ‰ç¬¬ä¸‰æ–¹æ’ä»¶cpdetectorå¯ä»¥æ£€æµ‹å½“å‰æ–‡ä»¶çš„ç¼–ç ï¼›æœ€åè¿˜å¯ä»¥é€šè¿‡æä¾›æ–‡ä»¶æ¨¡æ¿ï¼Œå›ºå®šæ–‡æœ¬æ–‡ä»¶çš„å¤´å°¾ç­‰æ–¹å¼æ¥è¿›è¡Œæ ¡éªŒã€‚\nè¿™é‡Œä¸»è¦è¯´æ˜ç¬¬ä¸€ç§æƒ…å†µï¼Œç¬¬äºŒç§æ–‡æœ¬æƒ…å†µæ ¹æ®ä¸šåŠ¡å…·ä½“ç¯å¢ƒä¸åŒï¼Œæœ‰ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚\næ–‡ä»¶ç±»å‹æšä¸¾:\npackage com.uti.utilEnum;\rpublic enum FileTypeEnum {\rJPG(\u0026quot;ffd8ffe000104a464946\u0026quot;),\rPNG(\u0026quot;89504e470d0a1a0a0000\u0026quot;),\rGIF(\u0026quot;47494638396126026f01\u0026quot;),\rTIF(\u0026quot;49492a00227105008037\u0026quot;),\rBMP_1(\u0026quot;424d228c010000000000\u0026quot;),//16è‰²ä½å›¾(bmp)\rBMP_2(\u0026quot;424d8240090000000000\u0026quot;),//24ä½ä½å›¾(bmp)\rBMP_3(\u0026quot;424d8e1b030000000000\u0026quot;),//256è‰²ä½å›¾(bmp)\rDWG(\u0026quot;41433130313500000000\u0026quot;),\rHTML(\u0026quot;3c21444f435459504520\u0026quot;),\rHTM(\u0026quot;3c21646f637479706520\u0026quot;),\rCSS(\u0026quot;48544d4c207b0d0a0942\u0026quot;),\rJS(\u0026quot;696b2e71623d696b2e71\u0026quot;),\rRTF(\u0026quot;7b5c727466315c616e73\u0026quot;),\rPSD(\u0026quot;38425053000100000000\u0026quot;),\rEML(\u0026quot;46726f6d3a203d3f6762\u0026quot;),\rDOC(\u0026quot;d0cf11e0a1b11ae10000\u0026quot;),\rVSD(\u0026quot;d0cf11e0a1b11ae10000\u0026quot;),\rMDB(\u0026quot;5374616E64617264204A\u0026quot;),\rPS(\u0026quot;252150532D41646F6265\u0026quot;),\rPDF(\u0026quot;255044462d312e350d0a\u0026quot;),\rRMVB(\u0026quot;2e524d46000000120001\u0026quot;),\rRM(\u0026quot;2e524d46000000120001\u0026quot;),\rFLV(\u0026quot;464c5601050000000900\u0026quot;),\rF4V(\u0026quot;464c5601050000000900\u0026quot;),\rMP4(\u0026quot;00000020667479706d70\u0026quot;),\rMP3(\u0026quot;49443303000000002176\u0026quot;),\rMPG(\u0026quot;000001ba210001000180\u0026quot;),\rWMV(\u0026quot;3026b2758e66cf11a6d9\u0026quot;),\rASF(\u0026quot;3026b2758e66cf11a6d9\u0026quot;),\rWAV(\u0026quot;52494646e27807005741\u0026quot;),\rAVI(\u0026quot;52494646d07d60074156\u0026quot;),\rMID(\u0026quot;4d546864000000060001\u0026quot;),\rZIP(\u0026quot;504b0304140000000800\u0026quot;),\rRAR(\u0026quot;526172211a0700cf9073\u0026quot;),\rINI(\u0026quot;235468697320636f6e66\u0026quot;),\rJAR(\u0026quot;504b03040a0000000000\u0026quot;),\rEXE(\u0026quot;4d5a9000030000000400\u0026quot;),\rJSP(\u0026quot;3c25402070616765206c\u0026quot;),\rMF(\u0026quot;4d616e69666573742d56\u0026quot;),\rXML(\u0026quot;3c3f786d6c2076657273\u0026quot;),\rSQL(\u0026quot;494e5345525420494e54\u0026quot;),\rJAVA(\u0026quot;7061636b616765207765\u0026quot;),\rBAT(\u0026quot;406563686f206f66660d\u0026quot;),\rGZ(\u0026quot;1f8b0800000000000000\u0026quot;),\rPROPERTIES(\u0026quot;6c6f67346a2e726f6f74\u0026quot;),\rCLASS(\u0026quot;cafebabe0000002e0041\u0026quot;),\rCHM(\u0026quot;49545346030000006000\u0026quot;),\rMXP(\u0026quot;04000000010000001300\u0026quot;),\rDOCX(\u0026quot;504b0304140006000800\u0026quot;),\rWPS(\u0026quot;d0cf11e0a1b11ae10000\u0026quot;),\rTORRENT(\u0026quot;6431303a637265617465\u0026quot;),\rMOV(\u0026quot;6D6F6F76\u0026quot;),\rWPD(\u0026quot;FF575043\u0026quot;),\rDBX(\u0026quot;CFAD12FEC5FD746F\u0026quot;),\rPST(\u0026quot;2142444E\u0026quot;),\rQDF(\u0026quot;AC9EBD8F\u0026quot;),\rPWL(\u0026quot;E3828596\u0026quot;),\rRAM(\u0026quot;2E7261FD\u0026quot;);\rprivate String value = \u0026quot;\u0026quot;;\rprivate FileTypeEnum(String value) {\rthis.value = value;\r}\rpublic String getValue() {\rreturn value;\r}\rpublic void setValue(String value) {\rthis.value = value;\r}\r}\r å…·ä½“ä»£ç :\nprivate boolean notTextFileTypeCheck(InputStream inputStream, String specifiedType) throws IOException {\rboolean fileTypeIsVaild = false;\rbyte[] buffer = new byte[10];\rinputStream.read(buffer);\r//è·å–å½“å‰æ–‡ä»¶çš„çœŸå®ç±»å‹\rString curfileType = getTrueFileType(bytesToHexFileTypeString(buffer));\r//æŒ‡å®šæ–‡ä»¶ç±»å‹ä¸­æ˜¯å¦åŒ¹é…å½“å‰æ–‡ä»¶ç±»å‹\rif(specifiedType.toUpperCase().equals(curfileType)){\rfileTypeIsVaild = true;\r}\rreturn fileTypeIsVaild;\r}\rprivate String getTrueFileType(String s) {\rfor (FileTypeEnum fileTypeEnum : FileTypeEnum.values()) {\rif (s.startsWith(fileTypeEnum.getValue())) {\rreturn fileTypeEnum.toString();\r}\r}\rreturn null;\r}\rprivate String bytesToHexFileTypeString(byte[] buffer) {\rStringBuilder hexFileTypeStr = new StringBuilder();\rfor (byte b : buffer) {\rString hexString = Integer.toHexString(b \u0026amp; 0xFF);\rif (hexString.length() \u0026lt; 2) {\rhexFileTypeStr.append(\u0026quot;0\u0026quot;);\r}\rhexFileTypeStr.append(hexString);\r}\rreturn hexFileTypeStr.toString();\r}\r å…³äºä¸ºä»€ä¹ˆè¦\u0026amp;0xFFï¼Œæ¨èä¸€ç¯‡æ–‡ç« https://www.cnblogs.com/think-in-java/p/5527389.htmlï¼ŒåŠ ä¸Šè¯„è®ºæ›´å¥½ç†è§£ï¼Œè¿˜èƒ½å›é¡¾ä¸‹â€œåŸç åç è¡¥ç â€çš„çŸ¥è¯†\n","id":56,"section":"posts","summary":"åˆ¤æ–­ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„åˆæ³•æ€§ä»…ä»…é€šè¿‡åç¼€åæ˜¯å®Œå…¨ä¸å¤Ÿçš„ï¼Œè°ä¹Ÿä¸çŸ¥é“åç¼€åæ˜¯å¦è¢«æ›´æ”¹ï¼ŒæœåŠ¡å™¨ä¿å­˜ä¸€ä¸ªä¸çŸ¥é“çœŸå®ç±»å‹çš„æ–‡ä»¶æœ‰æå¤§çš„é£é™©ã€‚ å› æ­¤éœ€è¦åå°","tags":["java"],"title":"Javaä¸Šä¼ æ–‡ä»¶æ ¼å¼åˆ¤æ–­","uri":"https://www.mingaccount.com/2019/03/java-upload-file-verify-format/","year":"2019"},{"content":"åŸå›  ç¼–ç é—®é¢˜ï¼Œå¯èƒ½æ˜¯application.propertieså’Œç±»ä¼¼çš„å±æ€§æ–‡ä»¶ä¸­æœ‰éUTF-8å­—ç¬¦ï¼ˆå‚è€ƒspring-boot-issue ï¼‰\næˆ–è€…æŸä¸ªä¾èµ–åŒ…æœ‰é—®é¢˜ï¼Œæ²¡æœ‰æŒ‰ç…§utf-8æ¥æ„å»º\næ–¹æ¡ˆ ","id":57,"section":"posts","summary":"åŸå›  ç¼–ç é—®é¢˜ï¼Œå¯èƒ½æ˜¯application.propertieså’Œç±»ä¼¼çš„å±æ€§æ–‡ä»¶ä¸­æœ‰éUTF-8å­—ç¬¦ï¼ˆå‚è€ƒspring-boot-issue","tags":["maven"],"title":"Maven compileå¼‚å¸¸ Failed to execute goal maven-resources-plugin:3.2.0:resources  Input length = 1 ","uri":"https://www.mingaccount.com/2019/03/markdown-compile-error/","year":"2019"},{"content":"æœ€å¤§å…¬çº¦æ•°ï¼š @tailrec\rdef gcd(a: Int, b: Int): Int =\rif (b == 0) a else gcd(b, a % b)\r é˜¶ä¹˜: def factorial(n: Int): Int = {\r@tailrec\rdef iter(x: Int, result: Int): Int =\rif (x == 0) result else iter(x - 1, result * x)\riter(n, 1)\r}\r @tailrecæ³¨è§£å¯ä»¥æ£€æµ‹å½“å‰é€’å½’æ–¹æ³•æ˜¯å¦æ»¡è¶³å°¾é€’å½’ï¼Œä¸æ»¡è¶³ä¼šæŠ¥ç¼–è¯‘é”™è¯¯\n","id":58,"section":"posts","summary":"æœ€å¤§å…¬çº¦æ•°ï¼š @tailrec def gcd(a: Int, b: Int): Int = if (b == 0) a else gcd(b, a % b) é˜¶ä¹˜: def factorial(n: Int): Int = { @tailrec def iter(x: Int, result: Int): Int = if (x == 0) result else iter(x - 1, result * x) iter(n, 1) } @tailrecæ³¨è§£å¯ä»¥æ£€æµ‹","tags":["scala"],"title":"Scalaå®ç°çš„å°¾é€’å½’","uri":"https://www.mingaccount.com/2019/02/scala-tail-recursive/","year":"2019"},{"content":"markdownè¯­æ³•å¤§å¤šæ•°ç¬¦å·éœ€è¦åŠ ä¸€ä¸ªç©ºæ ¼å’Œæ­£å¼å†…å®¹åŒºåˆ†å¼€æ‰ä¼šç”Ÿæ•ˆ   æ¨ªçº¿  -\u0026ndash; *** ___   æ ‡é¢˜  # ä¸€çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ ### ä¸‰çº§æ ‡é¢˜ #### å››çº§æ ‡é¢˜ ##### äº”çº§æ ‡é¢˜ ###### å…­çº§æ ‡é¢˜   æ–‡æœ¬  æ–‡æœ¬å—ï¼Œåœ¨æ–‡æœ¬è¡Œå¼€å¤´åŠ ä¸€ä¸ªtabç¼©è¿› æ–‡å­—é«˜äº®ï¼Œç”¨ç¬¦å·`åŒ…è£¹æ–‡æœ¬ æ–‡æœ¬æ¢è¡Œï¼Œè¡Œæœ«å°¾åŠ ä¸¤ä¸ªç©ºæ ¼ æ–‡å­—æ–œä½“*æ–œä½“* _æ–œä½“_ æ–‡å­—ç²—ä½“**ç²—ä½“** __ç²—ä½“__ åˆ é™¤çº¿ ~~åˆ é™¤çº¿~~ æ–œç²—ä½“ ***æ–œç²—ä½“*** ___æ–œç²—ä½“___ æ–œç²—ä½“åˆ é™¤çº¿ ***~~æ–œç²—ä½“åˆ é™¤çº¿***~~ å›¾ç‰‡ï¼Œ![alt](URL \u0026quot;title\u0026quot;) å¤–éƒ¨é“¾æ¥ [é“¾æ¥åç§°](www.baidu.com)ä¹Ÿå¯ä»¥é“¾æ¥æœ¬åœ°æ–‡ä»¶ é”šç‚¹ [å›åˆ°é¡¶éƒ¨](#top) topä»£è¡¨ä»»æ„æ ‡é¢˜ï¼Œæ³¨æ„éƒ½æ˜¯å°å†™ ç©ºæ ¼ \u0026amp;nbsp;   åˆ—è¡¨  æ— åºåˆ—è¡¨ ä¸€æ®µæ–‡æœ¬å‰åŠ ç¬¦å·*æˆ–è€…- å¤šçº§æ— åºåˆ—è¡¨ï¼Œä¸‹ä¸€çº§åªéœ€è¦åœ¨æ— åºåˆ—è¡¨å‰åŠ ä¸€ä¸ªç¼©è¿› æœ‰åºåˆ—è¡¨ ä¸€æ®µæ–‡æœ¬å‰åŠ æ•°å­—å’Œ. ç±»ä¼¼1. å¤šçº§æœ‰åºåˆ—è¡¨ï¼Œä¸‹ä¸€çº§åªéœ€è¦åœ¨æœ‰åºåˆ—è¡¨å‰åŠ ä¸€ä¸ªç¼©è¿› å¤é€‰æ¡†åˆ—è¡¨ [ ]æœªå‹¾é€‰ [x]å·²å‹¾é€‰ ä½äºåˆ—å¤´éœ€è¦åŠ -å’Œç©ºæ ¼- [ ]   å—å¼•ç”¨  \u0026gt; å¼•ç”¨å— å—æœ‰å¤šçº§å¼•ç”¨\u0026gt;\u0026gt; ç¬¬äºŒçº§å¼•ç”¨ \u0026gt;\u0026gt;\u0026gt; ç¬¬ä¸‰å­£å¼•ç”¨\u0026hellip;\u0026hellip;   è¡¨æ ¼  æ ¼å¼:\r|è¡¨å¤´1|è¡¨å¤´2|\r|---|---|\r|è¡¨æ ¼å•å…ƒ|è¡¨æ ¼å•å…ƒ|\r|è¡¨æ ¼å•å…ƒ|è¡¨æ ¼å•å…ƒ|\rå¯¹é½ï¼š\rè°ƒæ•´ç¬¬äºŒè¡Œçš„æ–œçº¿\r:---æ˜¯å·¦å¯¹é½\r---:æ˜¯å³å¯¹é½\r:---:æ˜¯å±…ä¸­\r|å·¦å¯¹é½|å±…ä¸­|å³å¯¹é½|\r|:---|:---:|---:|\r|è¡¨æ ¼å•å…ƒ|è¡¨æ ¼å•å…ƒ|è¡¨æ ¼å•å…ƒ|\rè¡¨æ ¼å†…å®¹ï¼š\rè¡¨æ ¼ä¸­ä¹Ÿå¯ä»¥ç”¨æ–‡æœ¬åŠ ç²—ï¼Œæ–‡æœ¬é«˜äº®ç­‰æ–‡æœ¬æ•ˆæœã€‚åŒæ—¶ä¹Ÿå¯ä»¥æ’å…¥å›¾ç‰‡å’Œé“¾æ¥\r ","id":59,"section":"posts","summary":"markdownè¯­æ³•å¤§å¤šæ•°ç¬¦å·éœ€è¦åŠ ä¸€ä¸ªç©ºæ ¼å’Œæ­£å¼å†…å®¹åŒºåˆ†å¼€æ‰ä¼šç”Ÿæ•ˆ æ¨ªçº¿ -\u0026ndash; *** ___ æ ‡é¢˜ # ä¸€çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ ### ä¸‰çº§æ ‡é¢˜ #### å››çº§æ ‡é¢˜ ##### äº”çº§æ ‡é¢˜ ###### å…­çº§æ ‡","tags":["markdown"],"title":"Markdownå¸¸ç”¨è¯­æ³•å¤‡å¿˜","uri":"https://www.mingaccount.com/2019/01/markdown-common-symbol/","year":"2019"},{"content":"èƒŒæ™¯ controllerçš„å…¨å±€å¼‚å¸¸å¤„ç†å¯ä»¥é€šè¿‡@RestControllerAdvice @ExceptionHandleræ¥å¤„ç†ã€‚ä½†æ˜¯å¦‚æœfilterä¸­å‡ºäº†å¼‚å¸¸ï¼Œcontrollerçš„å…¨å±€å¼‚å¸¸æ˜¯æ— æ³•æ•è·çš„ã€‚\nè§£å†³æ–¹æ¡ˆ æ‰¾åˆ°filter chainä¸­æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªfilterï¼Œåœ¨ä»–çš„chain.doFilter()æ–¹æ³•ä¸ŠåŠ try-catchè¿›è¡Œfilterå…¨å±€å¼‚å¸¸å¤„ç†ã€‚è¿™ä¸ªfilterå°±æ˜¯OncePerRequestFilterã€‚\nä½†è¿™åªåœ¨æ²¡æœ‰æŒ‡å®šfilteré¡ºåºçš„æ—¶å€™ç”Ÿæ•ˆï¼Œå¦‚æœä½ ç»™ä»»ä½•Filteræ‰‹åŠ¨æŒ‡å®šäº†é¡ºåºï¼ˆæ¯”å¦‚é€šè¿‡Order(1)ï¼‰ï¼Œé‚£ä¹ˆOncePerRequestFilterå°±æ— æ³•ä¿è¯ç¬¬ä¸€ä¸ªæ‰§è¡Œã€‚\npublic class ExceptionHandlerFilter extends OncePerRequestFilter {\rprivate final ObjectMapper objectMapper;\rpublic ExceptionHandlerFilter(ObjectMapper objectMapper) {\rthis.objectMapper = objectMapper;\r}\r@Override\rprotected void doFilterInternal(@NotNull HttpServletRequest httpServletRequest, @NotNull HttpServletResponse httpServletResponse, FilterChain filterChain) throws ServletException, IOException {\rtry {\rfilterChain.doFilter(httpServletRequest, httpServletResponse);\r} catch (BaseException e) {\rwriteException(e, httpServletResponse, objectMapper.writeValueAsString(e.getResultEntity()));\r} catch (Exception e) {\rwriteException(e, httpServletResponse, objectMapper.writeValueAsString(ResponseInfoEnum.UNKNOWN_EXCEPTION.buildResultEntity()));\r}\r}\rprivate void writeException(Exception e, HttpServletResponse httpServletResponse, String writeValueAsString) throws IOException {\rlog.error(e.getMessage(), e);\rhttpServletResponse.setStatus(HttpStatus.HTTP_OK);\rhttpServletResponse.setContentType(ContentType.JSON.toString());\rhttpServletResponse.setCharacterEncoding(\u0026quot;utf-8\u0026quot;);\rhttpServletResponse.getWriter().append(writeValueAsString);\r}\r}\r æ³¨æ„BaseExceptionæ˜¯ä¸šåŠ¡å¼‚å¸¸çš„é¡¶çº§çˆ¶ç±»ï¼Œå› æ­¤åœ¨è‡ªå®šä¹‰çš„filterä¸­ï¼Œå¯ä»¥æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸ï¼Œå‘è°ƒç”¨æ–¹å±•ç¤ºä¸šåŠ¡å¼‚å¸¸ä¿¡æ¯ã€‚\nå¦å¤–æœªå‘ç°çš„å¼‚å¸¸ä¹Ÿä¼šè¢«æ•è·ï¼Œä½œä¸ºUNKNOWN_EXCEPTIONæŠ›å‡ºã€‚\nå¦‚æœæœ‰å…¶ä»–Filteræ‰‹åŠ¨æŒ‡å®šäº†é¡ºåºï¼Œé‚£ä¹ˆä¸Šé¢çš„æ–¹æ³•å°±ä¸èµ·ä½œç”¨äº†ã€‚è¿™æ—¶éœ€è¦é€šè¿‡@Order(Ordered.HIGHEST_PRECEDENCE)ä¿®é¥°ï¼ˆæ¨èæ­¤æ–¹æ³•ï¼‰ï¼ŒOncePerRequestFilterä¸å†æ˜¯å¿…è¦æ¡ä»¶ï¼š\n@Order(Ordered.HIGHEST_PRECEDENCE)\r@Slf4j\r@Component\rpublic class ExceptionHandlerFilter implements Filter {\rprivate final ObjectMapper objectMapper;\rpublic ExceptionHandlerFilter(ObjectMapper objectMapper) {\rthis.objectMapper = objectMapper;\r}\r@Override\rpublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\rHttpServletResponse httpServletResponse = (HttpServletResponse) response;\rtry {\rchain.doFilter(request, response);\r} catch (BaseException e) {\rwriteException(e,httpServletResponse,objectMapper.writeValueAsString(e.getResultEntity()));\r} catch (Exception e) {\rwriteException(e,httpServletResponse,objectMapper.writeValueAsString(ResponseInfoEnum.UNKNOWN_EXCEPTION.buildResultEntity()));\r}\r}\rprivate void writeException(Exception e, HttpServletResponse httpServletResponse, String writeValueAsString) throws IOException {\rlog.error(e.getMessage(), e);\rhttpServletResponse.setStatus(HttpStatus.HTTP_OK);\rhttpServletResponse.setContentType(ContentType.JSON.toString());\rhttpServletResponse.setCharacterEncoding(\u0026quot;utf-8\u0026quot;);\rhttpServletResponse.getWriter().append(writeValueAsString);\r}\r}\r ","id":60,"section":"posts","summary":"èƒŒæ™¯ controllerçš„å…¨å±€å¼‚å¸¸å¤„ç†å¯ä»¥é€šè¿‡@RestControllerAdvice @ExceptionHandleræ¥å¤„ç†ã€‚ä½†æ˜¯å¦‚æœf","tags":["spring"],"title":"Springboot filterå¼‚å¸¸å…¨å±€å¤„ç†","uri":"https://www.mingaccount.com/2019/01/spring-boot-filter-exception-global-handler/","year":"2019"},{"content":"# åˆ—å‡ºæ‰€æœ‰container\rdocker container ls -a\r# é€šè¿‡æŒ‡å®šåç§°æŸ¥è¯¢container\rdocker container ls -f name=mysql\r# åˆ é™¤æ‰€æœ‰åœæ­¢çš„container\rdocker container prune\r# åˆ—å‡ºæ‰€æœ‰docker network\rdocker network ls\r# åˆ—å‡ºæ‰€æœ‰docker é•œåƒ\rdocker images\r# å¯åŠ¨å®¹å™¨\rdocker container start [container-name]\r# ç»ˆæ­¢å®¹å™¨\rdocker container stop [container-name]\r# é‡å¯å®¹å™¨\rdocker container restart [container-name]\r# åˆ é™¤æŒ‡å®šå®¹å™¨\rdocker container rm [container-name]\r# æŸ¥çœ‹æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨\rdocker ps\r# è¿›å…¥å®¹å™¨\rdocker exec -it mysql bash\r# åˆ é™¤é•œåƒï¼Œæ³¨æ„ä¹‹å‰å¿…é¡»åœæ­¢å®¹å™¨å¹¶åˆ é™¤\rdocker rmi [é•œåƒid]\r# å®‰è£…å¹¶è¿è¡Œé•œåƒï¼Œ-p ä»£è¡¨ç«¯å£æ˜ å°„ï¼Œ-eä»£è¡¨ç¯å¢ƒå‚æ•°ï¼Œ-d ä»£è¡¨åå°è¿è¡Œ\rdocker run --name [å®¹å™¨åç§°] -p 3306:3306 -e MYSQL_ROOT_PASSWORD=jxcjvf09sfd_9dsf9 -d mysql:latest\r# æ ¹æ®å½“å‰ç›®å½•ä¸‹çš„Dockerfileæ„å»ºé•œåƒ\rdocker build -t [imageName] .\r# æ‹‰é•œåƒï¼Œé•œåƒåç§°å¯æŒ‡å®šregistryæœåŠ¡å™¨ï¼ˆä¾‹å¦‚ 'docker pull localhost:5000/mysql'ï¼‰\rdocker pull [é•œåƒåç§°]\r# tagé•œåƒå‡†å¤‡push\rdocker tag [é•œåƒåç§°] [tagåç§°]\r# pushä¹‹å‰éœ€è¦tag\rdocker push [tagåç§°]\r# å®æ—¶æŸ¥çœ‹å®¹å™¨æ—¥å¿—\rdocker logs -f [å®¹å™¨åç§°]\r# æŸ¥çœ‹registryä¸­çš„é•œåƒ\rcurl \u0026lt;ä»“åº“åœ°å€\u0026gt;/v2/_catalog\r# æŸ¥è¯¢é•œåƒtag(ç‰ˆæœ¬ï¼‰\rcurl \u0026lt;ä»“åº“åœ°å€\u0026gt;/h2/\u0026lt;é•œåƒå\u0026gt;/tags/list\r ","id":61,"section":"posts","summary":"# åˆ—å‡ºæ‰€æœ‰container docker container ls -a # é€šè¿‡æŒ‡å®šåç§°æŸ¥è¯¢container docker container ls -f name=mysql # åˆ é™¤æ‰€æœ‰åœæ­¢çš„container docker container prune # åˆ—å‡ºæ‰€æœ‰dock","tags":["docker"],"title":"Dockerå¸¸ç”¨å‘½ä»¤","uri":"https://www.mingaccount.com/2019/01/docker-common-command/","year":"2019"},{"content":"h2æœ‰å¤šç§æ•°æ®åº“å…¼å®¹æ¨¡å¼ï¼Œä¾‹å¦‚Mysqlï¼šjdbc:h2:mem:testdb;MODE=MYSQLã€‚\nä½†æ˜¯å…¼å®¹æ¨¡å¼å¹¶ä¸å¯é ï¼Œè¿˜æ˜¯æœ‰éƒ¨åˆ†ç‰¹æœ‰è¯­å¥ä¼šç›´æ¥æŠ¥é”™ï¼Œæ¯”å¦‚mysqlçš„collateã€‚å› æ­¤æœ€å¥½è¿˜æ˜¯ç›´æ¥ä½¿ç”¨h2åŸæ¨¡å¼ï¼Œä½¿ç”¨æ ‡å‡†sqlè¯­æ³•ã€‚\n å‚è€ƒh2 command\n ","id":62,"section":"posts","summary":"h2æœ‰å¤šç§æ•°æ®åº“å…¼å®¹æ¨¡å¼ï¼Œä¾‹å¦‚Mysqlï¼šjdbc:h2:mem:testdb;MODE=MYSQLã€‚ ä½†æ˜¯å…¼å®¹æ¨¡å¼å¹¶ä¸å¯é ï¼Œè¿˜æ˜¯æœ‰éƒ¨åˆ†ç‰¹æœ‰è¯­","tags":["h2"],"title":"h2å…¼å®¹æ¨¡å¼","uri":"https://www.mingaccount.com/2018/12/h2-compatible/","year":"2018"},{"content":" å‚è€ƒh2 feature\n ","id":63,"section":"posts","summary":"å‚è€ƒh2 feature","tags":["h2"],"title":"h2 urlå‚æ•°","uri":"https://www.mingaccount.com/2018/12/h2-url/","year":"2018"},{"content":"@BeforeAll @BeforeEach @AfterAll @AfterEach @DisplayName è‡ªå®šä¹‰çš„å±•ç¤ºåç§°\n@IndicativeSentencesGeneration(separator = \u0026quot; -\u0026gt; \u0026ldquo;, generator = DisplayNameGenerator.ReplaceUnderscores.class) æ›´æ”¹ç”Ÿæˆæµ‹è¯•åç§°è§„åˆ™ï¼Œæ ¹æ®ç±»åå’Œæ–¹æ³•åç”Ÿæˆï¼Œå¹¶å¯ä»¥æŒ‡å®šæ›¿æ¢ç­–ç•¥ï¼Œæ¯”å¦‚ä¸Šé¢çš„æ›¿æ¢ä¸‹åˆ’çº¿ä¸ºç©ºæ ¼\n@Disabled å±è”½æ•´ä¸ªç±»çš„æµ‹è¯•ï¼Œæˆ–è€…å•ä¸ªæµ‹è¯•æ–¹æ³•\n@EnabledOnOs/@DisabledOnOs æ ¹æ®ç³»ç»Ÿå¯ç”¨æˆ–è€…å¼ƒç”¨\n@EnabledOnJre/@DisabledOnJre/@EnabledForJreRange/@DisabledForJreRange æŒ‡å®šjreç‰ˆæœ¬æˆ–è€…èŒƒå›´å¯ç”¨æˆ–è€…å¼ƒç”¨\n@EnabledIfSystemProperty/@DisabledIfSystemProperty æ ¹æ®JVMç³»ç»Ÿå‚æ•°å¯ç”¨æˆ–è€…å¼ƒç”¨\n@Test\r@EnabledIfSystemProperty(named = \u0026quot;os.arch\u0026quot;, matches = \u0026quot;.*64.*\u0026quot;)\rvoid onlyOn64BitArchitectures() {\r// ...\r}\r@Test\r@DisabledIfSystemProperty(named = \u0026quot;ci-server\u0026quot;, matches = \u0026quot;true\u0026quot;)\rvoid notOnCiServer() {\r// ...\r}\r @EnabledIfEnvironmentVariable/@DisabledIfEnvironmentVariable æ ¹æ®åº•å±‚æ“ä½œç³»ç»Ÿå‚æ•°å¯ç”¨æˆ–è€…å¼ƒç”¨\n@Test\r@EnabledIfEnvironmentVariable(named = \u0026quot;ENV\u0026quot;, matches = \u0026quot;staging-server\u0026quot;)\rvoid onlyOnStagingServer() {\r// ...\r}\r@Test\r@DisabledIfEnvironmentVariable(named = \u0026quot;ENV\u0026quot;, matches = \u0026quot;.*development.*\u0026quot;)\rvoid notOnDeveloperWorkstation() {\r// ...\r}\r @EnabledIf/@DisabledIf @Test\r@EnabledIf(\u0026quot;customCondition\u0026quot;)\rvoid enabled() {\r// ...\r}\r@Test\r@DisabledIf(\u0026quot;customCondition\u0026quot;)\rvoid disabled() {\r// ...\r}\rboolean customCondition() {\rreturn true;\r}\r @Tag æ‰“æ ‡ç­¾è·Ÿ@Filteré…åˆä½¿ç”¨\n@TestMethodOrder æŒ‡å®šæµ‹è¯•æ–¹æ³•æ‰§è¡Œé¡ºåº\nimport org.junit.jupiter.api.MethodOrderer.OrderAnnotation;\rimport org.junit.jupiter.api.Order;\rimport org.junit.jupiter.api.Test;\rimport org.junit.jupiter.api.TestMethodOrder;\r@TestMethodOrder(OrderAnnotation.class)\rclass OrderedTestsDemo {\r@Test\r@Order(1)\rvoid nullValues() {\r// perform assertions against null values\r}\r@Test\r@Order(2)\rvoid emptyValues() {\r// perform assertions against empty values\r}\r@Test\r@Order(3)\rvoid validValues() {\r// perform assertions against valid values\r}\r}\r @TestInstance(Lifecycle.PER_CLASS) é»˜è®¤Junit5æ˜¯ä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼Œæ„æ€å°±æ˜¯å®ä¾‹ä¸­çš„å‚æ•°è¢«ä»»ä½•æ–¹æ³•æ”¹å˜ä¹Ÿä¸ä¼šå½±å“å…¶ä»–æ–¹æ³•ã€‚ä½†é€šè¿‡ä¸Šé¢çš„æ³¨è§£å¯ä»¥å°†å…¶æ”¹ä¸ºä¸€ä¸ªç±»å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼Œè¿™æ ·å¯èƒ½é€ æˆå®ä¾‹ä¸­çš„å‚æ•°æ±¡æŸ“ï¼Œå¯ä»¥é€šè¿‡@BeforeEachå’Œ@AfterEachæ¥è§£å†³ã€‚\næ”¹ä¸ºä¸€ä¸ªç±»å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼Œå¯ä»¥è®©@BeforeAll @AfterAllå£°æ˜åœ¨éstaticæ–¹æ³•ä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨@Nestedé›†æˆç±»ä¸­å£°æ˜@BeforeAll @AfterAll\n@Nested å†…éƒ¨æµ‹è¯•ç±»\n@RepeatedTest é‡å¤æµ‹è¯•\n@ParameterizedTest ä»¥ç»™å®šçš„å‚æ•°åˆ—è¡¨é‡å¤æ‰§è¡Œæµ‹è¯•\n@ParameterizedTest\r@ValueSource(strings = { \u0026quot;racecar\u0026quot;, \u0026quot;radar\u0026quot;, \u0026quot;able was I ere I saw elba\u0026quot; })\rvoid palindromes(String candidate) {\rassertTrue(StringUtils.isPalindrome(candidate));\r}\r @ValueSource æµ‹è¯•æ–¹æ³•åªæœ‰å•ä¸ªå‚æ•°ï¼Œå¹¶ä¸”å‚æ•°æ˜¯ä»¥ä¸‹ç±»å‹ï¼š\n  short\n  byte\n  int\n  long\n  float\n  double\n  char\n  boolean\n  java.lang.String\n  java.lang.Class\n  @NullSource å•ä¸ªå‚æ•°ï¼Œå¹¶ä¸”ä¸èƒ½æ˜¯åŸå§‹ç±»å‹\n@EmptySource å•ä¸ªå‚æ•°ï¼Œå¹¶ä¸”ç±»å‹æ˜¯æ•°ç»„ï¼Œé›†åˆï¼ŒStringï¼ŒSetï¼ŒMap\næ³¨æ„ä»¥ä¸Šç±»å‹çš„å­ç±»å‹ä¸å—æ”¯æŒ\n@NullAndEmptySource @NullSourceå’Œ@EmptySourceçš„å¤åˆæ³¨è§£\nä¸‹é¢çš„æµ‹è¯•æ–¹æ³•æ¥å—äº†æ‰€æœ‰ç±»å‹çš„ç©ºå€¼\n@ParameterizedTest\r@NullAndEmptySource\r@ValueSource(strings = { \u0026quot; \u0026quot;, \u0026quot; \u0026quot;, \u0026quot;\\t\u0026quot;, \u0026quot;\\n\u0026quot; })\rvoid nullEmptyAndBlankStrings(String text) {\rassertTrue(text == null || text.trim().isEmpty());\r}\r @EnumSource å¿½ç•¥namesæšä¸¾çš„æ‰€æœ‰å¸¸é‡éƒ½ä¼šä½œä¸ºå‚æ•°\n@ParameterizedTest\r@EnumSource\rvoid testWithEnumSourceWithAutoDetection(ChronoUnit unit) {\rassertNotNull(unit);\r}\r @ParameterizedTest\r@EnumSource(names = { \u0026quot;DAYS\u0026quot;, \u0026quot;HOURS\u0026quot; })\rvoid testWithEnumSourceInclude(ChronoUnit unit) {\rassertTrue(EnumSet.of(ChronoUnit.DAYS, ChronoUnit.HOURS).contains(unit));\r}\r é™¤äº†æ˜ç¡®æŒ‡å®šnamesè¿˜å¯ä»¥é€šè¿‡modeå±æ€§å»åŒ¹é…å¸¸é‡\n@ParameterizedTest\r@EnumSource(mode = EXCLUDE, names = { \u0026quot;ERAS\u0026quot;, \u0026quot;FOREVER\u0026quot; })\rvoid testWithEnumSourceExclude(ChronoUnit unit) {\rassertFalse(EnumSet.of(ChronoUnit.ERAS, ChronoUnit.FOREVER).contains(unit));\r}\r @ParameterizedTest\r@EnumSource(mode = MATCH_ALL, names = \u0026quot;^.*DAYS$\u0026quot;)\rvoid testWithEnumSourceRegex(ChronoUnit unit) {\rassertTrue(unit.name().endsWith(\u0026quot;DAYS\u0026quot;));\r}\r @MethodSource @ParameterizedTest\r@MethodSource(\u0026quot;stringProvider\u0026quot;)\rvoid testWithExplicitLocalMethodSource(String argument) {\rassertNotNull(argument);\r}\rstatic Stream\u0026lt;String\u0026gt; stringProvider() {\rreturn Stream.of(\u0026quot;apple\u0026quot;, \u0026quot;banana\u0026quot;);\r}\r MethodSourceå¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®šæ–¹æ³•åç§°ï¼Œä¼šè‡ªåŠ¨å®šä½è·Ÿå½“å‰æ–¹æ³•åç›¸åŒçš„å·¥å‚æ–¹æ³•ï¼ˆæ²¡æœ‰å‚æ•°ï¼Œå¹¶è¿”å›Stream\u0026lt;?\u0026gt;ï¼‰\n@ParameterizedTest\r@MethodSource\rvoid testWithDefaultLocalMethodSource(String argument) {\rassertNotNull(argument);\r}\rstatic Stream\u0026lt;String\u0026gt; testWithDefaultLocalMethodSource() {\rreturn Stream.of(\u0026quot;apple\u0026quot;, \u0026quot;banana\u0026quot;);\r}\r ä¸‹é¢çš„ä¾‹å­æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„ä¾‹å­\n@ParameterizedTest\r@MethodSource(\u0026quot;range\u0026quot;)\rvoid testWithRangeMethodSource(int argument) {\rassertNotEquals(9, argument);\r}\rstatic IntStream range() {\rreturn IntStream.range(0, 20).skip(10);\r}\r ä¸Šé¢éƒ½æ˜¯ä¸€ä¸ªå‚æ•°çš„ä¾‹å­ï¼Œä¸‹é¢çš„å®ä¾‹å±•ç¤ºçš„æ˜¯å¤šä¸ªå‚æ•°æ—¶çš„æƒ…å†µï¼š\n@ParameterizedTest\r@MethodSource(\u0026quot;stringIntAndListProvider\u0026quot;)\rvoid testWithMultiArgMethodSource(String str, int num, List\u0026lt;String\u0026gt; list) {\rassertEquals(5, str.length());\rassertTrue(num \u0026gt;=1 \u0026amp;\u0026amp; num \u0026lt;=2);\rassertEquals(2, list.size());\r}\rstatic Stream\u0026lt;Arguments\u0026gt; stringIntAndListProvider() {\rreturn Stream.of(\rarguments(\u0026quot;apple\u0026quot;, 1, Arrays.asList(\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;)),\rarguments(\u0026quot;lemon\u0026quot;, 2, Arrays.asList(\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;))\r);\r}\r å¦‚æœå¼•ç”¨çš„æ˜¯å¤–éƒ¨æ–¹æ³•ï¼Œé‚£ä¹ˆå°±éœ€è¦è¯¥æ–¹æ³•çš„å®Œå…¨é™å®šå\npackage example;\rimport java.util.stream.Stream;\rimport org.junit.jupiter.params.ParameterizedTest;\rimport org.junit.jupiter.params.provider.MethodSource;\rclass ExternalMethodSourceDemo {\r@ParameterizedTest\r@MethodSource(\u0026quot;example.StringsProviders#tinyStrings\u0026quot;)\rvoid testWithExternalMethodSource(String tinyString) {\r// test with tiny string\r}\r}\rclass StringsProviders {\rstatic Stream\u0026lt;String\u0026gt; tinyStrings() {\rreturn Stream.of(\u0026quot;.\u0026quot;, \u0026quot;oo\u0026quot;, \u0026quot;OOO\u0026quot;);\r}\r}\r @CsvSource å¤šä¸ªå‚æ•°çš„å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼š\n@ParameterizedTest\r@CsvSource({\r\u0026quot;apple, 1\u0026quot;,\r\u0026quot;banana, 2\u0026quot;,\r\u0026quot;'lemon, lime', 0xF1\u0026quot;\r})\rvoid testWithCsvSource(String fruit, int rank) {\rassertNotNull(fruit);\rassertNotEquals(0, rank);\r}\r @CsvSourceå¯ä»¥è‡ªå®šä¹‰ç©ºå€¼çš„åˆ«åï¼Œä¸‹é¢æ˜¯ä¸€äº›@CsvSourceä½¿ç”¨çš„å…·ä½“å®ä¾‹\n   Example Input Resulting Argument List     @CsvSource({ \u0026ldquo;apple, banana\u0026rdquo; }) \u0026ldquo;apple\u0026rdquo;, \u0026ldquo;banana\u0026rdquo;   @CsvSource({ \u0026ldquo;apple, \u0026lsquo;lemon, lime\u0026rsquo;\u0026rdquo; }) \u0026ldquo;apple\u0026rdquo;, \u0026ldquo;lemon, lime\u0026rdquo;   @CsvSource({ \u0026ldquo;apple, \u0026lsquo;'\u0026rdquo; }) \u0026ldquo;apple\u0026rdquo;, \u0026quot;\u0026rdquo;   @CsvSource({ \u0026ldquo;apple, \u0026quot; }) \u0026ldquo;apple\u0026rdquo;, null   @CsvSource(value = { \u0026ldquo;apple, banana, NIL\u0026rdquo; }, nullValues = \u0026ldquo;NIL\u0026rdquo;) \u0026ldquo;apple\u0026rdquo;, \u0026ldquo;banana\u0026rdquo;, null    CsvFileSource æ ¹æ®csvæ–‡ä»¶å†…å®¹ç”Ÿæˆæµ‹è¯•å‚æ•°ï¼Œæ³¨æ„ä»»ä½•ä»¥#å¼€å¤´çš„è¡Œéƒ½ä¼šè¢«è§†ä½œä¸ºæ³¨é‡Š\n@ParameterizedTest\r@CsvFileSource(resources = \u0026quot;/two-column.csv\u0026quot;, numLinesToSkip = 1)\rvoid testWithCsvFileSourceFromClasspath(String country, int reference) {\rassertNotNull(country);\rassertNotEquals(0, reference);\r}\r@ParameterizedTest\r@CsvFileSource(files = \u0026quot;src/test/resources/two-column.csv\u0026quot;, numLinesToSkip = 1)\rvoid testWithCsvFileSourceFromFile(String country, int reference) {\rassertNotNull(country);\rassertNotEquals(0, reference);\r}\r two-column.csv\nCountry, reference\rSweden, 1\rPoland, 2\r\u0026quot;United States of America\u0026quot;, 3\r è·Ÿ@CsvSourceä¸åŒï¼Œè¿™é‡Œçš„åˆ†éš”ç¬¦æ˜¯åŒå¼•å·ï¼Œä¸æ˜¯ä¹‹å‰çš„å•å¼•å·ã€‚\nè¿™é‡Œåˆ¤ç©ºçš„æ–¹å¼è·Ÿ@CsvSourceç±»ä¼¼ï¼Œå¹¶ä¸”ä¹Ÿæœ‰nullValuesä½œä¸ºæ§åˆ¶åˆ«åã€‚\n@ArgumentsSource å¯ä»¥ç”¨æ¥åˆ¶å®šä¸€ä¸ªè‡ªå®šä¹‰çš„çœ‹ï¼Œå¯é‡ç”¨çš„ArgumentsProvideræ³¨æ„è¿™ä¸ªæ³¨è§£åªèƒ½ä¿®é¥°é¡¶çº§ç±»ï¼Œæˆ–è€…é™æ€çš„é›†æˆç±»ã€‚\n@ParameterizedTest\r@ArgumentsSource(MyArgumentsProvider.class)\rvoid testWithArgumentsSource(String argument) {\rassertNotNull(argument);\r}\r public class MyArgumentsProvider implements ArgumentsProvider {\r@Override\rpublic Stream\u0026lt;? extends Arguments\u0026gt; provideArguments(ExtensionContext context) {\rreturn Stream.of(\u0026quot;apple\u0026quot;, \u0026quot;banana\u0026quot;).map(Arguments::of);\r}\r}\r å¤šå¯¹è±¡æ˜ å°„ é™¤äº†å‰é¢æåˆ°çš„@MethodSourceæ³¨è§£å¯ä»¥è¿›è¡Œè‡ªå®šä¹‰å¤šå¯¹è±¡æ˜ å°„æ„å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ArgumentAccessorä½œä¸ºå‚æ•°ï¼Œç„¶åæ‰‹åŠ¨æ˜ å°„åˆ°æŒ‡å®šçš„å¯¹è±¡ï¼š\n@ParameterizedTest\r@CsvSource({\r\u0026quot;Jane, Doe, F, 1990-05-20\u0026quot;,\r\u0026quot;John, Doe, M, 1990-10-22\u0026quot;\r})\rvoid testWithArgumentsAccessor(ArgumentsAccessor arguments) {\rPerson person = new Person(arguments.getString(0),\rarguments.getString(1),\rarguments.get(2, Gender.class),\rarguments.get(3, LocalDate.class));\rif (person.getFirstName().equals(\u0026quot;Jane\u0026quot;)) {\rassertEquals(Gender.F, person.getGender());\r}\relse {\rassertEquals(Gender.M, person.getGender());\r}\rassertEquals(\u0026quot;Doe\u0026quot;, person.getLastName());\rassertEquals(1990, person.getDateOfBirth().getYear());\r}\r é™¤äº†ArgumentAccessorä»¥å¤–ï¼Œä½ è¿˜å¯ä»¥è‡ªå®šä¹‰Aggregatorã€‚éœ€è¦é€šè¿‡å®ç°ArgumentsAggregatoræ¥å£ï¼Œå¹¶ä¸”å°†@AggregateWithæ³¨è§£æ”¾åˆ°å¯¹åº”å‚æ•°ä¸Šã€‚\n@ParameterizedTest\r@CsvSource({\r\u0026quot;Jane, Doe, F, 1990-05-20\u0026quot;,\r\u0026quot;John, Doe, M, 1990-10-22\u0026quot;\r})\rvoid testWithArgumentsAggregator(@AggregateWith(PersonAggregator.class) Person person) {\r// perform assertions against person\r}\r public class PersonAggregator implements ArgumentsAggregator {\r@Override\rpublic Person aggregateArguments(ArgumentsAccessor arguments, ParameterContext context) {\rreturn new Person(arguments.getString(0),\rarguments.getString(1),\rarguments.get(2, Gender.class),\rarguments.get(3, LocalDate.class));\r}\r}\r @TestFactory ä¸åŒäºJunit4çš„@Testï¼Œ@TestFactoryæ˜¯åŠ¨æ€çš„ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡æµ‹è¯•çš„ç»“æœå¯èƒ½ä¸ç›¸åŒã€‚ä»–æ‰€ä¿®é¥°çš„æ–¹æ³•å¿…é¡»è¿”å›DynamicNode or a Stream, Collection, Iterable, Iterator, or array of DynamicNode instances\nä¹‹æ‰€ä»¥å«TestFactoryï¼Œå°±æ˜¯å› ä¸ºä»–è¿”å›çš„æ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªæµ‹è¯•ï¼Œå¹¶ä¸”ä»–ä»¬çš„æµ‹è¯•ç»“æœå¯èƒ½ä¸æ˜¯ä¸€å®šçš„ã€‚\nä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç¬¬ä¸€ä¸ªæ˜¯é”™è¯¯ç¤ºèŒƒï¼Œè¿”å›çš„ä¸æ˜¯@TestFactoryæŒ‡å®šçš„è¿”å›ç±»å‹ä¼šåœ¨è¿è¡Œæ—¶æŠ¥é”™ã€‚ä¹‹åçš„äº”ä¸ªæ˜¯å¯¹å¯èƒ½çš„è¿”å›ç±»å‹çš„å±•ç¤ºã€‚æœ€åå‡ ä¸ªå°±æ˜¯çœŸæ­£çš„åŠ¨æ€å®ä¾‹ã€‚\nimport static example.util.StringUtils.isPalindrome;\rimport static org.junit.jupiter.api.Assertions.assertEquals;\rimport static org.junit.jupiter.api.Assertions.assertFalse;\rimport static org.junit.jupiter.api.Assertions.assertNotNull;\rimport static org.junit.jupiter.api.Assertions.assertTrue;\rimport static org.junit.jupiter.api.DynamicContainer.dynamicContainer;\rimport static org.junit.jupiter.api.DynamicTest.dynamicTest;\rimport java.util.Arrays;\rimport java.util.Collection;\rimport java.util.Iterator;\rimport java.util.List;\rimport java.util.Random;\rimport java.util.function.Function;\rimport java.util.stream.IntStream;\rimport java.util.stream.Stream;\rimport example.util.Calculator;\rimport org.junit.jupiter.api.DynamicNode;\rimport org.junit.jupiter.api.DynamicTest;\rimport org.junit.jupiter.api.Tag;\rimport org.junit.jupiter.api.TestFactory;\rimport org.junit.jupiter.api.function.ThrowingConsumer;\rclass DynamicTestsDemo {\rprivate final Calculator calculator = new Calculator();\r// This will result in a JUnitException!\r@TestFactory\rList\u0026lt;String\u0026gt; dynamicTestsWithInvalidReturnType() {\rreturn Arrays.asList(\u0026quot;Hello\u0026quot;);\r}\r@TestFactory\rCollection\u0026lt;DynamicTest\u0026gt; dynamicTestsFromCollection() {\rreturn Arrays.asList(\rdynamicTest(\u0026quot;1st dynamic test\u0026quot;, () -\u0026gt; assertTrue(isPalindrome(\u0026quot;madam\u0026quot;))),\rdynamicTest(\u0026quot;2nd dynamic test\u0026quot;, () -\u0026gt; assertEquals(4, calculator.multiply(2, 2)))\r);\r}\r@TestFactory\rIterable\u0026lt;DynamicTest\u0026gt; dynamicTestsFromIterable() {\rreturn Arrays.asList(\rdynamicTest(\u0026quot;3rd dynamic test\u0026quot;, () -\u0026gt; assertTrue(isPalindrome(\u0026quot;madam\u0026quot;))),\rdynamicTest(\u0026quot;4th dynamic test\u0026quot;, () -\u0026gt; assertEquals(4, calculator.multiply(2, 2)))\r);\r}\r@TestFactory\rIterator\u0026lt;DynamicTest\u0026gt; dynamicTestsFromIterator() {\rreturn Arrays.asList(\rdynamicTest(\u0026quot;5th dynamic test\u0026quot;, () -\u0026gt; assertTrue(isPalindrome(\u0026quot;madam\u0026quot;))),\rdynamicTest(\u0026quot;6th dynamic test\u0026quot;, () -\u0026gt; assertEquals(4, calculator.multiply(2, 2)))\r).iterator();\r}\r@TestFactory\rDynamicTest[] dynamicTestsFromArray() {\rreturn new DynamicTest[] {\rdynamicTest(\u0026quot;7th dynamic test\u0026quot;, () -\u0026gt; assertTrue(isPalindrome(\u0026quot;madam\u0026quot;))),\rdynamicTest(\u0026quot;8th dynamic test\u0026quot;, () -\u0026gt; assertEquals(4, calculator.multiply(2, 2)))\r};\r}\r@TestFactory\rStream\u0026lt;DynamicTest\u0026gt; dynamicTestsFromStream() {\rreturn Stream.of(\u0026quot;racecar\u0026quot;, \u0026quot;radar\u0026quot;, \u0026quot;mom\u0026quot;, \u0026quot;dad\u0026quot;)\r.map(text -\u0026gt; dynamicTest(text, () -\u0026gt; assertTrue(isPalindrome(text))));\r}\r@TestFactory\rStream\u0026lt;DynamicTest\u0026gt; dynamicTestsFromIntStream() {\r// Generates tests for the first 10 even integers.\rreturn IntStream.iterate(0, n -\u0026gt; n + 2).limit(10)\r.mapToObj(n -\u0026gt; dynamicTest(\u0026quot;test\u0026quot; + n, () -\u0026gt; assertTrue(n % 2 == 0)));\r}\r@TestFactory\rStream\u0026lt;DynamicTest\u0026gt; generateRandomNumberOfTestsFromIterator() {\r// Generates random positive integers between 0 and 100 until\r// a number evenly divisible by 7 is encountered.\rIterator\u0026lt;Integer\u0026gt; inputGenerator = new Iterator\u0026lt;Integer\u0026gt;() {\rRandom random = new Random();\rint current;\r@Override\rpublic boolean hasNext() {\rcurrent = random.nextInt(100);\rreturn current % 7 != 0;\r}\r@Override\rpublic Integer next() {\rreturn current;\r}\r};\r// Generates display names like: input:5, input:37, input:85, etc.\rFunction\u0026lt;Integer, String\u0026gt; displayNameGenerator = (input) -\u0026gt; \u0026quot;input:\u0026quot; + input;\r// Executes tests based on the current input value.\rThrowingConsumer\u0026lt;Integer\u0026gt; testExecutor = (input) -\u0026gt; assertTrue(input % 7 != 0);\r// Returns a stream of dynamic tests.\rreturn DynamicTest.stream(inputGenerator, displayNameGenerator, testExecutor);\r}\r@TestFactory\rStream\u0026lt;DynamicTest\u0026gt; dynamicTestsFromStreamFactoryMethod() {\r// Stream of palindromes to check\rStream\u0026lt;String\u0026gt; inputStream = Stream.of(\u0026quot;racecar\u0026quot;, \u0026quot;radar\u0026quot;, \u0026quot;mom\u0026quot;, \u0026quot;dad\u0026quot;);\r// Generates display names like: racecar is a palindrome\rFunction\u0026lt;String, String\u0026gt; displayNameGenerator = text -\u0026gt; text + \u0026quot; is a palindrome\u0026quot;;\r// Executes tests based on the current input value.\rThrowingConsumer\u0026lt;String\u0026gt; testExecutor = text -\u0026gt; assertTrue(isPalindrome(text));\r// Returns a stream of dynamic tests.\rreturn DynamicTest.stream(inputStream, displayNameGenerator, testExecutor);\r}\r@TestFactory\rStream\u0026lt;DynamicNode\u0026gt; dynamicTestsWithContainers() {\rreturn Stream.of(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;)\r.map(input -\u0026gt; dynamicContainer(\u0026quot;Container \u0026quot; + input, Stream.of(\rdynamicTest(\u0026quot;not null\u0026quot;, () -\u0026gt; assertNotNull(input)),\rdynamicContainer(\u0026quot;properties\u0026quot;, Stream.of(\rdynamicTest(\u0026quot;length \u0026gt; 0\u0026quot;, () -\u0026gt; assertTrue(input.length() \u0026gt; 0)),\rdynamicTest(\u0026quot;not empty\u0026quot;, () -\u0026gt; assertFalse(input.isEmpty()))\r))\r)));\r}\r@TestFactory\rDynamicNode dynamicNodeSingleTest() {\rreturn dynamicTest(\u0026quot;'pop' is a palindrome\u0026quot;, () -\u0026gt; assertTrue(isPalindrome(\u0026quot;pop\u0026quot;)));\r}\r@TestFactory\rDynamicNode dynamicNodeSingleContainer() {\rreturn dynamicContainer(\u0026quot;palindromes\u0026quot;,\rStream.of(\u0026quot;racecar\u0026quot;, \u0026quot;radar\u0026quot;, \u0026quot;mom\u0026quot;, \u0026quot;dad\u0026quot;)\r.map(text -\u0026gt; dynamicTest(text, () -\u0026gt; assertTrue(isPalindrome(text)))\r));\r}\r}\r åŠ¨æ€æµ‹è¯•è¿˜å¯ä»¥æ ¹æ®java.net.URIæä¾›çš„èµ„æºç”Ÿæˆï¼š\n DynamicTest.dynamicTest(String, URI, Executable) DynamicContainer.dynamicContainer(String, URI, Stream)  è¿™é‡Œçš„URIä¼šè¢«è½¬ä¸ºä»¥ä¸‹TestSourceå®ç°ï¼š\n  ClasspathResourceSource\nIf the URI contains the classpath schemeâ€‰â€”â€‰for example, classpath:/test/foo.xml?line=20,column=2.\n  DirectorySource\nIf the URI represents a directory present in the file system.\n  FileSource\nIf the URI represents a file present in the file system.\n  MethodSource\nIf the URI contains the method scheme and the fully qualified method name (FQMN)â€‰â€”â€‰for example, method:org.junit.Foo#bar(java.lang.String, java.lang.String[]). Please refer to the Javadoc for DiscoverySelectors.selectMethod(String) for the supported formats for a FQMN.\n  UriSource\nIf none of the above TestSource implementations are applicable.\n  @Timeout å¹¶å‘æµ‹è¯•  è¯•éªŒåŠŸèƒ½ï¼Œè¯¦æƒ…å‚è€ƒparallel execution\n ","id":64,"section":"posts","summary":"@BeforeAll @BeforeEach @AfterAll @AfterEach @DisplayName è‡ªå®šä¹‰çš„å±•ç¤ºåç§° @IndicativeSentencesGeneration(separator = \u0026quot; -\u0026gt; \u0026ldquo;, generator = DisplayNameGenerator.ReplaceUnderscores.class) æ›´æ”¹ç”Ÿæˆæµ‹è¯•åç§°è§„åˆ™ï¼Œæ ¹æ®ç±»åå’Œæ–¹æ³•åç”Ÿæˆï¼Œå¹¶å¯ä»¥æŒ‡å®šæ›¿æ¢ç­–ç•¥ï¼Œæ¯”å¦‚ä¸Šé¢çš„æ›¿æ¢ä¸‹åˆ’çº¿ä¸ºç©ºæ ¼ @Disabled å±è”½æ•´","tags":["junit5"],"title":"Junit5å¸¸ç”¨æ³¨è§£","uri":"https://www.mingaccount.com/2018/11/junit5-common-annotation/","year":"2018"},{"content":"å‚ç…§å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰è¯¦ç»†è¯´æ˜å’Œä½¿ç”¨å®ä¾‹\nMaven plugins\n","id":65,"section":"posts","summary":"å‚ç…§å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰è¯¦ç»†è¯´æ˜å’Œä½¿ç”¨å®ä¾‹ Maven plugins","tags":["maven"],"title":"Maven Plugins","uri":"https://www.mingaccount.com/2018/11/maven-plugin/","year":"2018"},{"content":"èƒŒæ™¯ ä½¿ç”¨AutoConfigure*æˆ–è€…SpringBootTestè¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼Œå¦‚æœä¸æ‰‹åŠ¨è®¾ç½®@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)ï¼Œé‚£ä¹ˆSpringBootä¼šé»˜è®¤åœ¨classpathä¸‹å¯»æ‰¾é›†æˆæ•°æ®åº“ã€‚\né›†æˆæ•°æ®åº“å¯ä»¥ç›´æ¥é€šè¿‡åˆå§‹åŒ–è„šæœ¬ï¼Œåœ¨æ²¡æœ‰æ•°æ®åº“ç¯å¢ƒçš„æƒ…å†µä¸‹ï¼Œå°±èƒ½è¿›è¡ŒåŠŸèƒ½æµ‹è¯•ã€‚å¹¶ä¸”ä½ ä¸éœ€è¦å¯¹é›†æˆæ•°æ®åº“è¿›è¡Œä»»ä½•é…ç½®ã€‚\nSpring boot é›†æˆh2 æƒ³è¦ä½¿ç”¨spirngbooté›†æˆçš„h2ï¼Œåªéœ€è¦å¼•å…¥ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt;\r\u0026lt;/dependency\u0026gt;\r åœ¨propertiesæ–‡ä»¶ä¸­ï¼Œä¸éœ€è¦ä»»ä½•é…ç½®ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼‰Springbootå°±èƒ½ç›´æ¥ä½¿ç”¨h2ã€‚\nå¦‚æœæƒ³è‡ªå·±é…ç½®h2ï¼Œä»¥æ›¿æ¢Spring-booté›†æˆçš„ï¼Œå¯ä»¥è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š\nspring:\rdatasource:\rurl: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=false;DATABASE_TO_LOWER=TRUE;CASE_INSENSITIVE_IDENTIFIERS=TRUE;MODE=MYSQL\rtest:\rdatabase:\rreplace: NONE\r æ³¨æ„ï¼Œå› ä¸ºæœ‰test.database.replace=NONEçš„å­˜åœ¨ï¼Œä¸éœ€è¦åœ¨æµ‹è¯•ç±»ä¸Šå†ç”³æ˜@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)\nå®ä¾‹ ä¸‹é¢æ˜¯ä¸€ä¸ªæµ‹è¯•ç±»çš„çˆ¶ç±»(åŸºäºJunit5)ï¼Œæ˜¯åœ¨æ‰€æœ‰æµ‹è¯•ä¹‹å‰åˆå§‹åŒ–è¡¨ç»“æœå’Œæµ‹è¯•æ•°æ®\n@AutoConfigureTestDatabase\r@TestInstance(TestInstance.Lifecycle.PER_CLASS)\rpublic class SuperTestConfiguration {\r@Autowired\rprivate DataSource dataSource;\r@BeforeAll\rvoid beforeAll() {\rResourceDatabasePopulator populator = new ResourceDatabasePopulator();\rpopulator.addScripts(\rnew ClassPathResource(\u0026quot;/sql/h2/init/init.sql\u0026quot;),\rnew ClassPathResource(\u0026quot;/sql/h2/test/test.sql\u0026quot;));\rpopulator.setSeparator(\u0026quot;;\u0026quot;);\rpopulator.execute(dataSource);\r}\r}\r ","id":66,"section":"posts","summary":"èƒŒæ™¯ ä½¿ç”¨AutoConfigure*æˆ–è€…SpringBootTestè¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼Œå¦‚æœä¸æ‰‹åŠ¨è®¾ç½®@AutoConfigureTestDat","tags":["spring","h2"],"title":"Spring boot h2é›†æˆæ•°æ®åº“è¿›è¡Œæµ‹è¯•","uri":"https://www.mingaccount.com/2018/10/spring-boot-h2-test/","year":"2018"},{"content":"é—®é¢˜èƒŒæ™¯ DROP VIEW temp_view;\r æŠ¥é”™ä¿¡æ¯ï¼š\nCan't drop temp_view,because *** depend on it\r è§£å†³æ–¹æ¡ˆ DROP VIEW temp_view CASCADE ;\r è¯¥sqlä¼šåˆ é™¤æ‰€æœ‰ä¾èµ–çš„è§†å›¾\n","id":67,"section":"posts","summary":"é—®é¢˜èƒŒæ™¯ DROP VIEW temp_view; æŠ¥é”™ä¿¡æ¯ï¼š Can't drop temp_view,because *** depend on it è§£å†³æ–¹æ¡ˆ DROP VIEW temp_view CASCADE ; è¯¥sqlä¼šåˆ é™¤æ‰€æœ‰ä¾èµ–çš„è§†å›¾","tags":["h2","postgresql"],"title":"åˆ é™¤è§†å›¾å¤±è´¥ï¼Œæç¤ºæœ‰å…¶ä»–è§†å›¾ä¾èµ–äºè¯¥è§†å›¾","uri":"https://www.mingaccount.com/2018/10/h2-drop-exception/","year":"2018"},{"content":"é—®é¢˜èƒŒæ™¯ é”™è¯¯æ—¥å¿—ï¼š\norg.apache.thrift.TApplicationException: [?] : out of sequence response\r é—®é¢˜åŸå›  hiveè¿æ¥åœ¨è¿æ¥æ± ä¸­ï¼ŒåŒæ—¶ä¸¤ä¸ªçº¿ç¨‹å»è·å–å¹¶æ‰§è¡Œï¼Œä¸¤ä¸ªéƒ½æœ‰closeæ“ä½œã€‚ å‚è€ƒhive jira\n","id":68,"section":"posts","summary":"é—®é¢˜èƒŒæ™¯ é”™è¯¯æ—¥å¿—ï¼š org.apache.thrift.TApplicationException: [?] : out of sequence response é—®é¢˜åŸå›  hiveè¿æ¥åœ¨è¿æ¥æ± ä¸­ï¼ŒåŒæ—¶ä¸¤ä¸ªçº¿ç¨‹å»è·å–å¹¶æ‰§è¡Œï¼Œä¸¤ä¸ªéƒ½æœ‰closeæ“ä½œã€‚ å‚è€ƒhive jira","tags":["hive"],"title":"hive æ‰§è¡Œsqlæ—¶æŠ¥é”™out of sequence","uri":"https://www.mingaccount.com/2018/09/hive-out-of-sequence/","year":"2018"},{"content":"@Configuration\r@MapperScan(basePackages = MysqlDatasourceConfig.PACKAGE, sqlSessionFactoryRef = \u0026quot;mysqlSessionFactory\u0026quot;)\rpublic class MysqlDatasourceConfig {\rpublic static final String PACKAGE = \u0026quot;com.ming.mapper.mysql1\u0026quot;;\rpublic static final String MAPPER_LOCATION = \u0026quot;classpath:mapper/mysql1/*.xml\u0026quot;;\r@Primary\r@Bean(name = \u0026quot;mysqlDatasource\u0026quot;)\r@ConfigurationProperties(\u0026quot;spring.datasource.druid.mysql1\u0026quot;)\rpublic DataSource mysqlDataSource(){\rreturn DruidDataSourceBuilder.create().build();\r}\r@Bean(name = \u0026quot;mysqlTransactionManager\u0026quot;)\r@Primary\rpublic DataSourceTransactionManager mysqlTransactionManager() {\rreturn new DataSourceTransactionManager(mysqlDataSource());\r}\r@Bean(name = \u0026quot;mysqlSessionFactory\u0026quot;)\r@Primary\rpublic SqlSessionFactory mysqlSessionFactory(@Qualifier(\u0026quot;mysqlDatasource\u0026quot;) DataSource dataSource) throws Exception {\rfinal SqlSessionFactoryBean sessionFactory = new SqlSessionFactoryBean();\rsessionFactory.setDataSource(dataSource);\rsessionFactory.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(MysqlDatasourceConfig.MAPPER_LOCATION));\rreturn sessionFactory.getObject();\r}\r}\r é…ç½®æ–‡ä»¶ä¸­æœ‰å¤šå°‘ä¸ªæ•°æ®æºå°±æ–°å»ºå¤šå°‘ä¸ªä¸Šé¢çš„é…ç½®ç±» é…ç½®ç±»ä¸­è®¾ç½®äº†å½“å‰æ•°æ®æºå¯¹åº”çš„mapperè·¯å¾„å’Œxmlè·¯å¾„ åœ¨serviceä¸­ä½¿ç”¨æ—¶ï¼Œåªéœ€è¦è°ƒç”¨å¯¹åº”çš„mapperå³å¯ ","id":69,"section":"posts","summary":"@Configuration @MapperScan(basePackages = MysqlDatasourceConfig.PACKAGE, sqlSessionFactoryRef = \u0026quot;mysqlSessionFactory\u0026quot;) public class MysqlDatasourceConfig { public static final String PACKAGE = \u0026quot;com.ming.mapper.mysql1\u0026quot;; public static final String MAPPER_LOCATION = \u0026quot;classpath:mapper/mysql1/*.xml\u0026quot;; @Primary @Bean(name = \u0026quot;mysqlDatasource\u0026quot;) @ConfigurationProperties(\u0026quot;spring.datasource.druid.mysql1\u0026quot;) public DataSource mysqlDataSource(){ return DruidDataSourceBuilder.create().build(); } @Bean(name = \u0026quot;mysqlTransactionManager\u0026quot;) @Primary public DataSourceTransactionManager mysqlTransactionManager() { return new DataSourceTransactionManager(mysqlDataSource()); } @Bean(name = \u0026quot;mysqlSessionFactory\u0026quot;) @Primary public SqlSessionFactory mysqlSessionFactory(@Qualifier(\u0026quot;mysqlDatasource\u0026quot;) DataSource dataSource) throws Exception { final SqlSessionFactoryBean sessionFactory = new SqlSessionFactoryBean(); sessionFactory.setDataSource(dataSource); sessionFactory.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(MysqlDatasourceConfig.MAPPER_LOCATION)); return","tags":["spring"],"title":"SpringBoot Mybatisé…ç½®å¤šæ•°æ®æº","uri":"https://www.mingaccount.com/2018/09/spring-boot-mybatis-multi-source/","year":"2018"},{"content":"ehcache.xml \u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r\u0026lt;ehcache xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxsi:noNamespaceSchemaLocation=\u0026quot;http://ehcache.org/ehcache.xsd\u0026quot;\u0026gt;\r\u0026lt;defaultCache\rmaxElementsInMemory=\u0026quot;10000\u0026quot;\reternal=\u0026quot;false\u0026quot;\rtimeToIdleSeconds=\u0026quot;3600\u0026quot;\rtimeToLiveSeconds=\u0026quot;0\u0026quot;\roverflowToDisk=\u0026quot;false\u0026quot;\rdiskPersistent=\u0026quot;false\u0026quot;\rdiskExpiryThreadIntervalSeconds=\u0026quot;120\u0026quot; /\u0026gt;\r\u0026lt;cache name=\u0026quot;myCache\u0026quot;\rmaxEntriesLocalHeap=\u0026quot;2000\u0026quot;\reternal=\u0026quot;false\u0026quot;\rtimeToIdleSeconds=\u0026quot;3600\u0026quot;\rtimeToLiveSeconds=\u0026quot;0\u0026quot;\roverflowToDisk=\u0026quot;false\u0026quot;\rstatistics=\u0026quot;true\u0026quot;/\u0026gt;\r\u0026lt;/ehcache\u0026gt;\r å±æ€§ç®€ä»‹ï¼š\n nameï¼šç¼“å­˜åç§°ã€‚ maxElementsInMemoryï¼šç¼“å­˜æœ€å¤§æ•°ç›® maxElementsOnDiskï¼šç¡¬ç›˜æœ€å¤§ç¼“å­˜ä¸ªæ•°ã€‚ eternalï¼šå¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆï¼Œä¸€ä½†è®¾ç½®äº†ï¼Œtimeoutå°†ä¸èµ·ä½œç”¨ã€‚ overflowToDiskï¼šæ˜¯å¦ä¿å­˜åˆ°ç£ç›˜ã€‚ timeToIdleSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ã€‚ timeToLiveSecondsï¼šè®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰å…è®¸å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚æœ€å¤§æ—¶é—´ä»‹äºåˆ›å»ºæ—¶é—´å’Œå¤±æ•ˆæ—¶é—´ä¹‹é—´ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡å­˜æ´»æ—¶é—´æ— ç©·å¤§ã€‚ diskPersistentï¼šæ˜¯å¦ç¼“å­˜è™šæ‹Ÿæœºé‡å¯æœŸæ•°æ®ï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚ diskSpoolBufferSizeMBï¼šè¿™ä¸ªå‚æ•°è®¾ç½®DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯30MBã€‚æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒºã€‚ diskExpiryThreadIntervalSecondsï¼šç£ç›˜å¤±æ•ˆçº¿ç¨‹è¿è¡Œæ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚ memoryStoreEvictionPolicyï¼šå½“è¾¾åˆ°maxElementsInMemoryé™åˆ¶æ—¶ï¼ŒEhcacheå°†ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥å»æ¸…ç†å†…å­˜ã€‚é»˜è®¤ç­–ç•¥æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚ä½ å¯ä»¥è®¾ç½®ä¸ºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æˆ–æ˜¯LFUï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ã€‚ clearOnFlushï¼šå†…å­˜æ•°é‡æœ€å¤§æ—¶æ˜¯å¦æ¸…é™¤ã€‚ memoryStoreEvictionPolicyï¼šEhcacheçš„ä¸‰ç§æ¸…ç©ºç­–ç•¥ï¼šFIFOï¼Œfirst in first outï¼Œè¿™ä¸ªæ˜¯å¤§å®¶æœ€ç†Ÿçš„ï¼Œå…ˆè¿›å…ˆå‡ºã€‚LFUï¼Œ Less Frequently Usedï¼Œå°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­ä½¿ç”¨çš„ç­–ç•¥ï¼Œç›´ç™½ä¸€ç‚¹å°±æ˜¯è®²ä¸€ç›´ä»¥æ¥æœ€å°‘è¢«ä½¿ç”¨çš„ã€‚å¦‚ä¸Šé¢æ‰€è®²ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªhitå±æ€§ï¼Œhitå€¼æœ€å°çš„å°†ä¼šè¢«æ¸…å‡ºç¼“å­˜ã€‚LRUï¼ŒLeast Recently Usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå½“ç¼“å­˜å®¹é‡æ»¡äº†ï¼Œè€Œåˆéœ€è¦è…¾å‡ºåœ°æ–¹æ¥ç¼“å­˜æ–°çš„å…ƒç´ çš„æ—¶å€™ï¼Œé‚£ä¹ˆç°æœ‰ç¼“å­˜å…ƒç´ ä¸­æ—¶é—´æˆ³ç¦»å½“å‰æ—¶é—´æœ€è¿œçš„å…ƒç´ å°†è¢«æ¸…å‡ºç¼“å­˜ã€‚  application.yml spring:\rcache:\rehcache:\rconfig: 'classpath:ehcache.xml'\r å¯ä»¥å¼ºåˆ¶æŒ‡å®šç¼“å­˜ç±»å‹\nspring:\rcache:\rtype: ehcache\r ","id":70,"section":"posts","summary":"ehcache.xml \u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt; \u0026lt;ehcache xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot; xsi:noNamespaceSchemaLocation=\u0026quot;http://ehcache.org/ehcache.xsd\u0026quot;\u0026gt; \u0026lt;defaultCache maxElementsInMemory=\u0026quot;10000\u0026quot; eternal=\u0026quot;false\u0026quot; timeToIdleSeconds=\u0026quot;3600\u0026quot; timeToLiveSeconds=\u0026quot;0\u0026quot; overflowToDisk=\u0026quot;false\u0026quot; diskPersistent=\u0026quot;false\u0026quot; diskExpiryThreadIntervalSeconds=\u0026quot;120\u0026quot; /\u0026gt; \u0026lt;cache name=\u0026quot;myCache\u0026quot; maxEntriesLocalHeap=\u0026quot;2000\u0026quot; eternal=\u0026quot;false\u0026quot; timeToIdleSeconds=\u0026quot;3600\u0026quot; timeToLiveSeconds=\u0026quot;0\u0026quot; overflowToDisk=\u0026quot;false\u0026quot; statistics=\u0026quot;true\u0026quot;/\u0026gt; \u0026lt;/ehcache\u0026gt; å±æ€§ç®€ä»‹ï¼š nameï¼šç¼“å­˜åç§°ã€‚ maxElementsInMemoryï¼šç¼“å­˜æœ€å¤§æ•°ç›® maxE","tags":["ehcache","spring"],"title":"SpringBoot Ehcacheé›†æˆ","uri":"https://www.mingaccount.com/2018/09/spring-boot-ehcache/","year":"2018"},{"content":"application.yml spring:\rredis:\rdatabase: 0\rhost: localhost\rprot: 6379\rpool:\rmax-active: 8\rmax-wait: -1\rmax-idle: 8\rmin-idle: 0\rtimeout: 0\r æ›´å¤šé…ç½®å‚è€ƒSpringå®˜ç½‘é…ç½®å‚æ•°\nRedisConfig @Configuration\r@EnableCaching\rpublic class RedisConfig extends CachingConfigurerSupport {\r@Bean\r@Override\rpublic CacheManager cacheManager(RedisConnectionFactory redisConnectionFactory) {\rreturn RedisCacheManager.create(redisConnectionFactory);\r}\r}\r ","id":71,"section":"posts","summary":"application.yml spring: redis: database: 0 host: localhost prot: 6379 pool: max-active: 8 max-wait: -1 max-idle: 8 min-idle: 0 timeout: 0 æ›´å¤šé…ç½®å‚è€ƒSpringå®˜ç½‘é…ç½®å‚æ•° RedisConfig @Configuration @EnableCaching public class RedisConfig extends CachingConfigurerSupport { @Bean @Override public CacheManager cacheManager(RedisConnectionFactory redisConnectionFactory) { return RedisCacheManager.create(redisConnectionFactory); } }","tags":["redis","spring"],"title":"SpringBoot Redisé›†æˆ","uri":"https://www.mingaccount.com/2018/09/spring-boot-redis/","year":"2018"},{"content":"1.äº†è§£ç¼“å­˜æ¦‚å¿µ  ç¼“å­˜å’Œç¼“å†²(Cache vs Buffer)\rç¼“å­˜å’Œç¼“å†²ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯äº¤æ›¿ä½¿ç”¨çš„ï¼Œéœ€è¦çŸ¥é“çš„æ˜¯ä»–ä»¬æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚\rbuffer(ç¼“å†²)æ˜¯ç”¨åœ¨å¿«æ…¢ä»‹è´¨ä¸­é—´ä½œä¸´æ—¶æ•°æ®å­˜å‚¨ç”¨ï¼Œä»‹è´¨ä¸€æ–¹å°†ä¼šç­‰å¾…å¦ä¸€æ–¹çš„æ“ä½œï¼Œè¿™ä¼šé€ æˆæ€§èƒ½æŸè€—ï¼Œä¸ºäº†ç¼“è§£ï¼Œbufferç”¨æ•´å—æ•°æ®çš„ç§»åŠ¨ä»£æ›¿å°å—æ•°æ®å¤šæ¬¡ç§»åŠ¨ã€‚\rè¿™æ ·bufferæ•°æ®è¯»å†™åªæœ‰ä¸€æ¬¡ï¼Œå¹¶ä¸”bufferå¯¹ä»‹è´¨åŒæ–¹æ¥è¯´è‡³å°‘æœ‰ä¸€æ–¹æ˜¯å¯è§çš„ã€‚\rcache(ç¼“å­˜)æ ¹æ®å®šä¹‰ä»–æ˜¯éšè—çš„ï¼ŒåŒæ–¹éƒ½ä¸çŸ¥é“ç¼“å­˜å‘ç”Ÿäº†ã€‚ä»–æé«˜æ€§èƒ½ä½“ç°åœ¨ä¸€ä¸ªæ•°æ®è¢«å¤šæ¬¡è¯»å–çš„æƒ…å†µ\r Springç¼“å­˜é’ˆå¯¹æ˜¯javaçš„æ–¹æ³•ï¼Œæ ¹æ®ç¼“å­˜é‡Œçš„ä¿¡æ¯å‡å°‘æ‰§è¡Œçš„æ¬¡æ•°ã€‚æ¯ä¸€æ¬¡ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰éƒ½ä¼šåˆ¤æ–­è¯¥æ–¹æ³•æ˜¯å¦å·²ç»è¢«è°ƒç”¨è¿‡ï¼Œå¹¶ä¸”å‚æ•°ä¸€è‡´ã€‚å¦‚æœå·²ç»è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆç›®æ ‡æ–¹æ³•ä¸ä¼šè¢«æ‰§è¡Œï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–ç»“æœã€‚\n è¿™ç§æ–¹å¼å¯¹æ–¹æ³•æœ‰è¦æ±‚ï¼Œéœ€è¦ç¡®ä¿æ–¹æ³•ä¸€ç»„å‚æ•°åªè¿”å›å”¯ä¸€ä¸ªç»“æœï¼Œä¸è®ºè°ƒç”¨å¤šå°‘æ¬¡è¯¥æ–¹æ³•\n Springåªæä¾›äº†ç¼“å­˜çš„é€»è¾‘ï¼Œæ„å‘³ç€ä½ éœ€è¦æä¾›ä¸€ä¸ªç¼“å­˜çš„å®ç°ï¼Œæ¥å®Œæˆå®é™…çš„æ•°æ®å‚¨å­˜ã€‚å¯¹åº”çš„å®ç°æ¥å£æ˜¯org.springframework.cache.Cacheå’Œorg.springframework.cache.CacheManager\nå½“ç„¶Springæä¾›äº†ç°æˆçš„ç¼“å­˜å®ç°ï¼š\n JDKjava.util.concurrent.ConcurrentMapä¸ºåŸºç¡€çš„ç¼“å­˜ Ehcache 2.x Gemfire cache Caffeine ç¬¦åˆJSR-107çš„ç¼“å­˜(Ehcache 3.x)   ç¼“å­˜çš„æŠ½è±¡å¹¶æ²¡æœ‰ç‰¹åˆ«çš„å¤„ç†å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹çš„ç¯å¢ƒï¼Œæ˜¯ç”±ç¼“å­˜çš„å®ç°å»å¤„ç†\n å¦‚æœä½ å¤„åœ¨å¤šè¿›ç¨‹ç¯å¢ƒï¼Œä½ éœ€è¦æ­£ç¡®çš„é…ç½®ä½ çš„ç¼“å­˜å®ç°ã€‚å¤šä¸ªèŠ‚ç‚¹ç›¸åŒæ•°æ®çš„å¤‡ä»½åº”è¯¥æ˜¯è¶³å¤Ÿçš„ï¼Œä½†è¿˜æ˜¯è¦ä¾èµ–äºä½ çš„å…·ä½“æƒ…å†µã€‚\nä½†æ˜¯ï¼Œå¦‚æœä½ åœ¨åº”ç”¨çš„å¤„ç†è¿‡ç¨‹ä¸­æ”¹å˜äº†æ•°æ®ï¼Œé‚£ä½ å¦å¤–éœ€è¦ä¸€ä¸ªçš„ä¼ æ’­æœºåˆ¶ã€‚\nç¼“å­˜çš„è¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ï¼Œç„¶åæ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼Œæœ€åä¿å­˜ç»“æœçš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯æ²¡æœ‰é”çš„ï¼Œå¦‚æœå¤šçº¿ç¨‹çš„æƒ…å†µä¸‹å¹¶å‘ä¿å­˜æˆ–è€…åˆ é™¤æ•°æ®ï¼Œæ•°æ®å¯èƒ½ä¼šè¢«æ±¡æŸ“ã€‚\næŸäº›ç¼“å­˜æä¾›è€…å¯¹è¿™ç§æƒ…å†µæœ‰ä¸“é—¨å¤„ç†ï¼Œè¯¦ç»†å‚è€ƒç¼“å­˜æä¾›è€…çš„æ–‡æ¡£\nè¦ä½¿ç”¨Springçš„ç¼“å­˜é›†æˆï¼Œä½ éœ€è¦æ³¨æ„è¿™ä¸¤ä¸ªæ–¹é¢ï¼š\n ç¼“å­˜å£°æ˜ï¼šç¡®å®šéœ€è¦ç¼“å­˜çš„æ–¹æ³•å’Œå…¶ç­–ç•¥ ç¼“å­˜é…ç½®ï¼šåå°ç¼“å­˜æ•°æ®æ˜¯æ€ä¹ˆå­˜å‚¨å’Œæ€ä¹ˆè¯»å–çš„  2.å£°æ˜å¼çš„åŸºäºæ³¨è§£çš„ç¼“å­˜ Springå¯¹äºç¼“å­˜å£°æ˜æä¾›äº†ä¸€ç³»åˆ—çš„javaæ³¨è§£ï¼š\n @Cacheable:è§¦å‘ç¼“å­˜å¡«å…… @CacheEvict:è§¦å‘ç¼“å­˜é‡Šæ”¾ @CachePut:åœ¨ä¸å¹²æ‰°æ–¹æ³•æ‰§è¡Œçš„å‰æä¸‹æ›´æ–°ç¼“å­˜ @Caching:é‡æ–°åˆ†ç»„å¤šä¸ªç¼“å­˜æ“ä½œå¹¶åº”ç”¨åˆ°ä¸€ä¸ªæ–¹æ³•ä¸Š @CacheConfig:åœ¨ç±»ä¸Šé…ç½®ä¸€äº›å…¬ç”¨çš„ç¼“å­˜é…ç½®  2.1 @Cacheableæ³¨è§£ è¿™ä¸ªæ³¨è§£çš„æ˜¯ç”¨æ¥æŒ‡å®šæ–¹æ³•æ˜¯å¯ä»¥ç¼“å­˜çš„\né»˜è®¤å‚æ•°nameæ˜¯ç¼“å­˜çš„åç§°ç”¨æ¥å’Œæ³¨è§£çš„æ–¹æ³•å…³è”ï¼š\n@Cacheable(\u0026quot;books\u0026quot;)\rpublic Book findBook(ISBN isbn) {...}\r åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒfindBookæ–¹æ³•æ˜¯ä¸ç¼“å­˜åç§°booksç›¸å…³è”çš„ã€‚æ¯æ¬¡æ–¹æ³•è°ƒç”¨éƒ½ä¼šæ£€æµ‹è¿™ä¸ªæ–¹æ³•æ˜¯å¦å·²ç»è¿è¡Œè¿‡å¹¶ä¸”ä¸éœ€è¦é‡å¤è°ƒç”¨ã€‚\nè™½ç„¶å¤§å¤šæ•°æƒ…å†µä¸‹ç¼“å­˜åªå£°æ˜ä¸€ä¸ªï¼Œä½†æ˜¯æ³¨è§£æ˜¯å…è®¸å¤šä¸ªåç§°çš„ï¼Œæ„å‘³ç€å¯¹åº”çš„ç¼“å­˜ä¹Ÿæœ‰å¤šä¸ªã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨æ–¹æ³•è°ƒç”¨å‰æ£€æŸ¥æ¯ä¸ªç¼“å­˜ï¼Œå¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªç¼“å­˜å‘½ä¸­ï¼Œé‚£ä»–å…³è”çš„ç¼“å­˜éƒ½ä¼šè¢«è¿”å›ã€‚\n@Cacheable({\u0026quot;books\u0026quot;, \u0026quot;isbns\u0026quot;})\rpublic Book findBook(ISBN isbn) {...}\r 2.1.1 é»˜è®¤ä¸»é”®ç”Ÿæˆ å› ä¸ºç¼“å­˜æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªkey-valueç»“æœçš„å‚¨å­˜ï¼Œå› æ­¤æ¯æ¬¡è°ƒç”¨ä¸€ä¸ªç¼“å­˜æ–¹æ³•ï¼Œéƒ½éœ€è¦å°†å®ƒè½¬ä¸ºä¸€ä¸ªåˆé€‚çš„keyç”¨äºç¼“å­˜è®¿é—®ã€‚\nSpringç”¨çš„KeyGeneratoråŸºäºä¸€ä¸‹ç®—æ³•ï¼š\n å¦‚æœæ²¡æœ‰ç»™å®šå‚æ•°ï¼Œè¿”å›SimpleKey.EMPTY å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›é‚£ä¸ªå®ä¾‹ å¦‚æœè¶…è¿‡ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆè¿”å›SimpleKeyï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰çš„å‚æ•°  è¿™ç§æ–¹æ³•åœ¨å¤§å¤šæ•°ä½¿ç”¨åœºæ™¯éƒ½èƒ½èƒœä»»ï¼Œåªè¦å‚æ•°æœ‰natural keyå¹¶ä¸”å®ç°äº†hashCode()å’Œequals()æ–¹æ³•ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆä½ éœ€è¦æ”¹å˜ç­–ç•¥ã€‚\næä¾›ä¸åŒçš„é»˜è®¤ä¸»é”®ç”Ÿæˆå™¨ï¼Œä½ éœ€è¦å®ç°org.springframework.cache.interceptor.KeyGeneratoræ¥å£\n Spring 4.0.Earlierç‰ˆæœ¬æ”¹å˜äº†é»˜è®¤çš„ä¸»é”®ç”Ÿæˆç­–ç•¥ï¼Œå¦‚æœæœ‰å¤šä¸ªå‚æ•°ï¼Œåªè€ƒè™‘äº†hashCode()æ²¡æœ‰è€ƒè™‘equals()ã€‚è¿™å¯èƒ½é€ æˆä¸»é”®å†²çª(å‚è€ƒSPR-10237)\næ–°çš„SimpleKeyGeneratorä½¿ç”¨äº†å¤åˆçš„ä¸»é”®æ¥åº”å¯¹è¿™ç§åœºæ™¯\nå¦‚æœä½ ä»ç„¶æƒ³ä½¿ç”¨ä¹‹å‰çš„ä¸»é”®ç­–ç•¥ï¼Œä½ å¯ä»¥é…ç½®org.springframework.cache.interceptor.DefaultKeyGeneratorç±»ï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰åŸºäºhashçš„KeyGeneratorå®ç°\n 2.1.2 è‡ªå®šä¹‰ä¸»é”®ç”Ÿæˆç­–ç•¥ å®é™…æƒ…å†µä¸­ï¼Œæ–¹æ³•çš„å¤šä¸ªå‚æ•°å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªéƒ½éœ€è¦ç”¨äºä¸»é”®ç”Ÿæˆï¼Œåƒä¸‹é¢çš„ä¾‹å­:\n@Cacheable(\u0026quot;books\u0026quot;)\rpublic Book findBook(ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r isbnæ˜æ˜¾æ˜¯ç”Ÿæˆä¸»é”®çš„å…³é”®å±æ€§ï¼Œè€Œå¦å¤–ä¸¤ä¸ªbooleanå€¼åº”è¯¥æ˜¯å¯æœ‰å¯æ— \nåœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨@Cacheableçš„å±æ€§keyå€¼æ¥æŒ‡å®šå“ªäº›ç”¨æ¥ç”Ÿæˆä¸»é”®ã€‚ä½ å¯ä»¥ä½¿ç”¨SpELæ¥é€‰æ‹©å‚æ•°ï¼ˆæˆ–è€…æ˜¯ä»–ä»¬çš„åµŒå¥—å±æ€§ï¼‰ï¼Œè¿è¡Œæ“ä½œï¼Œæˆ–è€…æ˜¯è°ƒç”¨ä»»æ„çš„æ–¹æ³•ä¸ç”¨å†™ä»»ä½•çš„ä»£ç æˆ–è€…å®ç°ä»»ä½•çš„æ¥å£ã€‚\néšç€ä»£ç é‡çš„å¢å¤šï¼Œä¹‹å‰çš„é»˜è®¤ä¸»é”®ç”Ÿæˆæ–¹æ³•å¯èƒ½é€‚åˆä¸€éƒ¨åˆ†æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆéš¾é€‚åº”æ‰€æœ‰æ–¹æ³•\nä¸‹é¢çš„ä¾‹å­ä½¿ç”¨ä¸åŒçš„SpELè¡¨è¾¾å¼å£°æ˜ï¼š\n@Cacheable(cacheNames=\u0026quot;books\u0026quot;, key=\u0026quot;#isbn\u0026quot;)\rpublic Book findBook(ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r@Cacheable(cacheNames=\u0026quot;books\u0026quot;, key=\u0026quot;#isbn.rawNumber\u0026quot;)\rpublic Book findBook(ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r@Cacheable(cacheNames=\u0026quot;books\u0026quot;, key=\u0026quot;T(someType).hash(#isbn)\u0026quot;)\rpublic Book findBook(ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r ä¸Šé¢çš„ä¾‹å­å±•ç¤ºäº†é€‰æ‹©æŸä¸ªå‚æ•°ï¼Œæˆ–è€…æŸä¸ªå‚æ•°çš„å±æ€§ï¼Œä»¥åŠä»»æ„ä¸€ä¸ªéšæœºçš„é™æ€æ–¹æ³•\nå¦‚æœè´Ÿè´£ç”Ÿæˆä¸»é”®çš„æ–¹æ³•ååˆ†ç‰¹æ®Šæˆ–è€…ä»–éœ€è¦å…±äº«ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„keyGeneratorã€‚éœ€è¦@Cacheableçš„å±æ€§keyGeneratorï¼Œä»–éœ€è¦ä¸€ä¸ªbean nameä½œä¸ºå‚æ•°ï¼š\n@Cacheable(cacheNames=\u0026quot;books\u0026quot;, keyGenerator=\u0026quot;myKeyGenerator\u0026quot;)\rpublic Book findBook(ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r  keyå’ŒkeyGeneratoråªèƒ½å£°æ˜ä¸€ä¸ªï¼ŒåŒæ—¶å£°æ˜ä¼šè·‘é”™\n 2.1.3 é»˜è®¤ç¼“å­˜è§£æ ç¼“å­˜æŠ½è±¡ç±»ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„CacheResolverï¼Œå®ƒä½¿ç”¨CacheManageræ£€ç´¢æ“ä½œå±‚é¢çš„ç¼“å­˜å®šä¹‰\nå¦‚æœè¦æä¾›å…¶ä»–çš„ç¼“å­˜è§£æå™¨ï¼Œä½ éœ€è¦å®ç°org.springframework.cache.interceptor.CacheResolveræ¥å£\n2.1.4 è‡ªå®šä¹‰ç¼“å­˜è§£æ é»˜è®¤çš„ç¼“å­˜è§£æé€‚ç”¨äºåº”ç”¨åªæœ‰å•ä¸ªCacheManagerå¹¶ä¸”æ²¡æœ‰å¤æ‚çš„ç¼“å­˜è§£æéœ€æ±‚\nå¦‚æœåº”ç”¨æœ‰å¤šä¸ªç¼“å­˜managerï¼Œä½ å¯ä»¥åœ¨æ¯ä¸ªæ“ä½œä¸Šè®¾ç½®cacheManagerï¼š\n@Cacheable(cacheNames=\u0026quot;books\u0026quot;, cacheManager=\u0026quot;anotherCacheManager\u0026quot;) public Book findBook(ISBN isbn) {...}\r ä½ ä¹Ÿå¯ä»¥ç±»ä¼¼çš„æ›¿æ¢CacheResolverï¼š\n@Cacheable(cacheResolver=\u0026quot;runtimeCacheResolver\u0026quot;) public Book findBook(ISBN isbn) {...}\r  ä»Spring 4.1å¼€å§‹ï¼Œä¸å†ç»´æŠ¤valueå±æ€§ï¼Œå› ä¸ºè¿™ä¸ªä¿¡æ¯å¯ä»¥ç”±CacheResolveræ¥æä¾›ï¼Œæ³¨é‡Šçš„å†…å®¹å¦‚ä½•ä¸å†ç”Ÿæ•ˆ\nè·Ÿkeyå’ŒkeyGeneratorç±»ä¼¼ï¼ŒcacheManagerå’ŒcacheResolverä¹Ÿæ˜¯ç›¸äº’æ’æ–¥çš„ã€‚\nåŸå› æ˜¯è‡ªå®šä¹‰çš„CacheManageræ˜¯è¢«CacheResolverçš„å®ç°æ‰€å¿½ç•¥çš„\n 2.1.5 åŒæ­¥çš„ç¼“å­˜ åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒï¼ŒæŸä¸€ä¸ªæ“ä½œå¯èƒ½è¢«åŒæ ·çš„å‚æ•°å¹¶å‘è°ƒç”¨ã€‚é»˜è®¤æƒ…å†µï¼Œç¼“å­˜æŠ½è±¡ç±»æ²¡æœ‰ä»»ä½•é”ï¼Œå¯èƒ½é€ æˆåŒæ ·çš„å€¼è¢«è®¡ç®—å¾ˆå¤šæ¬¡ï¼Œè¿™è¿èƒŒäº†ç¼“å­˜çš„åˆè¡·\nåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨syncå±æ€§å»å‘½ä»¤ç¼“å­˜æä¾›è€…åœ¨å€¼è®¡ç®—å®Œæ¯•åå¯¹ç¼“å­˜é”®å€¼ä¸Šé”ã€‚ç›®çš„æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è®¡ç®—ç»“æœï¼Œå…¶ä»–çš„éœ€è¦é˜»å¡ç›´åˆ°é”®å€¼å·²ç»æ›´æ–°å®Œæ¯•\n@Cacheable(cacheNames=\u0026quot;foos\u0026quot;, sync=true) public Foo executeExpensiveOperation(String id) {...}\r  è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„ç‰¹æ€§ï¼Œæœ‰å¯èƒ½ä½ ä½¿ç”¨çš„ç¼“å­˜æä¾›æ–¹ä¸æ”¯æŒå®ƒã€‚ç›®å‰æ ¸å¿ƒæ¡†æ¶å®ç°çš„æ‰€æœ‰CacheManageréƒ½æ”¯æŒä»–ã€‚æ›´å¤šä¿¡æ¯éœ€è¦å‚è€ƒæä¾›æ–¹çš„æ–‡æ¡£ã€‚\n 2.1.6 æœ‰æ¡ä»¶çš„ç¼“å­˜ æœ‰æ—¶å€™ï¼Œæ–¹æ³•å¹¶ä¸æ˜¯ä»»ä½•æ—¶å€™éƒ½éœ€è¦ç¼“å­˜(æ¯”å¦‚åœ¨æŸä¸ªç‰¹å®šçš„å‚æ•°å€¼æ‰ç¼“å­˜)ã€‚conditionå‚æ•°å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»–éœ€è¦ä¸€ä¸ªSpELè¡¨è¾¾å¼ï¼Œè¿™ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ˜¯trueæˆ–è€…falseï¼Œä»£è¡¨å¼€å¯ç¼“å­˜\nä¸‹é¢è¿™ä¸ªä¾‹å­ä»£è¡¨åªæœ‰æ–¹æ³•å‚æ•°nameé•¿åº¦å°äº32æ—¶æ‰å¯ç”¨ç¼“å­˜\n@Cacheable(cacheNames=\u0026quot;book\u0026quot;, condition=\u0026quot;#name.length() \u0026lt; 32\u0026quot;) public Book findBook(String name)\r é™¤äº†conditionï¼Œä½ è¿˜å¯ä»¥æŒ‡å®šunlesså‚æ•°å»é˜»æ­¢ç¼“å­˜ã€‚ä¸åƒconditionï¼Œunlessè¡¨è¾¾å¼æ˜¯åœ¨æ–¹æ³•è¢«è°ƒç”¨åæ‰è®¡ç®—ã€‚\nç°åœ¨æ‰©å±•ä¹‹å‰çš„ä¾‹å­ï¼Œä¹Ÿè®¸æˆ‘ä»¬æƒ³ç¼“å­˜ç®€è£…ç‰ˆçš„ä¹¦ç±ï¼Œè€Œä¸æ˜¯ç²¾è£…ç‰ˆï¼š\n@Cacheable(cacheNames=\u0026quot;book\u0026quot;, condition=\u0026quot;#name.length() \u0026lt; 32\u0026quot;, unless=\u0026quot;#result.hardback\u0026quot;)\rpublic Book findBook(String name)\r ç¼“å­˜æŠ½è±¡ç±»æ˜¯æ”¯æŒjava.util.Optionalçš„ï¼Œä»…å½“å…¶å€¼å­˜åœ¨æ—¶æ‰å°†ä»–çš„å†…å®¹ä½œä¸ºç¼“å­˜ã€‚#resultå§‹ç»ˆæ˜¯æŒ‡ä¸šåŠ¡å®ä½“ï¼Œä¸ä¼šæ˜¯ä»–çš„å°è£…ã€‚æ‰€ä»¥ä¹‹å‰çš„ä¾‹å­è¿˜å¯ä»¥è¿›ä¸€æ­¥é‡å†™ï¼š\n@Cacheable(cacheNames=\u0026quot;book\u0026quot;, condition=\u0026quot;#name.length() \u0026lt; 32\u0026quot;, unless=\u0026quot;#result?.hardback\u0026quot;)\rpublic Optional\u0026lt;Book\u0026gt; findBook(String name)\r æ³¨æ„resultä»ç„¶æŒ‡Bookè€Œä¸æ˜¯Optionalã€‚å› ä¸ºä»–å¯èƒ½ä¸ºnullï¼Œåº”è¯¥ä½¿ç”¨safe navigationæ“ä½œç¬¦\n2.1.7 ç¼“å­˜SpELä¸­å¯ç”¨çš„ä¸Šä¸‹æ–‡å‚æ•° æ¯ä¸ªSpELè¡¨è¾¾å¼éƒ½æ ¹æ®ä¸€ä¸ªä¸“é—¨çš„contextå¯¹è±¡æ¥è®¡ç®—ã€‚è¿™ä¸ªcontextåŒ…å«ä¸€äº›é»˜è®¤çš„å‚æ•°ï¼Œå¯ä»¥ç”¨æ¥è®¡ç®—ä¸»é”®æˆ–è€…è¿è¡Œæ¡ä»¶ï¼Œå‚ç…§ä¸‹è¡¨ï¼š\n   åç§° ä½ç½® æè¿° ä¾‹å­     methodName Root object è¢«è°ƒç”¨çš„æ–¹æ³•åç§° #root.methodName   method Root object è¢«è°ƒç”¨çš„æ–¹æ³• #root.method.name   target Root obejct è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡ #root.target   targetClass Root object è¢«è°ƒç”¨çš„ç›®æ ‡ç±» #root.targetClass   args Root object è¢«è°ƒç”¨æ–¹æ³•çš„å‚æ•°ï¼ˆæ•°ç»„ï¼‰ #root.args[0]   caches Root object å½“å‰è¿è¡Œæ–¹æ³•çš„ç¼“å­˜é›†åˆ #root.cache[0].name   å‚æ•°å Evaluation context ä»»ä½•æ–¹æ³•çš„å‚æ•°åç§°ã€‚å¦‚æœåç§°ä¸å¯ç”¨(ä¹Ÿè®¸æ˜¯å› ä¸ºæ²¡æœ‰debugä¿¡æ¯)ï¼Œå¯ä»¥ä½¿ç”¨#a\u0026lt;#arg\u0026gt;ï¼Œå…¶ä¸­#argä»£è¡¨å‚æ•°çš„ä¸‹æ ‡(ä»0å¼€å§‹) #ibanæˆ–è€…#a0ï¼ˆä½ ä¹Ÿå¯ä»¥ç”¨#p0æˆ–è€…#p\u0026lt;#arg\u0026gt;ä½œä¸ºåˆ«åï¼‰   result Evaluation context æ–¹æ³•è°ƒç”¨çš„ç»“æœï¼ˆæ‹¿æ¥ç¼“å­˜çš„å€¼ï¼‰ã€‚åªåœ¨unlessè¡¨è¾¾å¼ï¼Œcache putè¡¨è¾¾å¼ï¼ˆç”¨äºè®¡ç®—ä¸»é”®çš„ï¼‰ï¼Œæˆ–è€…cache evictè¡¨è¾¾å¼ï¼ˆbeforeInvacationçš„å€¼æ˜¯falseï¼‰æ—¶å¯ç”¨ã€‚ä¸ºäº†æ”¯æŒåŒ…è£…ç±»ï¼ˆæ¯”å¦‚Optional)ï¼Œ#resultæŒ‡ä»£çš„å®ä½“å¯¹è±¡ï¼Œä¸æ˜¯åŒ…è£…å¯¹è±¡ #result    2.2 CachePutæ³¨è§£ å½“ç¼“å­˜éœ€è¦æ›´æ–°å¹¶ä¸”ä¸å¸Œæœ›å¹²æ‰°æ–¹æ³•çš„æ‰§è¡Œæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨CachePutæ³¨è§£ã€‚ä¹Ÿå°±æ˜¯è¯¥æ–¹æ³•ä»»ä½•æ—¶å€™éƒ½ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”å®ƒçš„ç»“æœå°†ä¼šæ”¾åˆ°ç¼“å­˜ä¸­ï¼ˆå…·ä½“å‚ç…§æ³¨è§£å‚æ•°é…ç½®ï¼‰ã€‚å®ƒä¹Ÿæ”¯æŒ@Cacheableæ³¨è§£æ”¯æŒçš„å‚æ•°ï¼Œå®ƒåº”è¯¥åº”ç”¨äºç¼“å­˜å¡«å……è€Œä¸æ˜¯æ–¹æ³•æµä¼˜åŒ–ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ä¾‹å­ï¼š\n@CachePut(cacheNames=\u0026quot;book\u0026quot;, key=\u0026quot;#isbn\u0026quot;)\rpublic Book updateBook(ISBN isbn, BookDescriptor descriptor)\r  å¼ºçƒˆä¸æ¨èåœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸Šä½¿ç”¨CachePutå’ŒCacheableã€‚Cacheableä¼šåœ¨æ£€æŸ¥åˆ°æ–¹æ³•æœ‰ç¼“å­˜çš„æ—¶å€™è·³è¿‡æ‰§è¡Œï¼ŒCachePutä¸ºäº†æ›´æ–°ç¼“å­˜å¼ºåˆ¶æ‰§è¡Œè°ƒç”¨ã€‚åŒæ—¶å£°æ˜ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„æ“ä½œï¼ˆé™¤éæç«¯æƒ…å†µï¼Œæ¯”å¦‚ä¸¤ä¸ªæ³¨è§£çš„å‚æ•°äº’ç›¸æ’é™¤äº†å¯¹æ–¹ï¼‰ï¼Œæ‰€ä»¥å°½é‡é¿å…è¿™ä¹ˆå£°æ˜\n 2.3 CacheEvictæ³¨è§£ é™¤äº†ç¼“å­˜å¡«å……ï¼ŒSpringä¹Ÿæä¾›äº†ç¼“å­˜é‡Šæ”¾æ³¨è§£@CacheEvictã€‚è·Ÿ@Cacheableæ³¨è§£ç±»ä¼¼ï¼Œ@CacheEvictä¹Ÿéœ€è¦æŒ‡å®šå½±å“çš„ç¼“å­˜ï¼ˆä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼‰ï¼Œå…è®¸è‡ªå®šä¹‰ç¼“å­˜å’Œä¸»é”®çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒæ ·ä¹Ÿå¯ä»¥æŒ‡å®šç”Ÿæ•ˆæ¡ä»¶ã€‚é™¤äº†è¿™äº›è·ŸCacheableä¸€æ ·çš„ç‰¹æ€§ï¼ŒCacheEvictè¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„å‚æ•°allEntriesï¼Œå®ƒä»£è¡¨æ˜¯å¦æ‰§è¡Œæ•´ä¸ªç¼“å­˜èŒƒå›´çš„é‡Šæ”¾ï¼Œè€Œä¸æ˜¯ä»…ä»…ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆåŸºäºä¸»é”®ï¼‰\n@CacheEvict(cacheNames=\u0026quot;books\u0026quot;, allEntries=true) public void loadBooks(InputStream batch)\r è¿™ä¸ªé€‰é¡¹åœ¨éœ€è¦æ¸…ç©ºæ•´ä¸ªç¼“å­˜åŒºåŸŸæ—¶éå¸¸æœ‰ç”¨ï¼Œå¦‚æœå•ç‹¬çš„æ¸…é™¤æ¯ä¸ªé”®å€¼å¯¹ï¼Œé‚£å°†è€—è´¹å¤§é‡æ—¶é—´ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¸€ä¸ªæ“ä½œå°±å¯ä»¥æ¸…ç©ºæ‰€æœ‰çš„é”®å€¼å¯¹ã€‚æ³¨æ„åœ¨è¿™ä¸ªåœºæ™¯ä½ æŒ‡å®šçš„ä¸»é”®æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚\nä½ ä¹Ÿå¯ä»¥æŒ‡å®šé‡Šæ”¾æ“ä½œåœ¨æ–¹æ³•è°ƒç”¨åï¼ˆé»˜è®¤ï¼‰æˆ–è€…è°ƒç”¨å‰æ‰§è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯è°ƒç”¨åæ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡å±æ€§beforeInvcationæ¥æŒ‡å®šè°ƒç”¨å‰æ‰§è¡Œï¼Œè¿™æ ·æ–¹æ³•æ˜¯å¦è¿è¡Œå®Œéƒ½ä¸ä¼šå½±å“åˆ°é‡Šæ”¾æ“ä½œ\næ³¨æ„@CacheEvictå¯ä»¥åœ¨voidæ–¹æ³•ä¸Šä½¿ç”¨ï¼Œæ–¹æ³•ç›¸å½“äºä¸€ä¸ªè§¦å‘å™¨ï¼Œè¿”å›ç»“æœå°†ä¼šè¢«å¿½ç•¥ã€‚\n2.4 @Cachingæ³¨è§£ æœ‰äº›æ—¶å€™ï¼Œç›¸åŒç±»å‹çš„å¤šä¸ªæ³¨è§£ï¼ˆæ¯”å¦‚@CacheEvictæˆ–è€…@CachePutï¼‰éœ€è¦æŒ‡å®šåœ¨ä¸€ä¸ªæ–¹æ³•ä¸Šâ€”â€”ä¾‹å¦‚ï¼Œå› ä¸ºæ¡ä»¶ä¸åŒæˆ–è€…ä¸»é”®è¡¨è¾¾å¼ä¸åŒçš„ä¸¤ä¸ªä¸åŒçš„ç¼“å­˜ã€‚@Cachingæ³¨è§£å¯ä»¥è®©å¤šä¸ª@Cacheable,@CachePut,å’Œ@CacheEvictæ³¨è§£é›†æˆç”¨åœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸Šã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ç”¨äº†ä¸¤ä¸ª@CacheEvictæ³¨è§£ï¼š\n@Caching(evict = {@CacheEvict(\u0026quot;primary\u0026quot;),@CacheEvict(cacheNames=\u0026quot;secondary\u0026quot;,key=\u0026quot;#p0\u0026quot;)})\rpublic Book importBooks(String deposit, Date date)\r 2.5 @CacheConfigæ³¨è§£ å½“ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºçš„ç¼“å­˜æ“ä½œæä¾›äº†å¾ˆå¤šçš„è‡ªå®šä¹‰é€‰é¡¹ã€‚ä½†æ˜¯æœ‰äº›é€‰é¡¹æ˜¯é€šç”¨çš„ï¼Œå¦‚æœæ–¹æ³•é‡Œçš„æ‰€æœ‰æ“ä½œéƒ½éœ€è¦é…ç½®è¿™ä¸ªé€‰é¡¹ï¼Œå¹¶ä¸”è¿˜æ˜¯ç›¸åŒçš„å€¼ï¼Œé‚£ä¹ˆå°±å¤ªéº»çƒ¦äº†ã€‚æ‰€ä»¥Springæä¾›äº†@CacheConfigæ³¨è§£ï¼Œè¿™æ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ï¼Œå¯ä»¥ç”¨å®ƒæ¥æŒ‡å®šä¸€äº›å…±ç”¨çš„é€‰é¡¹ä¿¡æ¯ã€‚ ä¸‹é¢çš„ä¾‹å­ç”¨@CacheConfigæŒ‡å®šäº†è¯¥ç±»æ‰€æœ‰ç¼“å­˜æ“ä½œçš„ç¼“å­˜åç§°\n@CacheConfig(\u0026quot;books\u0026quot;) public class BookRepositoryImpl implements BookRepository {\r@Cacheable\rpublic Book findBook(ISBN isbn) {...}\r}\r @CacheConfigæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£å¯ä»¥åˆ†äº«çš„é€‰é¡¹æœ‰ï¼šç¼“å­˜åç§°ã€è‡ªå®šä¹‰KeyGeneratorã€è‡ªå®šä¹‰CacheManagerã€ä»¥åŠè‡ªå®šä¹‰CacheResolverã€‚æŠŠè¿™ä¸ªæ³¨è§£æ”¾åœ¨ç±»ä¸Šåªæ˜¯å…±äº«é…ç½®ï¼Œå¹¶ä¸ä¼šæ‰“å¼€ä»»ä½•ç¼“å­˜æ“ä½œã€‚\nä¸€ä¸ªæ“ä½œçº§åˆ«çš„è‡ªå®šä¹‰å‚æ•°å§‹ç»ˆå¯ä»¥è¦†ç›–åœ¨@CacheConfigä¸Šçš„é…ç½®ã€‚ç¼“å­˜è‡ªå®šä¹‰é€‰é¡¹æœ‰ä¸‰ä¸ªçº§åˆ«ï¼š\n å…¨å±€é…ç½®ï¼Œå¯¹CacheManager,KeyGeneratorç”Ÿæ•ˆã€‚ ç±»çº§åˆ«ï¼Œç”¨CacheConfigã€‚ æ“ä½œçº§åˆ«é…ç½®  2.6 è®©ç¼“å­˜æ³¨è§£ç”Ÿæ•ˆ æƒ³è®¸å¤šSpringç‰¹æ€§ä¸€æ ·ï¼Œç¼“å­˜æ³¨è§£ä¸æ˜¯è‡ªåŠ¨è§¦å‘çš„ï¼Œä»–ä»¬éœ€è¦ä¸€ä¸ªæœ‰æ•ˆå£°æ˜ï¼ˆå½“ä½ å‘è§‰é—®é¢˜æœ‰å¯èƒ½æ˜¯ç¼“å­˜å¸¦æ¥çš„ï¼Œä½ å¯ä»¥åªç§»é™¤ä¸€è¡Œé…ç½®è¡Œï¼Œè€Œä¸æ˜¯ä½ ä»£ç é‡Œé¢çš„æ‰€æœ‰æ³¨è§£ï¼‰\nè®©ç¼“å­˜æ³¨è§£ç”Ÿæ•ˆå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ä»»æ„ä¸€ä¸ª@Configurationç±»ä¸ŠåŠ æ³¨è§£@EnableCaching\n@Configuration\r@EnableCaching\rpublic class AppConfig {\r}\r æˆ–è€…ï¼Œé€šè¿‡xmlé…ç½®ï¼Œä½ å¯ä»¥ä½¿ç”¨cache:annotation-driven\n\u0026lt;beans xmlns=\u0026quot;http://www.springframework.org/schema/beans\u0026quot;\rxmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxmlns:cache=\u0026quot;http://www.springframework.org/schema/cache\u0026quot;\rxsi:schemaLocation=\u0026quot;\rhttp://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd\rhttp://www.springframework.org/schema/cache https://www.springframework.org/schema/cache/spring-cache.xsd\u0026quot;\u0026gt;\r\u0026lt;cache:annotation-driven/\u0026gt;\r\u0026lt;/beans\u0026gt;\r ä¸Šé¢ä¸¤ç§æ–¹å¼éƒ½æœ‰å¤§é‡é…ç½®é¡¹å¯ä»¥è°ƒæ•´ï¼Œä»–ä»¬é€šè¿‡aopå®é™…çš„å½±å“ç¼“å­˜è¡Œä¸ºã€‚è¿™äº›é…ç½®é¡¹è·Ÿ@Transactional ç›¸ä¼¼\n é»˜è®¤å¤„ç†ç¼“å­˜æ³¨è§£çš„æ–¹å¼æ˜¯é€šè¿‡ä»£ç†å®ç°çš„ï¼Œä»–åªä¼šæ‹¦æˆªé€šè¿‡ä»£ç†çš„è°ƒç”¨ã€‚å› æ­¤åœ¨åŒä¸€ä¸ªç±»çš„æœ¬åœ°è°ƒç”¨ï¼Œæ˜¯æ— æ³•è¢«æ‹¦æˆªåˆ°çš„ï¼ˆå…·ä½“å‚ç…§Spring AOP).å¦‚æœéœ€è¦å…¶ä»–çš„æ‹¦æˆªæ¨¡å¼ï¼Œè€ƒè™‘åˆ‡æ¢åˆ°aspectjæ¨¡å¼ç»“åˆç¼–è¯‘æ—¶æˆ–è€…åŠ è½½æ—¶çš„weavingã€‚\n  æ›´å¤šè‡ªå®šä¹‰é…ç½®å¯ä»¥å®ç°CachingConfigurerï¼Œå‚è€ƒjavadoc\n è‡ªå®šä¹‰ç¼“å­˜é…ç½®é¡¹ï¼š\n   xmlå±æ€§ æ³¨è§£å±æ€§ é»˜è®¤å€¼ æè¿°     cache-manager å‚ç…§CachingConfigurer æ–‡æ¡£ cacheManager æŒ‡ä»£ç¼“å­˜ç®¡ç†å™¨ä½¿ç”¨çš„åç§°ã€‚é»˜è®¤çš„ç¼“å­˜ç®¡ç†å™¨æˆ–è€…æ²¡æœ‰è®¾ç½®cahcheMnagerï¼Œåœ¨ä»–çš„åå°ä¼šåˆå§‹åŒ–ä¸€ä¸ªé»˜è®¤çš„CacheResolverã€‚å¦‚æœä½ éœ€è¦å¯¹ç¼“å­˜è§£ææ›´ç»†ç²’åº¦çš„ç®¡ç†ï¼Œè€ƒè™‘è®¾ç½®cache-resolverå±æ€§   cache-resolver å‚ç…§CachingConfigurer æ–‡æ¡£ SimpleCacheResolverï¼Œç¼“å­˜ç®¡ç†ä½¿ç”¨çš„é»˜è®¤cacheManger ç¼“å­˜è§£æå™¨çš„bean nameï¼Œç¼“å­˜è§£æå™¨æ˜¯ç¼“å­˜çš„åº•å±‚å®ç°ã€‚è¿™ä¸ªå±æ€§ä¸æ˜¯å¿…é¡»çš„ï¼Œä»…å½“éœ€è¦æ›¿ä»£cache-managerå±æ€§æ—¶æ‰æŒ‡å®š   key-generator å‚ç…§CachingConfigurer æ–‡æ¡£ SimpleKeyGenerator è‡ªå®šä¹‰ä¸»é”®ç”Ÿæˆå™¨çš„åç§°   error-handler å‚ç…§CachingConfigurer æ–‡æ¡£ SimpleCacheErrorHandler è‡ªå®šä¹‰ç¼“å­˜é”™è¯¯å¤„ç†å™¨çš„åç§°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç¼“å­˜ç›¸å…³æ“ä½œæŠ›å‡ºçš„å¼‚å¸¸ä¼šç›´æ¥æŠ›ç»™è°ƒç”¨æ–¹   mode mode proxy é»˜è®¤proxyæ¨¡å¼ä»£è¡¨æ³¨è§£ä¼šé€šè¿‡Spring AOPæ¡†æ¶å¤„ç†ï¼Œç”ŸæˆåŸç±»çš„ä»£ç†ç±»ã€‚å¯é€‰æ‹©çš„æ›¿ä»£å‚æ•°æ˜¯aspectj   proxy-target-class proxyTargetClass false åªåœ¨modeå€¼æ˜¯proxyæ—¶ç”Ÿæ•ˆã€‚æ§åˆ¶ä¸ºç¼“å­˜ç±»ç”Ÿæˆä»€ä¹ˆç±»å‹çš„ç¼“å­˜ä»£ç†ã€‚å¦‚æœå±æ€§æ˜¯trueï¼Œä»¥ç±»ä¸ºåŸºç¡€çš„ä»£ç†å°†ä¼šè¢«åˆ›å»ºã€‚å¦‚æœå±æ€§æ˜¯falseæˆ–è€…å±æ€§æ²¡æœ‰æ‰‹åŠ¨é…ç½®ï¼Œæ ‡å‡†çš„JDKæ¥å£ä»£ç†ä¼šè¢«åˆ›å»ºï¼ˆä¸¤è€…çš„å…·ä½“å·®è·å¯ä»¥å‚è€ƒä»£ç†æœºåˆ¶ )   order order Ordered.LOWEST_PRECEDENCE å½“å‰ç±»é‡Œçš„ç¼“å­˜åˆ‡é¢é€»è¾‘çš„æ‰§è¡Œä¼˜å…ˆæƒï¼Œå…·ä½“å‚è€ƒAOPæ‰§è¡Œé¡ºåº     ç¼“å­˜æ³¨è§£çš„æ–¹æ³•å¯è§æ€§ å½“ä½ ä½¿ç”¨proxy modeï¼Œä½ åº”è¯¥å°†ä½ çš„ç¼“å­˜æ³¨è§£æ”¾åˆ°publicæ–¹æ³•ä¸Šã€‚å¦‚æœæ”¾åˆ°è¯¸å¦‚protected,private,æˆ–è€… packageå¯è§çš„æ–¹æ³•ä¸Šï¼Œè™½ç„¶æ²¡æœ‰å¼‚å¸¸æç¤ºï¼Œä½†æ˜¯ä½ çš„æ³¨è§£å°†ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚å¦‚æœæœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨AspectJ\n  Springæ¨èå°†ç¼“å­˜æ³¨è§£æ”¾åˆ°å®ç°ç±»ä¸Šï¼Œè€Œä¸æ˜¯æ¥å£ä¸Šã€‚ä½ å½“ç„¶å¯ä»¥å§ç¼“å­˜æ³¨è§£æ”¾åˆ°æ¥å£ä¸Šæˆ–è€…æ¥å£çš„æ–¹æ³•ä¸Šï¼Œä½†æ˜¯å‰ææ˜¯proxy-target-classçš„å€¼å¿…é¡»æ˜¯falseã€‚å¦‚æœproxy-target-classå€¼æ˜¯trueæˆ–è€…mode=\u0026quot;aspectjï¼Œç¼“å­˜é…ç½®å°†æ²¡æœ‰ä»»ä½•æ•ˆæœ\n  åœ¨proxy mode(é»˜è®¤æƒ…å†µ)ï¼Œåªæœ‰å¤–éƒ¨çš„æ–¹æ³•è°ƒç”¨ä¼šè¢«æ‹¦æˆªå¹¶å¤„ç†ã€‚å†…éƒ¨çš„è°ƒç”¨ï¼ŒæŒ‡ç±»å†…éƒ¨çš„æ–¹æ³•æ‰äº†åŒç±»ä¸‹çš„å¦ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™æ ·çš„è°ƒç”¨å°±ç®—æ–¹æ³•æœ‰ç¼“å­˜æ³¨è§£ä¹Ÿä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚è¿™æ ·çš„æƒ…å†µè¯·è€ƒè™‘ä½¿ç”¨aspectjmodeã€‚å¦å¤–ï¼Œå¿…é¡»å®Œå…¨åˆå§‹åŒ–ä»£ç†æ‰èƒ½æä¾›é¢„æœŸçš„æ”¯æŒï¼Œæ‰€ä»¥ä¸åº”è¯¥åœ¨åˆå§‹åŒ–ä»£ç ä¸­ï¼ˆ@PostConstructï¼‰ä½¿ç”¨ç¼“å­˜æ³¨è§£\n 2.7 ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£  è‡ªå®šä¹‰æ³¨è§£å’ŒAspectJ\nè¿™ä¸ªç‰¹æ€§åªèƒ½åœ¨åŸºäºä»£ç†çš„æ–¹æ³•ä¸Šä½¿ç”¨ï¼Œéä»£ç†æ–¹æ³•éœ€è¦ä½¿ç”¨AspectJ\nspring-aspectsé¡¹ç›®æ¨¡å—åªå®šä¹‰äº†æ ‡å‡†æ³¨è§£çš„åˆ‡é¢ã€‚å¦‚æœä½ å®šä¹‰äº†ä½ è‡ªå·±çš„æ³¨è§£ï¼Œä½ éœ€è¦ä¸ºå®ƒå®šä¹‰å¯¹åº”çš„åˆ‡é¢ç±»ã€‚AnnotationCacheAspectç±»å°±æ˜¯ä¸€ä¸ªä¾‹å­\n Springå¯ä»¥è®©ä½ ç”¨è‡ªå®šä¹‰æ³¨è§£å»ç”³æ˜ä»€ä¹ˆæ–¹æ³•è§¦å‘ç¼“å­˜å¡«å……å’Œé‡Šæ”¾ã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ¨¡æ¿æœºåˆ¶ï¼Œå› ä¸ºä»–å¯ä»¥é¿å…ç¼“å­˜æ³¨è§£çš„é‡å¤å£°æ˜ï¼Œç‰¹åˆ«æ˜¯æŒ‡å®šäº†ä¸»é”®å’Œæ¡ä»¶ï¼Œæˆ–è€…ä»£ç åº“ä¸å…è®¸å¤–éƒ¨å¯¼å…¥(org.springframework)æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚è·Ÿå…¶ä½™çš„æ¨¡æ¿æ³¨è§£ç›¸åŒï¼Œä½ å¯ä»¥ä½¿ç”¨@Cacheableï¼Œ@CachePutï¼Œ@CacheEvictï¼Œå’Œ@CacheConfigä½œä¸ºå…ƒæ³¨è§£ï¼ˆæ„æ€å°±æ˜¯ï¼Œèƒ½å¤Ÿåœ¨å…¶ä»–æ³¨è§£ä¸Šå£°æ˜æ³¨è§£ï¼‰\nä¸‹é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ›¿æ¢ä¸€ä¸ªå…¬ç”¨å¾—é—®@Cacheableæ³¨è§£ä¸ºæˆ‘ä»¬çš„è‡ªå®šä¹‰æ³¨è§£:\n@Retention(RetentionPolicy.RUNTIME)\r@Target(ElementType.METHOD)\r@Cacheable(cacheNames=\u0026quot;books\u0026quot;,key=\u0026quot;#isbn\u0026quot;)\rpublic @interface SlowService{\r}\r ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å®šä¹‰äº†è‡ªå·±çš„SlowServiceæ³¨è§£ï¼Œä»–è¢«@Cacheableæ³¨è§£ä¿®é¥°ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ›¿æ¢æ‰ä¸‹é¢çš„ä»£ç \n@Cacheable(cacheNames=\u0026quot;books\u0026quot;, key=\u0026quot;#isbn\u0026quot;)\rpublic Book findBook(ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r é‚£å¦‚æœç”¨æˆ‘ä»¬ç”³æ˜çš„è‡ªå®šä¹‰æ³¨è§£ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å†™ä¸ºï¼š\n@SlowService\rpublic Book findBook(ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r å³ä½¿@SlowServiceä¸æ˜¯Springæ³¨è§£ï¼Œåœ¨è¿è¡Œæ—¶å®¹å™¨ä¹Ÿèƒ½è‡ªåŠ¨è·å–ä»–çš„å£°æ˜ã€‚æ³¨æ„ï¼Œå¦‚å‰æ‰€è¿°ï¼Œéœ€è¦å¯ç”¨æ³¨è§£é©±åŠ¨ã€‚\n3.JCache(JSR-107)æ³¨è§£ ä»4.1ç‰ˆæœ¬å¼€å§‹ï¼ŒSpringç¼“å­˜å…¨é¢æ”¯æŒJCacheæ ‡å‡†æ³¨è§£ï¼š@CacheResult,@CachePut,@CacheRemove,å’Œ@CacheRemoveAllä»¥åŠ@CacheDefaults,@CacheKey,å’Œ@CacheValueé…åˆã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™äº›æ³¨è§£å³ä½¿æ²¡æœ‰æŠŠç¼“å­˜å­˜å‚¨åˆ°JSR-107ä¸Šã€‚å†…éƒ¨å®ç°ä½¿ç”¨äº†Springçš„ç¼“å­˜æŠ½è±¡ç±»ï¼Œå¹¶æä¾›äº†é»˜è®¤çš„ç¬¦åˆè§„èŒƒçš„CacheResolverå’ŒKeyGeneratorå®ç°ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ å·²ç»ä½¿ç”¨äº†Springçš„ç¼“å­˜æŠ½è±¡ï¼Œä½ å¯ä»¥åˆ‡æ¢åˆ°è¿™äº›æ ‡å‡†æ³¨è§£å¹¶ä¸”ä¸éœ€è¦æ”¹å˜ä½ çš„ç¼“å­˜å­˜å‚¨ï¼ˆæˆ–è€…é…ç½®ï¼‰ã€‚\n3.1 ç‰¹å¾æ€»ç»“ ä¸‹é¢æ˜¯Springç¼“å­˜æ³¨è§£å’Œå¯¹åº”çš„JSR-107æ³¨è§£çš„åŒºåˆ«ï¼š\n   Spring JSR-107 å¤‡æ³¨     @Cacheable @CacheResult åŸºæœ¬ç›¸åŒï¼Œ@CacheResultå¯ä»¥ç¼“å­˜æŒ‡å®šçš„å¼‚å¸¸è¿˜èƒ½å¼ºåˆ¶æ‰§è¡Œæ–¹æ³•ä¸ç®¡ç¼“å­˜çš„å†…å®¹   @CachePut @CachePut å½“Springç”¨æ–¹æ³•è°ƒç”¨çš„ç»“æœæ›´æ–°ç¼“å­˜æ—¶ï¼ŒJCacheéœ€è¦å°†å®ƒå½“åšä¸€ä¸ªå‚æ•°(@CacheValueæ³¨è§£ä¿®é¥°)ä¼ é€’ã€‚å› ä¸ºè¿™ä¸ªä¸åŒï¼ŒJCacheæ˜¯å…è®¸åœ¨å®é™…æ–¹æ³•æ‰§è¡Œå‰æˆ–è€…æ‰§è¡Œåæ›´æ–°ç¼“å­˜çš„   @CacheEvict @CacheRemove åŸºæœ¬ç›¸åŒã€‚@CacheRemoveæ”¯æŒæ–¹æ³•è°ƒç”¨å¼‚å¸¸æ—¶æ¡ä»¶é‡Šæ”¾   @CacheEvict(allEntries=true) @CacheRemoveAll å‚ç…§@CacheRemove   @CacheConfig @CacheDefaults æå–ç›¸åŒçš„é…ç½®ï¼Œç›¸ä¼¼çš„é£æ ¼    JCacheä¹Ÿæœ‰CacheResolveræ¦‚å¿µï¼šjavax.cache.annotation.CacheResolverï¼Œè·ŸSpringçš„CacheResolveræ¥å£æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œé™¤äº†JCacheåªæ”¯æŒä¸€ç§ç¼“å­˜å¤–ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç®€å•çš„å®ç°æ ¹æ®æ³¨è§£ä¸­å£°æ˜çš„åç§°å»æ£€ç´¢è¦ä½¿ç”¨çš„ç¼“å­˜ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜åç§°æŒ‡å®šï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„ã€‚@CacheResult#cacheName()apiæ–‡æ¡£æœ‰æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚\nCacheResolverå®ä¾‹æ˜¯é€šè¿‡CacheResolverFactoryæ¥æ£€ç´¢çš„ã€‚å¯ä»¥ä¸ºæ¯ä¸ªç¼“å­˜æ“ä½œè‡ªå®šä¹‰factoryï¼š\n@CacheResult(cacheNames=\u0026quot;books\u0026quot;, cacheResolverFactory=MyCacheResolverFactory.class) public Book findBook(ISBN isbn)\r  å¯¹äºæ‰€æœ‰å¼•ç”¨çš„ç±»ï¼ŒSpringä¼šæ ¹æ®æŒ‡å®šç±»å‹å°è¯•å»å®šä½ä¸€ä¸ªbeanã€‚å¦‚æœå¤šä¸ªåŒ¹é…é¡¹å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å®ä¾‹ä¼šè¢«åˆ›å»ºï¼Œå¹¶ä¸”ä½¿ç”¨å¸¸è§„beanç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œå°±åƒä¾èµ–æ³¨å…¥ä¸€æ ·ã€‚\n è·ŸSpringçš„KeyGeneratorç›®çš„ä¸€æ ·ï¼Œjavax.cache.annotation.CacheKeyGeneratorè¢«ç”¨æ¥ç”Ÿæˆä¸»é”®ã€‚é»˜è®¤æƒ…å†µï¼Œæ–¹æ³•çš„æ‰€æœ‰å‚æ•°éƒ½è¢«è€ƒè™‘åœ¨å†…ï¼Œé™¤éè‡³å°‘ä¸€ä¸ªå‚æ•°è¢«@CacheKeyæ³¨è§£ä¿®é¥°ã€‚è¿™ä¸ªSpringçš„è‡ªå®šä¹‰ä¸»é”®ç”Ÿæˆéå¸¸ç›¸ä¼¼ã€‚ä¸‹é¢çš„ä¾‹å­å°±æ˜¯è·ŸSpringçš„ä¸€ä¸ªå¯¹æ¯”ï¼š\n@Cacheable(cacheNames=\u0026quot;books\u0026quot;, key=\u0026quot;#isbn\u0026quot;)\rpublic Book findBook(ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r@CacheResult(cacheName=\u0026quot;books\u0026quot;)\rpublic Book findBook(@CacheKey ISBN isbn, boolean checkWarehouse, boolean includeUsed)\r ä½ ä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªæ“ä½œä¸ŠæŒ‡å®šCacheKeyResolverï¼Œæ–¹æ³•è·ŸæŒ‡å®šCacheResolverFactoryç›¸åŒã€‚\nJCacheå¯ä»¥ç®¡ç†è¢«æ³¨è§£æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ã€‚ä»–å¯ä»¥é˜»æ­¢ç¼“å­˜çš„æ›´æ–°ï¼Œä¹Ÿå¯ä»¥ç¼“å­˜å¼‚å¸¸è€Œä¸æ˜¯å†å»è°ƒç”¨ä¸€æ¬¡æ–¹æ³•ã€‚å‡å®šISBNæ— æ•ˆæ—¶ä¼šæŠ›å‡ºInvalidIsbnNotFoundExceptionã€‚ä¸‹é¢çš„ä¾‹å­ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ç”¨ä¸€ä¸ªæ— æ•ˆçš„ï¼Œå¹¶ä¸”ç›¸åŒçš„ISBNï¼Œå¤šæ¬¡è°ƒç”¨çš„æƒ…å†µä¸‹ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å†æ¬¡æ‰§è¡Œæ–¹æ³•ï¼š\n@CacheResult(cacheName=\u0026quot;books\u0026quot;, exceptionCacheName=\u0026quot;failures\u0026quot;\rcachedExceptions = InvalidIsbnNotFoundException.class)\rpublic Book findBook(ISBN isbn)\r 3.2 å¼€å¯JSR-107æ”¯æŒ é™¤äº†Springçš„ç”³æ˜æ³¨è§£æ”¯æŒå¤–ï¼Œä¸éœ€è¦å…¶ä»–çš„æ“ä½œæ¥å¯ç”¨JSR-107ã€‚å¦‚æœclasspathå†…éƒ¨æœ‰JSR-107APIå’Œspring-context-supportæ¨¡å—ï¼Œé‚£ä¹ˆ@EnableCachingå’Œcache:annotation-drivenå…ƒç´ ä¼šè‡ªåŠ¨å¯ç”¨JCacheæ”¯æŒ\n ä¸¤ç§æ³¨è§£å½¢å¼å¯ä»¥éšæ„ä½¿ç”¨ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœSpringå’ŒJSR-107éƒ½å½±å“äº†ç›¸åŒçš„ç¼“å­˜ï¼Œä½ åº”è¯¥ä¿è¯ä¸»é”®ç”Ÿæˆå™¨ä¸€è‡´\n ","id":72,"section":"posts","summary":"1.äº†è§£ç¼“å­˜æ¦‚å¿µ ç¼“å­˜å’Œç¼“å†²(Cache vs Buffer) ç¼“å­˜å’Œç¼“å†²ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯äº¤æ›¿ä½¿ç”¨çš„ï¼Œéœ€è¦çŸ¥é“çš„æ˜¯ä»–ä»¬æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚ buffer(ç¼“å†²)æ˜¯ç”¨åœ¨","tags":["spring"],"title":"Springç¼“å­˜é›†æˆ","uri":"https://www.mingaccount.com/2018/09/spring-cache/","year":"2018"},{"content":"1.å¤§å‹ç½‘ç«™çš„ç‰¹ç‚¹ï¼š ã€€ç›¸æ¯”ä¼ ç»Ÿä¼ä¸šåº”ç”¨ç³»ç»Ÿï¼Œå¤§å‹äº’è”ç½‘åº”ç”¨ç³»ç»Ÿæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š\n é«˜å¹¶å‘ã€å¤§æµé‡ï¼šéœ€è¦é¢å¯¹é«˜å¹¶å‘ç”¨æˆ·ï¼Œå¤§æµé‡è®¿é—®ã€‚ é«˜å¯ç”¨ï¼šç³»ç»Ÿéœ€è¦7*24å°æ—¶ä¸é—´æ–­æœåŠ¡ã€‚ æµ·é‡æ•°æ®ï¼šéœ€è¦å‚¨å­˜ã€ç®¡ç†æµ·é‡æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨å¤§é‡æœåŠ¡å™¨ã€‚ ç”¨æˆ·åˆ†å¸ƒå¹¿æ³›ï¼Œç½‘ç»œæƒ…å†µå¤æ‚ã€‚ å®‰å…¨ç¯å¢ƒæ¶åŠ£ï¼šé»‘å®¢æ”»å‡»ã€‚ éœ€æ±‚å¿«é€Ÿå˜æ›´ï¼Œå‘å¸ƒé¢‘ç¹ã€‚ æ¸è¿›å¼å‘å±•ï¼šå¤§å‹äº’è”ç½‘å‡ ä¹éƒ½æ˜¯ä»å°ç½‘ç«™å‘å±•èµ·æ¥çš„ï¼Œä¸åƒä¼ ç»Ÿè¡Œä¸šä¸€å¼€å§‹éœ€æ±‚å°±ç›¸å¯¹å›ºå®šã€‚ é‚£ä¹ˆå¤§å‹ç½‘ç«™æ˜¯å¦‚ä½•åšåˆ°é«˜å¯ç”¨ã€é«˜æ€§èƒ½ã€æ˜“æ‰©å±•ã€å¯ä¼¸ç¼©ä¸”å®‰å…¨çš„ç½‘ç«™ï¼Œåˆæ˜¯æ€æ ·æ¼”å˜çš„äº†ï¼Ÿ  2.å¤§å‹ç½‘ç«™æ¶æ„çš„æ¼”åŒ–å‘å±•å†ç¨‹ 2.1 åˆå§‹åŒ–é˜¶æ®µçš„ç½‘ç«™æ¶æ„ åº”ç”¨ç¨‹åºã€æ•°æ®åº“ã€å’Œç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ç­‰æ‰€æœ‰çš„èµ„æºéƒ½æ˜¯åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šã€‚\n2.2 åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦» éšç€ç½‘ç«™ç”¨æˆ·çš„å¢åŠ ï¼Œä¸æ–­å¢åŠ çš„è®¿é—®æ•°é‡ï¼Œå’Œå¤§é‡çš„æ–‡ä»¶å‚¨å­˜ï¼Œä¸€å°æœåŠ¡å™¨å·²ç»ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œè¿™æ—¶å°±éœ€è¦åˆ†ç¦»åº”ç”¨å’Œæ•°æ®ã€‚\nåˆ†ç¦»åæ•´ä¸ªç½‘ç«™ä½¿ç”¨ä¸‰å°æœåŠ¡å™¨ï¼šåº”ç”¨æœåŠ¡å™¨ã€æ–‡ä»¶æœåŠ¡å™¨ã€æ•°æ®åº“æœåŠ¡å™¨ã€‚\nä¸‰å°æœåŠ¡å™¨å¯¹ç¡¬ä»¶çš„è¦æ±‚ä¸åŒï¼š\n åº”ç”¨æœåŠ¡å™¨éœ€è¦å¤„ç†å¤§é‡ä¸šåŠ¡é€»è¾‘ï¼Œéœ€è¦æ›´å¥½çš„cpuï¼› æ•°æ®åº“æœåŠ¡å™¨éœ€è¦å¿«é€Ÿæ£€ç´¢ç£ç›˜å’Œæ•°æ®ç¼“å­˜ï¼Œå› æ­¤éœ€è¦æ›´å¿«çš„ç¡¬ç›˜å’Œæ›´å¤§çš„å†…å­˜ï¼› æ–‡ä»¶æœåŠ¡å™¨éœ€è¦å‚¨å­˜å¤§é‡ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦æ›´å¤§çš„ç¡¬ç›˜ã€‚  2.3 ä½¿ç”¨ç¼“å­˜æ”¹å–„ç½‘ç«™æ€§èƒ½ éšç€ç”¨æˆ·è¿›ä¸€æ­¥å¢åŠ ï¼Œæ•°æ®åº“å‹åŠ›å¤ªå¤§å¯¼è‡´è®¿é—®å»¶è¿Ÿã€‚è€Œå¤§éƒ¨åˆ†æ•°æ®çš„è®¿é—®ï¼Œæ€»æ˜¯é›†ä¸­åœ¨æŸäº›çƒ­ç‚¹æ•°æ®ä¸Šï¼Œä¾‹å¦‚æ·˜å®å•†å“è®¿é—®ï¼Œæ€»æ˜¯é›†ä¸­åœ¨è¯„ä»·æœ€é«˜çš„å•†å“ä¸Šã€‚\né‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸€éƒ¨åˆ†çƒ­ç‚¹æ•°æ®ï¼Œç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œä»¥å‡å°‘æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚\nç½‘ç«™å¯ä½¿ç”¨çš„ç¼“å­˜åˆ†ä¸ºä¸¤ç§ï¼š\n æœ¬åœ°ç¼“å­˜ï¼šç¼“å­˜åœ¨åº”ç”¨æœåŠ¡å™¨ä¸Šï¼Œè®¿é—®é€Ÿåº¦å¿«ï¼Œä½†å—åº”ç”¨æœåŠ¡å™¨çš„å†…å­˜é™åˆ¶ã€‚ è¿œç¨‹ç¼“å­˜ï¼šç¼“å­˜åœ¨ä¸“é—¨çš„åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ä¸Šï¼Œç†è®ºä¸Šä¸å—å†…å­˜å®¹é‡é™åˆ¶ã€‚  2.4 ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„ç½‘ç«™çš„å¹¶å‘å¤„ç†èƒ½åŠ› ä½¿ç”¨ç¼“å­˜åï¼Œæ•°æ®åº“çš„å‹åŠ›å¾—åˆ°æœ‰æ•ˆç¼“è§£ï¼Œä½†å•ä¸ªåº”ç”¨æœåŠ¡å™¨èƒ½å¤„ç†çš„è¯·æ±‚è¿æ¥æœ‰é™ï¼Œåœ¨è®¿é—®é«˜å³°æœŸï¼Œåº”ç”¨æœåŠ¡å™¨æˆä¸ºæ•´ä¸ªç½‘ç«™çš„ç“¶é¢ˆã€‚\nå•ä¸€åº”ç”¨æœåŠ¡å™¨æ€§èƒ½æ˜¯æœ‰ä¸Šé™çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯å¤šä¸ªæœåŠ¡å™¨çš„é›†ç¾¤æ¥åˆ†æ‹…åŸæœ‰æœåŠ¡å™¨çš„è®¿é—®åŠå‚¨å­˜å‹åŠ›ï¼Œä»è€Œå®ç°ç³»ç»Ÿçš„å¯ä¼¸ç¼©æ€§ã€‚\nåº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ­å»ºåï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡è°ƒåº¦æœåŠ¡å™¨ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°é›†ä¸­ä¸­ä»»ä½•ä¸€å°æœºå™¨ä¸Šã€‚\n2.5 æ•°æ®åº“è¯»å†™åˆ†ç¦» ç½‘ç«™ä½¿ç”¨ç¼“å­˜åï¼Œç»å¤§éƒ¨åˆ†æ•°æ®éƒ½å¯ä»¥ä»ç¼“å­˜ä¸­è·å–ï¼Œä½†åœ¨éƒ¨åˆ†æƒ…å†µä¸‹ä»»ç„¶éœ€è¦è®¿é—®æ•°æ®åº“ï¼š\n ç¼“å­˜æœªå‘½ä¸­ï¼ˆè¯·æ±‚æœªèƒ½ä»ç¼“å­˜ç³»ç»Ÿä¸­æ‰¾åˆ°åŒ¹é…çš„ç¼“å­˜ï¼‰ ç¼“å­˜è¿‡æœŸ å…¨éƒ¨å†™æ“ä½œ è™½ç„¶åªæœ‰éƒ¨åˆ†æƒ…å†µæ‰ä¼šè®¿é—®æ•°æ®åº“ï¼Œä½†å½“ç”¨æˆ·åŸºæ•°ä¸æ–­å¢å¤§ï¼Œæ•°æ®åº“ä¹Ÿä¼šä¸å ªé‡è´Ÿã€‚  è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡è¯»å†™åˆ†ç¦»ï¼Œæ¥å‡è½»æ•°æ®åº“çš„å‹åŠ›ã€‚\nç›®å‰å¤§éƒ¨åˆ†ä¸»æµæ•°æ®åº“éƒ½æ”¯æŒä¸»ä»çƒ­å¤‡ï¼ˆåŒæœºçƒ­å¤‡ï¼‰ï¼Œé€šè¿‡è®¾å®šä¸¤å°æ•°æ®åº“çš„ä¸»ä»å…³ç³»ï¼Œå¯ä»¥å°†ä¸€å°æ•°æ®åº“æœåŠ¡å™¨çš„æ•°æ®åŒæ­¥æ›´æ–°åˆ°å¦ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œç½‘ç«™åˆ©ç”¨æ•°æ®åº“çš„è¿™ä¸ªåŠŸèƒ½æ¥å®ç°è¯»å†™åˆ†ç¦»ã€‚\nåœ¨å†™æ•°æ®æ—¶è®¿é—®ä¸»æ•°æ®åº“ï¼ŒåŒæ—¶ä¸»æ•°æ®åº“åŒæ­¥æ•°æ®åˆ°ä»æ•°æ®åº“ï¼Œåœ¨è¯»å–æ•°æ®æ—¶ï¼Œå°±å¯ä»¥è®¿é—®ä»æ•°æ®åº“ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¸€ä¸ªæ•°æ®è®¿é—®æ¨¡å—ï¼Œè®©è¯»å†™åˆ†ç¦»å¯¹åº”ç”¨ç¨‹åºé€æ˜ï¼Œå‡å°‘ä»£ç ä¾èµ–ã€‚\n2.6 ä½¿ç”¨åå‘ä»£ç†å’ŒCDNåŠ é€Ÿç½‘ç«™å“åº” éšç€ç½‘ç«™è§„æ¨¡çš„æ‰©å¤§ï¼Œç”¨æˆ·å¯èƒ½åˆ†å¸ƒåœ¨å…¨å›½å„åœ°ï¼Œä¸åŒåœ°æ–¹çš„ç½‘ç»œç¯å¢ƒä¸åŒï¼Œè¦ä¿è¯å“åº”é€Ÿåº¦ï¼Œå°±éœ€è¦åŠ é€Ÿç½‘ç«™çš„è®¿é—®é€Ÿåº¦ã€‚\nä¸»è¦çš„åŠ é€Ÿæ‰‹æ®µï¼š\n CDN åå‘ä»£ç†  è¿™ä¸¤ç§æ–¹å¼éƒ½åŸºäºç¼“å­˜ï¼Œä¸åŒç‚¹åœ¨äºï¼š\n CDNéƒ¨ç½²åœ¨ç½‘ç»œæä¾›å•†çš„æœºæˆ¿ï¼Œç”¨æˆ·åœ¨è¯·æ±‚æ•°æ®æ—¶ï¼Œå¯ä»¥ä»ç¦»è‡ªå·±æœ€è¿‘çš„ç½‘ç»œæä¾›å•†å‡ºè·å–æ•°æ®ã€‚ åå‘ä»£ç†éƒ¨ç½²åœ¨ç½‘ç«™ä¸­å¿ƒæœºæˆ¿ï¼Œç”¨æˆ·åœ¨è¯·æ±‚æ•°æ®æ—¶ï¼Œé¦–å…ˆè®¿é—®çš„æ—¶åå“ä»£ç†æœåŠ¡å™¨ï¼Œå¦‚æœç¼“å­˜ç€ç”¨æˆ·è¯·æ±‚çš„èµ„æºï¼Œå°±ç›´æ¥å°†ç¼“å­˜è¿”å›ç»™ç”¨æˆ·ã€‚  2.7 ä½¿ç”¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿ æ•°æ®åº“ç»è¿‡è¯»å†™åˆ†ç¦»ï¼Œæ‹†åˆ†ä¸ºä¸¤å°æœåŠ¡å™¨ï¼Œä½†æ˜¯éšç€ç½‘ç«™å‘å±•ä»»ç„¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œæ–‡ä»¶æœåŠ¡å™¨ä¹Ÿæ˜¯ä¸€æ ·ã€‚\nè¿™æ—¶å°±éœ€è¦åˆ†å¸ƒå¼çš„æ•°æ®åº“ç³»ç»Ÿå’Œæ–‡ä»¶ç³»ç»Ÿã€‚\nåˆ†å¸ƒå¼æ•°æ®åº“æ˜¯ç½‘ç«™æ•°æ®åº“æ‹†åˆ†çš„æœ€åæ‰‹æ®µï¼Œåªæœ‰åœ¨å•è¡¨æ•°æ®éå¸¸åºå¤§çš„æ—¶å€™æ‰ä½¿ç”¨ã€‚ä¸åˆ°ä¸å¾—å·²æ—¶ï¼Œç½‘ç«™æ›´å¸¸ç”¨çš„æ•°æ®åº“æ‹†åˆ†æ‰‹æ®µæ˜¯ä¸šåŠ¡åˆ†åº“ï¼Œå°†ä¸åŒçš„ä¸šåŠ¡çš„æ•°æ®åº“éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚\n2.8 ä½¿ç”¨NoSQLå’Œæœç´¢å¼•æ“ éšç€ç½‘ç«™ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚ï¼Œå¯¹æ•°æ®åº“å‚¨å­˜å’Œæ£€ç´¢çš„éœ€æ±‚ä¹Ÿè¶Šæ¥è¶Šå¤æ‚ï¼Œç½‘ç«™éœ€è¦é‡‡å–ä¸€äº›éå…³ç³»å‹æ•°æ®åº“æŠ€æœ¯å¦‚NoSQLå’Œéæ•°æ®åº“æŸ¥è¯¢æŠ€æœ¯å¦‚æœç´¢å¼•æ“ã€‚\nNoSQLå’Œæœç´¢å¼•æ“ï¼Œå¯¹å¯ä¼¸ç¼©çš„åˆ†å¸ƒå¼ç³»ç»Ÿæœ‰å¾ˆå¥½çš„æ”¯æŒã€‚é¢å¯¹å¦‚æ­¤å¤šçš„æ•°æ®æºï¼Œåº”ç”¨æœåŠ¡å™¨é€šè¿‡ç»Ÿä¸€çš„æ•°æ®è®¿é—®æ¨¡å—æ¥è®¿é—®ä¸åŒçš„æ•°æ®æºã€‚\n2.9 ä¸šåŠ¡æ‹†åˆ† å¤§å‹ç½‘ç«™é¢å¯¹æ—¥ç›Šå¤æ‚çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ ¹æ®äº§å“çº¿åˆ’åˆ†ï¼Œå¯ä»¥å°†ä¸€ä¸ªç½‘ç«™æ‹†æˆå¤šä¸ªåº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½ç‹¬ç«‹éƒ¨ç½²ç»´æŠ¤ã€‚\næ¯ä¸ªåº”ç”¨ä¹‹é—´çš„æ•°æ®å…³è”æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š\n é€šè¿‡è®¿é—®åŒä¸€ä¸ªæ•°æ®å‚¨å­˜ç³»ç»Ÿ(æœ€å¸¸ç”¨)ã€‚ é€šè¿‡è¶…é“¾æ¥å»ºç«‹å…³ç³»ã€‚ é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œæ•°æ®åˆ†å‘ã€‚  2.10 åˆ†å¸ƒå¼æœåŠ¡ éšç€ä¸šåŠ¡æ‹†åˆ†è¶Šæ¥è¶Šç»†ï¼Œåº”ç”¨ç³»ç»Ÿè¶Šæ¥è¶Šå¤æ‚ï¼Œå¹¶ä¸”ç”±äºæ‰€æœ‰åº”ç”¨è¦å’Œæ‰€æœ‰æ•°æ®åº“è¿æ¥ï¼Œåœ¨æ•°ä¸‡å°æœåŠ¡å™¨è§„æ¨¡çš„ç½‘ç«™ä¸­ï¼Œä¼šå¯¼è‡´æ•°æ®åº“è¿æ¥èµ„æºä¸è¶³ï¼Œæ‹’ç»æœåŠ¡ã€‚\nåº”ç”¨ç³»ç»Ÿä¸­æœ‰è®¸å¤šç›¸åŒçš„ä¸šåŠ¡æ“ä½œï¼Œæ¯”å¦‚ç”¨æˆ·ç®¡ç†ã€å•†å“ç®¡ç†ç­‰ï¼Œé‚£ä¹ˆå¯ä»¥å°†è¿™äº›ç›¸åŒçš„ä¸šåŠ¡æå–å‡ºæ¥ç‹¬ç«‹éƒ¨ç½²ï¼Œç”±è¿™äº›å¯å¤ç”¨çš„ä¸šåŠ¡è¿æ¥æ•°æ®åº“ï¼Œé€šè¿‡åˆ†å¸ƒå¼æœåŠ¡è°ƒç”¨å…±ç”¨ä¸šåŠ¡æœåŠ¡å®Œæˆå…·ä½“æ“ä½œã€‚\n*æœ¬æ–‡æ˜¯ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ æ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹çš„ç« èŠ‚æ€»ç»“\n","id":73,"section":"posts","summary":"1.å¤§å‹ç½‘ç«™çš„ç‰¹ç‚¹ï¼š ç›¸æ¯”ä¼ ç»Ÿä¼ä¸šåº”ç”¨ç³»ç»Ÿï¼Œå¤§å‹äº’è”ç½‘åº”ç”¨ç³»ç»Ÿæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š é«˜å¹¶å‘ã€å¤§æµé‡ï¼šéœ€è¦é¢å¯¹é«˜å¹¶å‘ç”¨æˆ·ï¼Œå¤§æµé‡è®¿é—®ã€‚ é«˜å¯ç”¨ï¼šç³»ç»Ÿéœ€è¦7*","tags":["website build"],"title":"å¤§å‹ç½‘ç«™æ¶æ„æ¼”åŒ–æ¦‚è®º","uri":"https://www.mingaccount.com/2018/09/big-web-bala-bala/","year":"2018"},{"content":"Java8å‡½æ•°å¼ç¼–ç¨‹çš„åŠ å…¥å½»åº•æ”¹å˜äº†æ¸¸æˆè§„åˆ™ã€‚å¯¹Javaå¼€å‘è€…æ¥è¯´è¿™æ˜¯ä¸€ä¸ªå…¨æ–°çš„ä¸–ç•Œï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦åšå‡ºç›¸åº”çš„æ”¹å˜ã€‚\nåœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å°†æ‰¾å¯»ä¼ ç»Ÿå¾ªç¯ä»£ç çš„å¯æ›¿ä»£æ–¹æ¡ˆã€‚Java8çš„å‡½æ•°å¼ç¼–ç¨‹ç‰¹æ€§æ”¹å˜äº†ç¼–ç¨‹æ€è·¯ï¼Œä» â€œæˆ‘ä»¬æ€æ ·å»åšâ€ å˜æˆäº† â€œæˆ‘ä»¬æƒ³åšä»€ä¹ˆâ€ ã€‚\nè¿™ä¹Ÿæ˜¯ä¼ ç»Ÿå¾ªç¯çš„ç¼ºç‚¹ã€‚å½“ç„¶ä¼ ç»Ÿå¾ªç¯æ›´åŠ çš„çµæ´»ï¼Œä½†å…¶çµæ´»æ€§å¹¶ä¸èƒ½æ©ç›–ä»–çš„é—®é¢˜ã€‚\nreturnã€breakã€continueèƒ½ç›´æ¥æ”¹å˜å¾ªç¯çš„æ‰§è¡Œæµç¨‹ï¼Œå¼ºè¿«æˆ‘ä»¬ä¸ä»…è¦ç†è§£ä¸šåŠ¡é€»è¾‘ï¼ŒåŒæ—¶ä¹Ÿè¦äº†è§£å¾ªç¯æ˜¯æ€æ ·å·¥ä½œçš„ã€‚\nJava8é€šè¿‡å¼•å…¥streamæŒ‡ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é›†åˆä¸Šä½¿ç”¨å¼ºå¤§çš„å‡½æ•°å¼æ“ä½œã€‚ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹æ€æ ·å°†ä¼ ç»Ÿå¾ªç¯è½¬å˜ä¸ºæ›´ç®€æ´ï¼Œæ›´å…·æœ‰å¯è¯»æ€§çš„ä»£ç ã€‚\nè¿™é‡Œå°†ä¼šåˆ›å»ºä¸€ä¸ªArticleç±»ï¼Œä»–æœ‰ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼štitleã€authorã€tagsï¼š\nprivate class Article {\rprivate final String title;\rprivate final String author;\rprivate final List\u0026lt;String\u0026gt; tags;\rprivate Article(String title, String author, List\u0026lt;String\u0026gt; tags) {\rthis.title = title;\rthis.author = author;\rthis.tags = tags;\r}\rpublic String getTitle() {\rreturn title;\r}\rpublic String getAuthor() {\rreturn author;\r}\rpublic List\u0026lt;String\u0026gt; getTags() {\rreturn tags;\r}\r}\r æ¯ä¸ªä¾‹å­éƒ½ä¼šåŒ…æ‹¬ä¸€ä¸ªä¼ ç»Ÿå¾ªç¯çš„è§£å†³æ–¹æ¡ˆï¼Œå’ŒJava8å‡½æ•°å¼ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆã€‚\nåœ¨ç¬¬ä¸€ä¸ªä¾‹å­é‡Œé¢ï¼Œå°†ä¼šåœ¨Articleé›†åˆä¸­å¯»æ‰¾tagåŒ…å«\u0026quot;Java\u0026quot;çš„ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼š\nä¼ ç»Ÿå¾ªç¯çš„è§£å†³æ–¹æ¡ˆï¼š\npublic Article getFirstJavaArticle(){\rfor(Article article : articles){\rif(article.getTags().contains(\u0026quot;Java\u0026quot;)){\rreturn article;\r}\r}\rreturn null;\r}\r Java8çš„è§£å†³æ–¹æ¡ˆï¼š\npublic Optional\u0026lt;String\u0026gt; getFirstJavaArticle(){\rreturn articles.stream().filter(article -\u0026gt; article.getTags.contains(\u0026quot;Java\u0026quot;)).findFirst(); }\r é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨filteræ“ä½œæ‰¾åˆ°æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„Articleï¼Œç„¶åè°ƒç”¨findFirst()æ–¹æ³•å¾—åˆ°ç¬¬ä¸€ä¸ªã€‚\nå› ä¸ºstreamæ˜¯æƒ°æ€§çš„è€Œä¸”filterè¿”å›äº†ä¸€ä¸ªstreamï¼Œå› æ­¤æ–¹æ³•åªæœ‰åœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…æ—¶æ‰ä¼šå»å¤„ç†è¿™ä¸ªå…ƒç´ ã€‚\nç°åœ¨è®©æˆ‘ä»¬å°è¯•è·å–æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ã€‚\nä¼ ç»Ÿå¾ªç¯è§£å†³æ–¹æ¡ˆï¼š\npublic List\u0026lt;Article\u0026gt; getAllJavaArticles() {\rList\u0026lt;Article\u0026gt; result = new ArrayList\u0026lt;\u0026gt;();\rfor (Article article : articles) {\rif (article.getTags().contains(\u0026quot;Java\u0026quot;)) {\rresult.add(article);\r}\r}\rreturn result;\r}\r Java8è§£å†³æ–¹æ¡ˆï¼š\npublic List\u0026lt;Article\u0026gt; getAllJavaArticles() {\rreturn articles.stream().filter(article -\u0026gt; article.getTags.contains(\u0026quot;Java\u0026quot;)).collect(Collectors.toList());\r}\r åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨äº† collect æ–¹æ³•å»ç­›é€‰streamï¼Œè€Œä¸æ˜¯è‡ªå·±å£°æ˜ä¸€ä¸ªé›†åˆï¼Œå¹¶å°†åŒ¹é…çš„å‚æ•°è¿½åŠ åˆ°é›†åˆä¸­ã€‚\nåˆ°ç›®å‰ä¸ºæ­¢éƒ½ä¸é”™ï¼Œç°åœ¨æ˜¯æ—¶å€™æ¥å±•ç° stream apiçœŸæ­£çš„é­…åŠ›äº†ï¼\nè®©æˆ‘ä»¬åŸºäºauthorå°†articlesè¿›è¡Œåˆ†ç»„ã€‚\nä¼ ç»Ÿå¾ªç¯è§£å†³æ–¹æ¡ˆï¼š\npublic Map\u0026lt;String,List\u0026lt;Article\u0026gt;\u0026gt; groupByAuthor(){\rMap\u0026lt;String,List\u0026lt;Article\u0026gt;\u0026gt; result = new HashMap\u0026lt;\u0026gt;();\rfor(Article article : articles){\rif(result.containsKey(article.getAuthor)){\rresult.get(article.getAuthor).add(article);\r}else{\rArrayList\u0026lt;Article\u0026gt; articles = new ArrayList\u0026lt;\u0026gt;();\rarticles.add(article);\rresult.put(article.getAuthor(), articles);\r}\r} }\r Java8è§£å†³æ–¹æ¡ˆï¼š\npublic Map\u0026lt;String, List\u0026lt;Article\u0026gt;\u0026gt; groupByAuthor() {\rreturn articles.stream().collect(Collectors.groupingBy(Article::getAuthor));\r}\r é€šè¿‡ä½¿ç”¨groupingByæ“ä½œå’ŒgetAuthorçš„æ–¹æ³•å¼•ç”¨ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ•´æ´å¹¶ä¸”å¯è¯»æ€§é«˜çš„ä»£ç ã€‚\nç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨é›†åˆä¸­æ‰¾åˆ°Articleæ‰€æœ‰çš„ä¸é‡å¤çš„tagsã€‚\né¦–å…ˆæ—¶ä¼ ç»Ÿå¾ªç¯æ–¹æ¡ˆï¼š\npublic Set\u0026lt;String\u0026gt; getDistinctTags(){\rSet\u0026lt;String\u0026gt; result = new HashSet\u0026lt;\u0026gt;();\rfor(Article article : articles){\rresult.addAll(article.getTags());\r}\rreturn result; }\r Java8è§£å†³æ–¹æ¡ˆï¼š\npublic Set\u0026lt;String\u0026gt; getDistinctTags(){\rreturn articles.stream().flatMap(article -\u0026gt; article.getTags().stream()).collect(Collectors.toSet());\r}\r flatMapå¸®åŠ©æˆ‘ä»¬è·å–ç»“æœæµä¸­çš„tagé›†åˆï¼Œç„¶åç”¨collectæ–¹æ³•åˆ›å»ºä¸€ä¸ªSetå¹¶è¿”å›ç»“æœã€‚\nå‡½æ•°å¼ç¼–ç¨‹æ‹¥æœ‰æ— é™çš„å¯èƒ½ï¼Œè¿™å››ä¸ªä¾‹å­çš„ç›®çš„æ˜¯æ€æ ·å°†å¾ªç¯æ›¿æ¢æˆæ›´å¯è¯»çš„ä»£ç ã€‚ä½ åº”è¯¥ä»”ç»†æŸ¥çœ‹stream APIï¼Œå› ä¸ºç›¸æ¯”apiè¿™æ–‡ç« ä»…ä»…åªæ˜¯çš®æ¯›è€Œå·²ã€‚\n*è‹±æ–‡é“¾æ¥ï¼šdeadCodeRising\n*åŸåˆ›è¯‘æ–‡\n","id":74,"section":"posts","summary":"Java8å‡½æ•°å¼ç¼–ç¨‹çš„åŠ å…¥å½»åº•æ”¹å˜äº†æ¸¸æˆè§„åˆ™ã€‚å¯¹Javaå¼€å‘è€…æ¥è¯´è¿™æ˜¯ä¸€ä¸ªå…¨æ–°çš„ä¸–ç•Œï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦åšå‡ºç›¸åº”çš„æ”¹å˜ã€‚ åœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å°†æ‰¾å¯»ä¼ ç»Ÿå¾ª","tags":["java"],"title":"[è¯‘]Java8ï¼šå¾ªç¯ä¸å‡½æ•°å¼ç¼–ç¨‹","uri":"https://www.mingaccount.com/2018/08/java8-for-functional/","year":"2018"},{"content":"Java8å¼•å…¥äº† java.util.function åŒ…ï¼Œä»–åŒ…å«äº†å‡½æ•°å¼æ¥å£ï¼Œå…·ä½“çš„æè¿°åœ¨ä»¥ä¸‹apiè¯´æ˜æ–‡æ¡£ä¸­ï¼š\nå‡½æ•°å¼æ¥å£ä¸ºlambdaè¡¨è¾¾å¼å’Œæ–¹æ³•å¼•ç”¨æä¾›ç›®æ ‡ç±»å‹ã€‚æ¯ä¸ªå‡½æ•°å¼æ¥å£æœ‰ä¸€ä¸ªå•ç‹¬çš„æŠ½è±¡æ–¹æ³•ï¼Œè¢«ç§°ä¸ºå‡½æ•°å¼æ¥å£çš„å‡½æ•°æ–¹æ³•ï¼Œlambdaè¡¨è¾¾å¼çš„å‚æ•°å’Œè¿”å›ç±»å‹ä¸ä¹‹åŒ¹é…æˆ–é€‚åº”ã€‚\r åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œå°†ç€é‡ä»‹ç»functionåŒ…40ä¸ªæ¥å£ä¸­çš„4ä¸ªï¼š\nPredicate ä»£è¡¨æœ‰ä¸€ä¸ªå‚æ•°çš„æ–­è¨€(booleanå€¼çš„å‡½æ•°)\r Predicate æ¥å£å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŸºäºç»™å®šå‚æ•°å¹¶è¿”å›ä¸€ä¸ªbooleanå€¼çš„lambdaè¡¨è¾¾å¼ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªPredicateæ¥æµ‹è¯•ä¸€ä¸ªPersonæ˜¯å¦ä¸ºæˆå¹´äººã€‚\nPredicate\u0026lt;Integer\u0026gt; isAnAdult = age -\u0026gt; age \u0026gt;= 18;\r è¿™é‡Œå¯¹äºstreamçš„filteræ–¹æ³•çš„ä½¿ç”¨ï¼Œè®©Predicateæ¥å£ä½œä¸ºä¸€ä¸ªå‚æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬å®é™…ä¸Šèƒ½å¤Ÿåœ¨streamä¸­ä½¿ç”¨æˆ‘ä»¬çš„Predicateæ¥å£ã€‚\nPredicate\u0026lt;Person\u0026gt; isAnAdult = person -\u0026gt; person.getAge() \u0026gt;= 18;\rList\u0026lt;Person\u0026gt; people = getAllPeople();\rInteger numOfAdult = people.stream().filter(isAnAdult).count();\r Consumer ä»£è¡¨ä¸€ä¸ªæ¥å—å•ä¸ªå‚æ•°è¾“å…¥è€Œä¸è¿”å›ä»»ä½•ç»“æœçš„æ“ä½œã€‚ä¸åƒå¤§å¤šæ•°å…¶ä»–çš„å‡½æ•°å¼æ¥å£ï¼ŒCustomeré¢„æœŸæ˜¯é€šè¿‡å‰¯ä½œç”¨è¿›è¡Œæ“ä½œã€‚\r Consumer\u0026lt;Ticket\u0026gt; ticketPrinter = ticket -\u0026gt; ticket.print();\r Iterableæ¥å£å¸¦æ¥çš„å…¨æ–°forEachæ–¹æ³•å¯ä»¥å°†Consumerä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œè®©æˆ‘ä»¬ç”¨forEachæ–¹æ³•å°†ä¸Šé¢åˆ›å»ºçš„ticketPrinteræ“ä½œç»„åˆåœ¨ä¸€ä¸ªCollectionä¸Šï¼š\nConsumer\u0026lt;Ticket\u0026gt; ticketPrinter = ticket -\u0026gt; ticket.print();\rCollection\u0026lt;Ticket\u0026gt; tickets = getTicketsToPrint();\rtickets.forEach(ticketPrinter);\r ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç®€åŒ–ä¸€ä¸‹ä»£ç ï¼Œé€šè¿‡æŠŠConsumerç›´æ¥æ”¾è¿›forEachæ–¹æ³•ä¸­ï¼š\nCollection\u0026lt;Ticket\u0026gt; tickets = getTicketsToPrint();\rtickets.forEach(ticket -\u0026gt; ticket.print());\r Supplier è¡¨ç¤ºç»“æœä¾›åº”\r è¿™æ˜¯å·¥å‚çš„ä¸€ç§ï¼Œä»–æ²¡æœ‰å‚æ•°ï¼Œåªæ˜¯è¿”å›ç»™ä½ ä¸€ä¸ªç»“æœã€‚éå¸¸é€‚åˆè¿”å›ä¸€ä¸ªå®ä¾‹ã€‚\nSupplier\u0026lt;TicketHandler\u0026gt; ticketHandlerCreator = () -\u0026gt; new TicketHandler();\r å¦ä¸€ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ„é€ æ–¹æ³•å¼•ç”¨ã€‚\nSupplier\u0026lt;TicketHandler\u0026gt; ticketCreator = TicketHandler::new;\r Function\u0026lt;T,R\u0026gt; è¡¨ç¤ºä¸€ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‚æ•°ç„¶åäº§å‡ºä¸€ä¸ªç»“æœ\r è®©æˆ‘ä»¬ç›´æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š\nFunction\u0026lt;String,Predicate\u0026lt;Ticket\u0026gt;\u0026gt; ticketFor = event -\u0026gt; ticket -\u0026gt; event.equals(ticket.getName());\rList\u0026lt;Ticket\u0026gt; tickets = getAllTickets();\rInteger soldTicketsForCoolEvent = tickets.stream().filter(ticketFor.apply(\u0026quot;CoolEvent\u0026quot;)).count();\r æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªä»¥eventå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°çš„Functionï¼Œä»–ä¼šè¿”å›ä¸€ä¸ªPredicateã€‚å‚æ•°ä¼šè¢«ä¼ ç»™Predicateï¼Œå¹¶ä¸eventå­—ç¬¦ä¸²ä½œæ¯”è¾ƒã€‚ç„¶åæˆ‘ä»¬åœ¨streamä¸­ä½¿ç”¨functionå»è®¡ç®—ticket nameä¸º\u0026quot;CoolEvent\u0026quot;çš„æ•°é‡\n*è‹±æ–‡é“¾æ¥ï¼šdeadCodeRising\n*åŸåˆ›è¯‘æ–‡\n","id":75,"section":"posts","summary":"Java8å¼•å…¥äº† java.util.function åŒ…ï¼Œä»–åŒ…å«äº†å‡½æ•°å¼æ¥å£ï¼Œå…·ä½“çš„æè¿°åœ¨ä»¥ä¸‹apiè¯´æ˜æ–‡æ¡£ä¸­ï¼š å‡½æ•°å¼æ¥å£ä¸ºlambdaè¡¨è¾¾å¼å’Œæ–¹æ³•å¼•ç”¨æä¾›ç›®æ ‡ç±»å‹ã€‚æ¯ä¸ªå‡½æ•°å¼","tags":["java"],"title":"[è¯‘]Java8çš„å‡½æ•°å¼æ¥å£","uri":"https://www.mingaccount.com/2018/08/java8-lamda-interface/","year":"2018"},{"content":"åœ¨å¼€å‘ä»£ç ä¸­ï¼Œæœ‰ä¸€æ®µéœ€è¦è·å–resourcesç›®å½•ä¸‹çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆè¿™é‡Œå†™ä½œtest.xmlï¼‰ã€‚\nè¿™æ®µä»£ç åœ¨ideä¸­æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯ä¸€æ‰“æˆjaråŒ…å‘å¸ƒåˆ°çº¿ä¸Šï¼Œè¿™æ®µä»£ç å°±ä¼šæŠ¥æ‰¾ä¸åˆ°å¯¹åº”æ–‡ä»¶çš„é”™è¯¯ã€‚\næŒ‰ç…§ä¸€èˆ¬çš„æ€è·¯ï¼Œå› ä¸ºresourcesç›®å½•ä¸‹çš„æ–‡ä»¶ç»è¿‡ç¼–è¯‘åéƒ½ä¼šæ”¾åœ¨classpathæ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è·å–åˆ°æ ¹ç›®å½•ç„¶åè¿½åŠ test.xmlå³å¯å¾—åˆ°è¯¥æ–‡ä»¶è·¯å¾„ã€‚è¿™æ˜¯å°è¯•è·å–è·¯å¾„å¤±è´¥çš„ä»£ç ï¼š\n//ç›´æ¥è·å–ç›®æ ‡æ–‡ä»¶è·¯å¾„\rString filePath = this.getClass.getClassLoader().getResource(\u0026quot;text.xml\u0026quot;).getPath;\r//è·å–æ ¹ç›®å½•è·¯å¾„1\rString rootPath = this.getClass.getClassLoader().getResource(\u0026quot;\u0026quot;).getPath;\r//è·å–æ ¹ç›®å½•è·¯å¾„2\rString rootPath2 = ResourceUtils.getURL(\u0026quot;classpath:\u0026quot;).getPath();\r é€šè¿‡ä»¥ä¸Šä»£ç è·å–åˆ°çš„è·¯å¾„åœ¨spring booté¡¹ç›®ä½œä¸ºjaråŒ…è¿è¡Œæ—¶ï¼Œå¾—åˆ°çš„å¹¶ä¸æ˜¯çœŸå®çš„è·¯å¾„ï¼Œè€Œæ˜¯å¦‚ä¸‹çš„ä¸€ä¸ªè·¯å¾„ï¼š\nworkspace/project/target/project.jar!/BOOT-INF/classes!/...\r springæä¾›äº†ClassPathResourceç±»å¤„ç†è¿™ç§æƒ…å†µï¼Œé€šè¿‡ClassPathResourceå¯ä»¥ç›´æ¥è·å–Fileå¯¹è±¡ï¼Œæˆ–è€…InputStreamï¼Œè¿™æ˜¯è·å–æˆåŠŸçš„ä»£ç ï¼š\nResource resource = new ClassPathResource(\u0026quot;text.xml\u0026quot;);\rresource.getFile();\rresource.getInputStream();\r ","id":76,"section":"posts","summary":"åœ¨å¼€å‘ä»£ç ä¸­ï¼Œæœ‰ä¸€æ®µéœ€è¦è·å–resourcesç›®å½•ä¸‹çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆè¿™é‡Œå†™ä½œtest.xmlï¼‰ã€‚ è¿™æ®µä»£ç åœ¨ideä¸­æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯ä¸€æ‰“æˆj","tags":["spring"],"title":"Spring boot æ–‡ä»¶è·¯å¾„è¯»å–å¼‚å¸¸","uri":"https://www.mingaccount.com/2018/08/spring-boot-get-file-path/","year":"2018"},{"content":"cd - #æŸ¥çœ‹ä¸Šä¸€æ¬¡æ‰€åœ¨çš„ç›®å½• cat /etc/hosts #æ–‡æ¡£æŸ¥çœ‹ ls #æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ pwd #æŸ¥çœ‹å½“å‰ç›®å½•çš„ç»å¯¹è·¯å¾„ ll #æŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æƒé™å±ç»„ç­‰ä¿¡æ¯ find / -name web.xml #æŸ¥çœ‹åå­—ä¸ºweb.xmlçš„æ–‡ä»¶ï¼Œéœ€è¦ç­‰å¾…ç‰‡åˆ» find .|xargs grep -rl \u0026quot;google.com\u0026quot; #æœç´¢å½“å‰ç›®å½•æ–‡ä»¶å†…å®¹å¹¶è¿”å›æ–‡ä»¶å find .|xargs grep -r \u0026quot;google.com\u0026quot; #æœç´¢å½“å‰ç›®å½•æ–‡ä»¶å†…å®¹å¹¶è¿”å›æ–‡ä»¶åï¼Œå¹¶å±•ç¤ºå‘½ä¸­è¡Œ find .|xargs grep -rn \u0026quot;google.com\u0026quot; #æœç´¢å½“å‰ç›®å½•æ–‡ä»¶å†…å®¹å¹¶è¿”å›æ–‡ä»¶åï¼Œå¹¶å±•ç¤ºè¡Œå· find .|xargs grep -rn1 \u0026quot;google.com\u0026quot; #æœç´¢å½“å‰ç›®å½•æ–‡ä»¶å†…å®¹å¹¶è¿”å›æ–‡ä»¶åï¼Œå¹¶å±•ç¤ºä¸Šä¸‹æ–‡å†…å®¹ mkdir -p #åˆ›å»ºæ–‡ä»¶å¤¹ cat [ç›®å½•1] \u0026gt;\u0026gt; [ç›®å½•2] #æŠŠç›®å½•1çš„æ–‡ä»¶å†…å®¹è¾“å…¥åˆ°ç›®å½•2ä¸­ chmod a+x filename #è®©æ‰§è¡Œæ–‡ä»¶èƒ½è¢«./filenameè°ƒç”¨ mv #æ–‡ä»¶ç§»åŠ¨æˆ–è€…é‡å‘½å #å°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ç§»åˆ°ä¸Šå±‚ç›®å½•ï¼Œä»¥ä¾¿åˆ é™¤ä¸Šçº§ç›®å½• mv * ../ vi /etc/hosts #HOSTä¿®æ”¹éœ€é‡å¯ vi /etc/resolv.conf #DNSä¿®æ”¹å³æ—¶ç”Ÿæ•ˆ vi /etc/sysconfig/network-scripts/ifcfg-eth0 #IPä¿®æ”¹éœ€é‡å¯ cat /etc/os-release #æŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ # æŠŠdir1å®Œæ•´å¤åˆ¶åˆ°dir2 cp -r dir1 dir2 # æŠŠdir1ä¸‹çš„æ‰€æœ‰å­æ–‡ä»¶å¤åˆ¶åˆ°dir2ï¼Œä¸åŒ…æ‹¬ç›®å½•è‡ªèº« cp -r dir1/. dir2 unset #åˆ é™¤å¯¹åº”çš„ç¯å¢ƒå˜é‡ nslookup [ip/åŸŸå] #é€šè¿‡åŸŸåæŸ¥æ‰¾ipå’Œdnsï¼Œæˆ–è€…é€šè¿‡ipæŸ¥æ‰¾åŸŸå wget åŸŸå #é€šè¿‡æŒ‡å®šåŸŸåä¸‹è½½æ–‡ä»¶åˆ°å½“å‰ç›®å½• scp -r ~/data root@127.0.0.1:~/data #æŒ‡å®šæœåŠ¡ä¸Šä¼  scp -r root@127.0.0.1:~/data ~/data #æŒ‡å®šæœåŠ¡ä¸‹è½½ ctrl+z #è¿›ç¨‹æš‚åœ ctrl+c #è¿›ç¨‹ç»ˆæ­¢ fg [JobID] #å°†åå°è¿›ç¨‹ç§»åˆ°å‰å°å¤„ç†ï¼Œä¸è®¾ç½®idï¼Œå°†æ˜¾ç¤ºæœ€åä¸€ä¸ªæš‚åœçš„è¿›ç¨‹ bg [JobID] #å°†è¿›ç¨‹æ”¾åˆ°åå°å¤„ç† jobs [é€‰é¡¹] [JobID] #è¯¥å‘½ä»¤ç”Ÿæ•ˆä¹‹å‰éœ€æ‰§è¡Œfind / -name password \u0026amp; #-læ˜¾ç¤ºè¿›ç¨‹ #-pä»…æ˜¾ç¤ºä»»åŠ¡å¯¹åº”çš„è¿›ç¨‹å· #-rä»…è¾“å‡ºè¿è¡ŒçŠ¶æ€çš„ä»»åŠ¡ #-sä»…è¾“å‡ºåœæ­¢çŠ¶æ€çš„ä»»åŠ¡ ps -ef #æŸ¥è¯¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„service ps -ef | grep mysql #æŸ¥è¯¢mysqlç›¸å…³çš„è¿›ç¨‹ service --status-all #æŸ¥è¯¢æ‰€æœ‰å·²å®‰è£…çš„service reboot #-dé‡æ–°å¼€æœºæ—¶ä¸æŠŠæ•°æ®å†™å…¥è®°å½•æ–‡ä»¶/var/tmp/wtmpã€‚å…·æœ‰-næ•ˆæœ #-få¼ºåˆ¶é‡æ–°å¼€æœºï¼Œä¸è°ƒç”¨shutdowæŒ‡ä»¤ #-ié‡æ–°å¼€æœºä¹‹å‰ï¼Œå…³é—­æ‰€æœ‰ç½‘ç»œç•Œé¢ #-né‡æ–°å¼€æœºä¹‹å‰ä¸æ£€æŸ¥æ˜¯å¦æœ‰ç¨‹åºæœªç»“æŸ #-wä»…åšæµ‹è¯•ï¼Œä¸çœŸæ­£é‡å¯ï¼Œåªä¼šåœ¨/var/log/wtmpå†™å…¥è®°å½• su - [ç”¨æˆ·å] #å®Œå…¨åˆ‡æ¢åˆ°æŒ‡å®šç”¨æˆ·ï¼Œéœ€è¦æŒ‡å®šç”¨æˆ·çš„å¯†ç  sudo -i #æš‚æ—¶åˆ‡æ¢åˆ°rootè´¦æˆ·ï¼Œlogoutå‘½ä»¤å¯é€€å‡ºrootï¼Œéœ€è¦sudoersæƒé™ sudo passwd root #è®¾ç½®rootå¯†ç ã€€sudo useradd -m hadoop -s /bin/bash #æ·»åŠ ç”¨æˆ· sudo adduser hadoop sudo #ç»™ç”¨æˆ·è¿½åŠ ç®¡ç†å‘˜æƒé™ top #è¡¨ç¤º1åˆ†é’Ÿï¼Œ5åˆ†é’Ÿï¼Œ15åˆ†é’Ÿçš„è¿è¡Œé˜Ÿåˆ—å¹³å‡è¿›ç¨‹æ•° while true;do ps -u your-user-name -L | wc -l;sleep 1;done #æŸ¥çœ‹å½“å‰ç”¨æˆ·å¼€å¯çš„çº¿ç¨‹æ•° ulimit -u #æŸ¥çœ‹å½“å‰ç”¨æˆ·æ‰€èƒ½å¼€å¯çš„çº¿ç¨‹æ•° echo $JAVA_HOME #æŸ¥è¯¢ç¯å¢ƒå˜é‡ which java #è·å–javaæ‰§è¡Œè·¯å¾„ ls -lrt /usr/bin/java #æŸ¥æ‰¾å®‰è£…è·¯å¾„ sudo tar -zxf å‹ç¼©åŒ…ç›®å½• -C ç›®æ ‡è§£å‹ç›®å½• #æ–‡ä»¶è§£å‹ sudo chown -R [userName] [filePath] #æ›´æ”¹æ–‡ä»¶åŠå…¶æ‰€æœ‰å­æ–‡ä»¶çš„æ‰€æœ‰è€…æƒé™ unzip #è§£å‹zipæ–‡ä»¶ vi /etc/apt/sources.list #ç¼–è¾‘ç¯å¢ƒå˜é‡ dpkg -i *.deb #ubuntuä½“ç³»å®‰è£…è½¯ä»¶åŒ…å‘½ä»¤ apt-get upgrade [è½¯ä»¶å] #ubuntuæ›´æ–°è½¯ä»¶ jps #æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„javaè¿›ç¨‹ï¼Œå¹¶æ˜¾ç¤ºè¿›ç¨‹id ssh-keygen #ç”ŸæˆSSH key  ","id":77,"section":"posts","summary":"cd - #æŸ¥çœ‹ä¸Šä¸€æ¬¡æ‰€åœ¨çš„ç›®å½• cat /etc/hosts #æ–‡æ¡£æŸ¥çœ‹ ls #æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ pwd #æŸ¥çœ‹å½“å‰ç›®å½•çš„ç»å¯¹è·¯å¾„ ll #æŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æƒé™å±ç»„ç­‰ä¿¡æ¯","tags":["linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤å¤‡å¿˜","uri":"https://www.mingaccount.com/2018/08/linux-common-command/","year":"2018"},{"content":"vi /etc/hosts\ni ä¿®æ”¹æ¨¡å¼\rescã€€é€€å‡ºä¿®æ”¹\r:qã€€æ­£å¸¸é€€å‡º(æ–‡ä»¶æ²¡æœ‰ä¿®æ”¹\r:q!ã€€ä¸ä¿å­˜é€€å‡º\r:wq ä¿å­˜é€€å‡º\rGã€€è·³åˆ°æœ«å°¾è¡Œ\rddã€€åˆ é™¤å½“å‰è¡Œ\rggã€€è·³åˆ°ç¬¬ä¸€è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦\r$ã€€è·³åˆ°å½“å‰è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦\roã€€åœ¨å½“å‰è¡Œä¹‹åæ’å…¥ä¸€ä¸ªæ–°è¡Œ\r/æœç´¢å†…å®¹ã€€æœç´¢æŒ‡å®šå†…å®¹\r:122ã€€è·³è½¬åˆ°æŒ‡å®šè¡Œ\r:%d åˆ é™¤æ‰€æœ‰å†…å®¹\rdG åˆ é™¤å½“å‰å…‰æ ‡ä»¥ä¸‹çš„æ‰€æœ‰å†…å®¹\r:set ff æŸ¥çœ‹å½“å‰è„šæœ¬æ ¼å¼ ","id":78,"section":"posts","summary":"vi /etc/hosts i ä¿®æ”¹æ¨¡å¼ esc é€€å‡ºä¿®æ”¹ :q æ­£å¸¸é€€å‡º(æ–‡ä»¶æ²¡æœ‰ä¿®æ”¹ :q! ä¸ä¿å­˜é€€å‡º :wq ä¿å­˜é€€å‡º G è·³åˆ°æœ«å°¾è¡Œ dd åˆ é™¤å½“å‰è¡Œ gg è·³åˆ°ç¬¬ä¸€è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦ $ è·³åˆ°å½“å‰è¡Œçš„æœ€åä¸€ä¸ªå­—","tags":["linux"],"title":"vimå‘½ä»¤å¤‡å¿˜","uri":"https://www.mingaccount.com/2018/08/vim-common-command/","year":"2018"},{"content":"å¼€å¯å®šæ—¶ä»»åŠ¡  @Configuration\r@EnableScheduling\r@ComponentScan(basePackages=\u0026quot;com.myco.tasks\u0026quot;)\rpublic class AppConfig {\r}\r å¦‚æœéœ€è¦å¯¹å®šæ—¶ä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸæœ‰å…¶ä»–çš„æ“ä½œï¼Œå¯ä»¥å®ç°æ¥å£SchedulingConfigurer\n@Configuration\r@EnableScheduling\rpublic class AppConfig implements SchedulingConfigurer {\r@Override\rpublic void configureTasks(ScheduledTaskRegistrar taskRegistrar) {\rtaskRegistrar.setScheduler(taskScheduler());\rtaskRegistrar.addTriggerTask(\rnew Runnable() {\rpublic void run() {\rmyTask().work();\r}\r},\rnew CustomTrigger()\r);\r}\r@Bean(destroyMethod=\u0026quot;shutdown\u0026quot;)\rpublic Executor taskScheduler() {\rreturn Executors.newScheduledThreadPool(42);\r}\r@Bean\rpublic MyTask myTask() {\rreturn new MyTask();\r}\r}\r  è¯¦ç»†ä¿¡æ¯å‚è€ƒ @EnableSchedulingæ³¨è§£å®˜æ–¹API\n é…ç½®å®šæ—¶ä»»åŠ¡ package com.myco.tasks;\r@Component\rpublic class MyTask {\r@Scheduled(fixedRate=1000)\rpublic void work() {\r// task execution logic\r}\r}\r æ³¨è§£@Scheduledæœ‰å¦‚ä¸‹å‚æ•°\n cron è¾“å…¥cronè¡¨è¾¾å¼ fixedDelay åœ¨æœ€åä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œåï¼Œä¸‹ä¸ªä»»åŠ¡å¼€å§‹æ‰§è¡Œçš„é—´éš”æ—¶é—´ fixedRate æœ€åä¸€ä¸ªä»»åŠ¡å¼€å§‹æ‰§è¡Œåï¼Œä¸‹ä¸ªä»»åŠ¡å¼€å§‹æ‰§è¡Œçš„é—´éš”æ—¶é—´ initialDelay ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå‰çš„å»¶è¿Ÿæ—¶é—´ zone æ—¶åŒº   è¯¦ç»†ä¿¡æ¯å‚è€ƒ @Scheduledæ³¨è§£å®˜æ–¹API\n ","id":79,"section":"posts","summary":"å¼€å¯å®šæ—¶ä»»åŠ¡ @Configuration @EnableScheduling @ComponentScan(basePackages=\u0026quot;com.myco.tasks\u0026quot;) public class AppConfig { } å¦‚æœéœ€è¦å¯¹å®šæ—¶ä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸæœ‰å…¶ä»–çš„æ“ä½œï¼Œå¯ä»¥å®ç°æ¥å£SchedulingConfigurer @Configuration @EnableScheduling public class AppConfig implements SchedulingConfigurer { @Override","tags":["spring"],"title":"SpringBootå®šæ—¶ä»»åŠ¡","uri":"https://www.mingaccount.com/2018/08/spring-boot-schedule/","year":"2018"},{"content":"æœ¬ç¯‡æ–‡ç« ç€é‡æ•´ç†ä»€ä¹ˆæ˜¯é™æ€åŒ–ç³»ç»Ÿæ¶æ„ï¼Œä»¥åŠé™æ€åŒ–æ¶æ„çš„å‡ ç§æ–¹æ¡ˆã€‚\né¦–å…ˆå…ˆè´´ä¸€ä¸ªæ·˜å®ç³»ç»Ÿå‡çº§çš„å†ç¨‹(09~13)ï¼š\n 09å¹´ï¼Œç³»ç»Ÿæ‹†åˆ†ï¼Œé™æ€æ–‡ä»¶åˆå¹¶ï¼Œå‰ç«¯é¡µé¢å¼‚æ­¥åŒ–å’ŒjsonåŒ–ã€‚ 10å¹´ï¼Œå»DBä¾èµ–ã€å¼•å…¥ç¼“å­˜ã€æå‡å•æœºQPSã€å…³æ³¨ç”¨æˆ·ä½“éªŒã€‚ 11å¹´ï¼Œä¼˜åŒ–è¿›å…¥æ·±æ°´åŒºVelocityã€BigPipeã€‚ 12å¹´ï¼Œé™æ€åŒ–æ”¹é€ ã€‚ 13å¹´ç»Ÿä¸€Cacheã€CDNåŒ–ã€ç½‘ç»œåè®®ã€‚  ä¸€ã€ä»€ä¹ˆæ˜¯é™æ€åŒ–æ¶æ„ï¼Œä¸ºä»€ä¹ˆéœ€è¦å®ƒ é™æ€åŒ–æ¶æ„ç³»ç»Ÿé€šå¸¸æœ‰å‡ ä¸ªç‰¹å¾ï¼š\n ä¸€ä¸ªURLæ ‡è¯†ä¸€ä¸ªå”¯ä¸€çš„é¡µé¢ã€‚ é¡µé¢ä¸åŒ…å«cookieç­‰ç§æœ‰æ•°æ®ï¼Œå³ç”¨æˆ·ä¿¡æ¯ï¼Œæ—¶é—´ï¼Œåœ°ç‚¹ç­‰ã€‚  å½“å‡ºç°é«˜å¹¶å‘é—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹é¦–å…ˆæƒ³åˆ°çš„æ˜¯ä¼˜åŒ–javaç¨‹åºï¼Œä½†javaç¨‹åºæœ¬èº«æ˜¯æœ‰ç“¶é¢ˆçš„ï¼Œå¹¶ä¸”ä»–ä¹Ÿå­˜åœ¨ä¸æ“…é•¿å¤„ç†å¤§é‡è¿æ¥è¯·æ±‚ï¼Œæ¯ä¸ªè¿æ¥æ¶ˆè€—å†…å­˜è¾ƒå¤šï¼ŒServletå®¹å™¨è§£æHTTPè¾ƒæ…¢ç­‰é—®é¢˜ï¼Œé‚£è¦æ€æ ·è·³å‡ºJavaæ¥è¿›è¡Œä¼˜åŒ–äº†ï¼Ÿ\nä»¥ä¸‹æ˜¯é™æ€è¯åŒ–æ¶æ„çš„å¤„ç†æ–¹å¼ï¼š\n é¦–å…ˆåˆ†ç¦»é¡µé¢é™æ€å†…å®¹ï¼Œé¡µé¢å†…å®¹å¹¶ä¸æ˜¯æ‰€æœ‰éƒ½éœ€è¦ä»åå°è·å–ï¼Œå°†å¿…é¡»åå°å¤„ç†çš„åˆ†ç¦»å‡ºå»ï¼Œç•™ä¸‹ä¸å—ç”¨æˆ·ä¿¡æ¯å½±å“çš„é™æ€çš„é¡µé¢å†…å®¹ã€‚ æ”¹å˜é™æ€å†…å®¹ç¼“å­˜çš„ä½ç½®ï¼Œä¸å†ç¼“å­˜åˆ°javaå±‚é¢ï¼Œç›´æ¥åœ¨WebæœåŠ¡å™¨ä¸Šåšç¼“å­˜ï¼ˆNginx,Apache,Varnishï¼‰ï¼› åˆ†ç¦»å‡ºçš„åŠ¨æ€å†…å®¹JsonåŒ–ï¼Œä»¥ä¾¿å¤ç”¨ã€‚è·å–åŠ¨æ€å†…å®¹æœ‰ä¸¤ç§æ–¹å¼ESIã€CSI  ESIï¼šåœ¨WebæœåŠ¡å™¨ä¸ŠåšåŠ¨æ€å†…å®¹è¯·æ±‚ï¼Œå¹¶å°†åŠ¨æ€å†…å®¹æ’å…¥åˆ°é™æ€é¡µé¢ï¼Œç”¨æˆ·æ‹¿åˆ°çš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„é¡µé¢ï¼Œç”¨æˆ·ä½“éªŒå¥½ï¼ŒæœåŠ¡å™¨å‹åŠ›è¾ƒå¤§ã€‚ CSIï¼šé€šè¿‡JSç›´æ¥å‘é€åŠ¨æ€å†…å®¹è¯·æ±‚ï¼Œç”¨æˆ·ä½“éªŒå·®ï¼ŒæœåŠ¡å™¨å‹åŠ›å°ã€‚    äºŒã€é™æ€åŒ–æ¶æ„çš„å‡ ç§æ–¹æ¡ˆ é¦–å…ˆæ˜¯é™æ€åŒ–æ–¹æ¡ˆéœ€è¦è€ƒè™‘çš„å‡ ä¸ªé—®é¢˜ï¼š\n æ˜¯å¦ä¸€è‡´æ€§Hashåˆ†ç»„ï¼Ÿåšç¼“å­˜ä¸€å®šæ˜¯å’Œå‘½ä¸­ç‡ç´§å¯†ç›¸å…³çš„ï¼Œå‘½ä¸­ç‡å’Œæ•°æ®çš„é›†ä¸­åº¦ç›¸å…³ï¼Œè€Œè¦è®©æ•°æ®é›†ä¸­ä¸€è‡´æ€§Hashå°±æ˜¯ä¸€ä¸ªå¿…ç„¶é€‰æ‹©ã€‚ä½†æ˜¯ä¸€è‡´æ€§Hashæœ‰ä¸€ä¸ªå¤©ç„¶çš„ç¼ºé™·å°±æ˜¯ä¼šå¯¼è‡´çƒ­ç‚¹é—®é¢˜ï¼Œå½“çƒ­ç‚¹ç‰¹åˆ«é›†ä¸­æ—¶å¯èƒ½ä¼šå¯¼è‡´ç½‘ç»œç“¶é¢ˆã€‚ æ˜¯å¦ä½¿ç”¨ESI?ESIå¯¹æ€§èƒ½æœ‰å½±å“ï¼Œä½†æ˜¯ä»–å¯¹å®¢æˆ·ç«¯å‹å¥½ï¼Œå‰ç«¯ç¼–ç¨‹ä¹Ÿæ–¹ä¾¿ã€‚ æ˜¯å¦ä½¿ç”¨ç‰©ç†æœºï¼Ÿç‰©ç†æœºå¯ä»¥æä¾›æ›´å¤§çš„å†…å­˜ã€æ›´å¥½çš„CPUèµ„æºï¼Œä½†æ˜¯ä½¿ç”¨ç‰©ç†æœºä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œä¾‹å¦‚ä¼šå¯¼è‡´åº”ç”¨é›†ç¾¤çš„ç›¸å¯¹é›†ä¸­ï¼Œè¿›è€Œå¯¼è‡´ç½‘ç»œé£é™©å¢åŠ ã€‚å¦å¤–å¯¹Javaç³»ç»Ÿè€Œè¨€å†…å­˜å¢åŠ å¹¶ä¸èƒ½å¸¦æ¥é‚£ä¹ˆå¤§çš„å¥½å¤„ã€‚ è°æ¥å‹ç¼©ã€åœ¨å“ªé‡Œå‹ç¼©ä¹Ÿæ˜¯è®©äººæ¯”è¾ƒçº ç»“çš„é—®é¢˜ï¼Œå¢åŠ ä¸€å±‚Cacheï¼Œå¿…ç„¶å¢åŠ äº†æ•°æ®çš„ä¼ è¾“ï¼Œé‚£ä¹ˆè°æ¥å‹ç¼©å°±ä¼šå½±å“åˆ°Cacheçš„å®¹é‡å’Œç½‘ç»œæ•°æ®çš„ä¼ è¾“é‡å°±ã€‚ ç½‘å¡é€‰æ‹©ï¼Ÿç½‘å¡é€‰æ‹©å…¶å®æ˜¯ä¸ªæˆæœ¬é—®é¢˜ï¼Œé¿å…ç½‘ç»œç“¶é¢ˆå¯ä»¥é€‰æ‹©ä¸‡å…†ç½‘å¡å’Œäº¤æ¢æœºï¼Œä½†æ˜¯å¿…ç„¶æˆæœ¬å¢åŠ ã€‚  æ–¹æ¡ˆ1.é‡‡ç”¨Nginx+Cache+Javaç»“æ„çš„è™šæ‹Ÿæœºå•æœºéƒ¨ç½² è¿™ç§æ–¹æ¡ˆæ˜¯æœ€ç®€å•çš„é™æ€åŒ–æ–¹æ¡ˆï¼Œåªéœ€è¦åœ¨é™æ€åŒ–æ”¹é€ çš„åŸºç¡€ä¸Šï¼Œåœ¨å‰é¢çš„æ¶æ„ä¸ŠåŠ ä¸€å±‚Cachå°±è¡Œï¼Œä»–çš„ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š\nä¼˜ç‚¹ï¼š\n æ²¡æœ‰ç½‘ç»œç“¶é¢ˆï¼Œä¸éœ€è¦æ”¹é€ ç½‘ç»œï¼› æœºå™¨å¢åŠ ï¼Œä¹Ÿæ²¡æœ‰ç½‘å¡ç“¶é¢ˆï¼› æœºå™¨æ•°å¢å¤šï¼Œæ•…éšœé£é™©å‡å°‘ã€‚  ç¼ºç‚¹:\n æœºå™¨å¢åŠ ï¼Œç¼“å­˜å‘½ä¸­ç‡ä¸‹é™ï¼› ç¼“å­˜åˆ†æ•£ï¼Œå¤±æ•ˆåŠŸèƒ½éš¾åº¦å¢åŠ ï¼› Cacheå’ŒJBosséƒ½ä¼šäº‰æŠ¢å†…å­˜ï¼›  è¯¥æ–¹æ¡ˆè™½ç„¶æ¯”è¾ƒç®€å•ï¼Œä½†ä¹Ÿèƒ½å¤Ÿè§£å†³çƒ­ç‚¹å•†å“çš„è®¿é—®é—®é¢˜ï¼Œä¾‹å¦‚åšå¤§ä¿ƒæ—¶ï¼Œå•†å“æ•°æ¯”è¾ƒå°‘ï¼Œåœ¨æœ‰é™å†…å­˜ä¸­ä»»ç„¶èƒ½å¤Ÿå‘½ä¸­è¿™äº›å•†å“ï¼›å¦å¤–é’ˆå¯¹ä¸€äº›æ¶æ„æ”»å‡»ä¹Ÿååˆ†æœ‰æ•ˆï¼Œè¿™æ˜¯çš„å‘½ä¸­ç‡èƒ½è¾¾åˆ°90%ä»¥ä¸Šï¼Œä½†æ˜¯å¯¹ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½æ²¡æœ‰å¾ˆå¤šæå‡ã€‚\næ–¹æ¡ˆ2.é‡‡ç”¨Nginx+Cache+Javaç»“æ„å®ä½“æœºå•æœºéƒ¨ç½² è¿™ç§æ–¹æ¡ˆåœ¨å‰é¢çš„åŸºç¡€ä¸Šå°†è™šæ‹Ÿæœºæ”¹æˆå®ä½“æœºï¼Œå¢å¤§Cacheçš„å†…å­˜ï¼Œå¹¶ä¸”é‡‡ç”¨äº†ä¸€è‡´æ€§Hashåˆ†ç»„çš„æ–¹å¼æ¥æå‡å‘½ä¸­ç‡ï¼Œè¿™é‡Œå°†Cacheåˆ†æˆè‹¥å¹²ç»„ï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°å‘½ä¸­ç‡å’Œè®¿é—®çƒ­ç‚¹çš„å¹³è¡¡ã€‚\nä¼˜ç‚¹ï¼š\n æ—¢æ²¡æœ‰ç½‘ç»œç“¶é¢ˆï¼Œä¹Ÿèƒ½ä½¿ç”¨å¤§å†…å­˜ï¼› å‡å°‘Varnishæœºå™¨ï¼Œæå‡å‘½ä¸­ç‡ï¼› æå‡å‘½ä¸­ç‡ï¼Œèƒ½å‡å°‘Gzipå‹ç¼©ï¼› å‡å°‘Cacheå¤±æ•ˆçš„å‹åŠ›ã€‚  è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒç†æƒ³çš„æ–¹æ¡ˆï¼Œåœ¨æ­£å¸¸è¯·æ±‚ä¸‹ä¹Ÿèƒ½è¾¾åˆ°50%å·¦å³çš„å‘½ä¸­ç‡ï¼Œå¯¹ä¸€äº›åŸºæ•°æ•°æ®æ¯”è¾ƒå°çš„ç³»ç»Ÿå¦‚å¤©çŒ«Detailï¼Œå‘½ä¸­ç‡èƒ½è¾¾åˆ°80%å·¦å³ï¼Œè¿™æ ·çš„å‘½ä¸­ç‡æ¯”è¾ƒç†æƒ³ã€‚\næ–¹æ¡ˆ3.ç»Ÿä¸€Cacheå±‚ ç»Ÿä¸€Cacheå±‚æ˜¯ä¸ªæ›´ç†æƒ³çš„æ¨å¹¿æ–¹æ¡ˆã€‚\nå°†Cacheå±‚å•ç‹¬æ‹¿å‡ºæ¥ç»Ÿä¸€ç®¡ç†å¯ä»¥å‡å°‘è¿ç»´æˆæœ¬ï¼ŒåŒäº‹ä¹Ÿæ–¹ä¾¿å…¶ä»–é™æ€åŒ–ç³»ç»Ÿæ¥å…¥ã€‚\nä¼˜ç‚¹ï¼š\n å¯ä»¥å‡å°‘å¤šä¸ªåº”ç”¨æ¥å…¥Cacheçš„æˆæœ¬ï¼Œæ¥å…¥çš„åº”ç”¨åªç»´æŠ¤è‡ªå·±çš„Javaç³»ç»Ÿå°±å¥½ï¼Œä¸ç”¨å•ç‹¬ç»´æŠ¤Cacheï¼Œåªéœ€å…³å¿ƒå¦‚ä½•ä½¿ç”¨ï¼Œæ›´å¥½åœ°è®©æ›´å¤šæµé‡å‹ç³»ç»Ÿæ¥å…¥ä½¿ç”¨ã€‚ ç»Ÿä¸€Cacheæ˜“äºç»´æŠ¤ï¼Œä¾‹å¦‚åé¢åŠ å¼ºç›‘æ§ã€é…ç½®çš„è‡ªåŠ¨åŒ–ï¼Œç»Ÿä¸€ç»´æŠ¤ã€å‡çº§æ¯”è¾ƒæ–¹ä¾¿ã€‚ *å¯ä»¥å…±äº«å†…å­˜ï¼Œæœ€å¤§åŒ–åˆ©ç”¨å†…å­˜ï¼Œä¸åŒç³»ç»Ÿä¹‹é—´çš„å†…å­˜å¯ä»¥åŠ¨æ€åˆ‡æ¢ï¼Œæœ‰æ•ˆåº”å¯¹æ”»å‡»æƒ…å†µã€‚ æ›´æœ‰åŠ©äºå®‰å…¨é˜²æŠ¤ã€‚  ä¸‰ã€å¦‚ä½•è§£å†³å¤±æ•ˆé—®é¢˜ ç¼“å­˜çš„å¤±æ•ˆåŒæ ·æ—¶é™æ€åŒ–æ¶æ„éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œè¿™é‡Œé‡‡ç”¨ä¸»åŠ¨å¤±æ•ˆå’Œè¢«åŠ¨å¤±æ•ˆç›¸ç»“åˆçš„æ–¹å¼ã€‚\nè¢«åŠ¨å¤±æ•ˆ\nã€€è¢«åŠ¨å¤±æ•ˆä¸»è¦å¤„ç†å¦‚æ¨¡æ¿å˜æ›´å’Œä¸€äº›å¯¹æ—¶æ•ˆæ€§ä¸æ˜¯å¤ªæ•æ„Ÿçš„æ•°æ®çš„å¤±æ•ˆï¼Œé‡‡ç”¨è®¾ç½®Cacheæ—¶é—´é•¿åº¦è¿™ç§è‡ªåŠ¨å¤±æ•ˆçš„æ–¹å¼ï¼ŒåŒæ—¶ä¹Ÿè¦å¼€å‘ä¸€ä¸ªåå°ç®¡ç†ç•Œé¢æ¥ç”¨äºæ‰‹å·¥å¤±æ•ˆæŸäº›Cacheã€‚\nä¸»åŠ¨å¤±æ•ˆ\nã€€ä¸»åŠ¨æœ‰å¦‚ä¸‹å‡ ç§ï¼š\n Cacheå¤±æ•ˆä¸­å¿ƒç›‘æ§æ•°æ®åº“è¡¨å˜åŒ–ï¼Œå‘é€Purgeå¤±æ•ˆè¯·æ±‚ï¼› è£…ä¿®æ—¶é—´æˆ³æ¯”è¾ƒå¤±æ•ˆè£…ä¿®å†…å®¹ï¼› Javaç³»ç»Ÿå‘å¸ƒï¼Œæ¸…ç©ºCache; Vmæ¨¡æ¿å‘å¸ƒï¼Œæ¸…ç©ºCache;\nå…¶ä¸­ä¸»è¦ä½¿ç”¨ç¬¬ä¸€ä¸ªå¤±æ•ˆä¸­å¿ƒï¼Œè¿™ä¸ªå¤±æ•ˆä¸­å¿ƒé€šè¿‡ç›‘æ§æ•°æ®åº“å…³é”®æ•°æ®å¯¹åº”è¡¨çš„å˜æ›´ä»¥å‘é€Purgeå¤±æ•ˆè¯·æ±‚ç»™Cacheå±‚æ¥æ¸…é™¤ç¼“å­˜æ•°æ®ã€‚  å››ã€æœåŠ¡ç«¯é™æ€åŒ–æ–¹æ¡ˆçš„æ¼”è¿›ï¼šCDNåŒ– åœ¨é™æ€åŒ–ç³»ç»Ÿè¿‡åï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå°†Cacheå±‚å‰ç§»åˆ°CDNï¼ˆContent Delivery Network å†…å®¹åˆ†å¸ƒç½‘ç»œï¼Œå®ƒä¼šå°†ç”¨æˆ·çš„è¯·æ±‚è‡ªåŠ¨åˆ†é…åˆ°æœ€è¿‘çš„æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸”ä»–ä¼šç¼“å­˜ç½‘ç«™çš„é™æ€å†…å®¹ï¼ŒåŠ é€Ÿç½‘ç«™çš„å“åº”é€Ÿåº¦ï¼‰ï¼Œå› ä¸ºCDNç¦»ç”¨æˆ·æœ€è¿‘ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚\nä½†æ˜¯æƒ³è¦CDNåŒ–ï¼Œå­˜åœ¨å‡ ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼š\n å¤±æ•ˆé—®é¢˜ã€‚ç”±äºCDNåˆ†å¸ƒåœ¨å…¨å›½ï¼Œè¦åœ¨ç§’çº§æ—¶é—´å†…å¤±æ•ˆè¿™ä¹ˆå¹¿æ³›çš„Cacheï¼Œå¯¹CDNçš„å¤±æ•ˆç³»ç»Ÿè¦æ±‚å¾ˆé«˜ã€‚ å‘½ä¸­ç‡é—®é¢˜ã€‚Cacheæœ€é‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡å°±æ˜¯è¦ä¿è¯é«˜å‘½ä¸­ç‡ï¼Œä¸ç„¶Cacheå°±å¤±å»äº†æ„ä¹‰ã€‚åŒæ ·ï¼Œå¦‚æœå°†æ•°æ®å…¨éƒ¨æ”¾åˆ°å…¨å›½çš„CDNä¸Šï¼ŒCacheåˆ†æ•£æ˜¯å¿…ç„¶çš„ï¼ŒCacheåˆ†æ•£å¯¼è‡´è®¿é—®çš„è¯·æ±‚å‘½ä¸­åˆ°åŒä¸€ä¸ªè¯·æ±‚çš„Cacheé™ä½ï¼Œé‚£ä¹ˆå‘½ä¸­ç‡å°±æˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚ å‘å¸ƒæ›´æ–°é—®é¢˜ã€‚ä½œä¸ºä¸€ä¸ªä¸šåŠ¡ç³»ç»Ÿï¼Œæ¯å‘¨éƒ½æœ‰æ—¥å¸¸ä¸šåŠ¡éœ€è¦å‘å¸ƒï¼Œæ‰€ä»¥å‘å¸ƒç³»ç»Ÿæ˜¯å¦ç®€å•ã€å¿«é€Ÿä¹Ÿæ˜¯ä¸€ä¸ªä¸å¯å›é¿çš„é—®é¢˜ï¼Œæœ‰é—®é¢˜å¿«é€Ÿå›æ»šå’Œé—®é¢˜æ’æŸ¥çš„ç®€ä¾¿æ€§ä¹Ÿæ˜¯è¦è€ƒè™‘çš„æ–¹é¢ã€‚  è§£å†³å¤±æ•ˆé—®é¢˜\né‡‡ç”¨çº§è”çš„å¤±æ•ˆç»“æ„ï¼Œä¸»åŠ¨å‘Purgeè¯·æ±‚ç»™Cacheè½¯ä»¶å¤±æ•ˆçš„æ–¹å¼ï¼Œè¿™ç§å¤±æ•ˆç”±å¤±æ•ˆä¸­å¿ƒå°†å¤±æ•ˆè¯·æ±‚å‘é€ç»™æ¯ä¸ªCDNèŠ‚ç‚¹ä¸Šçš„Consoleæœºï¼Œç„¶åConcoleæœºå‘é€Purgeè¯·æ±‚ç»™æ¯å°Cacheæœºå™¨ã€‚\nè§£å†³å‘½ä¸­ç‡é—®é¢˜\nç°é˜¶æ®µæŠŠCacheæ”¾åˆ°å…¨å›½æ‰€æœ‰çš„CDNèŠ‚ç‚¹ä¸Šï¼Œç°é˜¶æ®µæ˜¯ä¸å¤ªå¯èƒ½å®ç°çš„ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥é€‰æ‹©è‹¥å¹²ä¸ªèŠ‚ç‚¹æ¥å®æ–½ã€å°è¯•äº†ï¼Ÿ\nè¿™æ ·çš„èŠ‚ç‚¹éœ€è¦æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š\n é è¿‘è®¿é—®é‡æ¯”è¾ƒé›†ä¸­çš„åœ°åŒºï¼› ç¦»ä¸»ç«™ç›¸å¯¹è¾ƒè¿œï¼› èŠ‚ç‚¹åˆ°ä¸»ç«™çš„ç½‘ç»œæ¯”è¾ƒå¥½ä¸”ç¨³å®šï¼› èŠ‚ç‚¹å®¹é‡æ¯”è¾ƒå¤§ï¼Œä¸ä¼šå ç”¨å…¶ä»–CDNå¤ªå¤šçš„èµ„æºï¼› èŠ‚ç‚¹ä¸è¦å¤ªå¤šï¼›  åŸºäºä¸Šé¢å‡ ä¸ªå› ç´ ï¼Œé€‰æ‹©CDNçš„äºŒçº§Cacheæ¯”è¾ƒåˆé€‚ã€‚\nä½¿ç”¨CDNçš„äºŒçº§Cacheä½œä¸ºç¼“å­˜ï¼Œå¯ä»¥è¾¾åˆ°å’Œå‰é¢æœåŠ¡ç«¯é™æ€åŒ–Cacheç±»ä¼¼çš„å‘½ä¸­ç‡ï¼Œå› ä¸ºèŠ‚ç‚¹æ•°ä¸å¤šï¼ŒCacheä¸æ˜¯å¾ˆåˆ†æ•£ï¼Œè®¿é—®é‡ä¹Ÿæ¯”è¾ƒé›†ä¸­ï¼Œè¿™æ ·ä¹Ÿè§£å†³äº†å‘½ä¸­ç‡çš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæä¾›ç»™ç”¨æˆ·æœ€å¥½çš„è®¿é—®ä½“éªŒï¼Œæ˜¯åœ¨å½“å‰ç¯å¢ƒä¸‹æ¯”è¾ƒç†æƒ³çš„CDNåŒ–æ–¹æ¡ˆã€‚\n*æœ¬æ–‡æ˜¯ã€Šæ·±å…¥åˆ†æJAVA WEBæŠ€æœ¯å†…å¹•ã€‹ä¸€ä¹¦çš„æ€»ç»“å’ŒèŠ‚é€‰\n","id":80,"section":"posts","summary":"æœ¬ç¯‡æ–‡ç« ç€é‡æ•´ç†ä»€ä¹ˆæ˜¯é™æ€åŒ–ç³»ç»Ÿæ¶æ„ï¼Œä»¥åŠé™æ€åŒ–æ¶æ„çš„å‡ ç§æ–¹æ¡ˆã€‚ é¦–å…ˆå…ˆè´´ä¸€ä¸ªæ·˜å®ç³»ç»Ÿå‡çº§çš„å†ç¨‹(09~13)ï¼š 09å¹´ï¼Œç³»ç»Ÿæ‹†åˆ†ï¼Œé™æ€æ–‡ä»¶åˆå¹¶","tags":["website build"],"title":"å¤§æµè§ˆé‡ç³»ç»Ÿçš„é™æ€åŒ–æ¶æ„è®¾è®¡","uri":"https://www.mingaccount.com/2018/08/static-sturcture-design/","year":"2018"},{"content":"æœ€è¿‘åœ¨å¼€å‘ä¸­ç¢°è§ä¸€ä¸ªé—®é¢˜ï¼Œåç«¯ä»£ç è°ƒç”¨æ¥å£ï¼Œåœ¨è¯·æ±‚ç«¯å‚æ•°æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯å½“æ¥å£æ¥æ”¶åˆ°å‚æ•°æ—¶ï¼Œå…¶ä¸­çš„åŠ å·å…¨éƒ¨å˜ä¸ºäº†ç©ºæ ¼ã€‚\nåœ¨æŸ¥é˜…èµ„æ–™åå‘ç°æ˜¯URLDecoderæ–¹æ³•çš„é—®é¢˜ï¼Œä»¥ä¸‹æ˜¯URLDecoderçš„æ–‡æ¡£è¯´æ˜ï¼š\nThe following rules are applied in the conversion:\n The alphanumeric characters \u0026ldquo;a\u0026rdquo; through \u0026ldquo;z\u0026rdquo;, \u0026ldquo;A\u0026rdquo; through \u0026ldquo;Z\u0026rdquo; and \u0026ldquo;0\u0026rdquo; through \u0026ldquo;9\u0026rdquo; remain the same. The special characters \u0026ldquo;.\u0026rdquo;, \u0026ldquo;-\u0026rdquo;, \u0026ldquo;*\u0026rdquo;, and \u0026ldquo;_\u0026rdquo; remain the same. The plus sign \u0026ldquo;+\u0026rdquo; is converted into a space character \u0026quot; \u0026quot; . A sequence of the form \u0026ldquo;%xy\u0026rdquo; will be treated as representing a byte where xy is the two-digit hexadecimal representation of the 8 bits. Then, all substrings that contain one or more of these byte sequences consecutively will be replaced by the character(s) whose encoding would result in those consecutive bytes. The encoding scheme used to decode these characters may be specified, or if unspecified, the default encoding of the platform will be used  æ–‡æ¡£ä¸­å¾ˆæ˜æ˜¾ï¼ŒURLDecoderä¼šå°†åŠ å·è½¬å˜ä¸ºç©ºæ ¼ï¼Œå…¶ä»–çš„ç¬¦å·\u0026quot;.\u0026quot;, \u0026ldquo;-\u0026rdquo;, \u0026ldquo;*\u0026rdquo;, \u0026ldquo;_\u0026ldquo;å°†ä¿æŒä¸å˜ã€‚\nSpring mvcæ¡†æ¶åœ¨ç»™å‚æ•°èµ‹å€¼çš„æ—¶å€™è°ƒç”¨äº†URLDecoderï¼Œé‚£è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨è¯·æ±‚çš„æ—¶å€™å¯¹\u0026rdquo;+\u0026ldquo;åšå¤„ç†ï¼š\nString plusEncode = URLEncoder.encode(\u0026quot;+\u0026quot;, \u0026quot;UTF-8\u0026quot;); param = param.replaceAll(\u0026quot;\\\\+\u0026quot;, plusEncode);  è¿™é‡Œåœ¨è¯·æ±‚å‘é€å‰ï¼Œå°†åŠ å·ç”¨URLEcoderè¿›è¡Œç¼–ç ï¼Œå¹¶å°†å‚æ•°jsonä¸­çš„æ‰€æœ‰åŠ å·æ›¿æ¢æˆç¼–ç åçš„å­—ç¬¦ã€‚\n","id":81,"section":"posts","summary":"æœ€è¿‘åœ¨å¼€å‘ä¸­ç¢°è§ä¸€ä¸ªé—®é¢˜ï¼Œåç«¯ä»£ç è°ƒç”¨æ¥å£ï¼Œåœ¨è¯·æ±‚ç«¯å‚æ•°æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯å½“æ¥å£æ¥æ”¶åˆ°å‚æ•°æ—¶ï¼Œå…¶ä¸­çš„åŠ å·å…¨éƒ¨å˜ä¸ºäº†ç©ºæ ¼ã€‚ åœ¨æŸ¥é˜…èµ„æ–™åå‘ç°æ˜¯U","tags":["java"],"title":"è¯·æ±‚å‚æ•°ä¸­çš„+å·ä¸ºä»€ä¹ˆä¼šä¸¢å¤±,å¦‚ä½•ä¿è¯å‚æ•°å®Œæ•´","uri":"https://www.mingaccount.com/2018/08/request-param-lost-add-symbol/","year":"2018"},{"content":"maven packageç”Ÿæˆçš„jaråŒ…é»˜è®¤æ˜¯æ²¡æœ‰é¡¹ç›®ä¾èµ–çš„ éœ€è¦å¯¼å‡ºçš„jaråŒ…åŒ…å«é¡¹ç›®æ‰€æœ‰çš„ä¾èµ–ï¼Œéœ€è¦é…ç½®pomï¼š\n\u0026lt;build\u0026gt;\r\u0026lt;finalName\u0026gt;yourApp\u0026lt;/finalName\u0026gt;\r\u0026lt;plugins\u0026gt;\r\u0026lt;plugin\u0026gt;\r\u0026lt;groupId\u0026gt;org.apache.maven.plugins\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;maven-shade-plugin\u0026lt;/artifactId\u0026gt;\r\u0026lt;configuration\u0026gt;\r\u0026lt;shadedArtifactAttached\u0026gt;true\u0026lt;/shadedArtifactAttached\u0026gt;\r\u0026lt;shadedClassifierName\u0026gt;jar-with-dependencies\u0026lt;/shadedClassifierName\u0026gt; \u0026lt;!-- Any name that makes sense --\u0026gt;\r\u0026lt;outputDirectory\u0026gt;../output/jar-with-dependencies\u0026lt;/outputDirectory\u0026gt;\r\u0026lt;/configuration\u0026gt;\r\u0026lt;/plugin\u0026gt;\r\u0026lt;/plugins\u0026gt;\r\u0026lt;/build\u0026gt;\r æ³¨æ„ä»¥ä¸Šé…ç½®ä¹‹åï¼Œmavenè¿˜æ˜¯ä¼šç”Ÿæˆä¸€ä¸ªæ— ä¾èµ–çš„jaråŒ…ï¼Œä½†æ˜¯åœ¨ä½ è®¾ç½®çš„\u0026lt;outputDirectory\u0026gt;è·¯å¾„ä¸‹ä¼šæœ‰ä¸€ä¸ªå…¨ä¾èµ–çš„jaråŒ…\n","id":82,"section":"posts","summary":"maven packageç”Ÿæˆçš„jaråŒ…é»˜è®¤æ˜¯æ²¡æœ‰é¡¹ç›®ä¾èµ–çš„ éœ€è¦å¯¼å‡ºçš„jaråŒ…åŒ…å«é¡¹ç›®æ‰€æœ‰çš„ä¾èµ–ï¼Œéœ€è¦é…ç½®pomï¼š \u0026lt;build\u0026gt; \u0026lt;finalName\u0026gt;yourApp\u0026lt;/finalName\u0026gt; \u0026lt;plugins\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.apache.maven.plugins\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;maven-shade-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;shadedArtifactAttached\u0026gt;true\u0026lt;/shadedArtifactAttached\u0026gt; \u0026lt;shadedClassifierName\u0026gt;jar-with-dependencies\u0026lt;/shadedClassifierName\u0026gt; \u0026lt;!-- Any name that makes sense --\u0026gt; \u0026lt;outputDirectory\u0026gt;../output/jar-with-dependencies\u0026lt;/outputDirectory\u0026gt; \u0026lt;/configuration\u0026gt;","tags":["maven"],"title":"Maven packageå®Œæ•´ä¾èµ–jaråŒ…","uri":"https://www.mingaccount.com/2018/07/maven-package-complete-dependency/","year":"2018"},{"content":"èƒŒæ™¯ é»˜è®¤æƒ…å†µä¸‹@Valueæ³¨è§£å¦‚æœæ²¡æœ‰åœ¨propertiesæ–‡ä»¶ä¸­å­˜åœ¨å¯¹åº”å€¼ï¼Œé‚£ä¹ˆå¯åŠ¨é¡¹ç›®çš„æ—¶å€™ä¼šç›´æ¥æŠ¥é”™ã€‚\nè§£å†³æ–¹æ¡ˆ å¯ä»¥ç»™@Valueæ³¨è§£è®¾å®šé»˜è®¤å€¼ï¼Œè¿™æ ·å°±ç®—é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰å¯¹åº”å€¼ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ã€‚\n@Component\rpublic class ConfigurationProperties{\r@Value(\u0026quot;${custom.values.val1:#{null}\u0026quot;)\rprivate String val1;\r@Value(\u0026quot;${custom.values.val2:hello}\u0026quot;)\rprivate String val2;\r}\r å¯ä»¥é€šè¿‡#{null}çš„æ–¹å¼å°†é»˜è®¤å€¼è®¾ä¸ºnull\n","id":83,"section":"posts","summary":"èƒŒæ™¯ é»˜è®¤æƒ…å†µä¸‹@Valueæ³¨è§£å¦‚æœæ²¡æœ‰åœ¨propertiesæ–‡ä»¶ä¸­å­˜åœ¨å¯¹åº”å€¼ï¼Œé‚£ä¹ˆå¯åŠ¨é¡¹ç›®çš„æ—¶å€™ä¼šç›´æ¥æŠ¥é”™ã€‚ è§£å†³æ–¹æ¡ˆ å¯ä»¥ç»™@Valueæ³¨è§£è®¾","tags":["spring"],"title":"Spring boot @Valueè®¾å®šé»˜è®¤å€¼ é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰ä¹Ÿä¸ä¼šæŠ¥é”™","uri":"https://www.mingaccount.com/2018/07/spring-boot-properties-default-value/","year":"2018"},{"content":"win10å³é”®å¾½æ ‡-\u0026gt;Windows Powershell(ç®¡ç†å‘˜)\n dispark list disk å±•ç¤ºæ‰€æœ‰ç£ç›˜ select disk # ç¡®è®¤å¥½æ‰€é€‰ç›®æ ‡ç£ç›˜ï¼Œ#å·ä¸ºid clean åˆ é™¤é€‰ä¸­ç£ç›˜çš„æ‰€æœ‰å†…å®¹ exit  ","id":84,"section":"posts","summary":"win10å³é”®å¾½æ ‡-\u0026gt;Windows Powershell(ç®¡ç†å‘˜) dispark list disk å±•ç¤ºæ‰€æœ‰ç£ç›˜ select disk # ç¡®è®¤å¥½æ‰€é€‰ç›®æ ‡ç£ç›˜ï¼Œ#å·ä¸ºid clean åˆ é™¤é€‰ä¸­ç£ç›˜","tags":["windows"],"title":"Windowsåˆ é™¤å¯åŠ¨ç›˜çš„æ‰€æœ‰åˆ†åŒº","uri":"https://www.mingaccount.com/2018/07/windows-delete-disk-partition/","year":"2018"},{"content":"åœ¨é˜…è¯»Venkat Subramaniamçš„è‘—ä½œã€ŠFunctional Programming in Javaã€‹ ä¹‹åï¼Œæ–¹æ³•æ¨¡å¼å’Œlambdaå®Œç¾ç»“åˆè®©æˆ‘å°è±¡æ·±åˆ»ã€‚\nè¿™ç§æ¨¡å¼ç»å¸¸ç”¨ä½œæ•°æ®æºå¤„ç†ï¼Œä½†ä¹Ÿé€‚ç”¨äºç±»ä¼¼çš„æƒ…å†µã€‚è¿™ç§æ¨¡å¼å¯ä»¥è®©ä½ é›†ä¸­æ³¨æ„åŠ›åœ¨æ ¸å¿ƒåŠŸèƒ½ç‚¹ä¸Šï¼Œè€Œä¸ç”¨æ‹…å¿ƒç±»é‡Œé¢æœ‰è¿‡å¤šé‡å¤çš„ä»£ç ã€‚\nè¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªäº‹åŠ¡å¤„ç†ä½œä¸ºäº‹ä¾‹ã€‚\næ¥å£ Transactionï¼Œä»–æœ‰ä¸€ä¸ªæ‰§è¡Œæ–¹æ³•ã€‚\nimport java.sql.Connection;\rimport java.sql.SQLException;\rpublic interface Transaction{\rpublic void execute(Connection connection) throws SQLException;\r}\r è¿™ä¸ªæ¥å£ä»£è¡¨æˆ‘ä»¬æƒ³åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œä»€ä¹ˆæ“ä½œã€‚è¿™æ˜¯ä¸€ä¸ª SAM(Single Abstract Method) ç±»å‹ï¼Œæ„å‘³ç€æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨lambdaè¡¨è¾¾å¼å»å®ç°ä»–ã€‚\nç„¶åæˆ‘ä»¬è½®åˆ°æˆ‘ä»¬çš„ä¸»è§’ç™»åœºï¼ŒTransactionHandlerã€‚\nimport java.sql.Connection; import java.sql.DriverManager;\rpublic class TransactionHandler {\rpublic static void runInTransaction(Transaction transaction) throws Exception {\rConnection dbConnection = createDatabaseConnection();\rdbConnection.setAutoCommit(false);\rtry {\rSystem.out.println(\u0026quot;Starting transaction\u0026quot;);\rtransaction.execute(dbConnection);\rSystem.out.println(\u0026quot;Committing transaction\u0026quot;);\rdbConnection.commit();\r} catch (Exception e) {\rSystem.out.println(e.getMessage());\rSystem.out.println(\u0026quot;Rolling back...\u0026quot;);\rdbConnection.rollback();\r} finally {\rdbConnection.close();\r}\r}\rprivate static Connection createDatabaseConnection() throws Exception {\rClass.forName(\u0026quot;com.mysql.jdbc.Driver\u0026quot;);\rreturn DriverManager.getConnection(\u0026quot;jdbc:mysql://localhost:3306/ticket_system\u0026quot;, \u0026quot;user\u0026quot;, \u0026quot;password\u0026quot;);\r}\r}\r ä»–åŒ…å«äº†ä¸€ä¸ªé™æ€æ–¹æ³•,ä»–çš„èŒè´£æ˜¯è¿è¡Œæˆ‘ä»¬çš„äº‹åŠ¡å’Œåœ¨å¼‚å¸¸æƒ…å†µä¸‹å›æ»š.\næˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ç¥¨åŠ¡ç³»ç»Ÿå»å±•ç¤ºTransactionHandleræ˜¯æ€ä¹ˆæ ·å’Œlambdaä¸€èµ·å·¥ä½œçš„.\né¦–å…ˆæ˜¯ä¸€ä¸ªæˆåŠŸçš„äº‹åŠ¡:\n@Test\rpublic void testSuccessfulPurchase() throws Exception {\rTransactionHandler.runInTransaction(connection -\u0026gt; {\rint ticketId = findAvailableTicket(connection);\rreserveTicket(ticketId, connection);\rmarkAsBought(ticketId, connection);\r});\rassertEquals(getNrOfTicketsIn(TicketState.AVAILABLE), 9);\rassertEquals(getNrOfTicketsIn(TicketState.RESERVED), 0);\rassertEquals(getNrOfTicketsIn(TicketState.BOUGHT), 1);\r}\r æ§åˆ¶å°è¾“å‡º:\nStarting transaction Reserving ticket with id 1 Marking ticket with id 1 as bought Committing transaction  ç„¶åæ˜¯å¤±è´¥çš„äº‹åŠ¡:\n@Test\rpublic void testFailedPurchase() throws Exception {\rTransactionHandler.runInTransaction(connection -\u0026gt; {\rint ticketId = findAvailableTicket(connection);\rreserveTicket(ticketId, connection);\rthrow new IllegalStateException(\u0026quot;Not approved credit card\u0026quot;);\r});\rassertEquals(getNrOfTicketsIn(TicketState.AVAILABLE), 10);\rassertEquals(getNrOfTicketsIn(TicketState.RESERVED), 0);\rassertEquals(getNrOfTicketsIn(TicketState.BOUGHT), 0);\r}\r è¿™ä¸ªæµ‹è¯•é¢„å®šäº†ä¸€å¼ ç¥¨,ç„¶åæŠ›å‡ºå¼‚å¸¸,è§¦å‘å›æ»šå–æ¶ˆé¢„çº¦;\næ§åˆ¶å°è¾“å‡º:\nStarting transaction Reserving ticket with id 1 Not approved credit card Rolling back...  lambdaè¡¨è¾¾å¼çš„å¤„ç†æ–¹å¼æ˜¯ç®€æ´ä¼˜é›…çš„ï¼Œè€ŒåŒ¿åå†…éƒ¨ç±»éœ€è¦åˆ›å»ºç±»å¹¶å®ä¾‹åŒ–ä»–ï¼Œä½ ä¸è§‰å¾—ä»–æœ‰äº›å¤ªç½—å—¦äº†å—?\nç•™æ„æˆ‘ä»¬æ˜¯å¦‚ä½•ä½¿ç”¨lambdaè¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªå·¥å…·å»æµ‹è¯•TransactionHandlerçš„æ¯ä¸ªæ–¹é¢\nä½ èƒ½åœ¨è¿™é‡Œæ‰¾åˆ°å®Œæ•´çš„ä¾‹å­ GitHub\n*è‹±æ–‡é“¾æ¥ï¼šdeadCodeRising\n*åŸåˆ›è¯‘æ–‡\n","id":85,"section":"posts","summary":"åœ¨é˜…è¯»Venkat Subramaniamçš„è‘—ä½œã€ŠFunctional Programming in Javaã€‹ ä¹‹åï¼Œæ–¹æ³•æ¨¡å¼å’Œlambdaå®Œç¾ç»“åˆè®©æˆ‘å°è±¡æ·±åˆ»ã€‚ è¿™ç§æ¨¡å¼","tags":["java"],"title":"[è¯‘]lambdaè¡¨è¾¾å¼å¯¹ SAM ï¼ˆå•ä¸ªæŠ½è±¡æ–¹æ³•ç±»ï¼‰typeçš„å¤„ç†æ–¹å¼","uri":"https://www.mingaccount.com/2018/06/lambda-sam/","year":"2018"},{"content":"npm config set registry https://registry.npm.taobao.org\r ","id":86,"section":"posts","summary":"npm config set registry https://registry.npm.taobao.org","tags":["npm"],"title":"Npmæ·˜å®é•œåƒ","uri":"https://www.mingaccount.com/2018/06/npm-taobao-mirror/","year":"2018"},{"content":"â€œJAVAåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„æ–¹æ³•å’Œå±æ€§â€\nä¸€ã€ç±»å¯¹è±¡çš„è·å– 1.é€šè¿‡å¯¹è±¡è·å– Object obj = new Object();\robj.getClass();\r 2.é€šè¿‡ç±»åè·å– Object.class;\r 3.é€šè¿‡ç±»çš„è·¯å¾„åè·å– Class.forName(\u0026quot;com.metadata.Student\u0026quot;);\r äºŒã€ç±»çš„å®ä¾‹åŒ–å’Œæ„é€ å‡½æ•° è·å–åˆ°çš„classå¯¹è±¡å¯ä»¥ç›´æ¥é€šè¿‡clazz.newInstance()æ–¹æ³•å®ä¾‹åŒ–ï¼Œä½†æ˜¯éœ€è¦ç›®æ ‡ç±»æœ‰é»˜è®¤æ— å‚æ„é€ å‡½æ•°ï¼Œä¸ç„¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\nåœ¨ç±»æ²¡æœ‰é»˜è®¤æ— å‚æ„é€ å‡½æ•°ï¼Œæˆ–è€…éœ€è¦æŸä¸ªå…·ä½“çš„æ„é€ å‡½æ•°æ¥å®ä¾‹åŒ–çš„æƒ…å†µï¼Œéœ€è¦é€šè¿‡Constructorç±»çš„newInstance()æ¥å®Œæˆã€‚\n1.è·å–å…¬æœ‰æ„é€ å‡½æ•°ï¼Œä¸åŒ…æ‹¬çˆ¶ç±» //Class\rpublic Constructor\u0026lt;?\u0026gt;[] getConstructors() public Constructor\u0026lt;T\u0026gt; getConstructor(Class\u0026lt;?\u0026gt;... parameterTypes)\r 2.è·å–å½“å‰ç±»æ„é€ å‡½æ•°ï¼Œå¿½ç•¥ä¿®é¥°ç¬¦ //Class\rpublic Constructor\u0026lt;?\u0026gt;[] getDeclaredConstructors()\rpublic Constructor\u0026lt;T\u0026gt; getDeclaredConstructor(Class\u0026lt;?\u0026gt;... parameterTypes)\r æ„é€ å‡½æ•°è°ƒç”¨\n//Constructor\rpublic T newInstance(Object... initargs)\r//å¿½ç•¥ä¿®é¥°ç¬¦ï¼Œå¼ºåˆ¶è°ƒç”¨\rpublic void setAccessible(boolean flag)\r ä¸‰ã€ç±»æˆå‘˜å˜é‡çš„è·å– 1.è·å–å…¬æœ‰å˜é‡ï¼ŒåŒ…æ‹¬çˆ¶ç±» //Class\rpublic Field[] getFields()\rpublic Field getField(String name)\r 2.è·å–å½“å‰ç±»æˆå‘˜å˜é‡ï¼Œå¿½ç•¥ä¿®é¥°ç¬¦ //Class\rpublic Field[] getDeclaredFields()\rpublic Field getDeclaredField(String name)\r æˆå‘˜å˜é‡èµ‹å€¼\n//Field\r//objä¸ºå®ä¾‹å¯¹è±¡\rpublic void set(Object obj,Object value)\r//å¿½ç•¥ä¿®é¥°ç¬¦ï¼Œå¼ºåˆ¶è°ƒç”¨\rpublic void setAccessible(boolean flag)\r å››ã€ç±»æ–¹æ³•çš„è·å– 1.è·å–å…¬æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬çˆ¶ç±» //Class\rpublic Method[] getMethods()\rpublic Method getMethod(String name,\rClass\u0026lt;?\u0026gt;... parameterTypes)\r 2.è·å–å½“å‰ç±»æ–¹æ³•ï¼Œå¿½ç•¥ä¿®é¥°ç¬¦ //Class\rpublic Method[] getDeclaredMethods()\rpublic Method getDeclaredMethod(String name,\rClass\u0026lt;?\u0026gt;... parameterTypes)\r æ–¹æ³•è°ƒç”¨\n//Method\r//objä¸ºç±»å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦‚æœä¸ºé™æ€æ–¹æ³•objä¸ºNull\rinvoke(Object obj, Object... args)\r//å¿½ç•¥ä¿®é¥°ç¬¦ï¼Œå¼ºåˆ¶è°ƒç”¨\rpublic void setAccessible(boolean flag)\r ","id":87,"section":"posts","summary":"â€œJAVAåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„æ–¹æ³•å’Œå±æ€§â€ ä¸€ã€ç±»å¯¹","tags":["java"],"title":"Javaåå°„å¸¸ç”¨APIæ±‡æ€»","uri":"https://www.mingaccount.com/2018/06/java-reflection-common-api/","year":"2018"},{"content":"å¤æ‚å¯†ç æ‰èƒ½é€šè¿‡\nsudo mysql -u root -p\rmysql\u0026gt; select user, plugin from mysql.user;\rmysql\u0026gt; update mysql.user set authentication_string=PASSWORD('xcvds_32GDS'), plugin='mysql_native_password' where user='root';\r mysql8.0ä¸èƒ½ç”¨ä¸Šè¾¹çš„è¯­å¥ï¼š\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY \u0026quot;svewe_123\u0026quot;;\r ","id":88,"section":"posts","summary":"å¤æ‚å¯†ç æ‰èƒ½é€šè¿‡ sudo mysql -u root -p mysql\u0026gt; select user, plugin from mysql.user; mysql\u0026gt; update mysql.user set authentication_string=PASSWORD('xcvds_32GDS'), plugin='mysql_native_password' where user='root'; mysql8.0ä¸èƒ½ç”¨ä¸Šè¾¹çš„è¯­å¥ï¼š ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY \u0026quot;svewe_123\u0026quot;;","tags":["mysql"],"title":"Mysqlå®‰è£…årootæ— æ³•ç™»é™†(Access denied for user 'root'@'localhost')","uri":"https://www.mingaccount.com/2018/06/mysql-cant-login-with-root/","year":"2018"},{"content":"distributionManagement éœ€è¦åœ¨pom.xmlæ–‡ä»¶ä¸­æ–°å¢æ ‡ç­¾\u0026lt;distributionManagement\u0026gt;\n\u0026lt;project xmlns=\u0026quot;http://maven.apache.org/POM/4.0.0\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxsi:schemaLocation=\u0026quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\u0026quot;\u0026gt;\r\u0026lt;modelVersion\u0026gt;4.0.0\u0026lt;/modelVersion\u0026gt;\r\u0026lt;groupId\u0026gt;com.mycompany.app\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;my-app\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1.0-SNAPSHOT\u0026lt;/version\u0026gt;\r\u0026lt;packaging\u0026gt;jar\u0026lt;/packaging\u0026gt;\r\u0026lt;name\u0026gt;Maven Quick Start Archetype\u0026lt;/name\u0026gt;\r\u0026lt;url\u0026gt;http://maven.apache.org\u0026lt;/url\u0026gt;\r\u0026lt;!--\r|\r|\r|\r--\u0026gt;\r\u0026lt;distributionManagement\u0026gt;\r\u0026lt;repository\u0026gt;\r\u0026lt;id\u0026gt;mycompany-repository\u0026lt;/id\u0026gt;\r\u0026lt;name\u0026gt;MyCompany Repository\u0026lt;/name\u0026gt;\r\u0026lt;url\u0026gt;scp://repository.mycompany.com/repository/maven2\u0026lt;/url\u0026gt;\r\u0026lt;/repository\u0026gt;\r\u0026lt;/distributionManagement\u0026gt;\r\u0026lt;/project\u0026gt;\r settings.xml ç„¶ååœ¨settings.xmlæ–‡ä»¶ä¸­é…ç½®è®¿é—®è¿œç¨‹ä»“åº“çš„è®¤è¯ä¿¡æ¯\n\u0026lt;settings xmlns=\u0026quot;http://maven.apache.org/SETTINGS/1.0.0\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxsi:schemaLocation=\u0026quot;http://maven.apache.org/SETTINGS/1.0.0 https://maven.apache.org/xsd/settings-1.0.0.xsd\u0026quot;\u0026gt;\r...\r\u0026lt;servers\u0026gt;\r\u0026lt;server\u0026gt;\r\u0026lt;id\u0026gt;mycompany-repository\u0026lt;/id\u0026gt;\r\u0026lt;username\u0026gt;jvanzyl\u0026lt;/username\u0026gt;\r\u0026lt;!-- Default value is ~/.ssh/id_dsa --\u0026gt;\r\u0026lt;privateKey\u0026gt;/path/to/identity\u0026lt;/privateKey\u0026gt; (default is ~/.ssh/id_dsa)\r\u0026lt;passphrase\u0026gt;my_key_passphrase\u0026lt;/passphrase\u0026gt;\r\u0026lt;/server\u0026gt;\r\u0026lt;/servers\u0026gt;\r...\r\u0026lt;/settings\u0026gt;\r ","id":89,"section":"posts","summary":"distributionManagement éœ€è¦åœ¨pom.xmlæ–‡ä»¶ä¸­æ–°å¢æ ‡ç­¾\u0026lt;distributionManagement\u0026gt; \u0026lt;project xmlns=\u0026quot;http://maven.apache.org/POM/4.0.0\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot; xsi:schemaLocation=\u0026quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\u0026quot;\u0026gt; \u0026lt;modelVersion\u0026gt;4.0.0\u0026lt;/modelVersion\u0026gt; \u0026lt;groupId\u0026gt;com.mycompany.app\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;my-app\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;packaging\u0026gt;jar\u0026lt;/packaging\u0026gt; \u0026lt;name\u0026gt;Maven Quick Start Archetype\u0026lt;/name\u0026gt; \u0026lt;url\u0026gt;http://maven.apache.org\u0026lt;/url\u0026gt; \u0026lt;!-- | | | --\u0026gt; \u0026lt;distributionManagement\u0026gt; \u0026lt;repository\u0026gt;","tags":["maven"],"title":"Mavenæ€æ ·æŠŠjaréƒ¨ç½²åˆ°è¿œç¨‹ä»“åº“","uri":"https://www.mingaccount.com/2018/06/maven-deploy-jar-to-remote-repository/","year":"2018"},{"content":"avgå‡½æ•°å¯¹å€¼ä¸ºnullçš„è¡Œï¼Œä¼šå¿½ç•¥ä¸è®¡ è§£å†³æ–¹æ¡ˆ\navg((coalesce(column,0))\r ","id":90,"section":"posts","summary":"avgå‡½æ•°å¯¹å€¼ä¸ºnullçš„è¡Œï¼Œä¼šå¿½ç•¥ä¸è®¡ è§£å†³æ–¹æ¡ˆ avg((coalesce(column,0))","tags":["mysql"],"title":"avgå‡½æ•°å¿½ç•¥nullå€¼","uri":"https://www.mingaccount.com/2018/06/avg-ignore-null/","year":"2018"},{"content":"å‚è€ƒå®˜æ–¹æ–‡æ¡£Spring Boot Test\n","id":91,"section":"posts","summary":"å‚è€ƒå®˜æ–¹æ–‡æ¡£Spring Boot Test","tags":["spring"],"title":"Srping Bootæµ‹è¯•","uri":"https://www.mingaccount.com/2018/05/spring-boot-test/","year":"2018"},{"content":"   ç›®å½• æè¿°     src/main/java Application/Library sources   src/main/resources Application/Library resources   src/main/filters Resource filter files   src/main/webapp Web application sources   src/test/java Test sources   src/test/resources Test resources   src/test/filters Test resource filter files   src/it Integration Tests (primarily for plugins)   src/assembly Assembly descriptors   src/site Site   LICENSE.txt Project\u0026rsquo;s license   NOTICE.txt Notices and attributions required by libraries that the project depends on   README.txt Project\u0026rsquo;s readme    ","id":92,"section":"posts","summary":"ç›®å½• æè¿° src/main/java Application/Library sources src/main/resources Application/Library resources src/main/filters Resource filter files src/main/webapp Web application sources src/test/java Test sources src/test/resources Test resources src/test/filters Test resource filter files src/it Integration Tests (primarily for plugins) src/assembly Assembly descriptors src/site Site LICENSE.txt Project\u0026rsquo;s license NOTICE.txt Notices and attributions required by libraries that the project depends on README.txt Project\u0026rsquo;s readme","tags":["maven"],"title":"Mavenæ ‡å‡†æ–‡ä»¶å¤¹ç»“æ„","uri":"https://www.mingaccount.com/2018/05/maven-stadard-dir-layout/","year":"2018"},{"content":"Java8 å¸¦æ¥äº†è®¸å¤šæ”¹å˜ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯defaultä¿®é¥°çš„æ¥å£æ–¹æ³•ã€‚\nè¿™äº›æ–¹æ³•æ”¹å˜äº†æˆ‘ä»¬å·²çŸ¥çš„æ¥å£ï¼Œç°åœ¨æˆ‘ä»¬èƒ½å¤Ÿåœ¨æ¥å£ä¸­å®šä¹‰é»˜è®¤å®ç°æ–¹æ³•ã€‚é»˜è®¤å®ç°æ–¹æ³•çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œåœ¨æ¥å£ä¸­ç”¨defaultä¿®é¥°æŠ½è±¡æ–¹æ³•åï¼Œè¯¥æ–¹æ³•å¯ä»¥æ‹¥æœ‰æ–¹æ³•ä½“ï¼Œå®ç°ä»–çš„æ–¹æ³•å¯ä»¥ä¸é‡å†™defaultä¿®é¥°çš„æ–¹æ³•è€Œä¸”å¯ä»¥ç›´æ¥è°ƒç”¨ã€‚\nå¦‚æœä½ å¤§é‡ä½¿ç”¨defaultæ–¹æ³•åœ¨ä½ çš„åº”ç”¨æ¥å£ä¸­ï¼Œä½ å°†å¾ˆå¿«æ„è¯†åˆ°ä»–æ²¡æœ‰çœŸæ­£ç²¾ç®€ä»£ç ã€‚\nå› ä¸ºä½ ä¸èƒ½åœ¨æ¥å£ä¸­æç‚¼defaulté‡Œé‡å¤çš„ä»£ç åˆ°ä¸€ä¸ªæ–°çš„æ™®é€šæ–¹æ³•ï¼Œè¿™ä¸ä»¥ç²¾ç®€ä»£ç ä¸ºç›®çš„çš„defaultå…³é”®å­—ç›¸å†²çªã€‚\nä½†åœ¨java9ä¸­è¿™ä¸ªé—®é¢˜è¢«å¼•å…¥çš„ private interface methods è§£å†³äº†ã€‚è¿™äº›æ–°å®šä¹‰çš„è§„åˆ™å¯ä»¥è®©ä½ åœ¨æ¥å£ä¸­åˆ›å»ºprivateä¿®é¥°çš„æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ¥å£ä¸­æ„é€ æ›´åŠ ç®€ç»ƒçš„ä»£ç ã€‚\nåˆ©ç”¨Java9çš„ private interface methods é‡æ„ default æ–¹æ³•\nä»£ç å®ä¾‹ï¼š\næ¥å£\u0026ndash;Archive\npublic interface Archive {\rList\u0026lt;Article\u0026gt; getArticles();\rdefault List\u0026lt;Article\u0026gt; filterByTitle(String title) {\rreturn getArticles().stream()\r.filter(article -\u0026gt; article.getTitle().equals(title))\r.collect(Collectors.toList());\r}\rdefault List\u0026lt;Article\u0026gt; filterByTag(String tag) {\rreturn getArticles().stream()\r.filter(article -\u0026gt; article.getTags().contains(tag))\r.collect(Collectors.toList());\r}\r}\r æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼ŒArchiveåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•- getArticles ï¼Œå’Œä¸¤ä¸ªdefaultæ–¹æ³•- filterByTitle å’Œ filterByTag ã€‚\nç°åœ¨ï¼Œå¦‚æœä½ ä»”ç»†è§‚å¯Ÿä¸¤ä¸ªdefaultæ–¹æ³•ï¼Œä½ ä¼šå‘ç°å®ƒä»¬å‡ ä¹ç›¸åŒã€‚å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯åœ¨filteræ–¹æ³•ä¸­ä½¿ç”¨äº†ä¸åŒçš„è°“è¯­è€Œå·²ã€‚\nè¿™ç§é‡å¤çš„ä»£ç åˆåœŸåˆæ²¡æœ‰å¿…è¦ã€‚ç†åº”è®©defaultä»£ç æ›´åŠ ç®€ç»ƒï¼Œå¹¸è¿çš„æ˜¯Java9çš„ private interface method å¯ä»¥å¸®ä¸Šå¿™ã€‚\nä¸‹é¢æ˜¯ç”¨ private interface methods é‡å†™çš„Archiveï¼š\npublic interface NewArchive {\rList\u0026lt;Article\u0026gt; getArticles();\rdefault List\u0026lt;Article\u0026gt; filterByTitle(String title) {\rreturn filterBy(article -\u0026gt; article.getTitle().equals(title));\r}\rdefault List\u0026lt;Article\u0026gt; filterByTag(String tag) {\rreturn filterBy(article -\u0026gt; article.getTags().contains(tag));\r}\rprivate List\u0026lt;Article\u0026gt; filterBy(Predicate\u0026lt;Article\u0026gt; toFilterBy) {\rreturn getArticles().stream()\r.filter(toFilterBy)\r.collect(Collectors.toList());\r}\r}\r è¿™å°±æ˜¯æƒ³è¦çš„ç»“æœï¼Œé€šè¿‡æå–é™¤äº†è°“è¯­ä»¥å¤–çš„ä»£ç ï¼Œæˆ‘ä»¬ç§»é™¤äº†é‡å¤çš„å†…å®¹ï¼Œä¹Ÿè®©ä»£ç æ›´å…·æœ‰å¯è¯»æ€§ã€‚\n*è‹±æ–‡é“¾æ¥ï¼šdeadCodeRising\n*åŸåˆ›è¯‘æ–‡\n","id":93,"section":"posts","summary":"Java8 å¸¦æ¥äº†è®¸å¤šæ”¹å˜ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯defaultä¿®é¥°çš„æ¥å£æ–¹æ³•ã€‚ è¿™äº›æ–¹æ³•æ”¹å˜äº†æˆ‘ä»¬å·²çŸ¥çš„æ¥å£ï¼Œç°åœ¨æˆ‘ä»¬èƒ½å¤Ÿåœ¨æ¥å£ä¸­å®šä¹‰é»˜è®¤å®ç°æ–¹æ³•ã€‚é»˜è®¤å®ç°æ–¹æ³•","tags":["java"],"title":"[è¯‘]java9æ–°ç‰¹æ€§ï¼šåœ¨æ¥å£ä¸­ç”¨pirvateæ–¹æ³•è®©default(java8æ¥å£ç‰¹æ€§)æ›´ç®€ç»ƒ","uri":"https://www.mingaccount.com/2018/05/java9-new-feature/","year":"2018"},{"content":"å¼‚å¸¸ä¿¡æ¯\nNo anonymous write access. Authentication failed for\r è§£å†³æ–¹æ¡ˆ\næäº¤çš„æ—¶å€™è®¾ç½®UserNameå’Œemail\r æˆ–è€…é‡æ–°è®¾ç½®å…¨å±€gitç”¨æˆ·åå’Œé‚®ç®±\ngit config --global user.name \u0026quot;username\u0026quot;\rgit config --global user.email \u0026quot;email\u0026quot;\r ","id":94,"section":"posts","summary":"å¼‚å¸¸ä¿¡æ¯ No anonymous write access. Authentication failed for è§£å†³æ–¹æ¡ˆ æäº¤çš„æ—¶å€™è®¾ç½®UserNameå’Œemail æˆ–è€…é‡æ–°è®¾ç½®å…¨å±€gitç”¨æˆ·åå’Œé‚®ç®± git config --global user.name \u0026quot;username\u0026quot; git config --global user.email \u0026quot;email\u0026quot;","tags":["git"],"title":"Git push å¼‚å¸¸ï¼šremote: No anonymous write access","uri":"https://www.mingaccount.com/2018/05/git-push-exception-no-anonymous/","year":"2018"},{"content":"1.åœ¨gitä¸Šåˆ›å»ºä»“åº“ï¼Œè®°ä¸‹cloneåœ°å€ 2.æŠŠçº¿ä¸Šä»“åº“æ‹‰åˆ°æœ¬åœ° git clone https://github.com/*/*.git\r 3.æŠŠè¦ä¸Šä¼ çš„æœ¬åœ°é¡¹ç›®æ–‡ä»¶å…¨éƒ¨æ”¾å…¥æœ¬åœ°ä»“åº“ä¸­ 4.æŠŠæ‰€æœ‰æ–‡ä»¶æäº¤åˆ°çº¿ä¸Š git add .\rgit commit -m \u0026quot;first commit\u0026quot;\rgit push -u origin master\r ","id":95,"section":"posts","summary":"1.åœ¨gitä¸Šåˆ›å»ºä»“åº“ï¼Œè®°ä¸‹cloneåœ°å€ 2.æŠŠçº¿ä¸Šä»“åº“æ‹‰åˆ°æœ¬åœ° git clone https://github.com/*/*.git 3.æŠŠè¦ä¸Šä¼ çš„æœ¬åœ°é¡¹ç›®æ–‡ä»¶å…¨éƒ¨æ”¾å…¥æœ¬åœ°ä»“åº“ä¸­ 4.æŠŠæ‰€æœ‰æ–‡ä»¶æäº¤åˆ°çº¿ä¸Š git","tags":["git"],"title":"Gitä¸Šä¼ æœ¬åœ°é¡¹ç›®","uri":"https://www.mingaccount.com/2018/05/git-upload-local-project/","year":"2018"},{"content":"# gitæ›´æ–°å½“å‰åˆ†æ”¯\rgit pull\r#æ‹‰çº¿ä¸Šä»£ç \rgit clone https://***.git.com\r#æŸ¥çœ‹å·¥ä½œåŒºçŠ¶æ€\rgit status -s\r#æ’¤å›ä¸Šä¸€æ¬¡çš„commitå†…å®¹\rgit reset --hard HEAD~\r#æŸ¥çœ‹å½“å‰åˆ†æ”¯\rgit branch\r#åˆ‡æ¢åˆ°å¯¹åº”åˆ†æ”¯\rgit checkout dev\r#åˆ é™¤æ‰€æœ‰æœ¬åœ°æœªæäº¤å†…å®¹\rgit checkout .\r#ä¸‹æ¬¡pushæ—¶ä¿å­˜è¾“å…¥å¯†ç \rgit config credential.helper store\r#æ›´æ”¹å½“å‰é¡¹ç›®çš„ç”¨æˆ·åå’Œé‚®ç®±\rgit config user.name \u0026quot;\u0026quot;\rgit config user.email \u0026quot;\u0026quot;\r#æ›´æ”¹å…¨å±€çš„ç”¨æˆ·åå’Œé‚®ç®±\rgit config --global user.name \u0026quot;\u0026quot;\rgit config --global user.email \u0026quot;\u0026quot;\r#gitæ—¥å¿—\rgit log\r#å–æ¶ˆcherry pick\rgit cherry-pick --abort\r#åœ¨æŒ‡å®šè·¯å¾„æ·»åŠ å­æ¨¡å—\rgit submodule add \u0026lt;url\u0026gt; [path] # æ’¤å›git addæ“ä½œ\rgit reset \u0026lt;file\u0026gt;\r ","id":96,"section":"posts","summary":"# gitæ›´æ–°å½“å‰åˆ†æ”¯ git pull #æ‹‰çº¿ä¸Šä»£ç  git clone https://***.git.com #æŸ¥çœ‹å·¥ä½œåŒºçŠ¶æ€ git status -s #æ’¤å›ä¸Šä¸€æ¬¡çš„commitå†…å®¹ git reset --hard HEAD~ #æŸ¥çœ‹å½“å‰åˆ†æ”¯ git branch #åˆ‡æ¢åˆ°å¯¹åº”åˆ†æ”¯ git checkout","tags":["git"],"title":"Gitå¸¸ç”¨å‘½ä»¤å¤‡å¿˜","uri":"https://www.mingaccount.com/2018/05/git-common-command/","year":"2018"},{"content":"Hutoolå°è£…å¤§é‡javaå·¥å…·ç±»\nmavené…ç½®ï¼š\n\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;cn.hutool\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;hutool-all\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;5.4.4\u0026lt;/version\u0026gt;\r\u0026lt;/dependency\u0026gt;\r  APIæ–‡æ¡£\nå®˜æ–¹é¦–é¡µ\n ","id":97,"section":"posts","summary":"Hutoolå°è£…å¤§é‡javaå·¥å…·ç±» mavené…ç½®ï¼š \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;cn.hutool\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hutool-all\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.4.4\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; APIæ–‡æ¡£ å®˜æ–¹é¦–é¡µ","tags":["java"],"title":"Hutoolå·¥å…·åŒ…","uri":"https://www.mingaccount.com/2018/05/hutool/","year":"2018"},{"content":"é—®é¢˜ä»£ç  serviceæ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä½†æ˜¯æ²¡æœ‰rollback\n@Transactional\rpublic void batchInsert() throws CommonException{}\r æŠ›å‡ºçš„è‡ªå®šä¹‰å¼‚å¸¸ç»§æ‰¿äºException\npublic class CommonException extends Exception{}\r é—®é¢˜åŸå›  @Transactionalæ³¨è§£é»˜è®¤ä¸èƒ½æ•è·checkedå¼‚å¸¸\ncheckedå¼‚å¸¸å°±æ˜¯ç»§æ‰¿äºExceptionçš„å¼‚å¸¸ï¼Œç¼–è¾‘å™¨å¼ºåˆ¶æ•è·æˆ–è€…æŠ›å‡º\runcheckedå¼‚å¸¸å°±æ˜¯ç»§æ‰¿äºRuntimeExceptionçš„å¼‚å¸¸ï¼Œç¼–è¯‘å™¨ä¸å¼ºåˆ¶å¤„ç†\r è§£å†³æ–¹æ¡ˆ  æŠŠCommonExceptionæ”¹ä¸ºç»§æ‰¿RuntimeException è®¾ç½®@Transactional(rollbackFor=CommonException.class)  å‘æ•£ é™¤äº†å› ä¸ºExceptionç±»å‹åŸå› å¯¼è‡´çš„äº‹åŠ¡å¤±è´¥ï¼Œè¿˜æœ‰å¯èƒ½å› ä¸ºä»¥ä¸‹åŸå› ï¼š\n @Transactionalä¿®é¥°çš„æ–¹æ³•ä¸æ˜¯public æœ¬ç±»ä¸­æ²¡æœ‰æ³¨è§£çš„æ–¹æ³•è°ƒç”¨æœ‰æ³¨è§£çš„æ–¹æ³• è®¾ç½®çš„å¼•æ“ä¸æ”¯æŒäº‹åŠ¡  ","id":98,"section":"posts","summary":"é—®é¢˜ä»£ç  serviceæ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä½†æ˜¯æ²¡æœ‰rollback @Transactional public void batchInsert() throws CommonException{} æŠ›å‡ºçš„è‡ªå®šä¹‰å¼‚å¸¸ç»§æ‰¿äºException public class CommonException extends Exception{} é—®é¢˜åŸå›  @Tra","tags":["spring"],"title":"Spring @Transactionaläº‹åŠ¡å¤±æ•ˆ","uri":"https://www.mingaccount.com/2018/05/spring-transaction-invalid/","year":"2018"},{"content":"Cronè¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä»¥5æˆ–6ä¸ªç©ºæ ¼éš”å¼€ï¼Œåˆ†ä¸º6æˆ–7ä¸ªåŸŸï¼Œæ¯ä¸€ä¸ªåŸŸä»£è¡¨ä¸€ä¸ªå«ä¹‰ï¼ŒCronæœ‰å¦‚ä¸‹ä¸¤ç§è¯­æ³•æ ¼å¼ï¼š\nã€€ï¼ˆ1ï¼‰ Seconds Minutes Hours DayofMonth Month DayofWeek Year\nã€€ï¼ˆ2ï¼‰Seconds Minutes Hours DayofMonth Month DayofWeek\nã€€ä¸€ã€ç»“æ„ ã€€cornä»å·¦åˆ°å³ï¼ˆç”¨ç©ºæ ¼éš”å¼€ï¼‰ï¼šç§’ åˆ† å°æ—¶ æœˆä»½ä¸­çš„æ—¥æœŸ æœˆä»½ æ˜ŸæœŸä¸­çš„æ—¥æœŸ å¹´ä»½\näºŒã€å„å­—æ®µçš„å«ä¹‰    å­—æ®µ å…è®¸å€¼ å…è®¸çš„ç‰¹æ®Šå­—ç¬¦     ç§’ï¼ˆSecondsï¼‰ 0~59çš„æ•´æ•° , - * / å››ä¸ªå­—ç¬¦   åˆ†ï¼ˆMinutesï¼‰ 0~59çš„æ•´æ•° , - * / å››ä¸ªå­—ç¬¦   å°æ—¶ï¼ˆHoursï¼‰ 0~23çš„æ•´æ•° , - * / å››ä¸ªå­—ç¬¦   æ—¥æœŸï¼ˆDayofMonthï¼‰ 1~31çš„æ•´æ•°ï¼ˆä½†æ˜¯ä½ éœ€è¦è€ƒè™‘ä½ æœˆçš„å¤©æ•°ï¼‰ ,- * ? / L W C å…«ä¸ªå­—ç¬¦   æœˆä»½ï¼ˆMonthï¼‰ 1~12çš„æ•´æ•°æˆ–è€… JAN-DEC , - * / å››ä¸ªå­—ç¬¦   æ˜ŸæœŸï¼ˆDayofWeekï¼‰ 1~7çš„æ•´æ•°æˆ–è€… SUN-SAT ï¼ˆ1=SUNï¼‰ , - * ? / L C # å…«ä¸ªå­—ç¬¦   å¹´(å¯é€‰ï¼Œç•™ç©º)ï¼ˆYearï¼‰ 1970~2099 , - * / å››ä¸ªå­—ç¬¦    ã€€æ³¨æ„äº‹é¡¹ï¼š\nã€€æ¯ä¸€ä¸ªåŸŸéƒ½ä½¿ç”¨æ•°å­—ï¼Œä½†è¿˜å¯ä»¥å‡ºç°å¦‚ä¸‹ç‰¹æ®Šå­—ç¬¦ï¼Œå®ƒä»¬çš„å«ä¹‰æ˜¯ï¼š\nã€€ï¼ˆ1ï¼‰*ï¼šè¡¨ç¤ºåŒ¹é…è¯¥åŸŸçš„ä»»æ„å€¼ã€‚å‡å¦‚åœ¨MinutesåŸŸä½¿ç”¨*, å³è¡¨ç¤ºæ¯åˆ†é’Ÿéƒ½ä¼šè§¦å‘äº‹ä»¶ã€‚\nã€€ï¼ˆ2ï¼‰?ï¼šåªèƒ½ç”¨åœ¨DayofMonthå’ŒDayofWeekä¸¤ä¸ªåŸŸã€‚å®ƒä¹ŸåŒ¹é…åŸŸçš„ä»»æ„å€¼ï¼Œä½†å®é™…ä¸ä¼šã€‚å› ä¸ºDayofMonthå’ŒDayofWeekä¼šç›¸äº’å½±å“ã€‚ä¾‹å¦‚æƒ³åœ¨æ¯æœˆçš„20æ—¥è§¦å‘è°ƒåº¦ï¼Œä¸ç®¡20æ—¥åˆ°åº•æ˜¯æ˜ŸæœŸå‡ ï¼Œåˆ™åªèƒ½ä½¿ç”¨å¦‚ä¸‹å†™æ³•ï¼š 13 13 15 20 * ?, å…¶ä¸­æœ€åä¸€ä½åªèƒ½ç”¨ï¼Ÿï¼Œè€Œä¸èƒ½ä½¿ç”¨*ï¼Œå¦‚æœä½¿ç”¨*è¡¨ç¤ºä¸ç®¡æ˜ŸæœŸå‡ éƒ½ä¼šè§¦å‘ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯è¿™æ ·ã€‚\nã€€ï¼ˆ3ï¼‰-ï¼šè¡¨ç¤ºèŒƒå›´ã€‚ä¾‹å¦‚åœ¨MinutesåŸŸä½¿ç”¨5-20ï¼Œè¡¨ç¤ºä»5åˆ†åˆ°20åˆ†é’Ÿæ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡\nã€€ï¼ˆ4ï¼‰/ï¼šè¡¨ç¤ºèµ·å§‹æ—¶é—´å¼€å§‹è§¦å‘ï¼Œç„¶åæ¯éš”å›ºå®šæ—¶é—´è§¦å‘ä¸€æ¬¡ã€‚ä¾‹å¦‚åœ¨MinutesåŸŸä½¿ç”¨5/20,åˆ™æ„å‘³ç€5åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ï¼Œè€Œ25ï¼Œ45ç­‰åˆ†åˆ«è§¦å‘ä¸€æ¬¡.\nã€€ï¼ˆ5ï¼‰,ï¼šè¡¨ç¤ºåˆ—å‡ºæšä¸¾å€¼ã€‚ä¾‹å¦‚ï¼šåœ¨MinutesåŸŸä½¿ç”¨5,20ï¼Œåˆ™æ„å‘³ç€åœ¨5å’Œ20åˆ†æ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚\nã€€ï¼ˆ6ï¼‰Lï¼šè¡¨ç¤ºæœ€åï¼Œåªèƒ½å‡ºç°åœ¨DayofWeekå’ŒDayofMonthåŸŸã€‚å¦‚æœåœ¨DayofWeekåŸŸä½¿ç”¨5L,æ„å‘³ç€åœ¨æœ€åçš„ä¸€ä¸ªæ˜ŸæœŸå››è§¦å‘ã€‚\nã€€ï¼ˆ7ï¼‰W:è¡¨ç¤ºæœ‰æ•ˆå·¥ä½œæ—¥(å‘¨ä¸€åˆ°å‘¨äº”),åªèƒ½å‡ºç°åœ¨DayofMonthåŸŸï¼Œç³»ç»Ÿå°†åœ¨ç¦»æŒ‡å®šæ—¥æœŸçš„æœ€è¿‘çš„æœ‰æ•ˆå·¥ä½œæ—¥è§¦å‘äº‹ä»¶ã€‚ä¾‹å¦‚ï¼šåœ¨ DayofMonthä½¿ç”¨5Wï¼Œå¦‚æœ5æ—¥æ˜¯æ˜ŸæœŸå…­ï¼Œåˆ™å°†åœ¨æœ€è¿‘çš„å·¥ä½œæ—¥ï¼šæ˜ŸæœŸäº”ï¼Œå³4æ—¥è§¦å‘ã€‚å¦‚æœ5æ—¥æ˜¯æ˜ŸæœŸå¤©ï¼Œåˆ™åœ¨6æ—¥(å‘¨ä¸€)è§¦å‘ï¼›å¦‚æœ5æ—¥åœ¨æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸäº”ä¸­çš„ä¸€å¤©ï¼Œåˆ™å°±åœ¨5æ—¥è§¦å‘ã€‚å¦å¤–ä¸€ç‚¹ï¼ŒWçš„æœ€è¿‘å¯»æ‰¾ä¸ä¼šè·¨è¿‡æœˆä»½ ã€‚\nã€€ï¼ˆ8ï¼‰LW:è¿™ä¸¤ä¸ªå­—ç¬¦å¯ä»¥è¿ç”¨ï¼Œè¡¨ç¤ºåœ¨æŸä¸ªæœˆæœ€åä¸€ä¸ªå·¥ä½œæ—¥ï¼Œå³æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ã€‚\nã€€ï¼ˆ9ï¼‰#:ç”¨äºç¡®å®šæ¯ä¸ªæœˆç¬¬å‡ ä¸ªæ˜ŸæœŸå‡ ï¼Œåªèƒ½å‡ºç°åœ¨DayofMonthåŸŸã€‚ä¾‹å¦‚åœ¨4#2ï¼Œè¡¨ç¤ºæŸæœˆçš„ç¬¬äºŒä¸ªæ˜ŸæœŸä¸‰ã€‚\nä¸‰ã€å¸¸ç”¨è¡¨è¾¾å¼ä¾‹å­ ã€€ï¼ˆ1ï¼‰0 0 2 1 * ? * è¡¨ç¤ºåœ¨æ¯æœˆçš„1æ—¥çš„å‡Œæ™¨2ç‚¹è°ƒæ•´ä»»åŠ¡\nã€€ï¼ˆ2ï¼‰0 15 10 ? * MON-FRI è¡¨ç¤ºå‘¨ä¸€åˆ°å‘¨äº”æ¯å¤©ä¸Šåˆ10:15æ‰§è¡Œä½œä¸š\nã€€ï¼ˆ3ï¼‰0 15 10 ? 6L 2002-2006 è¡¨ç¤º2002-2006å¹´çš„æ¯ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15æ‰§è¡Œä½œ\nã€€ï¼ˆ4ï¼‰0 0 10,14,16 * * ? æ¯å¤©ä¸Šåˆ10ç‚¹ï¼Œä¸‹åˆ2ç‚¹ï¼Œ4ç‚¹\nã€€ï¼ˆ5ï¼‰0 0/30 9-17 * * ? æœä¹æ™šäº”å·¥ä½œæ—¶é—´å†…æ¯åŠå°æ—¶\nã€€ï¼ˆ6ï¼‰0 0 12 ? * WED è¡¨ç¤ºæ¯ä¸ªæ˜ŸæœŸä¸‰ä¸­åˆ12ç‚¹\nã€€ï¼ˆ7ï¼‰0 0 12 * * ? æ¯å¤©ä¸­åˆ12ç‚¹è§¦å‘\nã€€ï¼ˆ8ï¼‰0 15 10 ? * * æ¯å¤©ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ9ï¼‰0 15 10 * * ? æ¯å¤©ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ10ï¼‰0 15 10 * * ? * æ¯å¤©ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ11ï¼‰0 15 10 * * ? 2005 2005å¹´çš„æ¯å¤©ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ12ï¼‰0 * 14 * * ? åœ¨æ¯å¤©ä¸‹åˆ2ç‚¹åˆ°ä¸‹åˆ2:59æœŸé—´çš„æ¯1åˆ†é’Ÿè§¦å‘\nã€€ï¼ˆ13ï¼‰0 0/5 14 * * ? åœ¨æ¯å¤©ä¸‹åˆ2ç‚¹åˆ°ä¸‹åˆ2:55æœŸé—´çš„æ¯5åˆ†é’Ÿè§¦å‘\nã€€ï¼ˆ14ï¼‰0 0/5 14,18 * * ? åœ¨æ¯å¤©ä¸‹åˆ2ç‚¹åˆ°2:55æœŸé—´å’Œä¸‹åˆ6ç‚¹åˆ°6:55æœŸé—´çš„æ¯5åˆ†é’Ÿè§¦å‘\nã€€ï¼ˆ15ï¼‰0 0-5 14 * * ? åœ¨æ¯å¤©ä¸‹åˆ2ç‚¹åˆ°ä¸‹åˆ2:05æœŸé—´çš„æ¯1åˆ†é’Ÿè§¦å‘\nã€€ï¼ˆ16ï¼‰0 10,44 14 ? 3 WED æ¯å¹´ä¸‰æœˆçš„æ˜ŸæœŸä¸‰çš„ä¸‹åˆ2:10å’Œ2:44è§¦å‘\nã€€ï¼ˆ17ï¼‰0 15 10 ? * MON-FRI å‘¨ä¸€è‡³å‘¨äº”çš„ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ18ï¼‰0 15 10 15 * ? æ¯æœˆ15æ—¥ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ19ï¼‰0 15 10 L * ? æ¯æœˆæœ€åä¸€æ—¥çš„ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ20ï¼‰0 15 10 ? * 6L æ¯æœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ21ï¼‰0 15 10 ? * 6L 2002-2005 2002å¹´è‡³2005å¹´çš„æ¯æœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15è§¦å‘\nã€€ï¼ˆ22ï¼‰0 15 10 ? * 6#3 æ¯æœˆçš„ç¬¬ä¸‰ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15è§¦å‘\nã€€æ³¨ï¼š\nã€€ï¼ˆ1ï¼‰æœ‰äº›å­è¡¨è¾¾å¼èƒ½åŒ…å«ä¸€äº›èŒƒå›´æˆ–åˆ—è¡¨\nã€€ä¾‹å¦‚ï¼šå­è¡¨è¾¾å¼ï¼ˆå¤©ï¼ˆæ˜ŸæœŸï¼‰ï¼‰å¯ä»¥ä¸º â€œMON-FRIâ€ï¼Œâ€œMONï¼ŒWEDï¼ŒFRIâ€ï¼Œâ€œMON-WED,SATâ€\nâ€œ*â€å­—ç¬¦ä»£è¡¨æ‰€æœ‰å¯èƒ½çš„å€¼\nã€€å› æ­¤ï¼Œâ€œ*â€åœ¨å­è¡¨è¾¾å¼ï¼ˆæœˆï¼‰é‡Œè¡¨ç¤ºæ¯ä¸ªæœˆçš„å«ä¹‰ï¼Œâ€œ*â€åœ¨å­è¡¨è¾¾å¼ï¼ˆå¤©ï¼ˆæ˜ŸæœŸï¼‰ï¼‰è¡¨ç¤ºæ˜ŸæœŸçš„æ¯ä¸€å¤©\nã€€â€œ/â€å­—ç¬¦ç”¨æ¥æŒ‡å®šæ•°å€¼çš„å¢é‡\nä¾‹å¦‚ï¼šåœ¨å­è¡¨è¾¾å¼ï¼ˆåˆ†é’Ÿï¼‰é‡Œçš„â€œ0/15â€è¡¨ç¤ºä»ç¬¬0åˆ†é’Ÿå¼€å§‹ï¼Œæ¯15åˆ†é’Ÿ\nåœ¨å­è¡¨è¾¾å¼ï¼ˆåˆ†é’Ÿï¼‰é‡Œçš„â€œ3/20â€è¡¨ç¤ºä»ç¬¬3åˆ†é’Ÿå¼€å§‹ï¼Œæ¯20åˆ†é’Ÿï¼ˆå®ƒå’Œâ€œ3ï¼Œ23ï¼Œ43â€ï¼‰çš„å«ä¹‰ä¸€æ ·\nã€€â€œï¼Ÿâ€å­—ç¬¦ä»…è¢«ç”¨äºå¤©ï¼ˆæœˆï¼‰å’Œå¤©ï¼ˆæ˜ŸæœŸï¼‰ä¸¤ä¸ªå­è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºä¸æŒ‡å®šå€¼\nå½“2ä¸ªå­è¡¨è¾¾å¼å…¶ä¸­ä¹‹ä¸€è¢«æŒ‡å®šäº†å€¼ä»¥åï¼Œä¸ºäº†é¿å…å†²çªï¼Œéœ€è¦å°†å¦ä¸€ä¸ªå­è¡¨è¾¾å¼çš„å€¼è®¾ä¸ºâ€œï¼Ÿâ€\nã€€â€œLâ€ å­—ç¬¦ä»…è¢«ç”¨äºå¤©ï¼ˆæœˆï¼‰å’Œå¤©ï¼ˆæ˜ŸæœŸï¼‰ä¸¤ä¸ªå­è¡¨è¾¾å¼ï¼Œå®ƒæ˜¯å•è¯â€œlastâ€çš„ç¼©å†™\nä½†æ˜¯å®ƒåœ¨ä¸¤ä¸ªå­è¡¨è¾¾å¼é‡Œçš„å«ä¹‰æ˜¯ä¸åŒçš„ã€‚\nåœ¨å¤©ï¼ˆæœˆï¼‰å­è¡¨è¾¾å¼ä¸­ï¼Œâ€œLâ€è¡¨ç¤ºä¸€ä¸ªæœˆçš„æœ€åä¸€å¤©\nåœ¨å¤©ï¼ˆæ˜ŸæœŸï¼‰è‡ªè¡¨è¾¾å¼ä¸­ï¼Œâ€œLâ€è¡¨ç¤ºä¸€ä¸ªæ˜ŸæœŸçš„æœ€åä¸€å¤©ï¼Œä¹Ÿå°±æ˜¯SAT\nã€€å¦‚æœåœ¨â€œLâ€å‰æœ‰å…·ä½“çš„å†…å®¹ï¼Œå®ƒå°±å…·æœ‰å…¶ä»–çš„å«ä¹‰äº†\nã€€ä¾‹å¦‚ï¼šâ€œ6Lâ€è¡¨ç¤ºè¿™ä¸ªæœˆçš„å€’æ•°ç¬¬ï¼–å¤©ï¼Œâ€œFRILâ€è¡¨ç¤ºè¿™ä¸ªæœˆçš„æœ€ä¸€ä¸ªæ˜ŸæœŸäº”\næ³¨æ„ï¼šåœ¨ä½¿ç”¨â€œLâ€å‚æ•°æ—¶ï¼Œä¸è¦æŒ‡å®šåˆ—è¡¨æˆ–èŒƒå›´ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´é—®é¢˜\nè½¬è‡ªï¼šhttps://www.cnblogs.com/javahr/p/8318728.html\n","id":99,"section":"posts","summary":"Cronè¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä»¥5æˆ–6ä¸ªç©ºæ ¼éš”å¼€ï¼Œåˆ†ä¸º6æˆ–7ä¸ªåŸŸï¼Œæ¯ä¸€ä¸ªåŸŸä»£è¡¨ä¸€ä¸ªå«ä¹‰ï¼ŒCronæœ‰å¦‚ä¸‹ä¸¤ç§è¯­æ³•æ ¼å¼ï¼š ï¼ˆ1ï¼‰ Seconds Minutes Hours DayofMonth Month DayofWeek Year","tags":["spring"],"title":"quartz cronè¡¨è¾¾å¼è¯¦è§£","uri":"https://www.mingaccount.com/2018/05/quartz-cron/","year":"2018"},{"content":"ThreadLocalRandom Java 1.7æˆ–è€…ä¹‹åçš„ç‰ˆæœ¬\nimport java.util.concurrent.ThreadLocalRandom; // nextInt is normally exclusive of the top value, // so add 1 to make it inclusive int randomNum = ThreadLocalRandom.current().nextInt(min, max + 1);   ThreadLocalRandom API\n Random Java 1.7ä¹‹å‰\nimport java.util.Random; /** * Returns a pseudo-random number between min and max, inclusive. * The difference between min and max can be at most * \u0026lt;code\u0026gt;Integer.MAX_VALUE - 1\u0026lt;/code\u0026gt;. * * @param min Minimum value * @param max Maximum value. Must be greater than min. * @return Integer between min and max, inclusive. * @see java.util.Random#nextInt(int) */ public static int randInt(int min, int max) { // NOTE: This will (intentionally) not run as written so that folks // copy-pasting have to think about how to initialize their // Random instance. Initialization of the Random instance is outside // the main scope of the question, but some decent options are to have // a field that is initialized once and then re-used as needed or to // use ThreadLocalRandom (if using at least Java 1.7). // // In particular, do NOT do 'Random rand = new Random()' here or you // will get not very good / not very random results. Random rand; // nextInt is normally exclusive of the top value, // so add 1 to make it inclusive int randomNum = rand.nextInt((max - min) + 1) + min; return randomNum; }   Random API\n Math ä¸æ¨èï¼Œå®¹æ˜“å‡ºé”™\n","id":100,"section":"posts","summary":"ThreadLocalRandom Java 1.7æˆ–è€…ä¹‹åçš„ç‰ˆæœ¬ import java.util.concurrent.ThreadLocalRandom; // nextInt is normally exclusive of the top value, // so add 1 to make it inclusive int randomNum = ThreadLocalRandom.current().nextInt(min, max + 1); ThreadLocalRandom API Random Java 1.7ä¹‹å‰ import java.util.Random; /** * Returns a pseudo-random number between min and max, inclusive. * The difference between min and max can be at","tags":["java","random"],"title":"Javaä¸­çš„éšæœºæ•°ç”ŸæˆAPI","uri":"https://www.mingaccount.com/2018/04/java-random-number/","year":"2018"},{"content":"æŒ‡å®šipä¿¡æ¯ï¼Œåªéœ€è¦ä¿®æ”¹setå‚æ•°\nnameæ˜¯æ§åˆ¶é¢æ¿\\ç½‘ç»œå’Œ Internet\\ç½‘ç»œè¿æ¥ä¸­å¯¹åº”çš„è¿æ¥åç§°\n@echo off\rset name=\u0026quot;Wi-Fi\u0026quot;\rset ipaddress=172.16.61.216\rset mask=255.255.255.0\rset gateway=172.16.61.254\rset dns1=172.16.3.38\rset dns2=172.16.3.41\rnetsh interface ip set address name=%name% source=static addr=%ipaddress% mask=%mask% gateway=%gateway% 1\rnetsh interface ip set dns name=%name% source=static addr=%dns1% register=PRIMARY\rnetsh interface ip add dns name=%name% addr=%dns2% index=2\r æ¢å¤é»˜è®¤ipé…ç½®\n@echo off\rset name=\u0026quot;Wi-Fi\u0026quot;\rnetsh interface ip set address name=%name% source=dhcp\rnetsh interface ip set dns name=%name% source=dhcp\r ","id":101,"section":"posts","summary":"æŒ‡å®šipä¿¡æ¯ï¼Œåªéœ€è¦ä¿®æ”¹setå‚æ•° nameæ˜¯æ§åˆ¶é¢æ¿\\ç½‘ç»œå’Œ Internet\\ç½‘ç»œè¿æ¥ä¸­å¯¹åº”çš„è¿æ¥åç§° @echo off set name=\u0026quot;Wi-Fi\u0026quot; set ipaddress=172.16.61.216 set mask=255.255.255.0 set gateway=172.16.61.254 set dns1=172.16.3.38 set dns2=172.16.3.41 netsh interface ip set address","tags":["windows"],"title":"Windows IP DNSæ‰¹å¤„ç†","uri":"https://www.mingaccount.com/2018/03/windows-dns/","year":"2018"},{"content":"éœ€è¦æ³¨æ„åœ¨åˆ¤æ–­intå’ŒIntegeræ˜¯å¦ç›¸ç­‰æ—¶ï¼Œä¼šå…ˆå°†Integeræ‹†ç®±ï¼Œå¦‚æœIntegerä¸ºnullï¼Œä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\nå› æ­¤éœ€è¦æå‰å¤„ç†å¥½Integerå¯¹è±¡ä¸ºnullçš„æƒ…å†µã€‚\n","id":102,"section":"posts","summary":"éœ€è¦æ³¨æ„åœ¨åˆ¤æ–­intå’ŒIntegeræ˜¯å¦ç›¸ç­‰æ—¶ï¼Œä¼šå…ˆå°†Integeræ‹†ç®±ï¼Œå¦‚æœIntegerä¸ºnullï¼Œä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ å› æ­¤éœ€è¦æå‰å¤„ç†å¥½I","tags":["java"],"title":"åˆ¤æ–­intå’ŒIntegerç±»å‹æ˜¯å¦ç›¸ç­‰æ—¶ï¼Œç©ºæŒ‡é’ˆå¼‚å¸¸","uri":"https://www.mingaccount.com/2018/03/int-equals-integer/","year":"2018"},{"content":"1. ASCIIç  æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨è®¡ç®—æœºå†…éƒ¨ï¼Œæ‰€æœ‰çš„ä¿¡æ¯æœ€ç»ˆéƒ½è¡¨ç¤ºä¸ºä¸€ä¸ªäºŒè¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆbitï¼‰æœ‰0å’Œ1ä¸¤ç§çŠ¶æ€ï¼Œå› æ­¤å…«ä¸ªäºŒè¿›åˆ¶ä½å°±å¯ä»¥ç»„åˆå‡º256ç§çŠ¶æ€ï¼ˆ-128~127ï¼‰ï¼Œè¿™è¢«ç§°ä¸ºä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå­—èŠ‚ä¸€å…±å¯ä»¥ç”¨æ¥è¡¨ç¤º256ç§ä¸åŒçš„çŠ¶æ€ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªç¬¦å·ï¼Œå°±æ˜¯256ä¸ªç¬¦å·ï¼Œä»0000000åˆ°11111111ã€‚\nä¸Šä¸ªä¸–çºª60å¹´ä»£ï¼Œç¾å›½åˆ¶å®šäº†ä¸€å¥—å­—ç¬¦ç¼–ç ï¼Œå¯¹è‹±è¯­å­—ç¬¦ä¸äºŒè¿›åˆ¶ä½ä¹‹é—´çš„å…³ç³»ï¼Œåšäº†ç»Ÿä¸€è§„å®šã€‚è¿™è¢«ç§°ä¸ºASCIIç ï¼Œä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚\nASCIIç ä¸€å…±è§„å®šäº†128ä¸ªå­—ç¬¦çš„ç¼–ç ï¼Œæ¯”å¦‚ç©ºæ ¼â€œSPACEâ€æ˜¯32ï¼ˆäºŒè¿›åˆ¶00100000ï¼‰ï¼Œå¤§å†™çš„å­—æ¯Aæ˜¯65ï¼ˆäºŒè¿›åˆ¶01000001ï¼‰ã€‚è¿™128ä¸ªç¬¦å·ï¼ˆåŒ…æ‹¬32ä¸ªä¸èƒ½æ‰“å°å‡ºæ¥çš„æ§åˆ¶ç¬¦å·ï¼‰ï¼Œåªå ç”¨äº†ä¸€ä¸ªå­—èŠ‚çš„åé¢7ä½ï¼Œæœ€å‰é¢çš„1ä½ç»Ÿä¸€è§„å®šä¸º0ã€‚\nASCIIç ç”¨äº†1ä¸ªå­—èŠ‚ï¼Œ1ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤º256ç§çŠ¶æ€ï¼Œä½†ASCIIç åªç”¨äº†128ç§ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå­—èŠ‚çš„åä¸ƒä½ï¼Œæœ€å‰é¢çš„1ä½éƒ½æ˜¯0\n2ã€éASCIIç¼–ç  è‹±è¯­ç”¨128ä¸ªç¬¦å·ç¼–ç å°±å¤Ÿäº†ï¼Œä½†æ˜¯ç”¨æ¥è¡¨ç¤ºå…¶ä»–è¯­è¨€ï¼Œ128ä¸ªç¬¦å·æ˜¯ä¸å¤Ÿçš„ã€‚æ¯”å¦‚ï¼Œåœ¨æ³•è¯­ä¸­ï¼Œå­—æ¯ä¸Šæ–¹æœ‰æ³¨éŸ³ç¬¦å·ï¼Œå®ƒå°±æ— æ³•ç”¨ASCIIç è¡¨ç¤ºã€‚äºæ˜¯ï¼Œä¸€äº›æ¬§æ´²å›½å®¶å°±å†³å®šï¼Œåˆ©ç”¨å­—èŠ‚ä¸­é—²ç½®çš„æœ€é«˜ä½ç¼–å…¥æ–°çš„ç¬¦å·ã€‚æ¯”å¦‚ï¼Œæ³•è¯­ä¸­çš„Ã©çš„ç¼–ç ä¸º130ï¼ˆäºŒè¿›åˆ¶10000010ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¿™äº›æ¬§æ´²å›½å®¶ä½¿ç”¨çš„ç¼–ç ä½“ç³»ï¼Œå¯ä»¥è¡¨ç¤ºæœ€å¤š256ä¸ªç¬¦å·ã€‚ ä½†æ˜¯ï¼Œè¿™é‡Œåˆå‡ºç°äº†æ–°çš„é—®é¢˜ã€‚ä¸åŒçš„å›½å®¶æœ‰ä¸åŒçš„å­—æ¯ï¼Œå› æ­¤ï¼Œå“ªæ€•å®ƒä»¬éƒ½ä½¿ç”¨256ä¸ªç¬¦å·çš„ç¼–ç æ–¹å¼ï¼Œä»£è¡¨çš„å­—æ¯å´ä¸ä¸€æ ·ã€‚æ¯”å¦‚ï¼Œ130åœ¨æ³•è¯­ç¼–ç ä¸­ä»£è¡¨äº†Ã©ï¼Œåœ¨å¸Œä¼¯æ¥è¯­ç¼–ç ä¸­å´ä»£è¡¨äº†å­—æ¯Gimel (×’)ï¼Œåœ¨ä¿„è¯­ç¼–ç ä¸­åˆä¼šä»£è¡¨å¦ä¸€ä¸ªç¬¦å·ã€‚ä½†æ˜¯ä¸ç®¡æ€æ ·ï¼Œæ‰€æœ‰è¿™äº›ç¼–ç æ–¹å¼ä¸­ï¼Œ0â€”127è¡¨ç¤ºçš„ç¬¦å·æ˜¯ä¸€æ ·çš„ï¼Œä¸ä¸€æ ·çš„åªæ˜¯128â€”255çš„è¿™ä¸€æ®µã€‚ è‡³äºäºšæ´²å›½å®¶çš„æ–‡å­—ï¼Œä½¿ç”¨çš„ç¬¦å·å°±æ›´å¤šäº†ï¼Œæ±‰å­—å°±å¤šè¾¾10ä¸‡å·¦å³ã€‚ä¸€ä¸ªå­—èŠ‚åªèƒ½è¡¨ç¤º256ç§ç¬¦å·ï¼Œè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šä¸ªå­—èŠ‚è¡¨è¾¾ä¸€ä¸ªç¬¦å·ã€‚æ¯”å¦‚ï¼Œç®€ä½“ä¸­æ–‡å¸¸è§çš„ç¼–ç æ–¹å¼æ˜¯GB2312ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥ç†è®ºä¸Šæœ€å¤šå¯ä»¥è¡¨ç¤º256x256=65536ä¸ªç¬¦å·ã€‚\nä¸­æ–‡ç¼–ç çš„é—®é¢˜éœ€è¦ä¸“æ–‡è®¨è®ºï¼Œè¿™ç¯‡ç¬”è®°ä¸æ¶‰åŠã€‚è¿™é‡ŒåªæŒ‡å‡ºï¼Œè™½ç„¶éƒ½æ˜¯ç”¨å¤šä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œä½†æ˜¯GBç±»çš„æ±‰å­—ç¼–ç ä¸åæ–‡çš„Unicodeå’ŒUTF-8æ˜¯æ¯«æ— å…³ç³»çš„ã€‚\n3.Unicodeç¼–ç  æ­£å¦‚ä¸Šä¸€èŠ‚æ‰€è¯´ï¼Œä¸–ç•Œä¸Šå­˜åœ¨ç€å¤šç§ç¼–ç æ–¹å¼ï¼ŒåŒä¸€ä¸ªäºŒè¿›åˆ¶æ•°å­—å¯ä»¥è¢«è§£é‡Šæˆä¸åŒçš„ç¬¦å·ã€‚å› æ­¤ï¼Œè¦æƒ³æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå°±å¿…é¡»çŸ¥é“å®ƒçš„ç¼–ç æ–¹å¼ï¼Œå¦åˆ™ç”¨é”™è¯¯çš„ç¼–ç æ–¹å¼è§£è¯»ï¼Œå°±ä¼šå‡ºç°ä¹±ç ã€‚ä¸ºä»€ä¹ˆç”µå­é‚®ä»¶å¸¸å¸¸å‡ºç°ä¹±ç ï¼Ÿå°±æ˜¯å› ä¸ºå‘ä¿¡äººå’Œæ”¶ä¿¡äººä½¿ç”¨çš„ç¼–ç æ–¹å¼ä¸ä¸€æ ·ã€‚\nå¯ä»¥æƒ³è±¡ï¼Œå¦‚æœæœ‰ä¸€ç§ç¼–ç ï¼Œå°†ä¸–ç•Œä¸Šæ‰€æœ‰çš„ç¬¦å·éƒ½çº³å…¥å…¶ä¸­ã€‚æ¯ä¸€ä¸ªç¬¦å·éƒ½ç»™äºˆä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–ç ï¼Œé‚£ä¹ˆä¹±ç é—®é¢˜å°±ä¼šæ¶ˆå¤±ã€‚è¿™å°±æ˜¯Unicodeï¼Œå°±åƒå®ƒçš„åå­—éƒ½è¡¨ç¤ºçš„ï¼Œè¿™æ˜¯ä¸€ç§æ‰€æœ‰ç¬¦å·çš„ç¼–ç ã€‚\nUnicodeå½“ç„¶æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é›†åˆï¼Œç°åœ¨çš„è§„æ¨¡å¯ä»¥å®¹çº³100å¤šä¸‡ä¸ªç¬¦å·ã€‚æ¯ä¸ªç¬¦å·çš„ç¼–ç éƒ½ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ï¼ŒU+0639è¡¨ç¤ºé˜¿æ‹‰ä¼¯å­—æ¯Ainï¼ŒU+0041è¡¨ç¤ºè‹±è¯­çš„å¤§å†™å­—æ¯Aï¼ŒU+4E25è¡¨ç¤ºæ±‰å­—â€œä¸¥â€ã€‚å…·ä½“çš„ç¬¦å·å¯¹åº”è¡¨ï¼Œå¯ä»¥æŸ¥è¯¢unicode.orgï¼Œæˆ–è€…ä¸“é—¨çš„æ±‰å­—å¯¹åº”è¡¨ã€‚\n4. Unicodeçš„é—®é¢˜ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒUnicodeåªæ˜¯ä¸€ä¸ªç¬¦å·é›†ï¼Œå®ƒåªè§„å®šäº†ç¬¦å·çš„äºŒè¿›åˆ¶ä»£ç ï¼Œå´æ²¡æœ‰è§„å®šè¿™ä¸ªäºŒè¿›åˆ¶ä»£ç åº”è¯¥å¦‚ä½•å­˜å‚¨ã€‚\næ¯”å¦‚ï¼Œæ±‰å­—â€œä¸¥â€çš„unicodeæ˜¯åå…­è¿›åˆ¶æ•°4E25ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶æ•°è¶³è¶³æœ‰15ä½ï¼ˆ100111000100101ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç¬¦å·çš„è¡¨ç¤ºè‡³å°‘éœ€è¦2ä¸ªå­—èŠ‚ã€‚è¡¨ç¤ºå…¶ä»–æ›´å¤§çš„ç¬¦å·ï¼Œå¯èƒ½éœ€è¦3ä¸ªå­—èŠ‚æˆ–è€…4ä¸ªå­—èŠ‚ï¼Œç”šè‡³æ›´å¤šã€‚\nè¿™é‡Œå°±æœ‰ä¸¤ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚ä½•æ‰èƒ½åŒºåˆ«unicodeå’Œasciiï¼Ÿè®¡ç®—æœºæ€ä¹ˆçŸ¥é“ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œè€Œä¸æ˜¯åˆ†åˆ«è¡¨ç¤ºä¸‰ä¸ªç¬¦å·å‘¢ï¼Ÿç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œè‹±æ–‡å­—æ¯åªç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå°±å¤Ÿäº†ï¼Œå¦‚æœunicodeç»Ÿä¸€è§„å®šï¼Œæ¯ä¸ªç¬¦å·ç”¨ä¸‰ä¸ªæˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªè‹±æ–‡å­—æ¯å‰éƒ½å¿…ç„¶æœ‰äºŒåˆ°ä¸‰ä¸ªå­—èŠ‚æ˜¯0ï¼Œè¿™å¯¹äºå­˜å‚¨æ¥è¯´æ˜¯æå¤§çš„æµªè´¹ï¼Œæ–‡æœ¬æ–‡ä»¶çš„å¤§å°ä¼šå› æ­¤å¤§å‡ºäºŒä¸‰å€ï¼Œè¿™æ˜¯æ— æ³•æ¥å—çš„ã€‚\nå®ƒä»¬é€ æˆçš„ç»“æœæ˜¯ï¼š1ï¼‰å‡ºç°äº†unicodeçš„å¤šç§å­˜å‚¨æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰è®¸å¤šç§ä¸åŒçš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¯ä»¥ç”¨æ¥è¡¨ç¤ºunicodeã€‚2ï¼‰unicodeåœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…æ— æ³•æ¨å¹¿ï¼Œç›´åˆ°äº’è”ç½‘çš„å‡ºç°ã€‚\n5.UTF-8 äº’è”ç½‘çš„æ™®åŠï¼Œå¼ºçƒˆè¦æ±‚å‡ºç°ä¸€ç§ç»Ÿä¸€çš„ç¼–ç æ–¹å¼ã€‚UTF-8å°±æ˜¯åœ¨äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿çš„ä¸€ç§unicodeçš„å®ç°æ–¹å¼ã€‚å…¶ä»–å®ç°æ–¹å¼è¿˜åŒ…æ‹¬UTF-16å’ŒUTF-32ï¼Œä¸è¿‡åœ¨äº’è”ç½‘ä¸ŠåŸºæœ¬ä¸ç”¨ã€‚é‡å¤ä¸€éï¼Œè¿™é‡Œçš„å…³ç³»æ˜¯ï¼ŒUTF-8æ˜¯Unicodeçš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚\nUTF-8æœ€å¤§çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯å®ƒæ˜¯ä¸€ç§å˜é•¿çš„ç¼–ç æ–¹å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ã€‚\nUTF-8çš„ç¼–ç è§„åˆ™å¾ˆç®€å•ï¼Œåªæœ‰äºŒæ¡ï¼š\n å¯¹äºå•å­—èŠ‚çš„ç¬¦å·ï¼Œå­—èŠ‚çš„ç¬¬ä¸€ä½è®¾ä¸º0ï¼Œåé¢7ä½ä¸ºè¿™ä¸ªç¬¦å·çš„unicodeç ã€‚å› æ­¤å¯¹äºè‹±è¯­å­—æ¯ï¼ŒUTF-8ç¼–ç å’ŒASCIIç æ˜¯ç›¸åŒçš„ã€‚ å¯¹äºnå­—èŠ‚çš„ç¬¦å·ï¼ˆn\u0026gt;1ï¼‰ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰nä½éƒ½è®¾ä¸º1ï¼Œç¬¬n+1ä½è®¾ä¸º0ï¼Œåé¢å­—èŠ‚çš„å‰ä¸¤ä½ä¸€å¾‹è®¾ä¸º10ã€‚å‰©ä¸‹çš„æ²¡æœ‰æåŠçš„äºŒè¿›åˆ¶ä½ï¼Œå…¨éƒ¨ä¸ºè¿™ä¸ªç¬¦å·çš„unicodeç ã€‚  ä¸‹è¡¨æ€»ç»“äº†ç¼–ç è§„åˆ™ï¼Œå­—æ¯xè¡¨ç¤ºå¯ç”¨ç¼–ç çš„ä½ã€‚\n   Unicodeç¬¦å·èŒƒå›´ UTF-8ç¼–ç æ–¹å¼     (åå…­è¿›åˆ¶) ï¼ˆäºŒè¿›åˆ¶ï¼‰   0000 0000-0000 007F 0xxxxxxx   0000 0080-0000 07FF 110xxxxx 10xxxxxx   0000 0800-0000 FFFF 1110xxxx 10xxxxxx 10xxxxxx   0001 0000-0010 FFFF 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx    ä¸‹é¢ï¼Œè¿˜æ˜¯ä»¥æ±‰å­—â€œä¸¥â€ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å®ç°UTF-8ç¼–ç ã€‚\nå·²çŸ¥â€œä¸¥â€çš„unicodeæ˜¯4E25ï¼ˆ100111000100101ï¼‰ï¼Œæ ¹æ®ä¸Šè¡¨ï¼Œå¯ä»¥å‘ç°4E25å¤„åœ¨ç¬¬ä¸‰è¡Œçš„èŒƒå›´å†…ï¼ˆ0000 0800-0000 FFFFï¼‰ï¼Œå› æ­¤â€œä¸¥â€çš„UTF-8ç¼–ç éœ€è¦ä¸‰ä¸ªå­—èŠ‚ï¼Œå³æ ¼å¼æ˜¯â€œ1110xxxx 10xxxxxx 10xxxxxxâ€ã€‚ç„¶åï¼Œä»â€œä¸¥â€çš„æœ€åä¸€ä¸ªäºŒè¿›åˆ¶ä½å¼€å§‹ï¼Œä¾æ¬¡ä»åå‘å‰å¡«å…¥æ ¼å¼ä¸­çš„xï¼Œå¤šå‡ºçš„ä½è¡¥0ã€‚è¿™æ ·å°±å¾—åˆ°äº†ï¼Œâ€œä¸¥â€çš„UTF-8ç¼–ç æ˜¯â€œ11100100 10111000 10100101â€ï¼Œè½¬æ¢æˆåå…­è¿›åˆ¶å°±æ˜¯E4B8A5ã€‚\n6. Unicodeä¸UTF-8ä¹‹é—´çš„è½¬æ¢ é€šè¿‡ä¸Šä¸€èŠ‚çš„ä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°â€œä¸¥â€çš„Unicodeç æ˜¯4E25ï¼ŒUTF-8ç¼–ç æ˜¯E4B8A5ï¼Œä¸¤è€…æ˜¯ä¸ä¸€æ ·çš„ã€‚å®ƒä»¬ä¹‹é—´çš„è½¬æ¢å¯ä»¥é€šè¿‡ç¨‹åºå®ç°ã€‚\nåœ¨Windowså¹³å°ä¸‹ï¼Œæœ‰ä¸€ä¸ªæœ€ç®€å•çš„è½¬åŒ–æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨å†…ç½®çš„è®°äº‹æœ¬å°ç¨‹åºNotepad.exeã€‚æ‰“å¼€æ–‡ä»¶åï¼Œç‚¹å‡»â€œæ–‡ä»¶â€èœå•ä¸­çš„â€œå¦å­˜ä¸ºâ€å‘½ä»¤ï¼Œä¼šè·³å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œåœ¨æœ€åº•éƒ¨æœ‰ä¸€ä¸ªâ€œç¼–ç â€çš„ä¸‹æ‹‰æ¡ã€‚\né‡Œé¢æœ‰å››ä¸ªé€‰é¡¹ï¼šANSIï¼ŒUnicodeï¼ŒUnicode big endian å’Œ UTF-8ã€‚\n 1ï¼‰ANSIæ˜¯é»˜è®¤çš„ç¼–ç æ–¹å¼ã€‚å¯¹äºè‹±æ–‡æ–‡ä»¶æ˜¯ASCIIç¼–ç ï¼Œå¯¹äºç®€ä½“ä¸­æ–‡æ–‡ä»¶æ˜¯GB2312ç¼–ç ï¼ˆåªé’ˆå¯¹Windowsç®€ä½“ä¸­æ–‡ç‰ˆï¼Œå¦‚æœæ˜¯ç¹ä½“ä¸­æ–‡ç‰ˆä¼šé‡‡ç”¨Big5ç ï¼‰ã€‚ 2ï¼‰Unicodeç¼–ç æŒ‡çš„æ˜¯UCS-2ç¼–ç æ–¹å¼ï¼Œå³ç›´æ¥ç”¨ä¸¤ä¸ªå­—èŠ‚å­˜å…¥å­—ç¬¦çš„Unicodeç ã€‚è¿™ä¸ªé€‰é¡¹ç”¨çš„little endianæ ¼å¼ã€‚ï¼ˆè¿™ç§æƒ…å†µä¸‹å¦‚æœä¸€ä¸ªå­—ç¬¦çš„unicodeè¶…è¿‡2ä¸ªå­—èŠ‚å°±å­˜ä¸ä¸‹äº†ï¼Œutf-8å°±æ²¡äº‹ï¼‰ 3ï¼‰Unicode big endianç¼–ç ä¸ä¸Šä¸€ä¸ªé€‰é¡¹ç›¸å¯¹åº”ã€‚æˆ‘åœ¨ä¸‹ä¸€èŠ‚ä¼šè§£é‡Šlittle endianå’Œbig endiançš„æ¶µä¹‰ã€‚ 4ï¼‰UTF-8ç¼–ç ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€èŠ‚è°ˆåˆ°çš„ç¼–ç æ–¹æ³•ã€‚  é€‰æ‹©å®Œâ€ç¼–ç æ–¹å¼â€œåï¼Œç‚¹å‡»â€ä¿å­˜â€œæŒ‰é’®ï¼Œæ–‡ä»¶çš„ç¼–ç æ–¹å¼å°±ç«‹åˆ»è½¬æ¢å¥½äº†ã€‚\n7. Little endianå’ŒBig endian ï¼ˆå…¶å®è¿™å°±æ˜¯bomï¼‰ ä¸Šä¸€èŠ‚å·²ç»æåˆ°ï¼ŒUnicodeç å¯ä»¥é‡‡ç”¨UCS-2æ ¼å¼ç›´æ¥å­˜å‚¨ã€‚ä»¥æ±‰å­—â€ä¸¥â€œä¸ºä¾‹ï¼ŒUnicodeç æ˜¯4E25ï¼Œéœ€è¦ç”¨ä¸¤ä¸ªå­—èŠ‚å­˜å‚¨ï¼Œä¸€ä¸ªå­—èŠ‚æ˜¯4Eï¼Œå¦ä¸€ä¸ªå­—èŠ‚æ˜¯25ã€‚å­˜å‚¨çš„æ—¶å€™ï¼Œ4Eåœ¨å‰ï¼Œ25åœ¨åï¼Œå°±æ˜¯Big endianæ–¹å¼ï¼›25åœ¨å‰ï¼Œ4Eåœ¨åï¼Œå°±æ˜¯Little endianæ–¹å¼ã€‚\nè¿™ä¸¤ä¸ªå¤æ€ªçš„åç§°æ¥è‡ªè‹±å›½ä½œå®¶æ–¯å¨å¤«ç‰¹çš„ã€Šæ ¼åˆ—ä½›æ¸¸è®°ã€‹ã€‚åœ¨è¯¥ä¹¦ä¸­ï¼Œå°äººå›½é‡Œçˆ†å‘äº†å†…æˆ˜ï¼Œæˆ˜äº‰èµ·å› æ˜¯äººä»¬äº‰è®ºï¼Œåƒé¸¡è›‹æ—¶ç©¶ç«Ÿæ˜¯ä»å¤§å¤´(Big-Endian)æ•²å¼€è¿˜æ˜¯ä»å°å¤´(Little-Endian)æ•²å¼€ã€‚ä¸ºäº†è¿™ä»¶äº‹æƒ…ï¼Œå‰åçˆ†å‘äº†å…­æ¬¡æˆ˜äº‰ï¼Œä¸€ä¸ªçš‡å¸é€äº†å‘½ï¼Œå¦ä¸€ä¸ªçš‡å¸ä¸¢äº†ç‹ä½ã€‚\nå› æ­¤ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚åœ¨å‰ï¼Œå°±æ˜¯â€å¤§å¤´æ–¹å¼â€œï¼ˆBig endianï¼‰ï¼Œç¬¬äºŒä¸ªå­—èŠ‚åœ¨å‰å°±æ˜¯â€å°å¤´æ–¹å¼â€œï¼ˆLittle endianï¼‰ã€‚\né‚£ä¹ˆå¾ˆè‡ªç„¶çš„ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼šè®¡ç®—æœºæ€ä¹ˆçŸ¥é“æŸä¸€ä¸ªæ–‡ä»¶åˆ°åº•é‡‡ç”¨å“ªä¸€ç§æ–¹å¼ç¼–ç ï¼Ÿ\nUnicodeè§„èŒƒä¸­å®šä¹‰ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶çš„æœ€å‰é¢åˆ†åˆ«åŠ å…¥ä¸€ä¸ªè¡¨ç¤ºç¼–ç é¡ºåºçš„å­—ç¬¦ï¼Œè¿™ä¸ªå­—ç¬¦çš„åå­—å«åšâ€é›¶å®½åº¦éæ¢è¡Œç©ºæ ¼â€œï¼ˆZERO WIDTH NO-BREAK SPACEï¼‰ï¼Œç”¨FEFFè¡¨ç¤ºã€‚è¿™æ­£å¥½æ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œè€Œä¸”FFæ¯”FEå¤§1ã€‚\nå¦‚æœä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„å¤´ä¸¤ä¸ªå­—èŠ‚æ˜¯FE FFï¼Œå°±è¡¨ç¤ºè¯¥æ–‡ä»¶é‡‡ç”¨å¤§å¤´æ–¹å¼ï¼›å¦‚æœå¤´ä¸¤ä¸ªå­—èŠ‚æ˜¯FF FEï¼Œå°±è¡¨ç¤ºè¯¥æ–‡ä»¶é‡‡ç”¨å°å¤´æ–¹å¼ã€‚\n8. å®ä¾‹ ä¸‹é¢ï¼Œä¸¾ä¸€ä¸ªå®ä¾‹ï¼š\næ‰“å¼€â€è®°äº‹æœ¬â€œç¨‹åºNotepad.exeï¼Œæ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹å°±æ˜¯ä¸€ä¸ªâ€ä¸¥â€œå­—ï¼Œä¾æ¬¡é‡‡ç”¨ANSIï¼ŒUnicodeï¼ŒUnicode big endian å’Œ UTF-8ç¼–ç æ–¹å¼ä¿å­˜ã€‚\nç„¶åï¼Œç”¨æ–‡æœ¬ç¼–è¾‘è½¯ä»¶UltraEditä¸­çš„â€åå…­è¿›åˆ¶åŠŸèƒ½â€œï¼Œè§‚å¯Ÿè¯¥æ–‡ä»¶çš„å†…éƒ¨ç¼–ç æ–¹å¼ã€‚\n 1ï¼‰ANSIï¼šæ–‡ä»¶çš„ç¼–ç å°±æ˜¯ä¸¤ä¸ªå­—èŠ‚â€œD1 CFâ€ï¼Œè¿™æ­£æ˜¯â€œä¸¥â€çš„GB2312ç¼–ç ï¼Œè¿™ä¹Ÿæš—ç¤ºGB2312æ˜¯é‡‡ç”¨å¤§å¤´æ–¹å¼å­˜å‚¨çš„ã€‚ 2ï¼‰Unicodeï¼šç¼–ç æ˜¯å››ä¸ªå­—èŠ‚â€œFF FE 25 4Eâ€ï¼Œå…¶ä¸­â€œFF FEâ€è¡¨æ˜æ˜¯å°å¤´æ–¹å¼å­˜å‚¨ï¼ŒçœŸæ­£çš„ç¼–ç æ˜¯4E25ã€‚ 3ï¼‰Unicode big endianï¼šç¼–ç æ˜¯å››ä¸ªå­—èŠ‚â€œFE FF 4E 25â€ï¼Œå…¶ä¸­â€œFE FFâ€è¡¨æ˜æ˜¯å¤§å¤´æ–¹å¼å­˜å‚¨ã€‚ 4ï¼‰UTF-8ï¼šç¼–ç æ˜¯å…­ä¸ªå­—èŠ‚â€œEF BB BF E4 B8 A5â€ï¼Œå‰ä¸‰ä¸ªå­—èŠ‚â€œEF BB BFâ€è¡¨ç¤ºè¿™æ˜¯UTF-8ç¼–ç ï¼Œåä¸‰ä¸ªâ€œE4B8A5â€å°±æ˜¯â€œä¸¥â€çš„å…·ä½“ç¼–ç ï¼Œå®ƒçš„å­˜å‚¨é¡ºåºä¸ç¼–ç é¡ºåºæ˜¯ä¸€è‡´çš„ã€‚  9ã€unicodeç¼–ç è¡¨ Unicodeç›®å‰æ™®éé‡‡ç”¨çš„æ˜¯UCS-2,å®ƒç”¨ä¸¤ä¸ªå­—èŠ‚æ¥ç¼–ç ä¸€ä¸ªå­—ç¬¦,æ¯”å¦‚æ±‰å­—\u0026quot;ç»\u0026quot;çš„ç¼–ç æ˜¯0x7ECF,æ³¨æ„å­—ç¬¦ç¼–ç ä¸€èˆ¬ç”¨åå…­è¿›åˆ¶æ¥è¡¨ç¤º,ä¸ºäº†ä¸åè¿›åˆ¶åŒºåˆ†,å°±æ˜¯32463,UCS-2ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥ç¼–ç å­—ç¬¦,ä¸¤ä¸ªå­—èŠ‚å°±æ˜¯16\nä½äºŒè¿›åˆ¶,2çš„16æ¬¡æ–¹ç­‰äº65536,æ‰€ä»¥UCS-2æœ€å¤šèƒ½ç¼–ç 65536ä¸ªå­—ç¬¦ã€‚ç¼–ç ä»0åˆ°127çš„å­—ç¬¦ä¸ASCIIç¼–ç çš„å­—ç¬¦ä¸€æ ·,æ¯”å¦‚å­—æ¯\u0026quot;a\u0026quot;çš„Unicode ç¼–ç æ˜¯0x0061,åè¿›åˆ¶æ˜¯97,è€Œ\u0026quot;a\u0026quot;çš„ASCIIç¼–ç æ˜¯0x61,åè¿›åˆ¶ä¹Ÿæ˜¯97,\nå¯¹äºæ±‰å­—çš„ç¼–ç ,äº‹å®ä¸ŠUnicodeå¯¹æ±‰å­—æ”¯æŒä¸æ€ä¹ˆå¥½,è¿™ä¹Ÿæ˜¯æ²¡åŠæ³•çš„,ç®€ä½“å’Œç¹ä½“æ€»å…±æœ‰å…­ä¸ƒä¸‡ä¸ªæ±‰å­—,è€ŒUCS-2æœ€å¤šèƒ½è¡¨ç¤º65536ä¸ª,æ‰å…­ä¸‡å¤šä¸ª,æ‰€ä»¥Unicodeåªèƒ½æ’é™¤ä¸€äº›å‡ ä¹ä¸ç”¨çš„æ±‰å­—,å¥½åœ¨å¸¸ç”¨çš„ç®€ä½“æ±‰å­—\nä¹Ÿä¸è¿‡ä¸ƒåƒå¤šä¸ª,ä¸ºäº†èƒ½è¡¨ç¤ºæ‰€æœ‰æ±‰å­—,Unicodeä¹Ÿæœ‰UCS-4è§„èŒƒ,å°±æ˜¯ç”¨4ä¸ªå­—èŠ‚æ¥ç¼–ç å­—ç¬¦,ä¸è¿‡ç°åœ¨æ™®éé‡‡ç”¨çš„è¿˜æ˜¯UCS-2ï¼Œåªç”¨ä¸¤ä¸ªå­—èŠ‚æ¥ç¼–ç \næ›¾ç»ä½¿ç”¨è¿™ç§æ–¹æ³•å¤„ç†æ±‰å­—ä¼ è¾“ä¹±ç é—®é¢˜ã€‚ä¼ è¾“è¿‡ç¨‹ä¸­å°†æ±‰å­—è½¬æ¢æˆUCS-2çš„unicode 4ä½16è¿›åˆ¶ç¼–ç ï¼Œæ¥æ”¶åå†è½¬å›æ¥ã€‚\n10ã€BCDç  åœ¨ä¸€æ¬¡é¢è¯•ä¸­è¢«é—®åˆ°BCDç ä¸Šé¢è®²çš„æ˜¯å­—ç¬¦ç¼–ç ï¼Œæ˜¯æŒ‡ä¸€ä¸ªå­—ç¬¦å¯¹åº”çš„ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ï¼Œè€ŒBCDç æ˜¯è®¡ç®—æœºåœ¨å¯¹åè¿›åˆ¶æ•°åšè¿ç®—æˆ–å­˜å‚¨æ—¶é‡‡ç”¨çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚\nå³BCDä»£ç ã€‚Binary-Coded Decimalâ€ï¼Œç®€ç§°BCDï¼Œç§°BCDç æˆ–äºŒ-åè¿›åˆ¶ä»£ç ï¼Œäº¦ç§°äºŒè¿›ç åè¿›æ•°ã€‚æ˜¯ä¸€ç§äºŒè¿›åˆ¶çš„æ•°å­—ç¼–ç å½¢å¼ï¼Œç”¨äºŒè¿›åˆ¶ç¼–ç çš„åè¿›åˆ¶ä»£ç ã€‚è¿™ç§ç¼–ç å½¢å¼åˆ©ç”¨äº†å››ä¸ªä½å…ƒæ¥å‚¨å­˜ä¸€ä¸ªåè¿›åˆ¶çš„æ•°ç ï¼Œä½¿äºŒè¿›åˆ¶å’Œåè¿›åˆ¶ä¹‹é—´çš„è½¬æ¢å¾—ä»¥å¿«æ·çš„è¿›è¡Œã€‚\nBCDç  - å¸¸ç”¨BCDç \n   åè¿›åˆ¶æ•° 8421ç  5421ç  2421ç  ä½™3ç  ä½™3å¾ªç¯ç      0 0000 0000 0000 0011 0010   1 0001 0001 0001 0100 0110   2 0010 0010 0010 0101 0111   3 0011 0011 0011 0110 0101   4 0100 0100 0100 0111 0100   5 0101 1000 1011 1000 1100   6 0110 1001 1100 1001 1101   7 0111 1010 1101 1010 1111   8 1000 1011 1110 1011 1110   9 1001 1100 1111 1100 1010    bcdç æ•ˆç‡é«˜ï¼š\næ¯”å¦‚åè¿›åˆ¶è¦ä»¥äºŒè¿›åˆ¶çš„å½¢å¼åœ¨è®¡ç®—æœºä¸­å­˜å‚¨ï¼Œåè¿›åˆ¶ç›´æ¥è½¬æ¢æˆä¸ä¹‹å¯¹åº”çš„BCDç æ¯”åè¿›åˆ¶é€šè¿‡é™¤æ³•å–ä½™å†è½¬æ¢çš„æ•ˆç‡æ¥çš„é«˜\n11ã€Base64ç¼–ç ï¼ˆæ€ä¹ˆä½¿ç”¨ï¼Ÿï¼‰ ï¼ˆæŠŠä¸€ä¸²äºŒè¿›åˆ¶è½¬æ¢æˆå¦ä¸€ç§äºŒè¿›åˆ¶ä¸²ï¼Œä»¥è‡³äºå¯ä»¥æ‰“å°æˆè‹±æ–‡ã€æ•°å­—å­—ç¬¦è¿˜æœ‰+ã€/ï¼‰\n1ã€Base64è¦æ±‚æŠŠæ¯ä¸‰ä¸ª8Bitçš„å­—èŠ‚è½¬æ¢ä¸ºå››ä¸ª6Bitçš„å­—èŠ‚ï¼ˆ3*8 = 4*6 = 24ï¼‰ï¼Œç„¶åæŠŠ6Bitå†æ·»ä¸¤ä½é«˜ä½0ï¼Œç»„æˆå››ä¸ª8Bitçš„å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè½¬æ¢åçš„å­—ç¬¦ä¸²ç†è®ºä¸Šå°†è¦æ¯”åŸæ¥çš„é•¿1/3ã€‚\n2ã€åœ¨emailä¼ è¾“ä¸­ï¼ŒåŠ å¯†æ˜¯è‚¯å®šçš„ï¼Œä½†æ˜¯base64åŠ å¯†çš„ç›®çš„ä¸æ˜¯è®©ç”¨æˆ·å‘é€éå¸¸å®‰å…¨çš„Emailã€‚è¿™ç§åŠ å¯†æ–¹å¼ä¸»è¦å°±æ˜¯â€œé˜²å›å­ä¸é˜²å°äººâ€ï¼Œè¾¾åˆ°ä¸€ç§ä¸€çœ¼çœ‹ä¸Šå»çœ‹ä¸å‡ºå†…å®¹çš„æ•ˆæœã€‚\n3ã€base64ç¼–ç æ˜¯ç”¨æ¥è§£å†³æŠŠä¸å¯æ‰“å°çš„å†…å®¹å¡è¿›å¯æ‰“å°å†…å®¹çš„éœ€æ±‚çš„ã€‚æ¯”å¦‚æŠŠå›¾ç‰‡å­˜åˆ°æ•°æ®åº“ï¼Œå›¾ç‰‡æ•°æ®å½’æ ¹åˆ°åº•è¿˜æ˜¯ä¸€å †äºŒè¿›åˆ¶ä¸²ï¼ˆæ€»ä¸èƒ½æŠŠè¿™äº›äºŒè¿›åˆ¶ä¸²ç›´æ¥å­˜åˆ°æ•°æ®åº“å§ï¼‰ï¼Œç”¨base64ç¼–ç åçš„æ˜¾ç¤ºæˆçš„å­—ç¬¦ä¸²å°±å¤§å¤§ç¼©å°çš„é•¿åº¦ï¼Œå¯ä»¥å­˜åˆ°æ•°æ®åº“ã€‚\n4ã€æ»¡è¶³ç”µå­é‚®ä»¶ä¸­ä¸èƒ½ç›´æ¥ä½¿ç”¨éASCIIç å­—ç¬¦ä¼ è¾“æ•°æ®çš„è§„å®šï¼Œæ‰€ä»¥ä½¿ç”¨base64è¿›è¡Œç¼–ç åä¼ è¾“ï¼Œå› ä¸ºbase64çš„64ä¸ªå­—ç¬¦è‚¯å®šæœ‰å¯¹åº”çš„asciiç¼–ç ã€‚\n5ã€è¯·ä¸è¦å†å«base64åŠ å¯†ï¼Œè¯·å«base64ç¼–ç \nè®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼ŒåŠ æ·±å°è±¡ï¼\nè½¬æ¢å‰ 10101101 10111010 01110110\nè½¬æ¢ä¸­ 101011 011011 101001 110110\nè½¬æ¢å 00101011 00011011 00101001 00110110\nå¯¹åº”ç è¡¨ä¸­çš„å€¼ r b p 2\nè½¬è‡ªhttp://blog.csdn.net/junhuahouse/article/details/23032827\nå¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œæœ‰ä¸€ç¾¤äººï¼Œä»–ä»¬å†³å®šç”¨8ä¸ªå¯ä»¥å¼€åˆçš„æ™¶ä½“ç®¡æ¥ç»„åˆæˆä¸åŒçš„çŠ¶æ€ï¼Œä»¥è¡¨ç¤ºä¸–ç•Œä¸Šçš„ä¸‡ç‰©ã€‚ä»–ä»¬çœ‹åˆ°8ä¸ªå¼€å…³çŠ¶æ€æ˜¯å¥½çš„ï¼Œäºæ˜¯ä»–ä»¬æŠŠè¿™ç§°ä¸ºâ€å­—èŠ‚â€œã€‚å†åæ¥ï¼Œä»–ä»¬åˆåšäº†ä¸€äº›å¯ä»¥å¤„ç†è¿™äº›å­—èŠ‚çš„æœºå™¨ï¼Œæœºå™¨å¼€åŠ¨äº†ï¼Œå¯ä»¥ç”¨å­—èŠ‚æ¥ç»„åˆå‡ºå¾ˆå¤šçŠ¶æ€ï¼ŒçŠ¶æ€å¼€å§‹å˜æ¥å˜å»ã€‚ä»–ä»¬çœ‹åˆ°è¿™æ ·æ˜¯å¥½çš„ï¼Œäºæ˜¯å®ƒä»¬å°±è¿™æœºå™¨ç§°ä¸ºâ€è®¡ç®—æœºâ€œã€‚\nå¼€å§‹è®¡ç®—æœºåªåœ¨ç¾å›½ç”¨ã€‚å…«ä½çš„å­—èŠ‚ä¸€å…±å¯ä»¥ç»„åˆå‡º256(2çš„8æ¬¡æ–¹)ç§ä¸åŒçš„çŠ¶æ€ã€‚ ä»–ä»¬æŠŠå…¶ä¸­çš„ç¼–å·ä»0å¼€å§‹çš„32ç§çŠ¶æ€åˆ†åˆ«è§„å®šäº†ç‰¹æ®Šçš„ç”¨é€”ï¼Œä¸€ä½†ç»ˆç«¯ã€æ‰“å°æœºé‡ä¸Šçº¦å®šå¥½çš„è¿™äº›å­—èŠ‚è¢«ä¼ è¿‡æ¥æ—¶ï¼Œå°±è¦åšä¸€äº›çº¦å®šçš„åŠ¨ä½œã€‚é‡ä¸Š0Ã—10, ç»ˆç«¯å°±æ¢è¡Œï¼Œé‡ä¸Š0Ã—07, ç»ˆç«¯å°±å‘äººä»¬å˜Ÿå˜Ÿå«ï¼Œä¾‹å¥½é‡ä¸Š0x1b, æ‰“å°æœºå°±æ‰“å°åç™½çš„å­—ï¼Œæˆ–è€…ç»ˆç«¯å°±ç”¨å½©è‰²æ˜¾ç¤ºå­—æ¯ã€‚ä»–ä»¬çœ‹åˆ°è¿™æ ·å¾ˆå¥½ï¼Œäºæ˜¯å°±æŠŠè¿™äº›0Ã—20ä»¥ä¸‹çš„å­—èŠ‚çŠ¶æ€ç§°ä¸ºâ€æ§åˆ¶ç â€ã€‚ä»–ä»¬åˆæŠŠæ‰€æœ‰çš„ç©º æ ¼ã€æ ‡ç‚¹ç¬¦å·ã€æ•°å­—ã€å¤§å°å†™å­—æ¯åˆ†åˆ«ç”¨è¿ç»­çš„å­—èŠ‚çŠ¶æ€è¡¨ç¤ºï¼Œä¸€ç›´ç¼–åˆ°äº†ç¬¬127å·ï¼Œè¿™æ ·è®¡ç®—æœºå°±å¯ä»¥ç”¨ä¸åŒå­—èŠ‚æ¥å­˜å‚¨è‹±è¯­çš„æ–‡å­—äº†ã€‚å¤§å®¶çœ‹åˆ°è¿™æ ·ï¼Œéƒ½æ„Ÿè§‰ å¾ˆå¥½ï¼Œäºæ˜¯å¤§å®¶éƒ½æŠŠè¿™ä¸ªæ–¹æ¡ˆå«åš ANSI çš„â€Asciiâ€ç¼–ç ï¼ˆAmerican Standard Code for Information Interchangeï¼Œç¾å›½ä¿¡æ¯äº’æ¢æ ‡å‡†ä»£ç ï¼‰ã€‚å½“æ—¶ä¸–ç•Œä¸Šæ‰€æœ‰çš„è®¡ç®—æœºéƒ½ç”¨åŒæ ·çš„ASCIIæ–¹æ¡ˆæ¥ä¿å­˜è‹±æ–‡æ–‡å­—ã€‚\nåæ¥ï¼Œå°±åƒå»ºé€ å·´æ¯”ä¼¦å¡”ä¸€æ ·ï¼Œä¸–ç•Œå„åœ°çš„éƒ½å¼€å§‹ä½¿ç”¨è®¡ç®—æœºï¼Œä½†æ˜¯å¾ˆå¤šå›½å®¶ç”¨çš„ä¸æ˜¯è‹±æ–‡ï¼Œä»–ä»¬çš„å­—æ¯é‡Œæœ‰è®¸å¤šæ˜¯ASCIIé‡Œæ²¡æœ‰çš„ï¼Œä¸ºäº†å¯ä»¥åœ¨è®¡ç®—æœºä¿å­˜ä»–ä»¬çš„æ–‡å­—ï¼Œä»–ä»¬å†³å®šé‡‡ç”¨ 127å·ä¹‹åçš„ç©ºä½æ¥è¡¨ç¤ºè¿™äº›æ–°çš„å­—æ¯ã€ç¬¦å·ï¼Œè¿˜åŠ å…¥äº†å¾ˆå¤šç”»è¡¨æ ¼æ—¶éœ€è¦ç”¨ä¸‹åˆ°çš„æ¨ªçº¿ã€ç«–çº¿ã€äº¤å‰ç­‰å½¢çŠ¶ï¼Œä¸€ç›´æŠŠåºå·ç¼–åˆ°äº†æœ€åä¸€ä¸ªçŠ¶æ€255ã€‚ä»128 åˆ°255è¿™ä¸€é¡µçš„å­—ç¬¦é›†è¢«ç§°â€æ‰©å±•å­—ç¬¦é›†â€œã€‚ä»æ­¤ä¹‹åï¼Œè´ªå©ªçš„äººç±»å†æ²¡æœ‰æ–°çš„çŠ¶æ€å¯ä»¥ç”¨äº†ï¼Œç¾å¸å›½ä¸»ä¹‰å¯èƒ½æ²¡æœ‰æƒ³åˆ°è¿˜æœ‰ç¬¬ä¸‰ä¸–ç•Œå›½å®¶çš„äººä»¬ä¹Ÿå¸Œæœ›å¯ä»¥ç”¨åˆ°è®¡ç®—æœºå§ï¼\nç­‰ä¸­å›½äººä»¬å¾—åˆ°è®¡ç®—æœºæ—¶ï¼Œå·²ç»æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„å­—èŠ‚çŠ¶æ€æ¥è¡¨ç¤ºæ±‰å­—ï¼Œå†µä¸”æœ‰6000å¤šä¸ªå¸¸ç”¨æ±‰å­—éœ€è¦ä¿å­˜å‘¢ã€‚ä½†æ˜¯è¿™éš¾ä¸å€’æ™ºæ…§çš„ä¸­å›½äººæ°‘ï¼Œæˆ‘ä»¬ä¸å®¢æ°”åœ°æŠŠé‚£äº›127å·ä¹‹åçš„å¥‡å¼‚ç¬¦å·ä»¬ç›´æ¥å–æ¶ˆæ‰, è§„å®šï¼šä¸€ä¸ªå°äº127çš„å­—ç¬¦çš„æ„ä¹‰ä¸åŸæ¥ç›¸åŒï¼Œä½†ä¸¤ä¸ªå¤§äº127çš„å­—ç¬¦è¿åœ¨ä¸€èµ·æ—¶ï¼Œå°±è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œå‰é¢çš„ä¸€ä¸ªå­—èŠ‚ï¼ˆä»–ç§°ä¹‹ä¸ºé«˜å­—èŠ‚ï¼‰ä»0xA1ç”¨åˆ° 0xF7ï¼Œåé¢ä¸€ä¸ªå­—èŠ‚ï¼ˆä½å­—èŠ‚ï¼‰ä»0xA1åˆ°0xFEï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»„åˆå‡ºå¤§çº¦7000å¤šä¸ªç®€ä½“æ±‰å­—äº†ã€‚åœ¨è¿™äº›ç¼–ç é‡Œï¼Œæˆ‘ä»¬è¿˜æŠŠæ•°å­¦ç¬¦å·ã€ç½—é©¬å¸Œè…Šçš„å­—æ¯ã€æ—¥æ–‡çš„å‡åä»¬éƒ½ç¼–è¿›å»äº†ï¼Œè¿åœ¨ ASCII é‡Œæœ¬æ¥å°±æœ‰çš„æ•°å­—ã€æ ‡ç‚¹ã€å­—æ¯éƒ½ç»Ÿç»Ÿé‡æ–°ç¼–äº†ä¸¤ä¸ªå­—èŠ‚é•¿çš„ç¼–ç ï¼Œè¿™å°±æ˜¯å¸¸è¯´çš„â€å…¨è§’â€å­—ç¬¦ï¼Œè€ŒåŸæ¥åœ¨127å·ä»¥ä¸‹çš„é‚£äº›å°±å«â€åŠè§’â€å­—ç¬¦äº†ã€‚ ä¸­å›½äººæ°‘çœ‹åˆ°è¿™æ ·å¾ˆä¸é”™ï¼Œäºæ˜¯å°±æŠŠè¿™ç§æ±‰å­—æ–¹æ¡ˆå«åš â€œGB2312â€œã€‚GB2312 æ˜¯å¯¹ ASCII çš„ä¸­æ–‡æ‰©å±•ã€‚\nä½†æ˜¯ä¸­å›½çš„æ±‰å­—å¤ªå¤šäº†ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±å°±å‘ç°æœ‰è®¸å¤šäººçš„äººåæ²¡æœ‰åŠæ³•åœ¨è¿™é‡Œæ‰“å‡ºæ¥ï¼Œç‰¹åˆ«æ˜¯æŸäº›å¾ˆä¼šéº»çƒ¦åˆ«äººçš„å›½å®¶é¢†å¯¼äººã€‚äºæ˜¯æˆ‘ä»¬ä¸å¾—ä¸ç»§ç»­æŠŠ GB2312 æ²¡æœ‰ç”¨åˆ°çš„ç ä½æ‰¾å‡ºæ¥è€å®ä¸å®¢æ°”åœ°ç”¨ä¸Šã€‚ åæ¥è¿˜æ˜¯ä¸å¤Ÿç”¨ï¼Œäºæ˜¯å¹²è„†ä¸å†è¦æ±‚ä½å­—èŠ‚ä¸€å®šæ˜¯127å·ä¹‹åçš„å†…ç ï¼Œåªè¦ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯å¤§äº127å°±å›ºå®šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ±‰å­—çš„å¼€å§‹ï¼Œä¸ç®¡åé¢è·Ÿçš„æ˜¯ä¸æ˜¯æ‰©å±•å­—ç¬¦é›†é‡Œçš„å†…å®¹ã€‚ç»“æœæ‰©å±•ä¹‹åçš„ç¼–ç æ–¹æ¡ˆè¢«ç§°ä¸º GBK æ ‡å‡†ï¼ŒGBKåŒ…æ‹¬äº†GB2312 çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒæ—¶åˆå¢åŠ äº†è¿‘20000ä¸ªæ–°çš„æ±‰å­—ï¼ˆåŒ…æ‹¬ç¹ä½“å­—ï¼‰å’Œç¬¦å·ã€‚ åæ¥å°‘æ•°æ°‘æ—ä¹Ÿè¦ç”¨ç”µè„‘äº†ï¼Œäºæ˜¯æˆ‘ä»¬å†æ‰©å±•ï¼ŒåˆåŠ äº†å‡ åƒä¸ªæ–°çš„å°‘æ•°æ°‘æ—çš„å­—ï¼ŒGBKæ‰©æˆäº†GB18030ã€‚ä»æ­¤ä¹‹åï¼Œä¸­åæ°‘æ—çš„æ–‡åŒ–å°±å¯ä»¥åœ¨è®¡ç®—æœºæ—¶ä»£ä¸­ä¼ æ‰¿äº†ã€‚ ä¸­å›½çš„ç¨‹åºå‘˜ä»¬çœ‹åˆ°è¿™ä¸€ç³»åˆ—æ±‰å­—ç¼–ç çš„æ ‡å‡†æ˜¯å¥½çš„ï¼Œäºæ˜¯é€šç§°ä»–ä»¬å«åš â€œDBCSâ€œï¼ˆDouble Byte Charecter Set åŒå­—èŠ‚å­—ç¬¦é›†ï¼‰ã€‚åœ¨DBCSç³»åˆ—æ ‡å‡†é‡Œï¼Œæœ€å¤§çš„ç‰¹ç‚¹æ˜¯ä¸¤å­—èŠ‚é•¿çš„æ±‰å­—å­—ç¬¦å’Œä¸€å­—èŠ‚é•¿çš„è‹±æ–‡å­—ç¬¦å¹¶å­˜äºåŒä¸€å¥—ç¼–ç æ–¹æ¡ˆé‡Œï¼Œå› æ­¤ä»–ä»¬å†™çš„ç¨‹åºä¸ºäº†æ”¯æŒä¸­æ–‡å¤„ç†ï¼Œå¿…é¡»è¦æ³¨æ„å­—ä¸²é‡Œçš„æ¯ä¸€ä¸ªå­—èŠ‚çš„å€¼ï¼Œå¦‚æœè¿™ä¸ªå€¼æ˜¯å¤§äº127çš„ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºä¸€ä¸ªåŒå­—èŠ‚å­—ç¬¦é›†é‡Œçš„å­—ç¬¦å‡ºç°äº†ã€‚é‚£æ—¶å€™å‡¡æ˜¯å—è¿‡åŠ æŒï¼Œä¼šç¼–ç¨‹çš„è®¡ç®—æœºåƒ§ä¾£ ä»¬éƒ½è¦æ¯å¤©å¿µä¸‹é¢è¿™ä¸ªå’’è¯­æ•°ç™¾éï¼š â€œä¸€ä¸ªæ±‰å­—ç®—ä¸¤ä¸ªè‹±æ–‡å­—ç¬¦ï¼ä¸€ä¸ªæ±‰å­—ç®—ä¸¤ä¸ªè‹±æ–‡å­—ç¬¦â€¦â€¦â€\nå› ä¸ºå½“æ—¶å„ä¸ªå›½å®¶éƒ½åƒä¸­å›½è¿™æ ·æå‡ºä¸€å¥—è‡ªå·±çš„ç¼–ç æ ‡å‡†ï¼Œç»“æœäº’ç›¸ä¹‹é—´è°ä¹Ÿä¸æ‡‚è°çš„ç¼–ç ï¼Œè°ä¹Ÿä¸æ”¯æŒåˆ«äººçš„ç¼–ç ï¼Œè¿å¤§é™†å’Œå°æ¹¾è¿™æ ·åªç›¸éš”äº†150æµ·é‡Œï¼Œä½¿ç”¨ç€åŒä¸€ç§è¯­è¨€çš„å…„å¼Ÿåœ°åŒºï¼Œä¹Ÿåˆ†åˆ«é‡‡ç”¨äº†ä¸åŒçš„ DBCS ç¼–ç æ–¹æ¡ˆâ€”â€”å½“æ—¶çš„ä¸­å›½äººæƒ³è®©ç”µè„‘æ˜¾ç¤ºæ±‰å­—ï¼Œå°±å¿…é¡»è£…ä¸Šä¸€ä¸ªâ€æ±‰å­—ç³»ç»Ÿâ€ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†æ±‰å­—çš„æ˜¾ç¤ºã€è¾“å…¥çš„é—®é¢˜ï¼Œä½†æ˜¯é‚£ä¸ªå°æ¹¾çš„æ„šæ˜§å°å»ºäººå£«å†™çš„ç®—å‘½ç¨‹åºå°±å¿…é¡»åŠ è£…å¦ä¸€å¥—æ”¯æŒ BIG5 ç¼–ç çš„ä»€ä¹ˆâ€å€šå¤©æ±‰å­—ç³»ç»Ÿâ€æ‰å¯ä»¥ç”¨ï¼Œè£…é”™äº†å­—ç¬¦ç³»ç»Ÿï¼Œæ˜¾ç¤ºå°±ä¼šä¹±äº†å¥—ï¼è¿™æ€ä¹ˆåŠï¼Ÿè€Œä¸”ä¸–ç•Œæ°‘æ—ä¹‹æ—ä¸­è¿˜æœ‰é‚£äº›ä¸€æ—¶ç”¨ä¸ä¸Šç”µè„‘çš„ç©·è‹¦äººæ°‘ï¼Œä»–ä»¬çš„æ–‡å­—åˆæ€ä¹ˆåŠï¼Ÿ çœŸæ˜¯è®¡ç®—æœºçš„å·´æ¯”ä¼¦å¡”å‘½é¢˜å•Šï¼\næ­£åœ¨è¿™æ—¶ï¼Œå¤§å¤©ä½¿åŠ ç™¾åˆ—åŠæ—¶å‡ºç°äº†â€”â€”ä¸€ä¸ªå« ISO ï¼ˆå›½é™…æ ‡è°åŒ–ç»„ç»‡ï¼‰çš„å›½é™…ç»„ç»‡å†³å®šç€æ‰‹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä»–ä»¬é‡‡ç”¨çš„æ–¹æ³•å¾ˆç®€å•ï¼šåºŸäº†æ‰€æœ‰çš„åœ°åŒºæ€§ç¼–ç æ–¹æ¡ˆï¼Œé‡æ–°æä¸€ä¸ªåŒ…æ‹¬äº†åœ°çƒä¸Šæ‰€æœ‰æ–‡åŒ–ã€æ‰€æœ‰å­—æ¯å’Œç¬¦å· çš„ç¼–ç ï¼ä»–ä»¬æ‰“ç®—å«å®ƒâ€Universal Multiple-Octet Coded Character Setâ€ï¼Œç®€ç§° UCS, ä¿—ç§° â€œunicodeâ€œã€‚\nunicodeå¼€å§‹åˆ¶è®¢æ—¶ï¼Œè®¡ç®—æœºçš„å­˜å‚¨å™¨å®¹é‡æå¤§åœ°å‘å±•äº†ï¼Œç©ºé—´å†ä¹Ÿä¸æˆä¸ºé—®é¢˜äº†ã€‚äºæ˜¯ ISO å°±ç›´æ¥è§„å®šå¿…é¡»ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯16ä½æ¥ç»Ÿä¸€è¡¨ç¤ºæ‰€æœ‰çš„å­—ç¬¦ï¼Œå¯¹äºASCIIé‡Œçš„é‚£äº›â€œåŠè§’â€å­—ç¬¦ï¼ŒunicodeåŒ…æŒå…¶åŸç¼–ç ä¸å˜ï¼Œåªæ˜¯å°†å…¶é•¿åº¦ç”±åŸæ¥çš„8ä½æ‰©å±•ä¸º16ä½ï¼Œè€Œå…¶ä»–æ–‡åŒ–å’Œè¯­è¨€çš„å­—ç¬¦åˆ™å…¨éƒ¨é‡æ–°ç»Ÿä¸€ç¼–ç ã€‚ç”±äºâ€åŠè§’â€è‹±æ–‡ç¬¦å·åªéœ€è¦ç”¨åˆ°ä½8ä½ï¼Œæ‰€ä»¥å…¶é«˜8ä½æ°¸è¿œæ˜¯0ï¼Œå› æ­¤è¿™ç§å¤§æ°”çš„æ–¹æ¡ˆåœ¨ä¿å­˜è‹±æ–‡æ–‡æœ¬æ—¶ä¼šå¤šæµªè´¹ä¸€å€çš„ç©ºé—´ã€‚\nè¿™æ—¶å€™ï¼Œä»æ—§ç¤¾ä¼šé‡Œèµ°è¿‡æ¥çš„ç¨‹åºå‘˜å¼€å§‹å‘ç°ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼šä»–ä»¬çš„strlenå‡½æ•°é ä¸ä½äº†ï¼Œä¸€ä¸ªæ±‰å­—ä¸å†æ˜¯ç›¸å½“äºä¸¤ä¸ªå­—ç¬¦äº†ï¼Œè€Œæ˜¯ä¸€ä¸ªï¼æ˜¯çš„ï¼Œä»unicodeå¼€å§‹ï¼Œæ— è®ºæ˜¯åŠè§’çš„è‹±æ–‡å­—æ¯ï¼Œè¿˜æ˜¯å…¨è§’çš„æ±‰å­—ï¼Œå®ƒä»¬éƒ½æ˜¯ç»Ÿä¸€çš„â€ä¸€ä¸ªå­—ç¬¦â€œï¼åŒæ—¶ï¼Œä¹Ÿéƒ½æ˜¯ç»Ÿä¸€çš„â€ä¸¤ä¸ªå­—èŠ‚â€œï¼Œè¯·æ³¨æ„â€å­—ç¬¦â€å’Œâ€å­—èŠ‚â€ä¸¤ä¸ªæœ¯è¯­çš„ä¸åŒï¼Œâ€œå­—èŠ‚â€æ˜¯ä¸€ä¸ª8ä½çš„ç‰©ç†å­˜è´®å•å…ƒï¼Œè€Œâ€œå­—ç¬¦â€åˆ™æ˜¯ä¸€ä¸ªæ–‡åŒ–ç›¸å…³çš„ç¬¦å·ã€‚åœ¨unicodeä¸­ï¼Œä¸€ä¸ªå­—ç¬¦å°±æ˜¯ä¸¤ä¸ªå­—èŠ‚ã€‚ä¸€ä¸ªæ±‰å­—ç®—ä¸¤ä¸ªè‹±æ–‡å­—ç¬¦çš„æ—¶ä»£å·²ç»å¿«è¿‡å»äº†ã€‚\nunicodeåŒæ ·ä¹Ÿä¸å®Œç¾ï¼Œè¿™é‡Œå°±æœ‰ä¸¤ä¸ªçš„é—®é¢˜ï¼Œä¸€ä¸ªæ˜¯ï¼Œå¦‚ä½•æ‰èƒ½åŒºåˆ«unicodeå’Œasciiï¼Ÿè®¡ç®—æœºæ€ä¹ˆçŸ¥é“ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œè€Œä¸æ˜¯åˆ†åˆ«è¡¨ç¤ºä¸‰ä¸ªç¬¦å·å‘¢ï¼Ÿç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œè‹±æ–‡å­—æ¯åªç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå°±å¤Ÿäº†ï¼Œå¦‚æœunicodeç»Ÿä¸€è§„å®šï¼Œæ¯ä¸ªç¬¦å·ç”¨ä¸‰ä¸ªæˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªè‹±æ–‡å­—æ¯å‰éƒ½å¿…ç„¶æœ‰äºŒåˆ°ä¸‰ä¸ªå­—èŠ‚æ˜¯0ï¼Œè¿™å¯¹äºå­˜å‚¨ç©ºé—´æ¥è¯´æ˜¯æå¤§çš„æµªè´¹ï¼Œæ–‡æœ¬æ–‡ä»¶çš„å¤§å°ä¼šå› æ­¤å¤§å‡ºäºŒä¸‰å€ï¼Œè¿™æ˜¯éš¾ä»¥æ¥å—çš„ã€‚\nunicodeåœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…æ— æ³•æ¨å¹¿ï¼Œç›´åˆ°äº’è”ç½‘çš„å‡ºç°ï¼Œä¸ºè§£å†³unicodeå¦‚ä½•åœ¨ç½‘ç»œä¸Šä¼ è¾“çš„é—®é¢˜ï¼Œäºæ˜¯é¢å‘ä¼ è¾“çš„ä¼—å¤š UTFï¼ˆUCS Transfer Formatï¼‰æ ‡å‡†å‡ºç°äº†ï¼Œé¡¾åæ€ä¹‰ï¼ŒUTF-8å°±æ˜¯æ¯æ¬¡8ä¸ªä½ä¼ è¾“æ•°æ®ï¼Œè€ŒUTF-16å°±æ˜¯æ¯æ¬¡16ä¸ªä½ã€‚UTF-8å°±æ˜¯åœ¨äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿çš„ä¸€ç§unicodeçš„å®ç°æ–¹å¼ï¼Œè¿™æ˜¯ä¸ºä¼ è¾“è€Œè®¾è®¡çš„ç¼–ç ï¼Œå¹¶ä½¿ç¼–ç æ— å›½ç•Œï¼Œè¿™æ ·å°±å¯ä»¥æ˜¾ç¤ºå…¨ä¸–ç•Œä¸Šæ‰€æœ‰æ–‡åŒ–çš„å­—ç¬¦äº†ã€‚\nUTF-8æœ€å¤§çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯å®ƒæ˜¯ä¸€ç§å˜é•¿çš„ç¼–ç æ–¹å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ï¼Œå½“å­—ç¬¦åœ¨ASCIIç çš„èŒƒå›´æ—¶ï¼Œå°±ç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä¿ç•™äº†ASCIIå­—ç¬¦ä¸€ä¸ªå­—èŠ‚çš„ç¼–ç åšä¸ºå®ƒçš„ä¸€éƒ¨åˆ†ï¼Œæ³¨æ„çš„æ˜¯unicodeä¸€ä¸ªä¸­æ–‡å­—ç¬¦å 2ä¸ªå­—èŠ‚ï¼Œè€ŒUTF-8ä¸€ä¸ªä¸­æ–‡å­—ç¬¦å 3ä¸ªå­—èŠ‚ï¼‰ã€‚ä»unicodeåˆ°uft-8å¹¶ä¸æ˜¯ç›´æ¥çš„å¯¹åº”ï¼Œè€Œæ˜¯è¦è¿‡ä¸€äº›ç®—æ³•å’Œè§„åˆ™æ¥è½¬æ¢ã€‚\n   Unicodeç¬¦å·èŒƒå›´ UTF-8ç¼–ç æ–¹å¼     (åå…­è¿›åˆ¶) ï¼ˆäºŒè¿›åˆ¶ï¼‰   0000 0000-0000 007F 0xxxxxxx   0000 0080-0000 07FF 110xxxxx 10xxxxxx   0000 0800-0000 FFFF 1110xxxx 10xxxxxx 10xxxxxx   0001 0000-0010 FFFF 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx    ä½œè€…ï¼šäºæ´‹\né“¾æ¥ï¼šhttps://www.zhihu.com/question/23374078/answer/69732605\næ¥æºï¼šçŸ¥ä¹\nè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n","id":103,"section":"posts","summary":"1. ASCIIç  æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨è®¡ç®—æœºå†…éƒ¨ï¼Œæ‰€æœ‰çš„ä¿¡æ¯æœ€ç»ˆéƒ½è¡¨ç¤ºä¸ºä¸€ä¸ªäºŒè¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆbitï¼‰æœ‰0å’Œ1ä¸¤ç§çŠ¶æ€ï¼Œå› æ­¤å…«ä¸ªäºŒè¿›åˆ¶ä½å°±","tags":["java"],"title":"[è½¬]å­—ç¬¦ç¼–ç ç¬”è®°ï¼šASCIIã€Unicodeã€UTF-8 å’Œ Base64","uri":"https://www.mingaccount.com/2018/03/char-encode/","year":"2018"},{"content":"å…³äºå¦‚ä½•æœ‰æ•ˆé¿å…ç©ºæŒ‡é’ˆï¼Œå¹¶å‡å°‘ç©ºæŒ‡é’ˆçš„é‡å¤ç”³æ˜ã€‚\nå‚è€ƒstackoverflowçš„è®¨è®º\n","id":104,"section":"posts","summary":"å…³äºå¦‚ä½•æœ‰æ•ˆé¿å…ç©ºæŒ‡é’ˆï¼Œå¹¶å‡å°‘ç©ºæŒ‡é’ˆçš„é‡å¤ç”³æ˜ã€‚ å‚è€ƒstackoverflowçš„è®¨è®º","tags":["java"],"title":"Javaåˆç†é¿å…ç©ºæŒ‡é’ˆ","uri":"https://www.mingaccount.com/2018/03/java-avoid-null-pointer/","year":"2018"},{"content":"ä¸€ã€éœ€è¦ä¸€ä¸ªç±»ç»§æ‰¿HttpServletRequestWrapperï¼Œè¯¥ç±»ç»§æ‰¿äº†ServletRequestWrapperå¹¶å®ç°äº†HttpServletRequestï¼Œ å› æ­¤å®ƒå¯ä½œä¸ºrequeståœ¨FilterChainä¸­ä¼ é€’ã€‚\nè¯¥ç±»éœ€è¦é‡å†™getReaderå’ŒgetInputStreamä¸¤ä¸ªæ–¹æ³•ï¼Œå¹¶åœ¨è¿”å›æ—¶å°†è¯»å‡ºçš„bodyæ•°æ®é‡æ–°å†™å…¥ã€‚\näºŒã€éœ€è¦ä¸€ä¸ªFilterç­›é€‰ç›®æ ‡urlPatternï¼Œè°ƒç”¨ç¬¬ä¸€ä¸ªç±»çš„åŒæ—¶ï¼Œå°†ç¬¬ä¸€ä¸ªç±»å†™å…¥FilterChainä¸­ä»£æ›¿åŸæœ¬çš„Request package com.bonc.util;\rimport javax.servlet.ReadListener;\rimport javax.servlet.ServletInputStream;\rimport javax.servlet.http.HttpServletRequest;\rimport javax.servlet.http.HttpServletRequestWrapper;\rimport java.io.*;\rpublic class BodyReaderRequestWrapper extends HttpServletRequestWrapper {\rprivate final String body;\r/**\r*\r* @param request\r*/\rpublic BodyReaderRequestWrapper(HttpServletRequest request) throws IOException{\rsuper(request);\rStringBuilder sb = new StringBuilder();\rInputStream ins = request.getInputStream();\rBufferedReader isr = null;\rtry{\rif(ins != null){\risr = new BufferedReader(new InputStreamReader(ins));\rchar[] charBuffer = new char[128];\rint readCount = 0;\rwhile((readCount = isr.read(charBuffer)) != -1){\rsb.append(charBuffer,0,readCount);\r}\r}else{\rsb.append(\u0026quot;\u0026quot;);\r}\r}catch (IOException e){\rthrow e;\r}finally {\rif(isr != null) {\risr.close();\r}\r}\rsb.toString();\rbody = sb.toString();\r}\r@Override\rpublic BufferedReader getReader() throws IOException {\rreturn new BufferedReader(new InputStreamReader(this.getInputStream()));\r}\r@Override\rpublic ServletInputStream getInputStream() throws IOException {\rfinal ByteArrayInputStream byteArrayIns = new ByteArrayInputStream(body.getBytes());\rServletInputStream servletIns = new ServletInputStream() {\r@Override\rpublic boolean isFinished() {\rreturn false;\r}\r@Override\rpublic boolean isReady() {\rreturn false;\r}\r@Override\rpublic void setReadListener(ReadListener readListener) {\r}\r@Override\rpublic int read() throws IOException {\rreturn byteArrayIns.read();\r}\r};\rreturn servletIns;\r}\r}\r package com.bonc.bitwd.filter;\rimport com.bonc.util.BodyReaderRequestWrapper;\rimport javax.servlet.*;\rimport javax.servlet.http.HttpServletRequest;\rimport javax.servlet.http.HttpServletResponse;\rimport java.io.IOException;\rpublic class BodyReaderRequestFilter implements Filter{\r@Override\rpublic void init(FilterConfig filterConfig) throws ServletException {\r}\r@Override\rpublic void doFilter(ServletRequest req, ServletResponse res, FilterChain filterChain) throws IOException, ServletException {\rHttpServletRequest request = (HttpServletRequest)req;\rHttpServletResponse response = (HttpServletResponse)res;\rBodyReaderRequestWrapper requestWrapper = new BodyReaderRequestWrapper(request);\rif(requestWrapper == null){\rfilterChain.doFilter(request,response);\r}else {\rfilterChain.doFilter(requestWrapper,response);\r}\r}\r@Override\rpublic void destroy() {\r}\r}\r ","id":105,"section":"posts","summary":"ä¸€ã€éœ€è¦ä¸€ä¸ªç±»ç»§æ‰¿HttpServletRequestWrapperï¼Œè¯¥ç±»ç»§æ‰¿äº†ServletRequestWrapperå¹¶å®ç°äº†HttpS","tags":["java"],"title":"Requestçš„Bodyåªèƒ½è¯»å–ä¸€æ¬¡è§£å†³æ–¹æ³•","uri":"https://www.mingaccount.com/2018/03/request-body-read-twice/","year":"2018"},{"content":"# ä¸€èˆ¬å£°æ˜\rdef printUser(id,name,sex,age,email,phone,group):\rprintUser(1,'ming','male',18,'',110,'default')\r # é»˜è®¤å€¼\rdef printUser(id,name,sex,age,email='',phone=110,group='default'):\rprintUser(1,'ming','male',18)\r # ä½ç½®å‚æ•°å’Œå…³é”®å­—å‚æ•°\rdef printUser(id,name,sex,/,age,email,*,phone,group):\r# ä½ç½®å‚æ•°å°±æ˜¯è°ƒç”¨çš„æ—¶å€™ç›´æ¥èµ‹å€¼\r# å…³é”®å­—å‚æ•°å°±æ˜¯è°ƒç”¨çš„æ—¶å€™é€šè¿‡ key=value çš„å½¢å¼èµ‹å€¼\r# æ–œæ ä¹‹å‰çš„åªèƒ½æœ‰ä½ç½®å‚æ•°ï¼Œæ–œæ†ä¹‹åå’Œ*å·ä¹‹å‰çš„ï¼Œå¯ä»¥æœ‰å…³é”®å­—å‚æ•°æˆ–è€…ä½ç½®å‚æ•°ï¼Œ*å·ä¹‹åçš„åªèƒ½å…³é”®å­—å‚æ•°\rprintUser(1,'ming','male',18, email='@mail', phone=110, group='default')\r# å…³é”®å­—å‚æ•°å¿…é¡»åœ¨ä½ç½®å‚æ•°ä¹‹åï¼Œå¹¶ä¸”ä½ç½®å‚æ•°å¿…é¡»éµå¾ªæ–¹æ³•å£°æ˜çš„é¡ºåºï¼Œä½†æ˜¯å…³é”®å­—å‚æ•°å¯ä»¥ä»»æ„å˜æ¢é¡ºåº\rprintUser(1,'ming','male',18, group='default', email='@mail', phone=110)\r # å…ƒç»„\rdef printUser(id, name, sex, *args):\rprintUser(1,'ming','male', 18, '@mail', 110, 'default')\r # å¤šä¸ªå…³é”®å­—å‚æ•°\rdef printUser(id, name, sex, **kwargs):\rprintUser(1,'ming','male', age=18, email='@mail', phone=110, group='defalut')\r æ³¨æ„*argså’Œ**kwargså¯ä»¥åœ¨ä¸€èµ·ä½¿ç”¨ï¼Œä½†æ˜¯*argså¿…é¡»åœ¨**kwargså‰é¢ã€‚\n# æ³¨è§£\r# è¡¨ç¤ºå‚æ•°ç±»å‹å’Œæ–¹æ³•è¿”å›ç±»å‹\rdef printUser(id,name,sex, age, email:str='@email', group:str='default') -\u0026gt; str:\r ","id":106,"section":"posts","summary":"# ä¸€èˆ¬å£°æ˜ def printUser(id,name,sex,age,email,phone,group): printUser(1,'ming','male',18,'',110,'default') # é»˜è®¤å€¼ def printUser(id,name,sex,age,email='',phone=110,group='default'): printUser(1,'ming','male',18) # ä½ç½®å‚æ•°å’Œå…³é”®å­—å‚æ•° def printUser(id,name,sex,/,age,email,*,phone,group): # ä½ç½®å‚æ•°å°±æ˜¯è°ƒç”¨çš„æ—¶å€™ç›´æ¥èµ‹å€¼ # å…³é”®å­—å‚æ•°å°±æ˜¯è°ƒç”¨çš„æ—¶å€™é€šè¿‡ key=value çš„å½¢å¼èµ‹å€¼ # æ–œæ ä¹‹å‰","tags":["python"],"title":"Pythonæ–¹æ³•å®šä¹‰","uri":"https://www.mingaccount.com/2018/01/python-method-define/","year":"2018"},{"content":"å…¨å±€filter @Component\r@Order(1)\rpublic class FirstFilter extends Filter {\r@Override\rpublic void doFilter(\rServletRequest request,\rServletResponse response,\rFilterChain chain) throws IOException, ServletException {\r...\rchain.doFilter(request, response);\r}\r}\r å…¨å±€è¿‡æ»¤ç›´æ¥å®ç°Filterå³å¯ï¼Œå¦‚éœ€è®¾å®šé¡ºåºï¼Œä½¿ç”¨@Orderæ³¨è§£\nURL Pattern Filter è¿‡æ»¤æŒ‡å®šçš„URLï¼Œéœ€è¦é€šè¿‡æ³¨å†ŒBeançš„å½¢å¼ï¼š\n@Configuration\rpublic class FilterBeanConfiguration{\r@Bean\rpublic FilterRegistrationBean\u0026lt;SecondFilter\u0026gt; secondFilter(){\rFilterRegistrationBean\u0026lt;SecondFilter\u0026gt; registrationBean\r= new FilterRegistrationBean\u0026lt;\u0026gt;();\rregistrationBean.setFilter(new SecondFilter());\rregistrationBean.addUrlPatterns(\u0026quot;/users/*\u0026quot;);\rreturn registrationBean;\r}\r}\r @Order(2)\rpublic class SecondFilter extends Filter {\r@Override\rpublic void doFilter(\rServletRequest request,\rServletResponse response,\rFilterChain chain) throws IOException, ServletException {\r...\rchain.doFilter(request, response);\r}\r}\r æ³¨æ„é€šè¿‡FilterRegistrationBeanæ³¨å†Œçš„filterï¼Œä¸èƒ½è¢«@Componentä¿®é¥°\n","id":107,"section":"posts","summary":"å…¨å±€filter @Component @Order(1) public class FirstFilter extends Filter { @Override public void doFilter( ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { ... chain.doFilter(request, response); } } å…¨å±€è¿‡æ»¤ç›´æ¥å®ç°Filterå³å¯ï¼Œå¦‚éœ€è®¾å®šé¡ºåºï¼Œä½¿ç”¨@Orderæ³¨è§£ URL","tags":["spring"],"title":"Spring boot filter","uri":"https://www.mingaccount.com/2018/01/spring-boot-filter/","year":"2018"},{"content":" äº¤äºSpringç®¡ç†çš„ç±»ï¼Œé€šè¿‡æ³¨è§£è°ƒç”¨  @Component\rpublic class Test{\r@Autowired\rprivate HttpServletRequest httpServletRequest;\r}\r é€šè¿‡é™æ€æ–¹æ³•è°ƒç”¨  HttpServletRequest httpServletRequest = ((ServletRequestAttributes)RequestContextHolder.getRequestAttributes()).getRequest();\r ","id":108,"section":"posts","summary":"äº¤äºSpringç®¡ç†çš„ç±»ï¼Œé€šè¿‡æ³¨è§£è°ƒç”¨ @Component public class Test{ @Autowired private HttpServletRequest httpServletRequest; } é€šè¿‡é™æ€æ–¹æ³•è°ƒç”¨ HttpServletRequest httpServletRequest = ((ServletRequestAttributes)RequestContextHolder.getRequestAttributes()).getRequest();","tags":["java"],"title":"å…¨å±€è·å–request","uri":"https://www.mingaccount.com/2018/01/get-request-global/","year":"2018"},{"content":"Description Below I present you two different ways to get the current Class:\n Using Thread Using getClass()  The simplest way to get the name of the class where your code is being executed in is using the getClass() method present in every java object. Like here:\nString clazz = this.getClass().getName();\r This works only if executed in an Object, namely an instanciated class. If you try to execute the code above in a static method. It won\u0026rsquo;t work. Even the keyword this is meaningless in a static method.\nAlso, the class returned by the above method may actually be a subclass of the class in which the method is defined. This is because subclasses inherit the methods of their parents; and getClass() returns the actual runtime type of the object. To get the actual class in which a method is defined, use the method below also.\nIn a static method you can instead use the following:\nString clazz = Thread.currentThread().getStackTrace()[1].getClassName();\r Which uses the static methodgetStackTrace() to get the whole stacktrace. This method returns an array, where the first element (index 0) is the getStackTrace() you called and the second element (index 1) is the method your code is in.\nA similar trick can be used to find out the name of the method currently executed:\nString method = Thread.currentThread().getStackTrace()[1].getMethodName();\r It\u0026rsquo;s exactly the same principle, just you dig out the name of the method instead of the class.\nThe code package org.wikijava.reflection; public class MethodName { public static void main(String[] args) { MethodName methodName = new MethodName(); String clazz = Thread.currentThread() .getStackTrace() [1].getClassName();\rString method = Thread.currentThread() .getStackTrace()[1].getMethodName();\rSystem.out.println(\u0026quot;class name: \u0026quot; + clazz + \u0026quot; Method Name \u0026quot; + method); methodName.anotherMethod(); } private void anotherMethod() { String clazz = this.getClass().getName(); String method = Thread.currentThread() .getStackTrace()[1].getMethodName(); System.out.println(\u0026quot;class name: \u0026quot; + clazz + \u0026quot; Method Name \u0026quot; + method); } }  ","id":109,"section":"posts","summary":"Description Below I present you two different ways to get the current Class: Using Thread Using getClass() The simplest way to get the name of the class where your code is being executed in is using the getClass() method present in every java object. Like here: String clazz = this.getClass().getName(); This works only if executed in an Object, namely an instanciated class. If you try to execute the code above","tags":["java"],"title":"Javaè·å–å½“å‰ç±»åå’Œæ–¹æ³•å","uri":"https://www.mingaccount.com/2018/01/java-fetch-current-classname-methodname/","year":"2018"},{"content":" æ‰€è°“è§‚å¯Ÿè€…æ¨¡å¼ï¼ŒæŒ‡çš„æŸä¸ªçŠ¶æ€ä¿¡æ¯çš„æ”¹å˜ï¼Œä¼šå½±å“å…¶ä»–ä¸€ç³»åˆ—çš„æ“ä½œï¼Œè¿™æ—¶å°±å¯ä»¥å°†è¿™äº›æ“ä½œæŠ½è±¡åŒ–ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªç±»ç»Ÿä¸€çš„ç®¡ç†å’Œæ‰§è¡Œè¿™äº›æ“ä½œã€‚æŠŠè¿™äº›æŠ½è±¡å‡ºæ¥çš„æ“ä½œç§°ä¸ºè§‚å¯Ÿè€…ç±»ï¼Œè€Œç®¡ç†è¿™äº›æ“ä½œçš„ç±»ç§°ä¸ºé€šçŸ¥è€…ç±»ï¼Œé€šçŸ¥è€…ç±»ç»´æŠ¤ç€ä¸€ä¸ªè§‚å¯Ÿè€…ç±»çš„é›†åˆï¼Œå¯ä»¥è¿½åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…ï¼ŒåŒæ—¶å¯éå†é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…ç±»æ‰§è¡Œæ“ä½œã€‚    è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸è¶³ï¼šè™½ç„¶è§‚å¯Ÿè€…æ¨¡å¼æå–å‡ºäº†æŠ½è±¡ç±»ï¼Œè®©ç±»ä¸ç±»ä¹‹é—´ä¸äº’ç›¸ä¾èµ–ï¼Œå…±åŒä¾èµ–äºæŠ½è±¡æ¥å£ï¼Œè¿™ç¬¦åˆä¾èµ–å€’è½¬åŸåˆ™ï¼Œä½†ä»–ä»¬ä»ç„¶ä¾èµ–ç€æŠ½è±¡æ¥å£ï¼Œè€Œä¸”æœ‰äº›æ—¶å€™ä¸èƒ½æå–å‡ºæŠ½è±¡çš„è§‚å¯Ÿè€…ï¼ˆæ¯”å¦‚å¼•ç”¨jaråŒ…ï¼‰ã€‚ javaå§”æ‰˜æœºåˆ¶ä¸è§‚å¯Ÿè€…æ¨¡å¼ï¼šå§”æ‰˜æœºåˆ¶çš„å®ç°ä¸å†éœ€è¦æå–è§‚å¯Ÿè€…æŠ½è±¡ç±»ï¼Œè§‚å¯Ÿè€…å’Œé€šçŸ¥è€…äº’ä¸ä¾èµ–ã€‚javaåˆ©ç”¨åå°„å³å¯å®ç°ï¼Œä»£ç å®ä¾‹å¦‚ä¸‹:  äº‹ä»¶ç±»\npackage com.suski.delegate;\rimport java.lang.reflect.Method;\rpublic class Event {\rprivate Object object;\rprivate String methodName;\rprivate Object[] params;\rprivate Class[] paramTypes;\rpublic Event(Object object,String method,Object...args)\r{\rthis.object = object;\rthis.methodName = method;\rthis.params = args;\rcontractParamTypes(this.params);\r}\rprivate void contractParamTypes(Object[] params)\r{\rthis.paramTypes = new Class[params.length];\rfor (int i=0;i\u0026lt;params.length;i++)\r{\rthis.paramTypes[i] = params[i].getClass();\r}\r}\rpublic void invoke() throws Exception\r{\rMethod method = object.getClass().getMethod(this.methodName, this.paramTypes);//åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¿™ä¸ªå‡½æ•°\rif (null == method)\r{\rreturn;\r}\rmethod.invoke(this.object, this.params);//åˆ©ç”¨åå°„æœºåˆ¶è°ƒç”¨å‡½æ•°\r}\r}\r äº‹ä»¶ç®¡ç†ç±»\npackage com.suski.delegate;\rimport java.util.ArrayList;\rimport java.util.List;\rpublic class EventHandler {\rprivate List\u0026lt;Event\u0026gt; objects;\rpublic EventHandler()\r{\robjects = new ArrayList\u0026lt;Event\u0026gt;();\r}\rpublic void addEvent(Object object, String methodName, Object...args)\r{\robjects.add(new Event(object, methodName, args));\r}\rpublic void notifyX() throws Exception\r{\rfor (Event event : objects)\r{\revent.invoke();\r}\r}\r}\r é€šçŸ¥è€…æŠ½è±¡ç±»\npackage com.suski.delegate;\rpublic abstract class Notifier {\rprivate EventHandler eventHandler = new EventHandler();\rpublic EventHandler getEventHandler()\r{\rreturn eventHandler;\r}\rpublic void setEventHandler(EventHandler eventHandler)\r{\rthis.eventHandler = eventHandler;\r}\rpublic abstract void addListener(Object object,String methodName, Object...args);\rpublic abstract void notifyX();\r}\r é€šçŸ¥è€…å…·ä½“å®ç°ç±»\npackage com.suski.delegate;\rpublic class ConcreteNotifier extends Notifier{\r@Override\rpublic void addListener(Object object, String methodName, Object... args) {\rthis.getEventHandler().addEvent(object, methodName, args);\r}\r@Override\rpublic void notifyX() {\rtry {\rthis.getEventHandler().notifyX();\r} catch (Exception e) {\r// TODO: handle exception\re.printStackTrace();\r}\r}\r}\r å…·ä½“çš„è§‚å¯Ÿè€…ç±»ï¼Œä¸å†éœ€è¦æŠ½è±¡è§‚å¯Ÿè€…\npackage com.suski.delegate;\rimport java.util.Date;\rpublic class WatchingTVListener {\rpublic WatchingTVListener()\r{\rSystem.out.println(\u0026quot;watching TV\u0026quot;);\r}\rpublic void stopWatchingTV(Date date) {\rSystem.out.println(\u0026quot;stop watching\u0026quot; + date);\r}\r}\r package com.suski.delegate;\rimport java.util.Date;\rpublic class PlayingGameListener {\rpublic PlayingGameListener()\r{\rSystem.out.println(\u0026quot;playing\u0026quot;);\r}\rpublic void stopPlayingGame(Date date)\r{\rSystem.out.println(\u0026quot;stop playing\u0026quot; + date);\r}\r}\r æµ‹è¯•æ–¹æ³•\npackage com.suski.delegate;\rimport java.util.Date;\rpublic class Test {\rpublic static void main (String[] args)\r{\rNotifier goodNotifier = new ConcreteNotifier();\rPlayingGameListener playingGameListener = new PlayingGameListener();\rWatchingTVListener watchingTVListener = new WatchingTVListener();\rgoodNotifier.addListener(playingGameListener, \u0026quot;stopPlayingGame\u0026quot;, new Date());\rgoodNotifier.addListener(watchingTVListener, \u0026quot;stopWatchingTV\u0026quot;, new Date());\rgoodNotifier.notifyX();\r}\r}\r ","id":110,"section":"posts","summary":"æ‰€è°“è§‚å¯Ÿè€…æ¨¡å¼ï¼ŒæŒ‡çš„æŸä¸ªçŠ¶æ€ä¿¡æ¯çš„æ”¹å˜ï¼Œä¼šå½±å“å…¶ä»–ä¸€ç³»åˆ—çš„æ“ä½œï¼Œè¿™æ—¶å°±å¯ä»¥å°†è¿™äº›æ“ä½œæŠ½è±¡åŒ–ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªç±»ç»Ÿä¸€çš„ç®¡ç†å’Œæ‰§è¡Œè¿™äº›æ“ä½œã€‚æŠŠè¿™äº›æŠ½","tags":["design pattern"],"title":"è§‚å¯Ÿè€…æ¨¡å¼å’Œjavaå§”æ‰˜","uri":"https://www.mingaccount.com/2018/01/observe-patter-and-java-agent/","year":"2018"},{"content":"è½¬è‡ª:http://blog.csdn.net/kaiwii/article/details/7405761\nä¸»è¦åŠŸèƒ½\nClass.forName(xxx.xx.xx)è¿”å›çš„æ˜¯ä¸€ä¸ªç±»\nClass.forName(xxx.xx.xx)çš„ä½œç”¨æ˜¯è¦æ±‚JVMæŸ¥æ‰¾å¹¶åŠ è½½æŒ‡å®šçš„ç±»ï¼Œ\nä¹Ÿå°±æ˜¯è¯´JVMä¼šæ‰§è¡Œè¯¥ç±»çš„é™æ€ä»£ç æ®µ\nä¸‹é¢ï¼Œé€šè¿‡è§£ç­”ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜çš„æ¥è¯¦ç»†è®²è§£ä¸‹Class.forName()çš„ç”¨æ³•ã€‚\nä¸€.ä»€ä¹ˆæ—¶å€™ç”¨Class.forName()ï¼Ÿ å…ˆæ¥ä¸ªçƒ­èº«ï¼Œç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªç±»çš„åŒ…åå’Œç±»åï¼Œä½ æ€ä¹ˆå®ä¾‹åŒ–å®ƒï¼Ÿä½ ç¬¬ä¸€æƒ³åˆ°çš„è‚¯å®šæ˜¯new,ä½†æ˜¯æ³¨æ„ä¸€ç‚¹ï¼š\nA a = (A)Class.forName(â€œpacage.Aâ€).newInstance();\r è¿™å’Œä½  A a = new A()ï¼› æ˜¯ä¸€æ ·çš„æ•ˆæœã€‚\nç°åœ¨è¨€å½’æ­£ä¼ ã€‚\nåŠ¨æ€åŠ è½½å’Œåˆ›å»ºClass å¯¹è±¡ï¼Œæ¯”å¦‚æƒ³æ ¹æ®ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²æ¥åˆ›å»ºå¯¹è±¡æ—¶éœ€è¦ç”¨åˆ°ï¼š\nString str = â€œç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²â€ ;\rClass t = Class.forName(str);\rt.newInstance();\r åœ¨åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œç”Ÿæˆä¸€ä¸ªå®ä¾‹çš„æ—¶å€™ï¼ŒnewInstance()æ–¹æ³•å’Œnewå…³é”®å­—é™¤äº†ä¸€ä¸ªæ˜¯æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯å…³é”®å­—å¤–ï¼Œæœ€ä¸»è¦æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå®ƒä»¬çš„åŒºåˆ«åœ¨äºåˆ›å»ºå¯¹è±¡çš„æ–¹å¼ä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ä½¿ç”¨ç±»åŠ è½½æœºåˆ¶ï¼Œåè€…æ˜¯åˆ›å»ºä¸€ä¸ªæ–°ç±»ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ç§åˆ›å»ºå¯¹è±¡æ–¹å¼ï¼Ÿè¿™ä¸»è¦è€ƒè™‘åˆ°è½¯ä»¶çš„å¯ä¼¸ç¼©ã€å¯æ‰©å±•å’Œå¯é‡ç”¨ç­‰è½¯ä»¶è®¾è®¡æ€æƒ³ã€‚\nJavaä¸­å·¥å‚æ¨¡å¼ç»å¸¸ä½¿ç”¨newInstance()æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ï¼Œå› æ­¤ä»ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å·¥å‚æ¨¡å¼ä¸Šå¯ä»¥æ‰¾åˆ°å…·ä½“ç­”æ¡ˆã€‚ ä¾‹å¦‚ï¼š\nclass c = Class.forName(â€œExampleâ€);\rfactory = (ExampleInterface)c.newInstance();\r å…¶ä¸­ExampleInterfaceæ˜¯Exampleçš„æ¥å£ï¼Œå¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š\nString className = â€œExampleâ€;\rclass c = Class.forName(className);\rfactory = (ExampleInterface)c.newInstance();\r è¿›ä¸€æ­¥å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š\nString className = readfromXMlConfig;//ä»xml é…ç½®æ–‡ä»¶ä¸­è·å¾—å­—ç¬¦ä¸²\rclass c = Class.forName(className);\rfactory = (ExampleInterface)c.newInstance();\r ä¸Šé¢ä»£ç å·²ç»ä¸å­˜åœ¨Exampleçš„ç±»åç§°ï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯ï¼Œæ— è®ºExampleç±»æ€ä¹ˆå˜åŒ–ï¼Œä¸Šè¿°ä»£ç ä¸å˜ï¼Œç”šè‡³å¯ä»¥æ›´æ¢Exampleçš„å…„å¼Ÿç±»Example2 , Example3 , Example4â€¦â€¦ï¼Œåªè¦ä»–ä»¬ç»§æ‰¿ExampleInterfaceå°±å¯ä»¥ã€‚\nä»JVMçš„è§’åº¦çœ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å…³é”®å­—newåˆ›å»ºä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œè¿™ä¸ªç±»å¯ä»¥æ²¡æœ‰è¢«åŠ è½½ã€‚ä½†æ˜¯ä½¿ç”¨newInstance()æ–¹æ³•çš„æ—¶å€™ï¼Œå°±å¿…é¡»ä¿è¯ï¼š\n1ã€è¿™ä¸ªç±»å·²ç»åŠ è½½ï¼›\n2ã€è¿™ä¸ªç±»å·²ç»è¿æ¥äº†ã€‚\nè€Œå®Œæˆä¸Šé¢ä¸¤ä¸ªæ­¥éª¤çš„æ­£æ˜¯Classçš„é™æ€æ–¹æ³•forName()æ‰€å®Œæˆçš„ï¼Œè¿™ä¸ªé™æ€æ–¹æ³•è°ƒç”¨äº†å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œå³åŠ è½½ java APIçš„é‚£ä¸ªåŠ è½½å™¨ã€‚\nç°åœ¨å¯ä»¥çœ‹å‡ºï¼ŒnewInstance()å®é™…ä¸Šæ˜¯æŠŠnewè¿™ä¸ªæ–¹å¼åˆ†è§£ä¸ºä¸¤æ­¥ï¼Œå³é¦–å…ˆè°ƒç”¨ClassåŠ è½½æ–¹æ³•åŠ è½½æŸä¸ªç±»ï¼Œç„¶åå®ä¾‹åŒ–ã€‚ è¿™æ ·åˆ†æ­¥çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨classçš„é™æ€åŠ è½½æ–¹æ³•forNameæ—¶è·å¾—æ›´å¥½çš„çµæ´»æ€§ï¼Œæä¾›ç»™äº†ä¸€ç§é™è€¦çš„æ‰‹æ®µã€‚\näºŒ.new å’ŒClass.forNameï¼ˆï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å…¶å®ä¸Šé¢å·²ç»è¯´åˆ°ä¸€äº›äº†ï¼Œè¿™é‡Œæ¥åšä¸ªæ€»ç»“ï¼š\né¦–å…ˆï¼ŒnewInstance( )æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œè€Œnewæ˜¯ä¸€ä¸ªå…³é”®å­—ï¼›\nå…¶æ¬¡ï¼ŒClassä¸‹çš„newInstance()çš„ä½¿ç”¨æœ‰å±€é™ï¼Œå› ä¸ºå®ƒç”Ÿæˆå¯¹è±¡åªèƒ½è°ƒç”¨æ— å‚çš„æ„é€ å‡½æ•°ï¼Œè€Œä½¿ç”¨ newå…³é”®å­—ç”Ÿæˆå¯¹è±¡æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚ ç®€è¨€ä¹‹ï¼š\n newInstance(): å¼±ç±»å‹,ä½æ•ˆç‡,åªèƒ½è°ƒç”¨æ— å‚æ„é€ ã€‚ new: å¼ºç±»å‹,ç›¸å¯¹é«˜æ•ˆ,èƒ½è°ƒç”¨ä»»ä½•publicæ„é€ ã€‚ Class.forName(â€œâ€)è¿”å›çš„æ˜¯ç±»ã€‚ Class.forName(â€œâ€).newInstance()è¿”å›çš„æ˜¯object ã€‚  ä¸‰.ä¸ºä»€ä¹ˆåœ¨åŠ è½½æ•°æ®åº“é©±åŠ¨åŒ…çš„æ—¶å€™æœ‰ç”¨çš„æ˜¯Class.forName( )ï¼Œå´æ²¡æœ‰è°ƒç”¨newInstance( )ï¼Ÿ åœ¨Javaå¼€å‘ç‰¹åˆ«æ˜¯æ•°æ®åº“å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šç”¨åˆ°Class.forName( )è¿™ä¸ªæ–¹æ³•ã€‚\né€šè¿‡æŸ¥è¯¢Java Documentationæˆ‘ä»¬ä¼šå‘ç°ä½¿ç”¨Class.forName( )é™æ€æ–¹æ³•çš„ç›®çš„æ˜¯ä¸ºäº†åŠ¨æ€åŠ è½½ç±»ã€‚\né€šå¸¸ç¼–ç è¿‡ç¨‹ä¸­ï¼Œåœ¨åŠ è½½å®Œæˆåï¼Œä¸€èˆ¬è¿˜è¦è°ƒç”¨Classä¸‹çš„newInstance( )é™æ€æ–¹æ³•æ¥å®ä¾‹åŒ–å¯¹è±¡ä»¥ä¾¿æ“ä½œã€‚å› æ­¤ï¼Œå•å•ä½¿ç”¨Class.forName( )æ˜¯åŠ¨æ€åŠ è½½ç±»æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå…¶æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†å®ä¾‹åŒ–å¯¹è±¡ã€‚\næœ‰æ•°æ®åº“å¼€å‘ç»éªŒæœ‹å‹ä¼šå‘ç°ï¼Œä¸ºä»€ä¹ˆåœ¨æˆ‘ä»¬åŠ è½½æ•°æ®åº“é©±åŠ¨åŒ…çš„æ—¶å€™æœ‰çš„å´æ²¡æœ‰è°ƒç”¨newInstance( )æ–¹æ³•å‘¢ï¼Ÿ\nå³æœ‰çš„jdbcè¿æ¥æ•°æ®åº“çš„å†™æ³•é‡Œæ˜¯Class.forName(xxx.xx.xx);è€Œæœ‰ä¸€ äº›ï¼šClass.forName(xxx.xx.xx).newInstance()ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸¤ç§å†™æ³•å‘¢ï¼Ÿ\nåˆšæ‰æåˆ°ï¼ŒClass.forName(â€œâ€);çš„ä½œç”¨æ˜¯è¦æ±‚JVMæŸ¥æ‰¾å¹¶åŠ è½½æŒ‡å®šçš„ç±»ï¼Œé¦–å…ˆè¦æ˜ç™½ï¼Œjavaé‡Œé¢ä»»ä½•classéƒ½è¦è£…è½½åœ¨è™šæ‹Ÿæœºä¸Šæ‰èƒ½è¿è¡Œï¼Œè€Œé™æ€ä»£ç æ˜¯å’Œclassç»‘å®šçš„ï¼Œclassè£…è½½æˆåŠŸå°±è¡¨ç¤ºæ‰§è¡Œäº†ä½ çš„é™æ€ä»£ç äº†ï¼Œè€Œä¸”ä»¥åä¸ä¼šå†èµ°è¿™æ®µé™æ€ä»£ç äº†ã€‚\nè€Œæˆ‘ä»¬å‰é¢ä¹Ÿè¯´äº†ï¼ŒClass.forName(xxx.xx.xx)çš„ä½œç”¨å°±æ˜¯è¦æ±‚JVMæŸ¥æ‰¾å¹¶åŠ è½½æŒ‡å®šçš„ç±»ï¼Œå¦‚æœåœ¨ç±»ä¸­æœ‰é™æ€åˆå§‹åŒ–å™¨çš„è¯ï¼ŒJVMå¿…ç„¶ä¼šæ‰§è¡Œè¯¥ç±»çš„é™æ€ä»£ç æ®µã€‚\nè€Œåœ¨JDBCè§„èŒƒä¸­æ˜ç¡®è¦æ±‚è¿™ä¸ªDriverç±»å¿…é¡»å‘DriverManageræ³¨å†Œè‡ªå·±ï¼Œå³ä»»ä½•ä¸€ä¸ªJDBC Driverçš„ Driverç±»çš„ä»£ç éƒ½å¿…é¡»ç±»ä¼¼å¦‚ä¸‹ï¼š\npublic class MyJDBCDriver implements Driver {\rstatic {\rDriverManager.registerDriver(new MyJDBCDriver());\r}\r}  æ—¢ç„¶åœ¨é™æ€åˆå§‹åŒ–å™¨çš„ä¸­å·²ç»è¿›è¡Œäº†æ³¨å†Œï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨JDBCæ—¶åªéœ€è¦Class.forName(XXX.XXX);å°±å¯ä»¥äº†ã€‚\nç›¸å…³è‹±æ–‡å‚è€ƒæ–‡çŒ®å¦‚ä¸‹ï¼š\nwe just want to load the driver to jvm only, but not need to user the instance of driver,\nso call Class.forName(xxx.xx.xx) is enough, if you call Class.forName(xxx.xx.xx).newInstance(),\nthe result will same as calling Class.forName(xxx.xx.xx),\nbecause Class.forName(xxx.xx.xx).newInstance() will load driver first,\nand then create instance, but the instacne you will never use in usual,\nso you need not to create it.\n","id":111,"section":"posts","summary":"è½¬è‡ª:http://blog.csdn.net/kaiwii/article/details/7405761 ä¸»è¦åŠŸèƒ½ Class.forNam","tags":["java"],"title":"[è½¬]Class.forName()ç”¨æ³•è¯¦è§£","uri":"https://www.mingaccount.com/2017/11/class-forname/","year":"2017"},{"content":"åŸå› æ˜¯å› ä¸ºlistæ˜¯ç”±Arrays.asListç”Ÿæˆçš„ æ ¹æ®Arraysæºç ï¼ŒasListæ–¹æ³•ç”Ÿæˆçš„ArrayListï¼Œå¹¶ä¸æ˜¯java.util.ArrayListï¼Œè€Œæ˜¯Arraysçš„ä¸€ä¸ªå†…éƒ¨ç±»\npublic static \u0026lt;T\u0026gt; List\u0026lt;T\u0026gt; asList(T... a) {\rreturn new ArrayList\u0026lt;\u0026gt;(a);\r}\r è¯¥å†…éƒ¨ç±»ç›´æ¥ç»§æ‰¿äº†AbstractListï¼Œå¹¶ä¸”å¹¶æœªå®ç°addAllæ–¹æ³•\nprivate static class ArrayList\u0026lt;E\u0026gt; extends AbstractList\u0026lt;E\u0026gt;\rimplements RandomAccess, java.io.Serializable\r ç„¶è€Œé»˜è®¤çš„AbstractListçš„addAllæ–¹æ³•ç›´æ¥æŠ›å‡ºäº†å¼‚å¸¸ï¼Œå¹¶æœªæœ‰ä»»ä½•å®ç°\npublic boolean addAll(Collection\u0026lt;? extends E\u0026gt; c) {\rboolean modified = false;\rfor (E e : c)\rif (add(e))\rmodified = true;\rreturn modified;\r}\rpublic boolean add(E e) {\rthrow new UnsupportedOperationException();\r}\r ","id":112,"section":"posts","summary":"åŸå› æ˜¯å› ä¸ºlistæ˜¯ç”±Arrays.asListç”Ÿæˆçš„ æ ¹æ®Arraysæºç ï¼ŒasListæ–¹æ³•ç”Ÿæˆçš„ArrayListï¼Œå¹¶ä¸æ˜¯java.uti","tags":["java"],"title":"List addAlläº§ç”Ÿå¼‚å¸¸java.lang.UnsupportedOperationException","uri":"https://www.mingaccount.com/2017/11/list-addall-exception/","year":"2017"},{"content":"é€šè¿‡ä»¥ä¸‹å‘½ä»¤ï¼Œå³å¯åˆ›å»ºé¡¹ç›®æè¿°ç½‘é¡µ\nmvn site\r è·Ÿç½‘é¡µå±•ç¤ºèµ„æºç›¸å…³çš„ç›®å½•\n+- src/\r+- site/\r+- apt/\r| +- index.apt\r!\r+- markdown/\r| +- content.md\r|\r+- fml/\r| +- general.fml\r| +- faq.fml\r|\r+- xdoc/\r| +- other.xml\r|\r+- site.xml\r site.xmlæ˜¯æè¿°æ–‡ä»¶ï¼Œå¯ä»¥æŒ‡å®šç½‘é¡µçš„èœå•ï¼Œé“¾æ¥ï¼Œå’Œå›¾ç‰‡ç­‰ã€‚\nsrc/siteä¸‹é¢çš„æ¯ä¸ªç›®å½•å¯¹åº”ä¸€ä¸ªæ ‡è®°è¯­è¨€ï¼Œå¯ä»¥é€‰æ‹©ç†Ÿæ‚‰çš„æ ‡è®°è¯­è¨€ç›®å½•æ¥ç”Ÿæˆæè¿°ä¿¡æ¯ï¼Œä½†æ˜¯indexæ–‡ä»¶åœ¨æ‰€æœ‰ç›®å½•ä¸‹åªèƒ½æœ‰ä¸€ä¸ªã€‚\n è¯¦æƒ…å‚è€ƒmvn site\n ","id":113,"section":"posts","summary":"é€šè¿‡ä»¥ä¸‹å‘½ä»¤ï¼Œå³å¯åˆ›å»ºé¡¹ç›®æè¿°ç½‘é¡µ mvn site è·Ÿç½‘é¡µå±•ç¤ºèµ„æºç›¸å…³çš„ç›®å½• +- src/ +- site/ +- apt/ | +- index.apt ! +- markdown/ | +- content.md | +- fml/ | +- general.fml | +- faq.fml | +- xdoc/ | +- other.xml | +- site.xml site.x","tags":["maven"],"title":"Mavenæ„å»ºé¡¹ç›®æè¿°ç½‘é¡µ","uri":"https://www.mingaccount.com/2017/11/maven-site/","year":"2017"},{"content":"èƒŒæ™¯ å¦‚æœé…ç½®beançš„æ—¶å€™å‡ºç°nullå€¼ï¼Œå¹¶ä¸”è¢«å…¶ä»–beanæ‰€å¼•ç”¨ã€‚é‚£ä¹ˆå¯åŠ¨çš„æ—¶å€™å°±æœ‰å¯èƒ½å‡ºç°å¤±è´¥çš„æƒ…å†µã€‚\n@Configuration\rpublic class BeanConfiguration{\r@Bean\rpublic Other getOther() {\rreturn null\r}\r}\r å› ä¸ºé…ç½®çš„beanä¸ºnullï¼ŒSpringä¼šç›´æ¥å¿½ç•¥è¿™ä¸ªbeanï¼š\nUser-defined bean method '***' in '***' ignored as the bean value is null\r è§£å†³æ–¹æ¡ˆ å¦‚æœä¸€ä¸ªbeanæ˜¯å¯èƒ½ä¸ºnullçš„ï¼Œé‚£ä¹ˆåœ¨å¼•ç”¨ä»–çš„æ—¶å€™ï¼Œéœ€è¦å°†@Autowireæ³¨è§£çš„requiredå±æ€§è®¾ç½®ä¸ºfalseã€‚\npublic class Test{\r@Autowire(required=false)\rprivate Other other;\r}\r è¿™æ ·å°±ç®—beanä¸ºnullï¼Œç¨‹åºä¹Ÿèƒ½æ­£å¸¸å¯åŠ¨ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ç©ºæŒ‡é’ˆã€‚\npublic class Test{\rprivate Other other;\r/**\r* can't work\r* @param other\r*/\r@Autowire(required=false)\rpublic Test(Other other) {\rthis.other = other\r}\r}\r æ³¨æ„å¦‚æœæ˜¯é€šè¿‡æ„é€ å™¨è¿›è¡Œçš„beanå¼•ç”¨ï¼Œé‚£ä¹ˆå°±ç®—åœ¨æ„é€ å™¨ä¸Šç”³æ˜äº†@Autowire(required=false)ä¹Ÿæ²¡ç”¨ã€‚\n","id":114,"section":"posts","summary":"èƒŒæ™¯ å¦‚æœé…ç½®beançš„æ—¶å€™å‡ºç°nullå€¼ï¼Œå¹¶ä¸”è¢«å…¶ä»–beanæ‰€å¼•ç”¨ã€‚é‚£ä¹ˆå¯åŠ¨çš„æ—¶å€™å°±æœ‰å¯èƒ½å‡ºç°å¤±è´¥çš„æƒ…å†µã€‚ @Configuration public class BeanConfiguration{ @Bean public Other getOther() { return null } } å› ä¸ºé…ç½®","tags":["spring"],"title":"Spring beanä¸ºnullå¯åŠ¨æŠ¥é”™","uri":"https://www.mingaccount.com/2017/11/spring-bean-null/","year":"2017"},{"content":"é¡¹ç›®ç»“æ„ +- pom.xml\r+- my-app\r| +- pom.xml\r| +- src\r| +- main\r| +- java\r+- my-webapp\r| +- pom.xml\r| +- src\r| +- main\r| +- webapp\r å¯ä»¥çœ‹åˆ°è¯¥é¡¹ç›®ä¸‹åŒ…å«ä¸¤ä¸ªmodule:my-appã€my-webappã€‚ä¸¤ä¸ªå­moduleéƒ½æœ‰å¯¹åº”çš„pom.xmlæ–‡ä»¶ã€‚\npom æœ€å¤–å±‚çš„é¡¹ç›®pom.xml\n\u0026lt;project xmlns=\u0026quot;http://maven.apache.org/POM/4.0.0\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxsi:schemaLocation=\u0026quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\u0026quot;\u0026gt;\r\u0026lt;modelVersion\u0026gt;4.0.0\u0026lt;/modelVersion\u0026gt;\r\u0026lt;groupId\u0026gt;com.mycompany.app\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;app\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1.0-SNAPSHOT\u0026lt;/version\u0026gt;\r\u0026lt;packaging\u0026gt;pom\u0026lt;/packaging\u0026gt;\r\u0026lt;modules\u0026gt;\r\u0026lt;module\u0026gt;my-app\u0026lt;/module\u0026gt;\r\u0026lt;module\u0026gt;my-webapp\u0026lt;/module\u0026gt;\r\u0026lt;/modules\u0026gt;\r\u0026lt;/project\u0026gt;\r ä¸Šé¢çš„\u0026lt;packaging\u0026gt;å’Œ\u0026lt;modules\u0026gt;æ ‡ç­¾æ˜¯ç”¨æ¥ä¿è¯æ¯ä¸ªå­æ¨¡å—çš„pomç›¸å…³å‘½ä»¤éƒ½èƒ½è¢«æ‰§è¡Œåˆ°\næ³¨æ„\u0026lt;module\u0026gt;æ ‡ç­¾ä¸­çš„å€¼æ˜¯å­æ¨¡å—çš„ç›¸å¯¹è·¯å¾„ï¼Œå¦‚æœå­æ¨¡å—ä¸æ˜¯çˆ¶é¡¹ç›®çš„å­æ–‡ä»¶å¤¹ï¼Œè€Œæ˜¯åŒçº§çš„æ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆ\u0026lt;module\u0026gt;çš„å€¼å°±åº”è¯¥æ˜¯../my-app\nå¦‚æœå­æ¨¡å—ä¸­æœ‰ä¾èµ–ï¼Œæ¯”å¦‚my-webappä¾èµ–my-appï¼Œé‚£ä¹ˆéœ€è¦åœ¨my-webappæ¨¡å—ä¸­çš„pom.xmlæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼š\n\u0026lt;dependencies\u0026gt;\r\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;com.mycompany.app\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;my-app\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1.0-SNAPSHOT\u0026lt;/version\u0026gt;\r\u0026lt;/dependency\u0026gt;\r...\r\u0026lt;/dependencies\u0026gt;\r ä¸Šé¢çš„å­æ¨¡å—ä¾èµ–ï¼Œä¿è¯my-webappç”Ÿæˆçš„åŒ…ä¸­åŒ…å«äº†my-appçš„åŒ…ï¼Œå¹¶ä¸”my-appçš„åŒ…æ„å»ºæ°¸è¿œåœ¨my-webappä¹‹å‰\nç„¶åä¸¤ä¸ªå­æ¨¡å—çš„pom.xmlä¸­åˆ†åˆ«éœ€è¦è¿½åŠ ä¸€ä¸ª\u0026lt;parent\u0026gt;æ ‡ç­¾ï¼Œä»¥é˜²å­æ¨¡å—å•ç‹¬æ„å»ºæ‰¾ä¸åˆ°çˆ¶æ¨¡å—çš„ä¾èµ–ï¼š\n\u0026lt;project xmlns=\u0026quot;http://maven.apache.org/POM/4.0.0\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxsi:schemaLocation=\u0026quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\u0026quot;\u0026gt;\r\u0026lt;parent\u0026gt;\r\u0026lt;groupId\u0026gt;com.mycompany.app\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;app\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1.0-SNAPSHOT\u0026lt;/version\u0026gt;\r\u0026lt;/parent\u0026gt;\r...\r å¦‚æœéœ€è¦ç»§æ‰¿çˆ¶é¡¹ç›®çš„ç‰ˆæœ¬å·å’ŒgroupIdï¼Œåœ¨å­æ¨¡å—ä¸­ä¸ç”³æ˜å’Œå³å¯\nå¦å¤–ï¼Œå¦‚æœå­æ¨¡å—è¦ç»§æ‰¿çš„çˆ¶é¡¹ç›®ä¸åƒä¸Šé¢çš„ç»“æ„ä¸€æ ·ï¼Œå¹¶ä¸”çˆ¶é¡¹ç›®ä¹Ÿä¸åœ¨æœ¬åœ°ä»“åº“ä¸­ï¼Œæ¯”å¦‚åƒè¿™æ ·çš„ç»“æ„ï¼š\n.\r|-- my-module\r| `-- pom.xml\r`-- parent\r`-- pom.xml\r é‚£ä¹ˆå°±éœ€è¦æ‰‹åŠ¨æŒ‡å‘çˆ¶æ¨¡å—çš„pom.xmlæ–‡ä»¶ï¼š\n\u0026lt;project\u0026gt;\r\u0026lt;modelVersion\u0026gt;4.0.0\u0026lt;/modelVersion\u0026gt;\r\u0026lt;parent\u0026gt;\r\u0026lt;groupId\u0026gt;com.mycompany.app\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;my-app\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;1\u0026lt;/version\u0026gt;\r\u0026lt;relativePath\u0026gt;../parent/pom.xml\u0026lt;/relativePath\u0026gt;\r\u0026lt;/parent\u0026gt;\r\u0026lt;artifactId\u0026gt;my-module\u0026lt;/artifactId\u0026gt;\r\u0026lt;/project\u0026gt;\r \u0026lt;relativePath\u0026gt;æ ‡ç­¾å°±æ˜¯æŒ‡ç›¸å¯¹äºå½“å‰æ¨¡å—ï¼Œçˆ¶æ¨¡å—pom.xmlæ–‡ä»¶æ‰€åœ¨çš„ç›¸å¯¹ä½ç½®\n","id":115,"section":"posts","summary":"é¡¹ç›®ç»“æ„ +- pom.xml +- my-app | +- pom.xml | +- src | +- main | +- java +- my-webapp | +- pom.xml | +- src | +- main | +- webapp å¯ä»¥çœ‹åˆ°è¯¥é¡¹ç›®ä¸‹åŒ…å«ä¸¤ä¸ªmodule:my-appã€my-webappã€‚","tags":["maven"],"title":"åŒ…å«å¤šä¸ªæ¨¡å—çš„é¡¹ç›®å¦‚ä½•é…ç½®maven","uri":"https://www.mingaccount.com/2017/11/maven-multiple-module/","year":"2017"},{"content":"*è¯¥åšå®¢è½¬è‡ª http://blog.csdn.net/danchu/article/details/54986442\nè¯­æ³•ç³–ï¼ˆSyntactic Sugarï¼‰ï¼Œä¹Ÿç§°ç³–è¡£è¯­æ³•ï¼ŒæŒ‡åœ¨è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€æœ¬èº«åŠŸèƒ½æ¥è¯´æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºå‘˜çš„å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚è¯´ç™½äº†ï¼Œè¯­æ³•ç³–å°±æ˜¯å¯¹ç°æœ‰è¯­æ³•çš„ä¸€ä¸ªå°è£…ã€‚\nJavaä½œä¸ºä¸€ç§ä¸å¹³å°æ— å…³çš„é«˜çº§è¯­è¨€ï¼Œå½“ç„¶ä¹Ÿå«æœ‰è¯­æ³•ç³–ï¼Œè¿™äº›è¯­æ³•ç³–å¹¶ä¸è¢«è™šæ‹Ÿæœºæ‰€æ”¯æŒï¼Œåœ¨ç¼–è¯‘æˆå­—èŠ‚ç é˜¶æ®µå°±è‡ªåŠ¨è½¬æ¢æˆç®€å•å¸¸ç”¨è¯­æ³•ã€‚ä¸€èˆ¬æ¥è¯´Javaä¸­çš„è¯­æ³•ç³–ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š\n æ³›å‹ä¸ç±»å‹æ“¦é™¤ è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±ï¼Œå˜é•¿å‚æ•°ã€ å¢å¼ºforå¾ªç¯ å†…éƒ¨ç±»ä¸æšä¸¾ç±»  æ³›å‹ä¸ç±»å‹æ“¦é™¤ Javaè¯­è¨€å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±æ”¯æŒæ³›å‹çš„ã€‚åœ¨æ—©æœŸçš„JDKä¸­ï¼Œåªèƒ½é€šè¿‡Objectç±»æ˜¯æ‰€æœ‰ç±»å‹çš„çˆ¶ç±»å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢æ¥å®ç°æ³›å‹çš„åŠŸèƒ½ã€‚å¼ºåˆ¶ç±»å‹è½¬æ¢çš„ç¼ºç‚¹å°±æ˜¯æŠŠç¼–è¯‘æœŸé—´çš„é—®é¢˜å»¶è¿Ÿåˆ°è¿è¡Œæ—¶ï¼ŒJVMå¹¶ä¸èƒ½ä¸ºæˆ‘ä»¬æä¾›ç¼–è¯‘æœŸé—´çš„æ£€æŸ¥ã€‚\nåœ¨JDK1.5ä¸­ï¼ŒJavaè¯­è¨€å¼•å…¥äº†æ³›å‹æœºåˆ¶ã€‚ä½†æ˜¯è¿™ç§æ³›å‹æœºåˆ¶æ˜¯é€šè¿‡ç±»å‹æ“¦é™¤æ¥å®ç°çš„ï¼Œå³Javaä¸­çš„æ³›å‹åªåœ¨ç¨‹åºæºä»£ç ä¸­æœ‰æ•ˆï¼ˆæºä»£ç é˜¶æ®µæä¾›ç±»å‹æ£€æŸ¥ï¼‰ï¼Œåœ¨ç¼–è¯‘åçš„å­—èŠ‚ç ä¸­è‡ªåŠ¨ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢è¿›è¡Œæ›¿ä»£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒJavaè¯­è¨€ä¸­çš„æ³›å‹æœºåˆ¶å…¶å®å°±æ˜¯ä¸€é¢—è¯­æ³•ç³–ï¼Œç›¸è¾ƒä¸C++ã€C#ç›¸æ¯”ï¼Œå…¶æ³›å‹å®ç°å®åœ¨æ˜¯ä¸é‚£ä¹ˆä¼˜é›…ã€‚\n/**\r* åœ¨æºä»£ç ä¸­å­˜åœ¨æ³›å‹\r*/\rpublic static void main(String[] args) {\rMap\u0026lt;String,String\u0026gt; map = new HashMap\u0026lt;String,String\u0026gt;();\rmap.put(\u0026quot;hello\u0026quot;,\u0026quot;ä½ å¥½\u0026quot;);\rString hello = map.get(\u0026quot;hello\u0026quot;);\rSystem.out.println(hello);\r}\r å½“ä¸Šè¿°æºä»£ç è¢«ç¼–è¯‘ä¸ºclassæ–‡ä»¶åï¼Œæ³›å‹è¢«æ“¦é™¤ä¸”å¼•å…¥å¼ºåˆ¶ç±»å‹è½¬æ¢\npublic static void main(String[] args) {\rHashMap map = new HashMap(); //ç±»å‹æ“¦é™¤\rmap.put(\u0026quot;hello\u0026quot;, \u0026quot;ä½ å¥½\u0026quot;);\rString hello = (String)map.get(\u0026quot;hello\u0026quot;);//å¼ºåˆ¶è½¬æ¢\rSystem.out.println(hello);\r}\r è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®± Javaä¸­çš„è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±æŒ‡çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸ä»–ä»¬çš„åŒ…è£…ç±»å‹ä¹‹é—´çš„ç›¸äº’è½¬æ¢ã€‚\r æˆ‘ä»¬çŸ¥é“Javaæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œåœ¨Javaä¸–ç•Œä¸­æœ‰ä¸€å¥è¯æ˜¯è¿™ä¹ˆè¯´çš„ï¼šâ€œä¸‡ç‰©çš†å¯¹è±¡â€ã€‚ä½†æ˜¯Javaä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹å´ä¸æ˜¯å¯¹è±¡ï¼Œä»–ä»¬ä¸éœ€è¦è¿›è¡Œnewæ“ä½œï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ä»»ä½•æ–¹æ³•ï¼Œè¿™åœ¨ä½¿ç”¨çš„æ—¶å€™æœ‰è¯¸å¤šä¸ä¾¿ã€‚å› æ­¤Javaä¸ºè¿™äº›åŸºæœ¬ç±»å‹æä¾›äº†åŒ…è£…ç±»ï¼Œå¹¶ä¸”ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œæä¾›äº†è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åŠŸèƒ½ã€‚è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå†…éƒ¨è¿˜æ˜¯è°ƒç”¨äº†ç›¸åº”çš„å‡½æ•°è¿›è¡Œè½¬æ¢ã€‚\nä¸‹é¢ä»£ç æ¼”ç¤ºäº†è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±åŠŸèƒ½\npublic static void main(String[] args) {\rInteger a = 1;\rint b = 2;\rint c = a + b;\rSystem.out.println(c);\r}\r ç»è¿‡ç¼–è¯‘åï¼Œä»£ç å¦‚ä¸‹\npublic static void main(String[] args) {\rInteger a = Integer.valueOf(1); // è‡ªåŠ¨è£…ç®±\rbyte b = 2;\rint c = a.intValue() + b;//è‡ªåŠ¨æ‹†ç®±\rSystem.out.println(c);\r}\r å˜é•¿å‚æ•° æ‰€è°“å˜é•¿å‚æ•°ï¼Œå°±æ˜¯æ–¹æ³•å¯ä»¥æ¥å—é•¿åº¦ä¸å®šç¡®å®šçš„å‚æ•°\nå˜é•¿å‚æ•°ç‰¹æ€§æ˜¯åœ¨JDK1.5ä¸­å¼•å…¥çš„ï¼Œä½¿ç”¨å˜é•¿å‚æ•°æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€æ˜¯å˜é•¿çš„é‚£ä¸€éƒ¨åˆ†å‚æ•°å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼ŒäºŒæ˜¯å˜é•¿å‚æ•°å¿…é¡»ä½äºæ–¹æ³•å‚æ•°åˆ—è¡¨çš„æœ€åé¢ã€‚å˜é•¿å‚æ•°åŒæ ·æ˜¯Javaä¸­çš„è¯­æ³•ç³–ï¼Œå…¶å†…éƒ¨å®ç°æ˜¯Javaæ•°ç»„ã€‚\npublic class Varargs {\rpublic static void print(String... args) {\rfor(String str : args){\rSystem.out.println(str);\r}\r}\rpublic static void main(String[] args) {\rprint(\u0026quot;hello\u0026quot;, \u0026quot;world\u0026quot;);\r}\r}\r ç¼–è¯‘ä¸ºclassæ–‡ä»¶åå¦‚ä¸‹ï¼Œä»ä¸­å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºå˜é•¿å‚æ•°å†…éƒ¨æ˜¯é€šè¿‡æ•°ç»„å®ç°çš„\npublic class Varargs {\rpublic Varargs() {\r}\rpublic static void print(String... args) {\rString[] var1 = args;\rint var2 = args.length;\r//å¢å¼ºforå¾ªç¯çš„æ•°ç»„å®ç°æ–¹å¼\rfor(int var3 = 0; var3 \u0026lt; var2; ++var3) {\rString str = var1[var3];\rSystem.out.println(str);\r}\r}\rpublic static void main(String[] args) {\r//å˜é•¿å‚æ•°è½¬æ¢ä¸ºæ•°ç»„\rprint(new String[]{\u0026quot;hello\u0026quot;, \u0026quot;world\u0026quot;});\r}\r}\r å¢å¼ºforå¾ªç¯ å¢å¼ºforå¾ªç¯ä¸æ™®é€šforå¾ªç¯ç›¸æ¯”ï¼ŒåŠŸèƒ½æ›´å¼ºå¹¶ä¸”ä»£ç æ›´ç®€æ´\r å¢å¼ºforå¾ªç¯çš„å¯¹è±¡è¦ä¹ˆæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¦ä¹ˆå®ç°äº†Iterableæ¥å£ã€‚è¿™ä¸ªè¯­æ³•ç³–ä¸»è¦ç”¨æ¥å¯¹æ•°ç»„æˆ–è€…é›†åˆè¿›è¡Œéå†ï¼Œå…¶åœ¨å¾ªç¯è¿‡ç¨‹ä¸­ä¸èƒ½æ”¹å˜é›†åˆçš„å¤§å°ã€‚\npublic static void main(String[] args) {\rString[] params = new String[]{\u0026quot;hello\u0026quot;,\u0026quot;world\u0026quot;};\r//å¢å¼ºforå¾ªç¯å¯¹è±¡ä¸ºæ•°ç»„\rfor(String str : params){\rSystem.out.println(str);\r}\rList\u0026lt;String\u0026gt; lists = Arrays.asList(\u0026quot;hello\u0026quot;,\u0026quot;world\u0026quot;);\r//å¢å¼ºforå¾ªç¯å¯¹è±¡å®ç°Iterableæ¥å£\rfor(String str : lists){\rSystem.out.println(str);\r}\r}\r ç¼–è¯‘åçš„classæ–‡ä»¶ä¸º\npublic static void main(String[] args) {\rString[] params = new String[]{\u0026quot;hello\u0026quot;, \u0026quot;world\u0026quot;};\rString[] lists = params;\rint var3 = params.length;\r//æ•°ç»„å½¢å¼çš„å¢å¼ºforé€€åŒ–ä¸ºæ™®é€šfor\rfor(int str = 0; str \u0026lt; var3; ++str) {\rString str1 = lists[str];\rSystem.out.println(str1);\r}\rList var6 = Arrays.asList(new String[]{\u0026quot;hello\u0026quot;, \u0026quot;world\u0026quot;});\rIterator var7 = var6.iterator();\r//å®ç°Iterableæ¥å£çš„å¢å¼ºforä½¿ç”¨iteratoræ¥å£è¿›è¡Œéå†\rwhile(var7.hasNext()) {\rString var8 = (String)var7.next();\rSystem.out.println(var8);\r}\r}\r å†…éƒ¨ç±» å†…éƒ¨ç±»å°±æ˜¯å®šä¹‰åœ¨ä¸€ä¸ªç±»å†…éƒ¨çš„ç±»\r Javaè¯­è¨€ä¸­ä¹‹æ‰€ä»¥å¼•å…¥å†…éƒ¨ç±»ï¼Œæ˜¯å› ä¸ºæœ‰äº›æ—¶å€™ä¸€ä¸ªç±»åªåœ¨å¦ä¸€ä¸ªç±»ä¸­æœ‰ç”¨ï¼Œæˆ‘ä»¬ä¸æƒ³è®©å…¶åœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹è¢«ä½¿ç”¨ã€‚å†…éƒ¨ç±»ä¹‹æ‰€ä»¥æ˜¯è¯­æ³•ç³–ï¼Œæ˜¯å› ä¸ºå…¶åªæ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶çš„æ¦‚å¿µï¼Œä¸€æ—¦ç¼–è¯‘å®Œæˆï¼Œç¼–è¯‘å™¨å°±ä¼šä¸ºå†…éƒ¨ç±»ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„classæ–‡ä»¶ï¼Œåä¸ºouter$innter.classã€‚\npublic class Outer {\rclass Inner{\r}\r}\r ä½¿ç”¨javacç¼–è¯‘åï¼Œç”Ÿæˆä¸¤ä¸ªclassæ–‡ä»¶Outer.classå’ŒOuter$Inner.classï¼Œå…¶ä¸­Outer$Inner.classçš„å†…å®¹å¦‚ä¸‹ï¼š\nclass Outer$Inner {\rOuter$Inner(Outer var1) {\rthis.this$0 = var1;\r}\r}\r å†…éƒ¨ç±»åˆ†ä¸ºå››ç§ï¼šæˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»ã€é™æ€å†…éƒ¨ç±»ï¼Œæ¯ä¸€ç§éƒ½æœ‰å…¶ç”¨æ³•ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†\næšä¸¾ç±»å‹ æšä¸¾ç±»å‹å°±æ˜¯ä¸€äº›å…·æœ‰ç›¸åŒç‰¹æ€§çš„ç±»å¸¸é‡\r javaä¸­ç±»çš„å®šä¹‰ä½¿ç”¨classï¼Œæšä¸¾ç±»çš„å®šä¹‰ä½¿ç”¨enumã€‚åœ¨Javaçš„å­—èŠ‚ç ç»“æ„ä¸­ï¼Œå…¶å®å¹¶æ²¡æœ‰æšä¸¾ç±»å‹ï¼Œæšä¸¾ç±»å‹åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘å®Œæˆåè¢«ç¼–è¯‘æˆä¸€ä¸ªæ™®é€šçš„ç±»ã€‚è¿™ä¸ªç±»ç»§æ‰¿java.lang.Enumï¼Œå¹¶è¢«finalå…³é”®å­—ä¿®é¥°ã€‚\npublic enum Fruit {\rAPPLE,ORINGE\r}\r ä½¿ç”¨jadå¯¹ç¼–è¯‘åçš„classæ–‡ä»¶è¿›è¡Œåç¼–è¯‘åå¾—åˆ°ï¼š\n//ç»§æ‰¿java.lang.Enumå¹¶å£°æ˜ä¸ºfinal\rpublic final class Fruit extends Enum\r{\rpublic static Fruit[] values()\r{\rreturn (Fruit[])$VALUES.clone();\r}\rpublic static Fruit valueOf(String s)\r{\rreturn (Fruit)Enum.valueOf(Fruit, s);\r}\rprivate Fruit(String s, int i)\r{\rsuper(s, i);\r}\r//æšä¸¾ç±»å‹å¸¸é‡\rpublic static final Fruit APPLE;\rpublic static final Fruit ORANGE;\rprivate static final Fruit $VALUES[];//ä½¿ç”¨æ•°ç»„è¿›è¡Œç»´æŠ¤\rstatic\r{\rAPPLE = new Fruit(\u0026quot;APPLE\u0026quot;, 0);\rORANGE = new Fruit(\u0026quot;ORANGE\u0026quot;, 1);\r$VALUES = (new Fruit[] {\rAPPLE, ORANGE\r});\r}\r}\r ","id":116,"section":"posts","summary":"*è¯¥åšå®¢è½¬è‡ª http://blog.csdn.net/danchu/article/details/54986442 è¯­æ³•ç³–ï¼ˆSyntactic Sugarï¼‰ï¼Œä¹Ÿç§°ç³–è¡£è¯­æ³•ï¼ŒæŒ‡åœ¨è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€æœ¬èº«åŠŸèƒ½æ¥è¯´æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œ","tags":["java"],"title":"[è½¬]è°ˆè°ˆJavaä¸­çš„è¯­æ³•ç³–","uri":"https://www.mingaccount.com/2017/10/java-syntatic-sugar/","year":"2017"},{"content":"ä¸€ã€å¸¸è§çš„ç¼–ç æ ¼å¼ 1.ASCII ã€€åŸºç¡€ç¼–ç ï¼Œè‹±æ–‡å’Œè¥¿æ¬§å­—ç¬¦ã€‚\nã€€ç”¨ä¸€ä¸ªå­—èŠ‚çš„ä½7ä½è¡¨ç¤ºï¼Œä¸€å…±128ä¸ªã€‚\nã€€0~13æ˜¯æ§åˆ¶å­—ç¬¦å¦‚æ¢è¡Œã€å›è½¦ã€åˆ é™¤ç­‰ï¼Œ32~126æ˜¯æ‰“å°å­—ç¬¦ï¼Œé”®ç›˜è¾“å…¥ã€‚\n2.IOS-8859-1 ã€€ASCIIçš„æ‰©å±•ã€‚\nã€€ç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä¸€å…±256ä¸ªã€‚\n3.GB2312 ã€€ä¸­æ–‡ç¼–ç å­—ç¬¦é›†ã€‚\nã€€ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºï¼ŒA1~A9æ˜¯ç¬¦å·åŒºï¼Œä¸€å…±682ä¸ªï¼›B0~F7æ˜¯æ±‰å­—åŒºï¼Œä¸€å…±6763ä¸ªã€‚\nã€€ç¼–ç éœ€è¦æŸ¥è¯¢å¯¹åº”ç è¡¨ï¼Œæ•ˆç‡ç•¥ä½ã€‚\n4.GBK ã€€GB2312çš„æ‰©å±•ï¼Œèƒ½å¤Ÿå…¼å®¹GB2312ã€‚\nã€€ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä¸€å…±23940ä¸ªç ä½ï¼Œè¡¨ç¤º21003ä¸ªæ±‰å­—ã€‚\nã€€ç¼–ç éœ€è¦æŸ¥è¯¢å¯¹åº”ç è¡¨ï¼Œæ•ˆç‡ç•¥ä½ã€‚\n5.UTF-16 ã€€UTF-16å…·ä½“å®šä¹‰äº†Unicodeå­—ç¬¦åœ¨è®¡ç®—æœºçš„å­˜å–æ–¹æ³•ã€‚\nã€€ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºUnicodeçš„è½¬åŒ–æ ¼å¼ã€‚\nã€€å®šé•¿çš„å±•ç¤ºæ–¹æ³•ï¼Œæ¯ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œè½¬åŒ–æ•ˆç‡é«˜ï¼Œå†…å­˜å’Œç¡¬ç›˜å¤šç”¨æ­¤ç¼–ç (JAVAå†…å­˜å­˜å‚¨æ ¼å¼UTF-16)ã€‚\nã€€é‡‡ç”¨é¡ºåºç¼–ç ï¼Œä¸èƒ½å¯¹å•ä¸ªå­—ç¬¦çš„ç¼–ç è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœæŸåï¼Œåé¢çš„ç å€¼éƒ½ä¼šå—å½±å“ã€‚\n6.UTF-8 ã€€UTF-8å…·ä½“å®šä¹‰äº†Unicodeå­—ç¬¦åœ¨è®¡ç®—æœºçš„å­˜å–æ–¹æ³•ã€‚\nã€€ç”¨1-6ä¸ªå­—èŠ‚ç»„æˆä¸€ä¸ªå­—ç¬¦ï¼Œæ±‰å­—é‡‡ç”¨ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºã€‚\nã€€å˜é•¿çš„å±•ç¤ºæ–¹æ³•ï¼Œæ¯ä¸ªç¼–ç åŒºåŸŸæœ‰ä¸åŒçš„å­—ç é•¿åº¦ã€‚\nã€€ç½‘ç»œä¼ è¾“ä¸­å¾ˆå¤§ä¸€éƒ¨åˆ†å­—ç¬¦ç”¨ä¸€ä¸ªå­—èŠ‚å°±å¯ä»¥å±•ç¤ºï¼ŒUTF-16è§„èŒƒåŒ–çš„å…¨éƒ¨è½¬ä¸ºäº†ä¸¤ä¸ªå­—èŠ‚ï¼Œå¯¹äºè¿™äº›å­—ç¬¦UTF-8åªéœ€è¦ä¸€ä¸ªå­—èŠ‚ã€‚\nã€€UTF-8å¦‚æœä¸­é—´ä¸€ä¸ªç å€¼æŸåï¼Œåé¢çš„ç å€¼å¹¶ä¸å—å½±å“ã€‚\nã€€ç›¸å¯¹äºUTF-16ï¼ŒUTF-8æœ‰ä¼ è¾“ä¸­èµ„æºå ç”¨å°ï¼Œæ•°æ®æ›´å®‰å…¨çš„ä¼˜åŠ¿ï¼Œæ›´é€‚åˆç½‘ç»œä¼ è¾“ï¼Œä½†UTF-16çš„ç¼–ç è§„åˆ™ç›¸å¯¹ç®€å•ï¼Œç¼–ç æ•ˆç‡æ›´é«˜ï¼Œé€‚åˆæœ¬åœ°å†…å­˜å’Œç£ç›˜ã€‚\näºŒã€å¸¸è§JAVAç¼–ç API 1.I/Oã€€ InputStreamReader isr = new InputStreamReader(inputStream,\u0026quot;utf-8\u0026quot;);\rCharset StreamDecoder\rOutputStreamWriter osw = new OutputStreamWriter(outputStream,\u0026quot;utf-8\u0026quot;);\rCharset StreamEncoder\r 2.å†…å­˜æ“ä½œ å­—ç¬¦ä¸å­—èŠ‚çš„è½¬æ¢ï¼šã€€//String\rString s = \u0026quot;ä¸­æ–‡å­—ç¬¦\u0026quot;;\rbyte[] b = s.getBytes(\u0026quot;UTF-8\u0026quot;);\rString s1 = new String(b,\u0026quot;UTF-8\u0026quot;);\r//Charset\rCharset charset = Charset.forName(\u0026quot;UTF-8\u0026quot;);\rByteBuffer byteBuffer = charset.encode(string);\rCharBuffer charBuffer = charset.decode(byteBuffer);\r//charå’Œbyteçš„è½¯è½¬æ¢ï¼Œå°†ä¸€ä¸ª16bitçš„charæ‹†åˆ†æˆä¸¤ä¸ª8bitçš„byteæ¥æ˜¾ç¤ºï¼Œå®é™…å€¼å¹¶æ²¡æœ‰è¢«è½¬æ¢ã€‚\rByteBuffer heapByteBuffer = ByteBuffer.allocate(1024);\rByteBuffer byteBuffer = heapByteBuffer.putChar(c);\r ä¸‰ã€Java Webä¸­æ¶‰åŠçš„ç¼–è§£ç  1.URLç¼–è§£ç  PathInfoä¸­æ–‡é—®é¢˜ï¼š\né…ç½®tomcatçš„server.xmlï¼š\nQueryStringæ˜¯é€šè¿‡HTTPä¸­çš„Headerä¼ åˆ°åå°çš„ï¼Œä»–çš„è§£ç å­—ç¬¦é›†é»˜è®¤æ˜¯ISO-8859-1ï¼Œ\nä¹Ÿå¯ä»¥é€šè¿‡Headerçš„ContentTypeä¸­çš„Charsetæ¥å®šä¹‰ã€‚\nå¦‚ä½•ç¡®å®šåç«¯è°ƒå–äº†ContentTypeä¸­çš„å­—ç¬¦é›†ï¼Œéœ€è¦åœ¨server.xmlä¸­é…ç½®ï¼ˆè¿™ä¸ªé…ç½®åªé’ˆå¯¹QueryStringæœ‰æ•ˆï¼‰ï¼š\n2.HTTP Headerçš„ç¼–è§£ç  é’ˆå¯¹Headerä¸­çš„å…¶ä»–å‚æ•°ï¼Œæ¯”å¦‚Cookie,redirectPathç­‰ã€‚\nå°½é‡ä¸è¦ä¼ é€’éASCIIå­—ç¬¦ï¼Œå¦‚æœå¿…é¡»ï¼Œåœ¨ä¼ é€’ä¹‹å‰ç”¨ä¸‹é¢çš„APIè¿›è¡Œç¼–ç å†ä¼ é€’ï¼š\norg.apache.catalina.util.URLEncoder\n3.POSTè¡¨å•çš„ç¼–è§£ç  å®¢æˆ·ç«¯è·å–å‚æ•°ä¸ºä¹±ç åçš„è§£å†³æ€è·¯ï¼š\nã€€1.å°†POSTæ”¹ä¸ºgetï¼ŒæŸ¥çœ‹æµè§ˆå™¨ç«¯æ˜¯å¦æœ‰é—®é¢˜ã€‚\nã€€2.åç«¯request.geCharacterEncdoingè¿”å›ç»“æœæ˜¯å¦æ˜¯é¢„æœŸç¼–ç ã€‚\n//åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨request.getParameterä¹‹å‰ä½¿ç”¨\nrequest.setCharacterEncoding(charset);\n4.HTTP BODYçš„ç¼–è§£ç  ä¸»è¦é˜è¿°ä»åå°åˆ°å‰å°çš„ç¼–è§£ç ï¼š\n//å¯¹è¿”å›å‰å°çš„æ•°æ®è¿›è¡Œç¼–ç ï¼Œå‰å°ä¼šé¦–å…ˆæ ¹æ®è¿™ä¸ªå€¼è¿›è¡Œè§£ç  response.setCharacterEncoding(charset)  \u0026lt;!-- å¦‚æœåå°æ²¡æœ‰è®¾ç½®ï¼Œä¼šæ ¹æ®é¡µé¢ä¸­çš„charsetæ¥è§£ç ï¼Œå¦‚æœé¡µé¢ä¹Ÿæœ‰è®¾ç½®åˆ™ç”¨é»˜è®¤ç¼–ç æ¥è§£ç  --\u0026gt;\r\u0026lt;meta HTTP-equiv=\u0026quot;Content-Type\u0026quot; content=\u0026quot;text/html;charset=UTF-8\u0026quot;/\u0026gt;\r\u0026lt;!-- JDBCè¯»å†™æ•°æ®æ—¶è¦å’Œæ•°æ®çš„å†…ç½®ç¼–ç ä¿æŒä¸€è‡´ --\u0026gt;\rurl=\u0026quot;jdbc:mysql://localhost:3306/DB?useUnicode=true\u0026amp;characterEncoding=UTF-8\u0026quot;\r å››ã€JSçš„ç¼–ç é—®é¢˜ 1.å¤–éƒ¨å¼•å…¥jsæ–‡ä»¶ \u0026lt;!-- æµè§ˆå™¨ä¼šæŒ‰ç…§charsetçš„è®¾ç½®æ¥è§£æè¿™ä¸ªjsæ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®åˆ™é»˜è®¤æŒ‰ç…§å½“å‰é¡µé¢çš„çš„ç¼–ç è®¾ç½®æ¥è§£æjsæ–‡ä»¶ --\u0026gt;\r\u0026lt;script src=\u0026quot;de/mo/demo.js\u0026quot; charset=\u0026quot;gbk\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\r 2.jsçš„URLç¼–ç  //å¯¹urlæ ¹æ®UTF-8è¿›è¡Œç¼–ç å’Œè§£ç ï¼Œé™¤äº†ä¸€äº›ç‰¹æ®Šå­—ç¬¦\u0026quot;!\u0026quot;\u0026quot;#\u0026quot;\u0026quot;$\u0026quot;\u0026quot;\u0026amp;\u0026quot;\u0026quot;'\u0026quot;\u0026quot;(\u0026quot;\u0026quot;)\u0026quot;\u0026quot;*\u0026quot;\u0026quot;+\u0026quot;\u0026quot;,\u0026quot;\u0026quot;-\u0026quot;\u0026quot;.\u0026quot;\u0026quot;/\u0026quot;\u0026quot;:\u0026quot;\u0026quot;;\u0026quot;\u0026quot;=\u0026quot;\u0026quot;?\u0026quot;\u0026quot;@\u0026quot;\u0026quot;_\u0026quot;\u0026quot;~\u0026quot;\u0026quot;0-9\u0026quot;\u0026quot;a-z\u0026quot;\u0026quot;A-Z\u0026quot;\r//ç¼–ç ç»“æœåœ¨æ¯ä¸ªç å€¼å‰åŠ ä¸€ä¸ª\u0026quot;%\u0026quot;\rencodeURI(\u0026quot;http://localhost:8080/examples/servlets/servlet/æ¥å§æ˜†ç‰¹ç‰Œå§å­™å­?inviter=æ°æ´›ç‰¹\u0026quot;);\rdecodeURI(\u0026quot;**ç¼–ç å†…å®¹**\u0026quot;);\r//å¯¹urlæ ¹æ®UTF-8è¿›è¡Œç¼–ç å’Œè§£ç ï¼Œç›¸å¯¹äºencodeURIï¼Œå®ƒæ›´åŠ çš„å½»åº•ã€‚æ’é™¤çš„ç‰¹æ®Šå­—ç¬¦ä¸º\u0026quot;!\u0026quot;\u0026quot;'\u0026quot;\u0026quot;(\u0026quot;\u0026quot;)\u0026quot;\u0026quot;*\u0026quot;\u0026quot;-\u0026quot;\u0026quot;.\u0026quot;\u0026quot;_\u0026quot;\u0026quot;~\u0026quot;\u0026quot;0-9\u0026quot;\u0026quot;a-z\u0026quot;\u0026quot;A-Z\u0026quot;\r//ç¼–ç ç»“æœåœ¨æ¯ä¸ªç å€¼å‰åŠ ä¸€ä¸ª\u0026quot;%\u0026quot;\r//å®ƒæ’é™¤çš„å­—ç¬¦æ¯”encodeURIæ›´å°‘ï¼Œé€šå¸¸ç”¨äºå°†URLä½œä¸ºå‚æ•°çš„URLçš„ç¼–ç ï¼Œå¦‚ç¤ºä¾‹å¦‚æœä¸å°†å‚æ•°URLä¸­çš„\u0026amp;è¿›è¡Œç¼–ç ä¼šå½±å“åˆ°æ•´ä¸ªURLçš„å®Œæ•´æ€§\r\u0026quot;http://localhost/servlet?ref=\u0026quot; + encodeURIComponent(\u0026quot;http://localhost:8080/examples/servlets/servlet/æ¥å§æ˜†ç‰¹ç‰Œå§å­™å­?inviter=æ°æ´›ç‰¹\u0026amp;inviter=å¶å¥ˆæ³•\u0026quot;);\rdecodeURIComponent(\u0026quot;**ç¼–ç å†…å®¹**\u0026quot;);\r 3.åç«¯æ¥æ”¶æ—¶è§£ç  åç«¯å¤„ç†URLç¼–è§£ç é çš„æ˜¯ java.net.URLEncoderå’Œjava.net.URLDecoderè¿™ä¸¤ä¸ªç±»ã€‚\nåç«¯å¯¹çš„å¯¹URLçš„ç¼–ç åŒæ ·ä¹Ÿæœ‰æ’é™¤çš„ç‰¹æ®Šå­—ç¬¦ï¼Œä¸å‰ç«¯çš„encodeURIComponentç›¸å¯¹åº”ã€‚\n//åç«¯ç›´æ¥è·å–ä¼ è¿‡æ¥çš„URLå‚æ•°ä¼šè‡ªåŠ¨è§£ç \r//å¦‚æœæ²¡æœ‰æå‰è®¾ç½®request.setCharacterEncoding()å¾ˆå®¹æ˜“å‡ºç°ç¼–ç ä¸åŒè€Œå¯¼è‡´çš„ä¹±ç \rrequest.getParameter();\r//å¦ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡å‰å°jså¯¹URLè¿›è¡Œä¸¤æ¬¡ç¼–ç ï¼Œåå°ä¸ç®¡é€šè¿‡ä»€ä¹ˆè¿›è¡Œç¬¬ä¸€æ¬¡è§£ç ï¼Œéƒ½èƒ½å¾—åˆ°æ­£ç¡®çš„UTF-8ç¼–ç ï¼Œå‰å°ä»£ç å¦‚ä¸‹\rencodeURIComponent(encodeURIComponent(url));\r//ç¬¬ä¸€æ¬¡ç¼–ç çš„ç»“æœï¼ˆä¾‹å¦‚ï¼š%E2%A7ï¼‰çš„ç™¾åˆ†å·ï¼Œä¼šåœ¨ç¬¬äºŒæ¬¡ç¼–ç åå°†%å˜æˆ%25ï¼ˆä¾‹å¦‚ï¼š%25E2%25A7ï¼‰\r//åå°åœ¨æ‰§è¡Œrequest.getParameter()çš„æ—¶å€™ä¼šè‡ªåŠ¨è§£ç ï¼Œä¸ç®¡å½“å‰å®¹å™¨çš„ç¼–ç æ˜¯ä»€ä¹ˆå¾—åˆ°çš„æ˜¯æ­£ç¡®çš„UTF-8ç¼–ç ï¼ˆä¾‹å¦‚ï¼š%E2%A7ï¼‰\r äº”ã€å…¶ä»–éœ€è¦ç¼–ç çš„åœ°æ–¹ 1.xml \u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r 2.Velocity services.VelocityService.input.encoding=UTF-8\r 3.JSP \u0026lt;%@page contentType=\u0026quot;text/html;charset=UTF-8\u0026quot;%\u0026gt;\r æ³¨ï¼šæœ¬æ–‡æ˜¯å¯¹â€œã€Šæ·±å…¥åˆ†æJava WebæŠ€æœ¯å†…å¹•ã€‹è®¸ä»¤æ³¢ è‘—â€ ä¸€ä¹¦çš„ç›¸å…³å†…å®¹çš„æ€»ç»“\n","id":117,"section":"posts","summary":"ä¸€ã€å¸¸è§çš„ç¼–ç æ ¼å¼ 1.ASCII åŸºç¡€ç¼–ç ï¼Œè‹±æ–‡å’Œè¥¿æ¬§å­—ç¬¦ã€‚ ç”¨ä¸€ä¸ªå­—èŠ‚çš„ä½7ä½è¡¨ç¤ºï¼Œä¸€å…±128ä¸ªã€‚ 0~13æ˜¯æ§åˆ¶å­—ç¬¦å¦‚æ¢è¡Œã€å›è½¦ã€åˆ é™¤ç­‰ï¼Œ32~126æ˜¯æ‰“","tags":["java"],"title":"Javaç¼–ç ,ä¹±ç é—®é¢˜è¯¦è§£","uri":"https://www.mingaccount.com/2017/10/java-encode/","year":"2017"},{"content":"pom resources é¦–å…ˆè¦ä¸ºpomæ–‡ä»¶æ–°æ·»ä¸€ä¸ªresourcesæ ‡ç­¾\n\u0026lt;project\u0026gt;\r\u0026lt;name\u0026gt;...\u0026lt;/name\u0026gt;\r\u0026lt;groupId\u0026gt;...\u0026lt;/groupId\u0026gt;\r\u0026lt;version\u0026gt;...\u0026lt;/version\u0026gt;\r...\r\u0026lt;build\u0026gt;\r\u0026lt;resources\u0026gt;\r\u0026lt;resource\u0026gt;\r\u0026lt;directory\u0026gt;src/main/resources\u0026lt;/directory\u0026gt;\r\u0026lt;/resource\u0026gt;\r\u0026lt;filtering\u0026gt;true\u0026lt;/filtering\u0026gt;\r\u0026lt;/resources\u0026gt;\r\u0026lt;/build\u0026gt;\r\u0026lt;/project\u0026gt;\r é»˜è®¤æƒ…å†µä¸‹\u0026lt;filtering\u0026gt;çš„å±æ€§ä¸ºfalseï¼Œå› æ­¤éœ€è¦ç”³æ˜æ¥è¦†ç›–å®ƒã€‚resourceçš„directoryæ ‡ç­¾ç”³æ˜äº†èµ„æºçš„è·¯å¾„ï¼Œä»£è¡¨è¯¥è·¯å¾„ä¸‹çš„èµ„æºéƒ½å¯ä»¥é€šè¿‡@property@ï¼ˆæ³¨æ„æ˜¯è¢«@åŒ…è£¹ï¼‰çš„æ–¹å¼æ¥è®¿é—®ä»¥ä¸‹ç›¸å…³çš„å±æ€§ï¼š\n pomä¸­çš„å±æ€§ï¼Œä¾‹å¦‚ï¼š@project.name@ @project.version@ @project.build.finalName@ settings.xmlä¸­çš„å±æ€§ï¼Œä¾‹å¦‚ï¼š@settings.localRepository@ ç³»ç»Ÿå±æ€§ï¼Œä¾‹å¦‚ï¼š @java.version@ @user.home@  #application.properties\rapplication.name=@project.name@\rapplication.version=@project.version@\rjava.version=@java.version@\r ä»¥ä¸Šçš„å±æ€§å¼•ç”¨ï¼Œéƒ½ä¼šåœ¨mvn buildé˜¶æ®µé€šè¿‡mvn process-resourcesè¯­å¥å¤„ç†ä¸ºå®é™…çš„å€¼ã€‚æ‰‹åŠ¨æ‰§è¡Œå®Œmvn process-resourceså‘½ä»¤ï¼Œåœ¨target/classesä¸‹çš„èµ„æºå°±ä¼šå˜æˆè¿™æ ·ï¼š\n#application.properties\rapplication.name=test\rapplication.version=1.1\rjava.version=1.8\r é™¤äº†ç³»ç»Ÿä¸­å·²ç»å®šä¹‰å¥½çš„å±æ€§ï¼Œä½ è¿˜å¯ä»¥è‡ªå®šä¹‰å±æ€§\nå¤–éƒ¨æ–‡ä»¶å±æ€§ å®šä¹‰ä¸€ä¸ªå¤–éƒ¨å±æ€§æ–‡ä»¶src/main/filters/filter.propertiesï¼š\n# filter.properties\rmy.filter.value=hello!\r è¦è®¿é—®è¿™ä¸ªå±æ€§æ–‡ä»¶ï¼Œéœ€è¦æ›´æ”¹pomæ–‡ä»¶buildå—çš„å†…å®¹ï¼š\n\u0026lt;build\u0026gt;\r\u0026lt;filters\u0026gt;\r\u0026lt;filter\u0026gt;src/main/filters/filter.properties\u0026lt;/filter\u0026gt;\r\u0026lt;/filters\u0026gt;\r\u0026lt;resources\u0026gt;\r\u0026lt;resource\u0026gt;\r\u0026lt;directory\u0026gt;src/main/resources\u0026lt;/directory\u0026gt;\r\u0026lt;filtering\u0026gt;true\u0026lt;/filtering\u0026gt;\r\u0026lt;/resource\u0026gt;\r\u0026lt;/resources\u0026gt;\r\u0026lt;/build\u0026gt;\r ç›¸æ¯”ä¹‹å‰çš„buildï¼Œå¢åŠ äº†ä¸€ä¸ªfiltersæ ‡ç­¾ï¼Œå°†è‡ªå®šä¹‰å±æ€§æ–‡ä»¶çš„è·¯å¾„ä½œä¸ºå­æ ‡ç­¾çš„å±æ€§ã€‚è¿™æ ·åœ¨src/main/resourcesè·¯å¾„ä¸‹çš„èµ„æºæ–‡ä»¶ä¸­å°±å¯ä»¥ç›´æ¥è®¿é—®äº†ï¼š\n#application.properties\rapplication.name=@project.name@\rapplication.version=@project.version@\rjava.version=@java.version@\rmy.filter.value=@my.filter.value@\r pom properties pomæ–‡ä»¶ä¸­çš„propertieså±æ€§ï¼Œä¸ä»…åœ¨pomæ–‡ä»¶ä¸­èƒ½è°ƒç”¨ï¼Œåœ¨å¤–éƒ¨èµ„æºæ–‡ä»¶ä¸­ä¹Ÿèƒ½åƒå‰é¢é‚£æ ·è°ƒç”¨ã€‚\n\u0026lt;project\u0026gt;\r\u0026lt;name\u0026gt;...\u0026lt;/name\u0026gt;\r\u0026lt;groupId\u0026gt;...\u0026lt;/groupId\u0026gt;\r\u0026lt;version\u0026gt;...\u0026lt;/version\u0026gt;\r...\r\u0026lt;properties\u0026gt;\r\u0026lt;my.property\u0026gt;myProperty\u0026lt;/my.property\u0026gt;\r\u0026lt;/properties\u0026gt;\r\u0026lt;build\u0026gt;\r\u0026lt;resources\u0026gt;\r\u0026lt;resource\u0026gt;\r\u0026lt;directory\u0026gt;src/main/resources\u0026lt;/directory\u0026gt;\r\u0026lt;/resource\u0026gt;\r\u0026lt;filtering\u0026gt;true\u0026lt;/filtering\u0026gt;\r\u0026lt;/resources\u0026gt;\r\u0026lt;/build\u0026gt;\r\u0026lt;/project\u0026gt;\r #application.properties\rapplication.name=@project.name@\rapplication.version=@project.version@\rjava.version=@java.version@\rmy.filter.value=@my.filter.value@\rmy.property=@my.property@\r å‘½ä»¤è¡Œå±æ€§ è·Ÿåœ¨mvnåé¢çš„å±æ€§å‚æ•°ï¼Œä¹Ÿèƒ½åœ¨src/main/resourcesç›®å½•ä¸­çš„èµ„æºæ–‡ä»¶ä¸­è°ƒç”¨ï¼š\nmvn package \u0026quot;-Dmy.command.property=commandProperty\u0026quot;\r è§„åˆ™å°±æ˜¯åœ¨-Dåè¾¹åŠ ä¸Šå±æ€§é”®å€¼å¯¹(key=value)\n#application.properties\rapplication.name=@project.name@\rapplication.version=@project.version@\rjava.version=@java.version@\rmy.filter.value=@my.filter.value@\rmy.property=@my.property@\rmy.command.property=@my.command.property@\r åŠ è½½å¤–éƒ¨æ–‡ä»¶çš„å±æ€§ å¯ä»¥é€šè¿‡åŠ è½½å¤–éƒ¨å±æ€§æ–‡ä»¶ï¼Œæ‰©å±•Mavenå¯ç”¨çš„å±æ€§å€¼ã€‚\n\u0026lt;project\u0026gt;\r...\r\u0026lt;name\u0026gt;My Resources Plugin Practice Project\u0026lt;/name\u0026gt;\r...\r\u0026lt;build\u0026gt;\r...\r\u0026lt;filters\u0026gt;\r\u0026lt;filter\u0026gt;[a filter property]\u0026lt;/filter\u0026gt;\r\u0026lt;/filters\u0026gt;\r...\r\u0026lt;/build\u0026gt;\r...\r\u0026lt;/project\u0026gt;\r my-filter-values.propertiesåŒ…å«ä»¥ä¸‹å±æ€§ï¼š\nyour.name = world\r å¯ä»¥åŠ è½½åˆ°pom.xmlä¸­ï¼š\n...\r\u0026lt;filters\u0026gt;\r\u0026lt;filter\u0026gt;my-filter-values.properties\u0026lt;/filter\u0026gt;\r\u0026lt;/filters\u0026gt;\r...\r è¿™æ ·å°±å¯ä»¥é€šè¿‡${your.name}æ¥è®¿é—®è¯¥å±æ€§å€¼\n","id":118,"section":"posts","summary":"pom resources é¦–å…ˆè¦ä¸ºpomæ–‡ä»¶æ–°æ·»ä¸€ä¸ªresourcesæ ‡ç­¾ \u0026lt;project\u0026gt; \u0026lt;name\u0026gt;...\u0026lt;/name\u0026gt; \u0026lt;groupId\u0026gt;...\u0026lt;/groupId\u0026gt; \u0026lt;version\u0026gt;...\u0026lt;/version\u0026gt; ... \u0026lt;build\u0026gt; \u0026lt;resources\u0026gt; \u0026lt;resource\u0026gt; \u0026lt;directory\u0026gt;src/main/resources\u0026lt;/directory\u0026gt; \u0026lt;/resource\u0026gt; \u0026lt;filtering\u0026gt;true\u0026lt;/filtering\u0026gt; \u0026lt;/resources\u0026gt; \u0026lt;/build\u0026gt; \u0026lt;/project\u0026gt; é»˜è®¤æƒ…å†µä¸‹\u0026lt;filtering\u0026gt;çš„å±æ€§ä¸ºfals","tags":["maven"],"title":"å¦‚ä½•åœ¨èµ„æºæ–‡ä»¶ä¸­è¯»å–Mavenç›¸å…³çš„å‚æ•°","uri":"https://www.mingaccount.com/2017/10/maven-filter-resources-file/","year":"2017"},{"content":"excelæ‹†åˆ†è§„åˆ™  å›ºå®šé•¿åº¦æ‹†åˆ† æŒ‡å®šç¬¦å·æ‹†åˆ† å¿½ç•¥é‡å¤æ‹†åˆ†ç¬¦å· å¸¦æ–‡æœ¬è¯†åˆ«ç¬¦å·çš„æ‹†åˆ†ï¼ˆæ¯”å¦‚\u0026quot;1,2,3,4,5\u0026quot;ç°åœ¨æŒ‰ç…§é€—å·åˆ†éš”ï¼Œä½†æ˜¯åˆè®¾ç½®æ–‡æœ¬è¯†åˆ«ç¬¦å·ä¸º\u0026quot;ï¼Œé‚£ä¹ˆ\u0026quot;1,2,3,4,5\u0026quot;ä¼šè¢«å½“åšä¸€ä¸ªæ•´ä½“ï¼Œä¸ä¼šè¿›ä¸€æ­¥å‚ä¸æ‹†åˆ†ï¼‰  æ­£åˆ™è¡¨è¾¾å¼ å›ºå®šé•¿åº¦ç›´æ¥substrå³å¯ï¼Œè¿™é‡Œä¸è®¨è®ºã€‚ä¸‹é¢çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­{split}ä»£è¡¨æ‹†åˆ†ç¬¦å·ï¼Œ{text}ä»£è¡¨æ–‡æœ¬è¯†åˆ«ç¬¦å·ã€‚\næŒ‡å®šç¬¦å·æ‹†åˆ†æ­£åˆ™ï¼š [{split}]\r å¿½ç•¥é‡å¤æ‹†åˆ†ç¬¦å· [{split}]+\r å¸¦æ–‡æœ¬è¯†åˆ«ç¬¦å·çš„æ‹†åˆ† (?![^{text}]+{text}{split}|[^{text}]+{text}$)\r ","id":119,"section":"posts","summary":"excelæ‹†åˆ†è§„åˆ™ å›ºå®šé•¿åº¦æ‹†åˆ† æŒ‡å®šç¬¦å·æ‹†åˆ† å¿½ç•¥é‡å¤æ‹†åˆ†ç¬¦å· å¸¦æ–‡æœ¬è¯†åˆ«ç¬¦å·çš„æ‹†åˆ†ï¼ˆæ¯”å¦‚\u0026quot;1,2,3,4,5\u0026quot;ç°åœ¨æŒ‰ç…§é€—å·åˆ†","tags":["regexp"],"title":"excelæ‹†åˆ†(split)åŠŸèƒ½å®ç°","uri":"https://www.mingaccount.com/2017/10/split-regexp/","year":"2017"},{"content":"æ¦‚è§ˆ Java8ä¸ºé›†åˆæµå¤„ç†æä¾›äº†å¹¶å‘æ”¯æŒã€‚å¹¶ä¸”å°±ç®—é›†åˆä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ä¸ä¿®æ”¹é›†åˆçš„çŠ¶æ€ä¸‹ï¼Œå¯¹é›†åˆè¿›è¡Œå¹¶å‘æ±‡æ€»æ“ä½œã€‚ä½†æ˜¯è¿™é‡Œé¢ä»æœ‰ä¸€äº›é™åˆ¶å’Œéœ€è¦æ³¨æ„çš„æƒ…å†µï¼ŒåŒæ—¶ä½ ä¹Ÿéœ€è¦æ ¹æ®æ•°æ®çš„å®é™…æƒ…å†µæ¥å†³å®šæ˜¯å¦éœ€è¦å¹¶å‘å¤„ç†ã€‚\nå¹¶å‘ç”³æ˜ ä½ å¯ä»¥é€šè¿‡å¹¶è¡Œæˆ–è€…ä¸²è¡Œçš„æ–¹å¼æ‰§è¡Œæµã€‚é»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰çš„æµéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¦‚æœéœ€è¦å¹¶è¡Œï¼Œå¯ä»¥é€šè¿‡Collection.parallelStreamæˆ–è€…è°ƒç”¨æŸä¸ªoperationçš„BaseStream.parallelã€‚\ndouble average = roster\r.parallelStream()\r.filter(p -\u0026gt; p.getGender() == Person.Sex.MALE)\r.mapToInt(Person::getAge)\r.average()\r.getAsDouble()\r ä¸Šé¢çš„ä¾‹å­æ˜¯å¹¶å‘æ±‚å–æ‰€æœ‰ç”·æ€§æˆå‘˜çš„å¹³å‡å¹´é¾„ã€‚\nå¹¶å‘Reduction é»˜è®¤ä¸²è¡Œreductionæ“ä½œï¼š\nMap\u0026lt;Person.Sex, List\u0026lt;Person\u0026gt;\u0026gt; byGender =\rroster\r.stream()\r.collect(\rCollectors.groupingBy(Person::getGender));\r ä¸Šé¢çš„ä¾‹å­å°†æ‰€æœ‰æˆå‘˜æŒ‰æ€§åˆ«åˆ†ç»„\nä¸‹é¢æ˜¯å¹¶è¡Œreductionï¼š\nConcurrentMap\u0026lt;Person.Sex, List\u0026lt;Person\u0026gt;\u0026gt; byGender =\rroster\r.parallelStream()\r.collect(\rCollectors.groupingByConcurrent(Person::getGender));\r å¯ä»¥çœ‹åˆ°ä¸å…‰æ˜¯parallelStreamçš„åŒºåˆ«ï¼Œè¿˜æœ‰groupingByConcurrentã€‚è¦ç¡®å®šcollectæ“ä½œæ˜¯å¦æ˜¯å¹¶å‘ï¼Œè¦æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š\n parallelStreamã€‚ collectæ“ä½œçš„å‚æ•°ï¼Œå¿…é¡»åŒ…å«ç‰¹å¾ï¼šCollector.Characteristics.CONCURRENT ã€‚é€šè¿‡è°ƒç”¨Collector.characteristics æ¥å†³å®šä¸€ä¸ªcollectorçš„ç‰¹å¾å±æ€§ã€‚ è¦ä¹ˆstreamæ˜¯æ— åºçš„ï¼Œè¦ä¹ˆcollectoræœ‰Collector.Characteristics.UNORDERED ç‰¹æ€§ã€‚é€šè¿‡è°ƒç”¨BaseStream.unordered æ¥ç¡®ä¿Streamæ˜¯æ— åºçš„ã€‚  æ³¨æ„ï¼šä¸Šé¢ç”¨äº†ConcurrentMapå’ŒgroupingByConcurrentï¼Œéƒ½æ˜¯å› ä¸ºæ€§èƒ½çš„åŸå› ã€‚å› ä¸ºä»–ä»¬èƒ½æ›´å¥½çš„é€‚é…parallelStreamå¸¦æ¥æ›´é«˜çš„æ€§èƒ½ã€‚\næ’åº æµå¤„ç†å…ƒç´ çš„é¡ºåºå–å†³äºå®ƒæ˜¯å¹¶è¡Œè¿˜æ˜¯ä¸²è¡Œçš„ï¼Œå¹¶ä¸”è¿˜æœ‰ä¸­é—´æ“ä½œçš„å½±å“ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸²è¡Œçš„æµæ˜¯æŒ‰ç…§é›†åˆé¡ºåºæ‰§è¡Œçš„ï¼Œå¹¶è¡Œçš„æƒ…å†µé¡ºåºæ— æ³•ä¿è¯ï¼Œä½†æ˜¯åœ¨è¿­ä»£æ—¶ä½ å¯ä»¥ä½¿ç”¨forEachOrderedæ¥ä»£æ›¿forEachå¼ºåˆ¶å¹¶è¡ŒæµæŒ‰ç…§é¡ºåºéå†ï¼Œä½†æ˜¯è¿™ä¼šæŸè€—æ€§èƒ½ï¼Œè·Ÿå¹¶è¡Œçš„åˆè¡·ç›¸è¿ã€‚\nInteger[] intArray = {1, 2, 3, 4, 5, 6, 7, 8 };\rList\u0026lt;Integer\u0026gt; listOfIntegers =\rnew ArrayList\u0026lt;\u0026gt;(Arrays.asList(intArray));\rSystem.out.println(\u0026quot;listOfIntegers:\u0026quot;);\rlistOfIntegers\r.stream()\r.forEach(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\rSystem.out.println(\u0026quot;listOfIntegers sorted in reverse order:\u0026quot;);\rComparator\u0026lt;Integer\u0026gt; normal = Integer::compare;\rComparator\u0026lt;Integer\u0026gt; reversed = normal.reversed(); Collections.sort(listOfIntegers, reversed); listOfIntegers\r.stream()\r.forEach(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\rSystem.out.println(\u0026quot;Parallel stream\u0026quot;);\rlistOfIntegers\r.parallelStream()\r.forEach(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\rSystem.out.println(\u0026quot;Another parallel stream:\u0026quot;);\rlistOfIntegers\r.parallelStream()\r.forEach(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\rSystem.out.println(\u0026quot;With forEachOrdered:\u0026quot;);\rlistOfIntegers\r.parallelStream()\r.forEachOrdered(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\r print:\nlistOfIntegers:\r1 2 3 4 5 6 7 8\rlistOfIntegers sorted in reverse order:\r8 7 6 5 4 3 2 1\rParallel stream:\r3 4 1 6 2 5 7 8\rAnother parallel stream:\r6 3 1 5 7 8 4 2\rWith forEachOrdered:\r8 7 6 5 4 3 2 1\r å‰¯ä½œç”¨ æµçš„collectæ“ä½œå¯¹å¹¶å‘æƒ…å†µæœ‰è‰¯å¥½çš„çš„æ”¯æŒï¼Œä½†æ˜¯åƒforEachå’Œpeekè¿™ç§æ“ä½œï¼Œä¸é€‚ç”¨äºå¹¶å‘æµï¼Œä»–ä»¬å¯èƒ½è¢«å¹¶å‘çš„åœ¨å¤šä¸ªçº¿ç¨‹å¤„ç†å¤šæ¬¡ï¼Œå¹¶ä¸”ä»–ä»¬çš„ç»“æœæ— æ³•ä¼°è®¡ï¼Œè¿˜ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚é™¤äº†ä¸¤ä¸ªéå†æ“ä½œï¼ŒåƒSystem.outè¿™ç§è¿”å›voidçš„è°ƒç”¨ï¼Œåœ¨lambdaè¡¨è¾¾å¼ä¸­é™¤äº†å¸¦æ¥å‰¯ä½œç”¨æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚è¿˜è¦æ³¨æ„åƒfilterå’Œmapæ“ä½œçš„lambdaè¡¨è¾¾å¼å‚æ•°ï¼Œéœ€è¦ç¡®ä¿ä»–ä»¬ä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ã€‚\næƒ°æ€§ æµçš„ä¸­é—´æ“ä½œéƒ½ä¸æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œä»–ä»¬å†è¢«ç”³æ˜è¿‡åï¼Œéƒ½ä¼šç­‰å¾…æœ€åä¸€ä¸ªç»ˆç«¯æ“ä½œï¼ˆæ¯”å¦‚ä¹‹å‰çš„forEachå’Œcollectï¼‰çš„å‡ºç°ï¼Œæ‰å¼€å§‹è¢«è°ƒç”¨ã€‚å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œåœ¨ç”³æ˜æµçš„ä¸­é—´æ“ä½œæ—¶ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ä¸è¦æœ‰å¹²æ‰°å’ŒçŠ¶æ€åŒ–çš„lambdaè¡¨è¾¾å¼å‡ºç°ã€‚\né”™è¯¯çš„å¹²æ‰° ä¸‹é¢çš„ä¾‹å­æ˜¯ä¸€ä¸ªé”™è¯¯çš„å¹²æ‰°æ€§çš„ä¸­é—´æ“ä½œç”³æ˜ï¼š\ntry {\rList\u0026lt;String\u0026gt; listOfStrings =\rnew ArrayList\u0026lt;\u0026gt;(Arrays.asList(\u0026quot;one\u0026quot;, \u0026quot;two\u0026quot;));\r// This will fail as the peek operation will attempt to add the\r// string \u0026quot;three\u0026quot; to the source after the terminal operation has\r// commenced. String concatenatedString = listOfStrings\r.stream()\r// Don't do this! Interference occurs here.\r.peek(s -\u0026gt; listOfStrings.add(\u0026quot;three\u0026quot;))\r.reduce((a, b) -\u0026gt; a + \u0026quot; \u0026quot; + b)\r.get();\rSystem.out.println(\u0026quot;Concatenated string: \u0026quot; + concatenatedString);\r} catch (Exception e) {\rSystem.out.println(\u0026quot;Exception caught: \u0026quot; + e.toString());\r}\r ä¸Šé¢çš„ä¾‹å­åœ¨peekæ“ä½œä¸­ç»™é›†åˆæºæ·»åŠ äº†ä¸€ä¸ªå…ƒç´ ã€‚æŒ‰ç…§ä¹‹å‰çš„æƒ°æ€§è¯´æ˜ï¼Œæµæ“ä½œçš„æ‰§è¡Œçš„å¼€å§‹æ˜¯åœ¨ç»ˆç«¯æ“ä½œå‡ºç°ä¹‹åã€‚å½“æµå¼€å§‹å¤„ç†ï¼Œè¿™æ—¶å€™peekæ“ä½œä¿®æ”¹æºæ•°æ®ï¼Œå°±ä¼šæŠ›å‡ºConcurrentModificationExceptionã€‚\nä¸è¯¥å‡ºç°çš„çŠ¶æ€åŒ–lambdaè¡¨è¾¾å¼ List\u0026lt;Integer\u0026gt; serialStorage = new ArrayList\u0026lt;\u0026gt;();\rSystem.out.println(\u0026quot;Serial stream:\u0026quot;);\rlistOfIntegers\r.stream()\r// Don't do this! It uses a stateful lambda expression.\r.map(e -\u0026gt; { serialStorage.add(e); return e; })\r.forEachOrdered(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\rserialStorage\r.stream()\r.forEachOrdered(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\rSystem.out.println(\u0026quot;Parallel stream:\u0026quot;);\rList\u0026lt;Integer\u0026gt; parallelStorage = Collections.synchronizedList(\rnew ArrayList\u0026lt;\u0026gt;());\rlistOfIntegers\r.parallelStream()\r// Don't do this! It uses a stateful lambda expression.\r.map(e -\u0026gt; { parallelStorage.add(e); return e; })\r.forEachOrdered(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\rparallelStorage\r.stream()\r.forEachOrdered(e -\u0026gt; System.out.print(e + \u0026quot; \u0026quot;));\rSystem.out.println(\u0026quot;\u0026quot;);\r  e -\u0026gt; { parallelStorage.add(e); return e; }åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªçŠ¶æ€åŒ–çš„lambdaè¡¨è¾¾å¼ï¼Œåœ¨parallelçš„æƒ…å†µä¸‹ä»–çš„æ‰§è¡Œç»“æœå¯èƒ½æ˜¯éš¾ä»¥é¢„æ–™çš„ï¼š\nSerial stream:\r8 7 6 5 4 3 2 1\r8 7 6 5 4 3 2 1\rParallel stream:\r8 7 6 5 4 3 2 1\r1 3 6 2 4 5 8 7\r æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨äº†Collections.synchronizedListæ¥åŒ…è£…å¹¶å‘çš„Listï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªé€»è¾‘ï¼Œç›´æ¥ç”³æ˜ä¸€ä¸ªArrayListæ¥æ¥æ”¶å¹¶å‘æµç”Ÿæˆçš„listï¼Œé‚£ä¹ˆå¯èƒ½ä¼šäº§ç”Ÿå¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„æƒ…å†µï¼Œç»“æœå¯èƒ½åƒè¿™æ ·ï¼š\nParallel stream:\r8 7 6 5 4 3 2 1\rnull 3 5 4 7 8 1 2\r ","id":120,"section":"posts","summary":"æ¦‚è§ˆ Java8ä¸ºé›†åˆæµå¤„ç†æä¾›äº†å¹¶å‘æ”¯æŒã€‚å¹¶ä¸”å°±ç®—é›†åˆä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ä¸ä¿®æ”¹é›†åˆçš„çŠ¶æ€ä¸‹ï¼Œå¯¹é›†åˆè¿›è¡Œå¹¶å‘æ±‡æ€»æ“ä½œã€‚ä½†æ˜¯è¿™é‡Œé¢ä»æœ‰ä¸€","tags":["java"],"title":"Java8 lamdaè¡¨è¾¾å¼ä¸­çš„parallel","uri":"https://www.mingaccount.com/2017/09/java8-parallel/","year":"2017"},{"content":"Reduction é¦–å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š\ndouble average = roster\r.stream()\r.filter(p -\u0026gt; p.getGender() == Person.Sex.MALE)\r.mapToInt(Person::getAge)\r.average()\r.getAsDouble();\r åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·ï¼ŒJDKè¿˜åŒ…å«å¾ˆå¤šå…¶ä»–çš„ç»ˆç«¯æ“ä½œï¼ˆæ¯”å¦‚è¯´average,sum,min,max,å’Œcountï¼‰ï¼Œä»–ä»¬åˆå¹¶äº†streamä¸­çš„å†…å®¹å¹¶è¿”å›å•ä¸€çš„ç»“æœã€‚è¿™äº›æ“ä½œè¢«ç»Ÿä¸€ç§°ä¸ºReduction operationsã€‚JDKåŒæ ·åŒ…å«å¯ä»¥è¿”å›é›†åˆè€Œä¸æ˜¯ä¸€ä¸ªå€¼çš„reductionæ“ä½œ.å¤§å¤šæ•°reductionæ“ä½œé’ˆå¯¹çš„éƒ½æ˜¯ç‰¹å®šæƒ…å†µï¼Œæ¯”å¦‚æ‰¾å¹³å‡å€¼æˆ–è€…æŒ‰ç…§ç›®å½•åˆ†ç»„ç­‰ã€‚ä½†æ˜¯ï¼ŒJDKåŒæ ·ä¹Ÿæä¾›äº†é€šç”¨çš„reductionæ“ä½œï¼Œä»–ä»¬æ˜¯reduceå’Œcollectã€‚\nStream.reduce ä¸‹é¢çš„ä¾‹å­ç›®çš„æ˜¯æ±‚åå†Œä¸­ç”·æ€§æˆå‘˜çš„å¹´é¾„æ€»å’Œ\né¦–å…ˆä½¿ç”¨Stream.sumçš„æ–¹å¼\nInteger totalAge = roster\r.stream()\r.mapToInt(Person::getAge)\r.sum();\r ä¸‹é¢ç”¨Stream.reduceè®¡ç®—åŒæ ·çš„ç»“æœ\nInteger totalAgeReduce = roster\r.stream()\r.map(Person::getAge)\r.reduce(\r0,\r(a,b) -\u0026gt; a + b);\r)\r è¿™ä¸ªreduceæ“ä½œæœ‰ä¸¤ä¸ªå‚æ•°ï¼š\n identityï¼šå®ƒæ—¢æ˜¯reductionè®¡ç®—çš„åˆå§‹å€¼ä¹Ÿæ˜¯åœ¨æµæ²¡æœ‰ä»»ä½•å…ƒç´ çš„æ—¶å€™çš„é»˜è®¤å€¼ã€‚è¿™ä¸ªä¾‹å­ä¸­identityçš„å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯æ±‚å’Œçš„åˆå§‹åŒ–å€¼æ˜¯0ï¼Œå¹¶ä¸”å¦‚æœrosteræµä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ ï¼Œæœ€åè¿”å›çš„ç»“æœä¹Ÿæ˜¯0ã€‚ accumulatorï¼šè¿™ä¸ªaccumulatoræ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯reductionçš„éƒ¨åˆ†ç»“æœï¼ˆåœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œå°±æ˜¯åˆ°ç›®å‰ä¸ºæ­¢æ‰€æœ‰å¹´é¾„çš„å’Œï¼‰ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯æµçš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­å°±æ˜¯ä¸‹ä¸€ä¸ªå¹´é¾„æ•°ï¼‰ã€‚å®ƒè¿”å›äº†ä¸€ä¸ªæ–°çš„éƒ¨åˆ†ç»“æœã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œaccumulatoræ–¹æ³•æ˜¯ä¸€ä¸ªå°†ä¸¤ä¸ªIntegerç›¸åŠ å¹¶è¿”å›Integerç›¸åŠ ç»“æœçš„lambdaè¡¨è¾¾å¼ï¼š\n(a,b) -\u0026gt; a + b  è¿™ä¸ªreduceæ“ä½œå§‹ç»ˆè¿”å›ä¸€ä¸ªæ–°çš„å€¼ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªaccumulatoræ–¹æ³•åœ¨æ¯æ¬¡å¤„ç†æµä¸­çš„ä¸€ä¸ªå…ƒç´ åï¼Œä¹Ÿè¿”å›ä¸€ä¸ªæ–°çš„å€¼ã€‚å‡å®šä½ æƒ³å¤„ç†çš„streamæ›´å¤æ‚ï¼Œæ¯”å¦‚å†…éƒ¨éƒ½æ˜¯é›†åˆã€‚è¿™æ ·å¯èƒ½å¯¹æ€§èƒ½é€ æˆå½±å“ã€‚æ¯”å¦‚ä½ çš„reduceæ“ä½œæ˜¯åˆå¹¶é›†åˆï¼Œé‚£ä¹ˆæ¯æ¬¡ä½ çš„accumulatoræ–¹æ³•åœ¨å¤„ç†ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆå»æ‰§è¡Œåˆå¹¶æ“ä½œï¼Œè¿™æ ·æ¯«æ— æ•ˆç‡å¯è¨€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ›´é€‚åˆä½¿ç”¨Stream.collectæ–¹æ³•ã€‚\nStream.collect ä¸åƒreduceæ–¹æ³•æ¯æ¬¡å¤„ç†å…ƒç´ éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å€¼ï¼Œcollectæ–¹æ³•æ˜¯ä¿®æ”¹æˆ–è€…æ”¹å˜ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å€¼ã€‚\næ€è€ƒä¸€ä¸‹ä½ è¦æ€æ ·æ±‚å‡ºstreamä¸­å…ƒç´ çš„å¹³å‡å€¼ã€‚ä½ éœ€è¦çš„æ˜¯å…ƒç´ æ€»æ•°å’Œå…ƒç´ çš„æ€»å’Œã€‚ä½†æ˜¯ï¼Œåƒreduceæ–¹æ³•å’Œæ‰€æœ‰å…¶ä»–çš„reductionæ–¹æ³•ä¸€æ ·ï¼Œcollectæ–¹æ³•ä¹Ÿåªèƒ½è¿”å›ä¸€ä¸ªå€¼ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹åŒ…å«è¿½è¸ªæ€»æ•°å’Œæ€»å’Œçš„æˆå‘˜å˜é‡ï¼Œå°±åƒä¸‹é¢çš„ç±»Averagerï¼š\nimport java.util.function.IntConsumer;\rclass Averager implements IntConsumer {\rprivate int total = 0;\rprivate int count = 0;\rpublic double average() {\rreturn count \u0026gt; 0 ? (double) total / count : 0;\r}\r@Override\rpublic void accept(int value) {\rtotal += value;\rcount++;\r}\rpublic void combine(Averager that) {\rtotal += that.total;\rcount += that.count;\r}\r}\r ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨Averagerç±»å’Œcollectæ–¹æ³•å»è·å–æ‰€æœ‰ç”·æ€§çš„å¹³å‡å¹´é¾„ï¼š\nAverager averager = roster.stream()\r.filter(p -\u0026gt; p.getGender() == Person.Sex.MALE)\r.map(Person::getAge)\r.collect(Averager::new, Averager::accept, Averager::combine);\rdouble averageNum = averager.average();\r è¿™ä¸ªä¾‹å­ä¸­çš„collectæœ‰ä¸‰ä¸ªå‚æ•°ï¼š\n supplierï¼šå®ƒæ˜¯ä¸€ä¸ªå·¥å‚æ–¹æ³•ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚supplierä¸ºcollectæ“ä½œæä¾›ä¸€ä¸ªå®ä¾‹ä½œä¸ºç»“æœå®¹å™¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯Averagerç±»çš„å®ä¾‹ã€‚ accumulatorï¼šå®ƒå°†ä¸€ä¸ªstreamçš„æˆå‘˜åˆå¹¶åˆ°ç»“æœå®¹å™¨ä¸­ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒé€šè¿‡æ¯æ¬¡ç»™count+1å’Œç»™totalåŠ ä¸Šå½“å‰æµä¸­çš„å¹´é¾„æ•°å€¼æ¥ä¿®æ”¹Averager`ç»“æœå®¹å™¨ã€‚ combinerï¼šå®ƒä»£è¡¨äº†ä½ è¦å¦‚ä½•åˆå¹¶ä¸¤ä¸ªç»“æœå®¹å™¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯åˆå¹¶ä¸¤ä¸ªç»“æœå®¹å™¨ä¸­çš„countå’Œtotalã€‚  æ³¨æ„äº‹é¡¹ï¼š\n supplieræ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼ˆæˆ–è€…ä¸€ä¸ªæ–¹æ³•å¼•ç”¨ï¼‰ï¼Œè€Œä¸æ˜¯åƒreduceæ“ä½œä¸­çš„identityå…ƒç´ ã€‚ accumulatorå’Œcombineræ–¹æ³•éƒ½ä¸è¿”å›å€¼ã€‚ å¯ä»¥åœ¨å¹¶å‘æµä¸Šä½¿ç”¨collectæ“ä½œï¼Œè¯¦æƒ…å‚è€ƒParallelism ã€‚å¦‚æœä½ åœ¨å¹¶å‘æµä¸Šè¿è¡Œcollectæ–¹æ³•ï¼Œé‚£ä¹ˆæ¯å½“combineræ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå°±åƒä¸Šé¢ä¾‹å­çš„Averagerå¯¹è±¡ï¼ŒJDKå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ã€‚å› æ­¤ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒåŒæ­¥çš„é—®é¢˜ã€‚  è™½ç„¶JDKå·²ç»æä¾›äº†averageæ“ä½œè®¡ç®—æµå…ƒç´ çš„å¹³å‡å€¼ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦è®¡ç®—å¤šä¸ªç»“æœå€¼çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡collectå’Œä¸€ä¸ªè‡ªå®šä¹‰ç±»æ¥è·å¾—ã€‚\ncollectæ“ä½œå®Œç¾é€‚é…é›†åˆã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•é€šè¿‡collectè·å–ç”·æ€§æˆå‘˜çš„æ‰€æœ‰åç§°é›†åˆï¼š\nList\u0026lt;String\u0026gt; names = roster.stream()\r.filter(p -\u0026gt; p.getGender() == Person.Sex.MALE)\r.map(p -\u0026gt; p.getName())\r.collect(Collectors.toList());\r ä¸Šé¢çš„collectæ–¹æ³•åªæœ‰ä¸€ä¸ªCollectorå‚æ•°ã€‚è¿™ä¸ªCollectoræ–¹æ³•å†…éƒ¨å…¶å®å°±æ˜¯å°è£…äº†ä¹‹å‰ä¸‰ä¸ªå‚æ•°çš„collectæ–¹æ³•ã€‚\nCollectorsé™¤äº†toListè¿˜å°è£…äº†å¾ˆå¤šå¸¸ç”¨çš„reductionæ“ä½œï¼Œæ¯”å¦‚ç´¯åŠ å…ƒç´ åˆ°é›†åˆä¸­å’Œæ ¹æ®å„ç§æ¡ä»¶æ±‡æ€»å…ƒç´ ã€‚è¿™äº›reductionæ“ä½œè¿”å›Collectorç±»çš„å®ä¾‹ï¼Œæ‰€ä»¥ä½ å¯ä»¥å°†ä»–ä»¬ä½œä¸ºcollectæ“ä½œçš„å‚æ•°ã€‚\nä¸Šé¢ä¾‹å­ä¸­çš„Collectors.toListæ“ä½œæ˜¯å°†æµä¸­æ‰€æœ‰çš„å…ƒç´ æ·»åŠ åˆ°ä¸€ä¸ªæ–°çš„Listä¸­ã€‚åƒå¤§å¤šæ•°Collectorsä¸­çš„æ“ä½œä¸€æ ·ï¼ŒtoListè¿”å›çš„æ˜¯ä¸€ä¸ªCollectorçš„å®ä¾‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªé›†åˆã€‚\nä¸‹é¢çš„ä¾‹å­æ˜¯æ ¹æ®rosterçš„æ€§åˆ«åˆ†ç»„ï¼š\nMap\u0026lt;Person.Sex, List\u0026lt;Person\u0026gt;\u0026gt; byGender =\rroster\r.stream()\r.collect(\rCollectors.groupingBy(Person::getGender));\r groupingByæ“ä½œï¼Œæ ¹æ®å‚æ•°ä¸­çš„lambdaè¡¨è¾¾å¼åˆ†ç±»ï¼Œå¹¶å°†å®ƒä½œä¸ºç»“æœMapçš„Keyå€¼ã€‚åƒè¿™ä¸ªä¾‹å­ä¸­ï¼ŒKeyå€¼å°±æ˜¯Person.Sex.Maleå’ŒPerson.Sex.Femaleã€‚\nä¸‹é¢çš„ä¾‹å­æ£€ç´¢æµå…ƒç´ çš„æ‰€æœ‰åç§°ï¼Œå¹¶æ ¹æ®æ€§åˆ«åˆ†ç±»ï¼š\nMap\u0026lt;Person.Sex, List\u0026lt;String\u0026gt;\u0026gt; namesByGender =\rroster\r.stream()\r.collect(\rCollectors.groupingBy(\rPerson::getGender, Collectors.mapping(\rPerson::getName,\rCollectors.toList())));\r è¿™ä¸ªgroupingByæ“ä½œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªåˆ†ç±»æ–¹æ³•å’Œä¸€ä¸ªCollectorå®ä¾‹ã€‚è¿™ä¸ªCollectorå‚æ•°å«åšdownstream collectorã€‚è¿™ä¸ªcollectorä¼šåœ¨Javaè¿è¡Œæ—¶åº”ç”¨åˆ°å¦å¤–ä¸€ä¸ªcollectorçš„ç»“æœä¸Šã€‚å› æ­¤è¿™ä¸ªgroupingByæ“ä½œè®©ä½ å¯ä»¥åº”ç”¨ä¸€ä¸ªcollectæ–¹æ³•åˆ°ç”±groupingByæ“ä½œåˆ›å»ºçš„Listå€¼ä¸Šã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåº”ç”¨äº†mapping collectorï¼Œå®ƒå°†Person::getNameæ–¹æ³•åº”ç”¨åˆ°streamçš„æ¯ä¸ªå…ƒç´ ä¸Šã€‚éšç§ï¼Œç»“æœä¼šå¾—åˆ°ä¸€ä¸ªç”±æˆå‘˜åç§°ç»„æˆçš„æµã€‚ä¸€ä¸ªç®¡é“æµåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªdownstream collectorsï¼Œå‘ä¸Šé¢ä¾‹å­è¿™æ ·ï¼Œè¢«å«åšmultilevel reductionã€‚\nä¸‹é¢çš„ä¾‹å­æ£€ç´¢æ¯ä¸ªæ€§åˆ«çš„å¹´é¾„æ€»å’Œï¼š\nMap\u0026lt;Person.Sex, Integer\u0026gt; totalAgeByGender =\rroster\r.stream()\r.collect(\rCollectors.groupingBy(\rPerson::getGender,\rCollectors.reducing(\r0,\rPerson::getAge,\rInteger::sum)));\r è¿™ä¸ªreducingæ“ä½œæœ‰ä¸‰ä¸ªå‚æ•°ï¼š\n identityï¼šå°±åƒStream.reduceæ“ä½œä¸­å£°æ˜çš„ä¸€æ ·ï¼Œå¯ä»¥ä½œä¸ºåˆå§‹åŒ–å€¼ï¼Œæˆ–è€…æµä¸ºç©ºæ—¶çš„é»˜è®¤å€¼ã€‚ mapperï¼šreducingæ“ä½œä¼šå°†è¿™ä¸ªmapperåº”ç”¨åˆ°æ¯ä¸ªstreamå…ƒç´ ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œmapperå°±æ˜¯ä¸ºäº†æ£€ç´¢æ‰€æœ‰çš„æˆå‘˜çš„å¹´é¾„ã€‚ operationï¼šè¿™ä¸ªæ“ä½œæ–¹æ³•æ˜¯ç”¨æ¥reduceç”±mapperå¤„ç†çš„å€¼çš„ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯Integerçš„åŠ æ³•æ“ä½œã€‚  ä¸‹é¢çš„ä¾‹å­æ£€ç´¢æ¯ä¸ªæ€§åˆ«çš„å¹³å‡å¹´é¾„ï¼š\nMap\u0026lt;Person.Sex, Double\u0026gt; averageAgeByGender = roster\r.stream()\r.collect(\rCollectors.groupingBy(\rPerson::getGender, Collectors.averagingInt(Person::getAge)));\r ","id":121,"section":"posts","summary":"Reduction é¦–å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š double average = roster .stream() .filter(p -\u0026gt; p.getGender() == Person.Sex.MALE) .mapToInt(Person::getAge) .average() .getAsDouble(); åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·ï¼ŒJDKè¿˜åŒ…å«å¾ˆå¤šå…¶ä»–çš„ç»ˆç«¯æ“ä½œï¼ˆæ¯”å¦‚è¯´average,sum,min,max,","tags":["java"],"title":"java8 lambda reduce\u0026collect","uri":"https://www.mingaccount.com/2017/09/lambda-reduce/","year":"2017"},{"content":"èµ„æºç±» User\n@Data\rpublic User{\rprivate String name;\rprivate List\u0026lt;String\u0026gt; tags;\r}\r map\u0026amp;flatmap mapå°†æ¯ä¸ªå‚æ•°å¯¹è±¡æ˜ å°„ä¸ºè¿”å›ç±»å‹ï¼Œä¸€ä¸ªå‚æ•°å¯¹åº”ä¸€ä¸ªè¿”å›å€¼\nList\u0026lt;User\u0026gt; userList = new ArrayList\u0026lt;User\u0026gt;();\r//...çœç•¥èµ‹å€¼\rList\u0026lt;String\u0026gt; userNames = userList.stream().map(user -\u0026gt; user.getName()).collect(Collectors.toList());\r flatMapå°†æ¯ä¸ªå‚æ•°å¯¹è±¡æ˜ å°„ä¸ºè¿”å›ç±»å‹ï¼Œä¸€ä¸ªå‚æ•°å¯¹åº”å¤šä¸ªè¿”å›å€¼\nList\u0026lt;User\u0026gt; userList = new ArrayList\u0026lt;User\u0026gt;();\r//...çœç•¥èµ‹å€¼\rSet\u0026lt;String\u0026gt; allUserTags = userList.stream().flatMap(user -\u0026gt; user.getTags().stream()).collect(Collectors.toSet());\r mapå’ŒflatMapè¿”å›çš„éƒ½æ˜¯ä¸€ä¸ªStreamï¼Œä¸è¿‡ä¸€ä¸ªStreamé‡Œé¢åªæœ‰ä¸€ä¸ªå€¼ï¼Œå¦ä¸€ä¸ªStreamå¯èƒ½åŒ…å«å¤šä¸ª\n","id":122,"section":"posts","summary":"èµ„æºç±» User @Data public User{ private String name; private List\u0026lt;String\u0026gt; tags; } map\u0026amp;flatmap mapå°†æ¯ä¸ªå‚æ•°å¯¹è±¡æ˜ å°„ä¸ºè¿”å›ç±»å‹ï¼Œä¸€ä¸ªå‚æ•°å¯¹åº”ä¸€ä¸ªè¿”å›å€¼ List\u0026lt;User\u0026gt; userList = new ArrayList\u0026lt;User\u0026gt;(); //...çœç•¥èµ‹å€¼ List\u0026lt;String\u0026gt; userNames = userList.stream().map(user -\u0026gt; user.getName()).collect(Collectors.toList()); flatMa","tags":["java"],"title":"java lambdaè¡¨è¾¾å¼mapå’ŒflatMap","uri":"https://www.mingaccount.com/2017/09/map-and-flatmap/","year":"2017"},{"content":"äº‹åŠ¡çš„å››å¤§ç‰¹æ€§ ACID:\n Atomicityï¼šåŸå­æ€§ï¼Œäº‹åŠ¡è¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå›æ»šåˆ°æ‰§è¡Œå‰çš„çŠ¶æ€ï¼› Consistencyï¼šä¸€è‡´æ€§ï¼Œå†™å…¥æ•°æ®æ»¡è¶³çº¦æŸæ¡ä»¶ã€‚ä¸€è‡´æ€§ä½œä¸ºç›®çš„ï¼ŒåŸå­æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§éƒ½æ˜¯æ‰‹æ®µï¼› Isolationï¼šéš”ç¦»æ€§ï¼Œäº‹åŠ¡ä¹‹é—´åº”è¯¥æ˜¯äº’ä¸å¹²æ‰°çš„ï¼› Durationï¼šæŒä¹…æ€§ï¼Œäº‹åŠ¡åœ¨ä»»ä½•æƒ…å†µéƒ½èƒ½æäº¤å’Œå›æ»šï¼Œå°±ç®—æœåŠ¡å™¨å´©æºƒã€‚  åŸå­æ€§ ä¿è¯æ•´ä¸ªä¸šåŠ¡åœ¨ä¸€ä¸ªäº‹åŠ¡ä¹‹ä¸­\nä¸€è‡´æ€§ éœ€è¦å…¶ä»–å‡ ä¸ªç‰¹æ€§æ¥å®ç°ï¼Œä»¥ä¿è¯æ•°æ®åº“æ•°æ®ä¸ä¼šå¹³ç™½å‡ºç°æˆ–è€…å¹³ç™½æ¶ˆå¤±\néš”ç¦»æ€§ æŒ‰ç…§ç†è®ºæ¥è¯´ï¼Œäº‹åŠ¡ä¹‹é—´æ˜¯è¦å®Œå…¨éš”ç¦»çš„ã€‚ä½†æ˜¯ï¼Œå®Œå…¨éš”ç¦»åœ¨å®é™…æƒ…å†µä¸‹ï¼Œæ•ˆç‡å¤ªä½ï¼Œæ‰€ä»¥æœ‰ä»¥ä¸‹å‡ ä¸ªéš”ç¦»ç­‰çº§ï¼š\n æ³¨æ„ï¼Œä¸‹é¢æ‰€æœ‰æåŠçš„è¯»ï¼ŒèƒŒæ™¯éƒ½æ˜¯ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶è¿è¡Œï¼Œä¸€ä¸ªåšå¢åˆ æ”¹ï¼Œä¸€ä¸ªåšè¯»å–ï¼Œè¯»å–äº‹åŠ¡ä¸­æœ‰ä¸¤æ¬¡å¯¹åŒä¸€ä¸ªæ•°æ®çš„è¯»å–ï¼Œè€Œå¢åˆ æ”¹äº‹åŠ¡åˆšå¥½åœ¨ä¸¤æ¬¡è¯»å–ä¹‹é—´å‘ç”Ÿã€‚\n  ä¸²è¡Œï¼ˆSQLLiteé»˜è®¤æ¨¡å¼ï¼‰ï¼šå°±æ˜¯æŒ‰é¡ºåºæ‰§è¡Œäº‹åŠ¡ï¼Œå®Œå…¨éš”ç¦»ï¼Œä½†æ˜¯æ•ˆç‡ä½ã€‚ å¯é‡å¤è¯»ï¼ˆMysqlé»˜è®¤æ¨¡å¼ï¼‰ï¼šå½“ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹ç›®æ ‡è¡¨å¹¶æäº¤æ—¶ï¼Œæ­£å¥½æœ‰å¦å¤–ä¸€ä¸ªäº‹åŠ¡åœ¨ä¿®æ”¹äº‹åŠ¡çš„å‰åå¯¹ç›®æ ‡è¡¨æ•°æ®è¿›è¡Œäº†æŸ¥è¯¢ï¼Œä¸¤æ¬¡æŸ¥è¯¢çš„ç»“æœä¸€æ ·ï¼Œå«åšå¯é‡å¤è¯»ã€‚å¯é‡å¤è¯»åªå¯¹ä¿®æ”¹æ•°æ®æœ‰æ•ˆï¼Œå¯¹æ–°å¢æ— æ•ˆï¼Œå¦‚æœä¿®æ”¹äº‹åŠ¡æ”¹ä¸ºæ–°å¢äº‹åŠ¡ï¼Œé‚£ä¹ˆæŸ¥è¯¢äº‹åŠ¡çš„ä¸¤æ¬¡æŸ¥è¯¢ä¼šå¾—åˆ°ä¸åŒç»“æœï¼Œè¿™å«å¹»è¯»ã€‚ è¯»å·²æäº¤ï¼ˆOracleã€PostgreSQLã€SQL Serveré»˜è®¤æ¨¡å¼ï¼‰ï¼šç›¸å¯¹äºå¯é‡å¤è¯»ï¼Œè¯»å·²æäº¤çš„éš”ç¦»æ€§æ›´ä½ï¼Œä¸ä»…æ–°å¢äº‹åŠ¡ä¸¤æ¬¡æŸ¥è¯¢çš„ç»“æœä¸ä¸€æ ·ï¼Œä¿®æ”¹äº‹åŠ¡ä¸¤æ¬¡æŸ¥è¯¢çš„ç»“æœä¹Ÿä¸ä¸€æ ·ã€‚ è¯»æœªæäº¤ï¼šè¯»æœªæäº¤éš”ç¦»æ€§æœ€ä½ï¼Œåœ¨å¢åˆ æ”¹äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œä½†è¿˜æœªæäº¤æ—¶ï¼Œå¤–éƒ¨çš„çº¿ç¨‹å°±èƒ½å¯Ÿè§‰åˆ°æ•°æ®çš„æ›´æ”¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€æ—¦å¢åˆ æ”¹äº‹åŠ¡å‘ç”Ÿäº†å›æ»šï¼Œé‚£ä¹ˆæŸ¥è¯¢äº‹åŠ¡ç¬¬äºŒæ¬¡æŸ¥è¯¢çš„ç»“æœå°±ä¼šå‡ºç°è„è¯»ã€‚  ä¸ºä»€ä¹ˆè¦åˆ†ä¸Šé¢å››ä¸ªçº§åˆ«ï¼Œä¸»è¦æ˜¯æ€§èƒ½å’Œå®‰å…¨é—®é¢˜ä¸å¯å…¼å¾—ï¼Œä¿è¯å®‰å…¨å°±è¦æŸå¤±ä¸€å®šçš„æ€§èƒ½ï¼Œæ²¡æœ‰å“ªä¸ªæœ€å¥½ï¼Œåªæœ‰å“ªä¸ªæœ€é€‚åˆå½“å‰çš„é¡¹ç›®ã€‚\né‚£ä¸ºä»€ä¹ˆä¸åŒçº§åˆ«çš„é”ä¼šå¯¹æ€§èƒ½é€ æˆæŸå¤±ï¼Œä¸»è¦æ˜¯å› ä¸ºåŠ é”çš„æ—¶é—´è·¨åº¦å’Œé”®å€¼èŒƒå›´ã€‚\næŒä¹…æ€§ äº‹åŠ¡éƒ½å¯¹åº”å®æ—¶æ—¥å¿—ï¼Œä¸€æ—¦æœåŠ¡å´©æºƒï¼Œé‡å¯çš„æ—¶å€™å¯æ ¹æ®æ—¥å¿—å®Œæˆä¹‹å‰çš„äº‹åŠ¡ï¼Œæˆ–è€…å›æ»šã€‚\n","id":123,"section":"posts","summary":"äº‹åŠ¡çš„å››å¤§ç‰¹æ€§ ACID: Atomicityï¼šåŸå­æ€§ï¼Œäº‹åŠ¡è¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå›æ»šåˆ°æ‰§è¡Œå‰çš„çŠ¶æ€ï¼› Consistencyï¼šä¸€è‡´æ€§ï¼Œå†™å…¥æ•°æ®æ»¡è¶³çº¦æŸæ¡ä»¶ã€‚","tags":["transactional","mysql"],"title":"äº‹åŠ¡ç®€ä»‹","uri":"https://www.mingaccount.com/2017/09/transactional/","year":"2017"},{"content":"çº¯æ•°å­— /^\\d+$/\r å°æ•° /^\\d*\\.\\d+$/\r æ•´æ•°æˆ–è€…å°æ•° /^\\d*(\\.\\d+)?$/\r æ­£è´Ÿæ•´æ•°æˆ–è€…å°æ•° /^-?\\d*(\\.\\d+)?$/\r æ•´æ•°å°æ•°æˆ–è€…åˆ†æ•° /[-]?[0-9]+[,.]?[0-9]*([\\/][0-9]+[,.]?[0-9]*)*/\r æ•°å­—å­—æ¯ /^[a-zA-Z0-9]*$/\r å•è¯ /^[a-zA-Z \\-]{1,50}$/\r MM/DD/YYYY 1900-2099\nå…¼å®¹çš„åˆ†éš”ç¬¦ï¼šç©ºæ ¼ - / .\n/^((0?[1-9]|1[012])[- /.](0?[1-9]|[12][0-9]|3[01])[- /.](19|20)?[0-9]{2})*$/\r YYYY/MM/DD 1900-2099\nå…¼å®¹çš„åˆ†éš”ç¬¦ï¼šç©ºæ ¼ - / .\n#^((19|20)?[0-9]{2}[- /.](0?[1-9]|1[012])[- /.](0?[1-9]|[12][0-9]|3[01]))*$#\r HH:mm:ss 24å°æ—¶åˆ¶\n/(?:[01]\\d|2[0123]):(?:[012345]\\d):(?:[012345]\\d)/\r æ‰‹æœºå· /^1[3-9]\\d{9}$/\r èº«ä»½è¯ /(^[1-9]\\d{5}(18|19|([23]\\d))\\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\\d{3}[0-9Xx]$)|(^[1-9]\\d{5}\\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\\d{3}$)/\r email /^([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,6})*$/\r masterCard /^(5[1-5][0-9]{14})*$/'\r visa /^(4[0-9]{12}(?:[0-9]{3})?)*$/\r å¤æ‚å…«ä½å¯†ç  å¿…é¡»åŒ…å«å¤§å†™ï¼Œå°å†™ï¼Œæ•°å­—å’Œç‰¹æ®Šç¬¦å·\n/(?=(.*[0-9]))(?=.*[\\!@#$%^\u0026amp;*()\\\\[\\]{}\\-_+=~`|:;\u0026quot;'\u0026lt;\u0026gt;,./?])(?=.*[a-z])(?=(.*[A-Z]))(?=(.*)).{8,}/  ä¸€èˆ¬å…«ä½å¯†ç  å¿…é¡»åŒ…å«å¤§å†™ï¼Œå°å†™ï¼Œæ•°å­—\n/(?=(.*[0-9]))((?=.*[A-Za-z0-9])(?=.*[A-Z])(?=.*[a-z]))^.{8,}$/\r ç”¨æˆ·å æ•°å­—å­—æ¯å­—ç¬¦ä¸²ï¼Œå¯èƒ½åŒ…å«_å’Œ-ï¼Œé•¿åº¦åœ¨3åˆ°16ä¹‹é—´\n/^[a-z0-9_-]{3,16}$/\r IPv4 /^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/  IPv6 /(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/\r IPv4å’ŒIPv6 /((^\\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\\s*$)|(^\\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?\\s*$))/\r URL /^(((http|https|ftp):\\/\\/)?([[a-zA-Z0-9]\\-\\.])+(\\.)([[a-zA-Z0-9]]){2,4}([[a-zA-Z0-9]\\/+=%\u0026amp;_\\.~?\\-]*))*$/\r HTMLæ ‡ç­¾ /\u0026lt;\\/?[\\w\\s]*\u0026gt;|\u0026lt;.+[\\W]\u0026gt;/\r åŒ¹é…å­—ç¬¦ä¸²ä¸­çš„é‡å¤å†…å®¹ /\u0026lt;\\/?[\\w\\s]*\u0026gt;|\u0026lt;.+[\\W]\u0026gt;/\r åŒ¹é…çº¿ä¸Šæ–‡ä»¶èµ„æºè·¯å¾„ /((\\/|\\\\|\\/\\/|https?:\\\\\\\\|https?:\\/\\/)[a-z0-9 _@\\-^!#$%\u0026amp;+={}.\\/\\\\\\[\\]]+)+\\.[a-z]+$/\r ","id":124,"section":"posts","summary":"çº¯æ•°å­— /^\\d+$/ å°æ•° /^\\d*\\.\\d+$/ æ•´æ•°æˆ–è€…å°æ•° /^\\d*(\\.\\d+)?$/ æ­£è´Ÿæ•´æ•°æˆ–è€…å°æ•° /^-?\\d*(\\.\\d+)?$/ æ•´æ•°å°æ•°æˆ–è€…åˆ†æ•° /[-]?[0-9]+[,.]?[0-9]*([\\/][0-9]+[,.]?[0-9]*)*/ æ•°å­—å­—æ¯ /^[a-zA-Z0-9]*$/ å•è¯ /^[a-zA-Z \\-]{1,50}$/ MM/DD/YYYY 1900-2099 å…¼å®¹çš„åˆ†éš”ç¬¦ï¼šç©ºæ ¼ - / . /^((0?[1-9]|1[012])[- /.](0?[1-9]|[12][0-9]|3[01])[- /.](19|20)?[0-9]{2})*$/ YYYY/MM/DD 1900-2099 å…¼å®¹çš„åˆ†éš”ç¬¦ï¼šç©ºæ ¼ -","tags":["regexp"],"title":"å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼","uri":"https://www.mingaccount.com/2017/09/common-regexp/","year":"2017"},{"content":"é—®é¢˜èƒŒæ™¯ ä½¿ç”¨sql:\ncreate view test_view as\rselect a.column_1, b.column_2\rfrom (select column_1 from table_1) a\rleft join (select column_2 from table_2) b on a.column_1 = b.column_2\r æŠ¥é”™ä¿¡æ¯ï¼š\nView's SELECT contains a subquery in the FROM clause\r é—®é¢˜åŸå›  æ ¹æ®mysqlå®˜æ–¹æ–‡æ¡£ï¼Œç‰ˆæœ¬5.7ä¹‹å‰éƒ½æ˜¯ä¸æ”¯æŒåˆ›å»ºè§†å›¾çš„fromè¯­å¥ä¸­æœ‰å­æŸ¥è¯¢çš„ï¼š\n The SELECT statement cannot contain a subquery in the FROM clause.\n å‚è€ƒmysql 5.6 create view\n  ä»ç‰ˆæœ¬5.7å¼€å§‹ä¸å†æœ‰è¯¥é™åˆ¶ã€‚\n å‚è€ƒmysql 5.7 create view\n ","id":125,"section":"posts","summary":"é—®é¢˜èƒŒæ™¯ ä½¿ç”¨sql: create view test_view as select a.column_1, b.column_2 from (select column_1 from table_1) a left join (select column_2 from table_2) b on a.column_1 = b.column_2 æŠ¥é”™ä¿¡æ¯ï¼š View's SELECT contains a subquery in the FROM clause é—®é¢˜åŸå›  æ ¹æ®mysqlå®˜æ–¹æ–‡æ¡£ï¼Œç‰ˆæœ¬5.7ä¹‹","tags":["mysql"],"title":"Mysql åˆ›å»ºè§†å›¾æŠ¥é”™ï¼šView's SELECT contains a subquery in the FROM clause","uri":"https://www.mingaccount.com/2017/09/mysql-create-view-exception/","year":"2017"},{"content":"1. æ¦‚è§ˆ ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬è¦æµ‹è¯•é¡¹ç›®æˆ–è€…å¹³å°çš„æŸä¸ªåŠŸèƒ½ï¼Œå…ˆè¦éƒ¨ç½²å¯åŠ¨åº”ç”¨æ‰èƒ½è¿›è¡Œï¼Œå¦‚æœåœ¨ä¸å¯åŠ¨åº”ç”¨æˆ–è€…è¿æ¥å…¶ä»–ä¼ä¸šçº§å¹³å°çš„æƒ…å†µä¸‹ï¼Œå°±èƒ½åšç›¸åº”çš„é›†æˆæµ‹è¯•ï¼Œé‚£ä¹ˆå°†ä¼šæå¤§çš„ç¼©çŸ­æµ‹è¯•æ—¶é—´ã€‚æ¯”å¦‚é€šè¿‡ORMæ¡†æ¶è®¿é—®æ•°æ®åº“çš„æ—¶å€™ï¼Œæƒ³ç¡®å®šsqlçš„æ­£ç¡®æ€§ï¼Œæˆ–è€…å¯¹è±¡å®ä¾‹æ˜ å°„çš„æ­£ç¡®æ€§\nä»‹ç»Springçš„æµ‹è¯•æ¡†æ¶ï¼Œç¬¬ä¸€ä¸ªå°±ç¦»ä¸å¼€org.springframework.teståŒ…ï¼Œä»–å¯¹Springå®¹å™¨é›†æˆæµ‹è¯•æœ‰å¾ˆå¤§çš„ä»·å€¼ï¼Œå¹¶ä¸”å®ƒä¸ä¾èµ–äºä»»ä½•å…¶ä»–çš„éƒ¨ç½²ç¯å¢ƒæˆ–è€…åº”ç”¨æœåŠ¡ã€‚è™½ç„¶ä»–æ¯”çº¯ç²¹çš„å•å…ƒæµ‹è¯•æ…¢ï¼Œä½†æ˜¯æ¯”ä»»ä½•ç­‰åŒäºSeleniumçš„æµ‹è¯•ï¼Œæˆ–è€…éœ€è¦ä¾èµ–äºéƒ¨ç½²åº”ç”¨æœåŠ¡çš„æµ‹è¯•éƒ½å¿«\nSpring TestContextæ¡†æ¶æ˜¯ä»¥æ³¨è§£ä¸ºé©±åŠ¨æ”¯æŒå•å…ƒå’Œé›†æˆæµ‹è¯•çš„ã€‚è¿™ä¸ªTestContextä¸ç®¡å®é™…ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæµ‹è¯•æ¡†æ¶ï¼Œåœ¨Junitï¼ŒTestNGï¼Œä»¥åŠå…¶ä»–æµ‹è¯•æ¡†æ¶ç¯å¢ƒä¸­éƒ½èƒ½è¿›è¡Œæµ‹è¯•\n2. é›†æˆæµ‹è¯•çš„ç›®æ ‡ Springé›†æˆæµ‹è¯•ä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªä¸»è¦ç›®æ ‡ï¼š\n åœ¨æµ‹è¯•ä¹‹é—´ç®¡ç†Spring IoCå®¹å™¨çš„ç¼“å­˜ ä¸ºæµ‹è¯•çš„èµ„æºå®ä¾‹æä¾›ä¾èµ–æ³¨å…¥ æä¾›é€‚åˆé›†æˆæµ‹è¯•çš„äº‹åŠ¡ç®¡ç† æä¾›SpringæŒ‡å®šçš„åŸºç¡€ç±»ä»¥å¸®åŠ©å¼€å‘è€…å†™é›†æˆæµ‹è¯•  æ¥ä¸‹æ¥çš„å­ç« èŠ‚æ˜¯å¯¹ä¸Šé¢å‡ ä¸ªç›®æ ‡çš„è¯¦ç»†æè¿°\n2.1. ä¸Šä¸‹æ–‡ç®¡ç†å’Œç¼“å­˜ Spring TestContextæ¡†æ¶æä¾›äº†ApplicationContextå®ä¾‹å’ŒWebApplicationContextå®ä¾‹çš„ä¸€è‡´æ€§åŠ è½½ï¼Œä»¥åŠè¿™äº›ä¸Šä¸‹æ–‡å¯¹è±¡çš„ç¼“å­˜ã€‚æ”¯æŒç¼“å­˜å’ŒåŠ è½½è¿™äº›ä¸Šä¸‹æ–‡å¯¹è±¡æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå¯åŠ¨æ—¶é—´æ˜¯ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œè¿™ä¸ªæ—¶é—´çš„æ¶ˆè´¹å¹¶ä¸æ˜¯Springå®¹å™¨è‡ªèº«æ¶ˆè€—çš„ï¼Œè€Œæ˜¯å¯¹è±¡å®ä¾‹åŒ–éœ€è¦æ—¶é—´ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªé¡¹ç›®æœ‰50åˆ°100ä¸ªHibernateçš„æ˜ å°„æ–‡ä»¶ï¼Œé‚£ä¹ˆå°†è¦èŠ±è´¹10åˆ°20ç§’çš„æ—¶é—´å»åŠ è½½è¿™äº›æ˜ å°„æ–‡ä»¶,å¦‚æœæ¯æ¬¡æµ‹è¯•éƒ½æœ‰è¿™ä¸ªèŠ±è´¹ï¼Œé‚£ä¹ˆä¼šæ‹–æ…¢æ•´ä¸ªæµ‹è¯•è¿›åº¦ï¼Œå‡å°‘å¼€å‘è€…çš„äº§å‡ºã€‚\nå…¸å‹çš„æµ‹è¯•ç±»ç”³æ˜è¦ä¹ˆæ˜¯xmlçš„èµ„æºä½ç½®æ•°ç»„æˆ–è€…Groovyçš„é…ç½®æºæ•°æ®ï¼ˆä¸€èˆ¬åœ¨classpathç›®å½•ä¸‹ï¼‰ï¼Œåˆæˆ–è€…æ˜¯é…ç½®åº”ç”¨çš„æˆå‘˜ç±»æ•°ç»„ã€‚è¿™äº›ä½ç½®æˆ–è€…ç±»è·Ÿweb.xmlä¸­çš„ç”³æ˜åŸºæœ¬ç±»ä¼¼\né»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€æ—¦åŠ è½½ï¼Œæ¯æ¬¡æµ‹è¯•éƒ½å¤ç”¨çš„ä¸€ä¸ªApplicationContextã€‚ å› æ­¤ï¼Œä¸€ä¸ªæµ‹è¯•å¥—ä»¶ï¼ˆtest suite)åªä¼šæœ‰ä¸€æ¬¡åˆå§‹åŒ–åº”ç”¨çš„è¿‡ç¨‹ï¼Œæ¯æ¬¡å­æµ‹è¯•å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ã€‚è¿™é‡Œè¯´çš„æµ‹è¯•å¥—ä»¶(test suite)æœ¯è¯­ä»£è¡¨åœ¨ä¸€ä¸ªJVMé‡Œé¢è¿è¡Œçš„æ‰€æœ‰æµ‹è¯•-æ¯”å¦‚è¯´ï¼Œä¸€ä¸ªç”±Antï¼ŒMavenï¼Œæˆ–è€…Gradleæ„å»ºçš„é¡¹ç›®ä¸­è¿è¡Œçš„æ‰€æœ‰æµ‹è¯•ã€‚åœ¨æå°‘æƒ…å†µä¸‹ï¼ŒApplicationContextä¼šè¢«æ±¡æŸ“éœ€è¦é‡æ–°åŠ è½½ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œé€šè¿‡ä¿®æ”¹beançš„å®šä¹‰æˆ–è€…åº”ç”¨å¯¹è±¡çš„çŠ¶æ€ï¼‰TestContextæ¡†æ¶å¯ä»¥é€šè¿‡é…ç½®é‡è½½é…ç½®ä¿¡æ¯ï¼Œå¹¶åœ¨æ‰§è¡Œä¸‹æ¬¡æµ‹è¯•ä¹‹å‰é‡æ–°æ„å»ºApplicationContextã€‚ä¸‹æ–‡ä¸­æœ‰è¯¦ç»†æ“ä½œã€‚\n2.2. æµ‹è¯•èµ„æºçš„ä¾èµ–æ³¨å…¥ å½“TestContextæ¡†æ¶åŠ è½½ä½ çš„ApplicationContextæ—¶ï¼Œä»–å¯ä»¥é€šè¿‡ä¾èµ–æ³¨å…¥æ·»åŠ ä»»æ„çš„é…ç½®åˆ°ä½ çš„æµ‹è¯•å®ä¾‹ã€‚ä»–æä¾›äº†ä¸€ä¸ªç®€æ˜çš„æœºåˆ¶ï¼Œé€šè¿‡ApplicationContextä¸­çš„é¢„é…ç½®beanæ¥æ„å»ºä½ æµ‹è¯•æ‰€éœ€è¦çš„èµ„æºç¯å¢ƒã€‚ä»–çš„æœ€å¤§å¥½å¤„æ˜¯æ¯ä¸ªæµ‹è¯•åœºæ™¯éƒ½å¯ä»¥å…±ç”¨ä¸€ä¸ªApplicationContextï¼Œé¿å…ä¸€æ¬¡æµ‹è¯•èµ·ä¸€æ¬¡ç¯å¢ƒ\nç°åœ¨å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªç±»HibernateTitleRepositoryï¼Œä»–å®ç°äº†Titleé¢†åŸŸå®ä½“ï¼ˆdomain entity)çš„æ•°æ®è®¿é—®é€»è¾‘ã€‚æˆ‘ä»¬æƒ³å†™ä¸€ä¸ªé›†æˆæµ‹è¯•ä»¥æµ‹è¯•ä¸‹é¢å‡ ä¸ªæ–¹é¢ï¼š\n Springçš„é…ç½®ï¼šæ‰€æœ‰HibernateTitleRepositoryç›¸å…³çš„é…ç½®æ˜¯å¦æ­£ç¡®å…³è”å’Œå±•ç¤ºï¼Ÿ Hibernateçš„æ˜ å°„æ–‡ä»¶é…ç½®ï¼šæ˜ å°„æ˜¯å¦æ­£ç¡®å¹¶ä¸”å»¶è¿ŸåŠ è½½çš„é…ç½®æ˜¯å¦åˆ°ä½ï¼Ÿ HibernateTitleRepositoryçš„é€»è¾‘ï¼šè¯¥ç±»é…ç½®å®ä¾‹çš„è¿è¡Œæ˜¯å¦ç¬¦åˆé¢„æœŸï¼Ÿ  ä¾èµ–æ³¨å…¥çš„è¯¦ç»†å†…å®¹åé¢ä¼šè®²åˆ°\n2.3. äº‹åŠ¡ç®¡ç† åœ¨æµ‹è¯•ä¸­è®¿é—®çœŸå®æ•°æ®åº“çš„ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯æµ‹è¯•å¯¹æŒä¹…æ€§å­˜å‚¨çŠ¶æ€çš„å½±å“ã€‚å³ä½¿ä½ ä½¿ç”¨çš„æ˜¯å¼€å‘æ•°æ®åº“ï¼Œæ›´æ”¹çŠ¶æ€ä¹Ÿå¯èƒ½ä¼šå½±å“åˆ°è¿›ä¸€æ­¥çš„æµ‹è¯•ã€‚è¿˜æœ‰è®¸å¤šæ“ä½œä¾‹å¦‚æ’å…¥æˆ–è€…ä¿®æ”¹æŒä¹…æ•°æ®ï¼Œæ²¡æœ‰äº‹åŠ¡éƒ½æ˜¯ä¸èƒ½è¿è¡Œçš„\nTestContextæ¡†æ¶è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¡†æ¶ä¼šä¸ºæ¯æ¬¡æµ‹è¯•åˆ›å»ºå’Œå›æ»šäº‹åŠ¡ã€‚ä½ å¯ä»¥åœ¨å‡å®šæœ‰äº‹åŠ¡çš„å‰æä¸‹å†™æµ‹è¯•ä»£ç ã€‚å¦‚æœä½ åœ¨æµ‹è¯•ä¸­è°ƒç”¨äº‹åŠ¡çš„ä»£ç†å¯¹è±¡ï¼Œæ ¹æ®ä»–ä»¬é…ç½®çš„äº‹åŠ¡è¯­å¥ï¼Œå†³å®šä»–ä»¬æ˜¯å¦èƒ½æ­£å¸¸è¿è½¬ã€‚å¦å¤–ï¼Œå¦‚æœä¸€ä¸ªæµ‹è¯•æ–¹æ³•åœ¨äº‹åŠ¡ç®¡ç†çš„èŒƒå›´å†…åˆ é™¤äº†é€‰ä¸­è¡¨çš„å†…å®¹ï¼Œé»˜è®¤æƒ…å†µä¸‹äº‹åŠ¡ä¼šå›æ»šï¼Œæ•°æ®åº“ä¼šè¿”å›åˆ°æ‰§è¡Œæµ‹è¯•ä¹‹å‰çš„çŠ¶æ€ã€‚ä¸ºæµ‹è¯•æä¾›çš„äº‹åŠ¡æ”¯æŒæ˜¯ç”±PlatformTransactionManagerbeanæ¥æä¾›çš„\nå¦‚æœä½ æƒ³æäº¤ä¸€ä¸ªäº‹åŠ¡ï¼ˆä¸€èˆ¬æ¥è¯´ä¸ä¼šï¼Œåœ¨ä½ æƒ³å¡«å……æˆ–è€…ä¿®æ”¹æ•°æ®åº“çš„æ—¶å€™æœ‰ç”¨ï¼‰ï¼Œä½ å¯ä»¥é€šè¿‡TestContextæ¡†æ¶æ¥æäº¤äº‹åŠ¡ä»¥ä»£æ›¿ä½¿ç”¨@Commitæ³¨è§£çš„å›æ»š\nè¯¦ç»†å†…å®¹åé¢ä¼šè®²åˆ°\n2.4. é›†æˆæµ‹è¯•çš„æ”¯æŒç±» TestContextæ¡†æ¶æä¾›äº†å¤šä¸ªæŠ½è±¡æ”¯æŒç±»ï¼Œä»–ä»¬ç®€åŒ–äº†é›†æˆæµ‹è¯•çš„ç¼–å†™ã€‚è¿™äº›åŸºç¡€æµ‹è¯•ç±»ä¸ºæµ‹è¯•æ¡†æ¶æä¾›äº†å®šä¹‰æ˜ç¡®çš„é’©å­å’Œæ–¹ä¾¿çš„å®ä¾‹å‚æ•°å’Œæ–¹æ³•ï¼Œä»–ä»¬èƒ½è®©ä½ è®¿é—®ï¼š\n ApplicationContextï¼Œç”¨äºæ‰§è¡Œæ˜¾å¼çš„beanæŸ¥æ‰¾æˆ–è€…æµ‹è¯•æ•´ä¸ªä¸Šä¸‹æ–‡çš„çŠ¶æ€ã€‚ JdbcTemplateï¼Œç”¨äºæ‰§è¡Œsqlè¡¨è¾¾å¼ã€‚ä½ å¯ä»¥æŸ¥è¯¢æ•°æ®åº“ç›¸å…³åº”ç”¨ä»£ç æ‰§è¡Œå‰åçš„æ•°æ®åº“çŠ¶æ€ï¼Œå¹¶ä¸”Springç¡®ä¿è¿™äº›æŸ¥è¯¢éƒ½åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚å…šå’ŒORMæ¡†æ¶é…åˆä½¿ç”¨æ—¶ï¼Œéœ€è¦ç¡®ä¿é¿å…false positives  å¦å¤–ä½ å¯èƒ½æƒ³åˆ›å»ºä½ è‡ªå®šä¹‰çš„æ”¯æŒç±»ï¼Œæ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒTestContext framework\n3. JDBCæµ‹è¯•çš„æ”¯æŒ JDBCç›¸å…³çš„å·¥å…·æ–¹æ³•åœ¨ç±»JdbcTestUtilsç±»ä¸­ï¼Œä»–åœ¨org.springframework.test.jdbcåŒ…ä¸‹ã€‚å®ƒç®€åŒ–äº†æ ‡å‡†çš„æ•°æ®åº“æµ‹è¯•åœºæ™¯ã€‚JdbcTestUtilsæä¾›äº†ä»¥ä¸‹é™æ€çš„å·¥å…·æ–¹æ³•ï¼š\n countRowsInTable(..):è®¡ç®—æŒ‡å®šè¡¨æœ‰å¤šå°‘è¡Œæ•°æ® countRowsInTableWhere(..):è®¡ç®—æŒ‡å®šè¡¨æœ‰å¤šå°‘è¡Œæ•°æ®é€šè¿‡æä¾›çš„whereæ¡ä»¶è¿›è¡Œé™åˆ¶ deleteFromTables(..):åˆ é™¤æŒ‡å®šè¡¨çš„æ‰€æœ‰è¡Œ deleteFromTableWhere(..):åˆ é™¤æŒ‡å®šè¡¨çš„æ•°æ®è¡Œé€šè¿‡æä¾›çš„whereæ¡ä»¶è¿›è¡Œé™åˆ¶ dropTables(..):DropæŒ‡å®šè¡¨   AbstractTransactionalJUnit4SpringContextTestså’ŒAbstractTransactionalTestNGSpringContextTestsä»£ç†äº†å‰é¢æåŠçš„JdbcTestUtilsç±»çš„æ–¹æ³•ã€‚\nspring-jdbcæ¨¡å—æ”¯æŒé…ç½®å’Œå¯åŠ¨ä¸€ä¸ªé›†æˆçš„æ•°æ®åº“ï¼Œä½ å¯ä»¥ç”¨å®ƒè¿›è¡Œé›†æˆæµ‹è¯•ã€‚æ›´å¤šç»†èŠ‚ï¼Œå‚è€ƒEmbedded Database Support å’Œ Testing Data Access Logic with an Embedded Database\n 4. æ³¨è§£ è¿™ä¸ªç« èŠ‚ä»‹ç»ä½ åœ¨æµ‹è¯•Springåº”ç”¨æ—¶å¯ä»¥ç”¨çš„æ³¨è§£ã€‚å®ƒåŒ…å«å¦‚ä¸‹å‡ ä¸ªä¸»é¢˜ï¼š\n Spring æµ‹è¯•æ³¨è§£ æ ‡å‡†æ³¨è§£æ”¯æŒ Spring JUnit 4 æµ‹è¯•æ³¨è§£ Spring JUnit Jupiter æµ‹è¯•æ³¨è§£ æµ‹è¯•å…ƒæ³¨è§£  4.1. Spring æµ‹è¯•æ³¨è§£ Springæ¡†æ¶æä¾›äº†å¦‚ä¸‹Springç‰¹æœ‰çš„æ³¨è§£ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»–ä»¬åœ¨ä½ çš„å•å…ƒå’Œé›†æˆæµ‹è¯•ä¸­ã€‚æŸ¥çœ‹ä»–ä»¬å¯¹åº”çš„javadocä»¥æŸ¥æ‰¾æ›´å¤šä¿¡æ¯ï¼ŒåŒ…æ‹¬é»˜è®¤çš„å±æ€§å€¼ï¼Œå±æ€§åˆ«åï¼Œå’Œå…¶ä»–ç»†èŠ‚ã€‚\nSpringæµ‹è¯•æ³¨è§£åŒ…æ‹¬ï¼š\n @BootstrapWith @ContextConfiguration @WebAppConfiguration @ContextHierarchy @ActiveProfiles @TestPropertySource @DynamicPropertySource @DirtiesContext @TestExecutionListeners @Commit @Rollback @BeforeTransaction @AfterTransaction @Sql @SqlConfig @SqlMergeMode @SqlGroup  @BoostrapWith @BootstrapWithæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒé…ç½®Spring TestContextæ¡†æ¶æ˜¯æ€æ ·å¼•å¯¼å¯åŠ¨çš„ã€‚å…·ä½“å¯ä»¥ä½¿ç”¨@BootstrapWithå»æŒ‡å®šä¸€ä¸ªè‡ªå®šçš„TestContextBootstrapperã€‚æŸ¥çœ‹bootstrapping the TestContext framework ä»¥è·å–è¯¦ç»†ä¿¡æ¯\n@ContextConfiguration @ContextConfiguration å®šä¹‰ç±»çº§åˆ«çš„æºæ•°æ®ï¼Œå¸¸ç”¨æ¥å†³å®šé›†æˆæµ‹è¯•å¦‚ä½•åŠ è½½å’Œé…ç½®ä¸€ä¸ªApplicationContextã€‚å…·ä½“çš„ï¼Œå¯ä»¥ä½¿ç”¨@ContextConfigurationå£°æ˜åº”ç”¨ä¸Šä¸‹æ–‡çš„èµ„æºä½ç½®ï¼Œæˆ–è€…ç”¨äºåŠ è½½ä¸Šä¸‹æ–‡çš„ç»„ä»¶ç±»\nèµ„æºä½ç½®ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯åœ¨classpathè·¯å¾„ä¸‹çš„XMLçš„é…ç½®æ–‡ä»¶æˆ–è€…Groovyçš„è„šæœ¬ï¼Œè€Œç»„ä»¶ç±»ä¸€èˆ¬æ¥è¯´æ˜¯@Configurationæ³¨è§£çš„ç±»ã€‚ä½†æ˜¯ï¼Œèµ„æºä½ç½®å¯ä»¥å¼•ç”¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å’Œè„šæœ¬ï¼Œå¹¶ä¸”ç»„ä»¶ç±»å¯ä»¥æ˜¯@Componentç±»ï¼Œ@Serviceç±»ï¼Œå…¶ä»–ç­‰ç­‰ã€‚æ›´å¤šå‚ç…§Component Classes\nä¸‹é¢çš„ä¾‹å­@ContextConfigurationæ³¨è§£æŒ‡å‘äº†ä¸€ä¸ªXMLæ–‡ä»¶ï¼š\n@ContextConfiguration(\u0026quot;/test-config.xml\u0026quot;)\rclass XmlApplicationContextTests{}\r ä¸‹é¢çš„ä¾‹å­@ContextConfigurationæŒ‡å‘ä¸€ä¸ªç±»ï¼š\n@ContextConfiguration(classes = TestConfig.class)\rclass ConfigClassApplicationContextTests{}\r å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨@ContextConfigurationå£°æ˜ApplicationContextInitializerç±»ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿå¯ä»¥å£°æ˜èµ„æºä½ç½®å’Œç»„ä»¶ç±»ï¼š\n@ContextConfiguration(initializers = CustomContextIntializer.class)\rclass ContextInitializerTests{}\r ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ContextConfigurationç”³æ˜ContextLoaderçš„æ–¹å¼ä¹Ÿè¡Œã€‚æ³¨æ„ï¼Œä½ é€šå¸¸ä¸éœ€è¦æ˜¾å¼çš„é…ç½®loaderï¼Œå› ä¸ºé»˜è®¤çš„loaderæ”¯æŒinitializerså’Œèµ„æºä½ç½®æˆ–ç»„ä»¶ç±»ã€‚\nä¸‹é¢çš„ä¾‹å­åŒæ—¶å£°æ˜äº†ä¸€ä¸ªèµ„æºä½ç½®å’Œä¸€ä¸ªloader:\n@ContextConfiguration(locations=\u0026quot;/test-context.xml\u0026quot;,loader=CustomContextLoader.class)\rclass CustomLoaderXmlApplicationContextTests{}\r  @ContextConfigurtionå¯¹ç»§æ‰¿èµ„æºä½ç½®æˆ–è€…é…ç½®ç±»æä¾›äº†æ”¯æŒï¼Œè¿˜æœ‰ç”±çˆ¶ç±»æˆ–è€…å°é—­ç±»å£°æ˜çš„context initializers\n è¯¦æƒ…å‚è€ƒ Context Management ,@Nested test class configuration ä»¥åŠ@ContextConfigurationçš„APIæ–‡æ¡£\n@WebAppConfiguration @WebAppConfigurationæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ï¼Œå®ƒèƒ½å°†ä¸ºé›†æˆæµ‹è¯•å£°æ˜çš„ApplicationContextæŒ‡å®šä¸ºWebApplicationContextã€‚WebAppConfigurationæ³¨è§£ä»…ä»…åœ¨æµ‹è¯•ç±»ä¸Šå­˜åœ¨ï¼Œä¸ºç¡®ä¿WebApplicationContextæ˜¯ä¸ºæµ‹è¯•åŠ è½½ï¼Œä½¿ç”¨é»˜è®¤å€¼file:src/main/webappä½œä¸ºwebåº”ç”¨çš„æ ¹è·¯å¾„ï¼ˆèµ„æºä»“åº“è·¯å¾„ï¼‰ã€‚èµ„æºä»“åº“è·¯å¾„ç”¨äºåœ¨åå°åˆ›å»ºMockServletContextï¼Œå®ƒè¢«ç”¨ä½œWebApplicationContextçš„ServletContext\nä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨@WebAppConfigurationæ³¨è§£ï¼š\n@ContextConfiguration\r@WebAppConfiguration\rclass WebAppTests{}\r å¦‚æœä½ çš„èµ„æºä»“åº“è·¯å¾„ä¸æ˜¯é»˜è®¤çš„file:src/main/webappï¼Œä½ å¯ä»¥æŒ‡å®šä½ è‡ªå·±çš„èµ„æºä»“åº“è·¯å¾„ï¼Œä½¿ç”¨é»˜è®¤çš„valueå±æ€§ã€‚å¯ä»¥æ”¯æŒclasspath:å’Œfile:èµ„æºå‰ç¼€ã€‚å¦‚æœæ²¡æœ‰æä¾›èµ„æºå‰ç¼€ï¼Œè¿™ä¸ªè·¯å¾„ä¼šè¢«å‡å®šä½æ–‡ä»¶ç³»ç»Ÿèµ„æºã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†æ€æ ·æŒ‡å®šä¸€ä¸ªclasspathèµ„æºï¼š\n@ContextConfiguration\r@WebAppConfiguration(\u0026quot;classpath:test-web-resources\u0026quot;)\rclass WebAppTests{}\r æ³¨æ„WebAppConfigurationå¿…é¡»ä¸ContextConfigurationé…åˆä½¿ç”¨ï¼Œä¸ç®¡åœ¨å•ä¸ªæµ‹è¯•ç±»è¿˜æ˜¯ä¸€ä¸ªæµ‹è¯•ç±»çš„å±‚æ¬¡ç»“æ„ä¸­ã€‚è¯¦æƒ…å‚è€ƒ@WebAppConfiguration APIæ–‡æ¡£\n@ContextHierarchy å®ƒæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ï¼Œä¸ºé›†æˆæµ‹è¯•å®šä¹‰ApplicationContextå®ä¾‹çš„å±‚æ¬¡ç»“æ„ã€‚@ContextHierarchyåº”è¯¥ç”±ä¸€ä¸ª@ContextConfigurationçš„å®ä¾‹é›†åˆæ¥ç”³æ˜ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªéƒ½å®šä¹‰contextå±‚çº§å…³ç³»ä¸­çš„ä¸€çº§ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†@ContextHierarchyåœ¨å•ä¸ªæµ‹è¯•ç±»ä¸­çš„çš„ä½¿ç”¨ï¼ˆå®ƒä¹Ÿå¯ä»¥ç”¨åœ¨ä¸€ä¸ªæµ‹è¯•ç±»çš„å±‚æ¬¡ç»“æ„ä¸­ï¼‰\n@ContextHierarchy({\r@ContextConfiguration(\u0026quot;/parent-config.xml\u0026quot;),\r@ContextConfiguration(\u0026quot;/child-config.xml\u0026quot;)\r})\rclass ContextHierarchyTests{}\r @WebAppConfiguration\r@ContextHierarchy({\r@ContextConfiguration(classes = AppConfig.class),\r@ContextConfiguration(classes = WebConfig.class)\r})\rclass WebIntegrationTests{}\r å¦‚æœä½ éœ€è¦åœ¨æµ‹è¯•ç±»çš„å±‚æ¬¡ç»“æ„ä¸­å¯¹æŒ‡å®šå±‚çº§çš„é…ç½®è¿›è¡Œåˆå¹¶æˆ–è€…é‡å†™ï¼Œé‚£ä¹ˆéœ€è¦ä¸€ä¸ªåˆ«åå€¼æ¥å¯¹åº”å±‚çº§ï¼Œåœ¨è®¾ç½®@ContextHierarchyçš„æ¯ä¸ª@ContextConfigurationå±‚çº§æ—¶ï¼Œéœ€è¦ç»™ä»–ä»¬æŒ‡æ˜å‚æ•°nameçš„å€¼ã€‚è¯¦æƒ…å‚è€ƒContext Hierarchies å’Œ@ContextHierarchy apiæ–‡æ¡£\n@ActiveProfiles å®ƒæ˜¯ç±»çº§åˆ«çš„æ³¨è§£ï¼Œå½“ä¸ºç»§æ‰¿æµ‹è¯•åŠ è½½ApplicationContextæ—¶ç”¨æ¥å£°æ˜å¯ç”¨å“ªäº›beanå®šä¹‰é…ç½®æ–‡ä»¶\nä¸‹é¢çš„ä¾‹å­è¡¨ç¤ºå¯ç”¨äº†devé…ç½®æ–‡ä»¶ï¼š\n@ContextConfiguration\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\rclass DeveloperTests{}\r ä¸‹é¢çš„ä¾‹å­è¡¨ç¤ºdevå’Œintegrationé…ç½®æ–‡ä»¶éƒ½åº”è¯¥å¯ç”¨ï¼š\n@ContextConfiguration\r@ActiveProfiles({\u0026quot;dev\u0026quot;,\u0026quot;integration\u0026quot;})\rclass DeveloperIntegrationTests{}\r  é»˜è®¤æƒ…å†µä¸‹@ActiveProfilesæ˜¯æ”¯æŒç»§æ‰¿çˆ¶ç±»æˆ–è€…å°é—­ç±»çš„é…ç½®ä¿¡æ¯çš„ã€‚ä½ å¯ä»¥å®Œå…¨è‡ªå®šä¹‰è§£ææ¿€æ´»é…ç½®æ–‡ä»¶é€šè¿‡å®ç°ActiveProfilesResolverï¼Œå¹¶ä½¿ç”¨@ActiveProfilesçš„å±æ€§resolveræ¥æ³¨å†Œã€‚\n è¯¦æƒ…å‚è€ƒContext Configuration with Environment Profiles ,@Nested test class configuration ,ä»¥åŠ@ActiveProfiles\n@TestPropertySource å®ƒæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥é…ç½®å±æ€§æ–‡ä»¶å’Œå†…è”å±æ€§çš„ä½ç½®ï¼Œæœ€åæ·»åŠ åˆ°PropertySourcesé›†åˆä¸­ï¼Œè¿™ä¸ªé›†åˆåœ¨ApplicationContextçš„Environmentä¸­ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†æ€æ ·å£°æ˜ä¸€ä¸ªæ¥è‡ªclasspathçš„å±æ€§æ–‡ä»¶:\n@ContextConfiguration\r@TestPropertySource(\u0026quot;/test.properties\u0026quot;)\rclass MyIntegrationTests{}\r ä¸‹é¢çš„ä¾‹å­å±•ç¤ºæ€æ ·å£°æ˜å†…è”å±æ€§ï¼š\n@ContextConfiguraiton\r@TestPropertySource(properties = {\u0026quot;timezone = GMT\u0026quot;, \u0026quot;port: 4242\u0026quot;})\rclass MyIntegrationTests{}\r è¯¦æƒ…å‚è€ƒContext Configuration with Test Property Sources\n@DynamicPropertySource å®ƒæ˜¯ä¸€ä¸ªæ–¹æ³•çº§åˆ«çš„æ³¨è§£ï¼Œä»–å¯ä»¥æ³¨å†ŒåŠ¨æ€å±æ€§ï¼Œè·Ÿ@TestPropertySourceä¸€æ ·ï¼Œä¹Ÿæ˜¯æ·»åŠ åˆ°PropertySourcesé›†åˆä¸­ã€‚å½“ä½ ä¸èƒ½æå‰åˆ¤æ–­å±æ€§å€¼æ—¶ï¼Œå¯ä»¥é€šè¿‡åŠ¨æ€å±æ€§æ¥è®¾ç½®-ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœå±æ€§æ˜¯äº¤ç”±å¤–éƒ¨èµ„æºç®¡ç†çš„ï¼Œæ¯”å¦‚é€šè¿‡TestContainers æ¥è¿›è¡Œçš„å®¹å™¨ç®¡ç†ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•æ³¨å†Œä¸€ä¸ªåŠ¨æ€å±æ€§ï¼š\n@ContextConfiguration\rclass MyIntegrationTests{\rstatic MyExternalServer server = // ...\r@DynamicPropertySource\rstatic void dynamicProperties(DynamicPropertyRegistry registry){\rregistry.add(\u0026quot;server.port\u0026quot;,server::getPort);\r}\r}\r è¯¦æƒ…å‚è€ƒContext Configuration with Dynamic Property Sources\n@DirtiesContext è¿™ä¸ªæ³¨è§£è¡¨ç¤ºåº•å±‚çš„SpringApplicationContextåœ¨æ‰§è¡Œæµ‹è¯•çš„æ—¶å€™è¢«æ±¡æŸ“äº†ï¼ˆæ„æ€å°±æ˜¯ï¼Œæµ‹è¯•çš„æ—¶å€™ä»¥æŸç§æ–¹å¼ä¿®æ”¹æˆ–è€…æ±¡æŸ“äº†ApplicationContext-æ¯”å¦‚è¯´ï¼Œæ”¹å˜å•ä¾‹beançš„çŠ¶æ€ï¼‰ï¼Œå¹¶ä¸”éœ€è¦å…³é—­è¿™ä¸ªcontextã€‚å½“ä¸€ä¸ªåº”ç”¨ä¸Šä¸‹æ–‡è¢«dirtyæ ‡è®°ï¼Œä¼šè¢«æµ‹è¯•æ¡†æ¶ä»ç¼“å­˜ä¸­ç§»é™¤å¹¶å…³é—­ã€‚åœ¨æœ€åï¼Œå¦‚æœè¿˜æœ‰å…¶ä»–æµ‹è¯•éœ€è¦è¿™ä¸ªcontextï¼ŒSpringå®¹å™¨ä¼šé‡æ–°æ„å»ºã€‚\nä½ å¯ä»¥ä½¿ç”¨è¯¥æ³¨è§£åœ¨ç±»çº§åˆ«æˆ–è€…æ–¹æ³•çº§åˆ«ï¼Œåœ¨åŒä¸€ä¸ªç±»ä¸­æˆ–è€…ç±»çš„å±‚æ¬¡ç»“æ„ä¸­ã€‚ä½ å¯ä»¥æ ‡è®°ApplicationContextæ˜¯åœ¨æ–¹æ³•å‰åè¿˜æ˜¯åœ¨ç±»å‰åè¢«æ±¡æŸ“çš„ï¼Œé€šè¿‡methodModeå’ŒclassModeæ¥é…ç½®ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å‡ ä¸ªä¸åŒåœºæ™¯çš„ä½¿ç”¨æ–¹æ¡ˆï¼š\n åœ¨å½“å‰çš„æµ‹è¯•ç±»ä¹‹å‰ï¼Œé€šè¿‡å£°æ˜classModeä¸ºBEFORE_CLASS  @DirtiesContext(classMode = BEFORE_CLASS)\rclass FetchContextTests{}\r  åœ¨å½“å‰çš„æµ‹è¯•ç±»ä¹‹åï¼Œé€šè¿‡å£°æ˜classModeä¸ºAFTER_CLASS(é»˜è®¤çš„classMode)  @DirtiesContext\rclass FetchContextTests{}\r  åœ¨å½“å‰æµ‹è¯•ç±»çš„æ¯ä¸ªæµ‹è¯•æ–¹æ³•ä¹‹å‰ï¼Œé€šè¿‡å£°æ˜classModeä¸ºBEFORE_EACH_TEST_METHOD  @DirtiesContext(classMode = BEFORE_EACH_TEST_METHOD)\rclass FreshContextTests{\r}\r  åœ¨å½“å‰æµ‹è¯•ç±»çš„æ¯ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œåï¼Œé€šè¿‡å£°æ˜classModeä¸ºAFTER_EACH_TEST_METHOD  @DirtiesContext(classMode = AFTER_EACH_TEST_METHOD)\rclass ContextDirtyingTests{}\r  åœ¨å½“å‰æµ‹è¯•ä¹‹å‰ï¼Œé€šè¿‡åœ¨æ–¹æ³•ä¸Šç”³æ˜methodModeä¸ºBEFORE_METHOD  @Test\r@DirtiesContext(methodMode = BEFORE_METHOD)\rvoid testProcessWhichRequiresFreshAppCtx(){}\r  åœ¨å½“å‰æµ‹è¯•ä¹‹åï¼Œé€šè¿‡åœ¨æ–¹æ³•ä¸Šå£°æ˜methodModeä¸ºAFTER_METHOD(é»˜è®¤çš„æ–¹æ³•æ¨¡å¼)  @DirtiesContext\r@Test\rvoid testProcessWhichDirtiesAppCtx(){}\r å¦‚æœ@DirtiesContextæ³¨è§£ä¿®é¥°çš„æµ‹è¯•contextï¼Œæ˜¯@ContextHierarchyæ³¨è§£å±‚æ¬¡ç»“æ„ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä½ å¯ä»¥ä½¿ç”¨hierarchyModeå±æ€§å»æ§åˆ¶contextç¼“å­˜å¦‚ä½•æ¸…é™¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªè¯¦å°½çš„ç®—æ³•ä¼šç”¨æ¥æ¸…é™¤contextç¼“å­˜ï¼ŒåŒ…æ‹¬çš„ä¸ä»…æ˜¯å½“å‰å±‚çº§ï¼Œè¿˜æœ‰æ‰€æœ‰å…¶ä»–å…±äº«äº†åŒä¸€ä¸ªçˆ¶ç±»contextçš„å­å±‚çº§ï¼Œå­å±‚çº§çš„æ‰€æœ‰ApplicationContextå®ä¾‹éƒ½ä¼šä»ç¼“å­˜ä¸­ç§»é™¤å¹¶å…³é—­ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœä½ è§‰å¾—é»˜è®¤çš„ç®—æ³•æ¸…æ¥šçš„èŒƒå›´å¤ªå¹¿ï¼Œä½ å¯ä»¥æŒ‡å®šæ›´ç®€å•çš„å½“å‰å±‚çº§ç®—æ³•ï¼š\n@ContextHierarchy({\r@ContextConfiguration(\u0026quot;/parent-config.xml\u0026quot;),\r@ContextConfiguration(\u0026quot;/child-config.xml\u0026quot;)\r})\rclass BaseTest{}\rclass ExtendedTests extends BaseTest{\r@Test\r@DirtiesContext(hierarchyMode=CURRENT_LEVEL)\rvoid test(){}\r}\r æ›´å¤šå…³äºEXHAUSTIVEå’ŒCURRENT_LEVELç®—æ³•çš„é—®é¢˜ï¼Œå¯ä»¥å‚è€ƒDirtiesContext.HierarchyMode\n@TestExecutionListeners å®ƒå®šä¹‰äº†ç”¨æ¥é…ç½®TestExecutionListenerå®ç°çš„ç±»çº§åˆ«å…ƒæ•°æ®(TestExecutionListenerå®ç°æ˜¯ç”±TestContextManageræ¥æ³¨å†Œçš„)ã€‚ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯é…åˆ@ContextConfigurationæ¥ä½¿ç”¨ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•æ³¨å†Œä¸¤ä¸ªTestExecutionListenerå®ç°\n@ContextConfiguration\r@TestExecutionListeners({CustonTestExecutionListener.class,AnotherTestExecutionListerner.class})\rclass CustomTestExecutionListenerTests {}\r é»˜è®¤æƒ…å†µä¸‹ï¼Œ@TestExecutionListenersæ˜¯æ”¯æŒä»çˆ¶ç±»ç»§æ‰¿çš„ï¼Œæˆ–è€…å†…éƒ¨ç±»ä»å¤–éƒ¨å°é—­ç±»ç»§æ‰¿ã€‚è¯¦æƒ…å‚è€ƒ@Nested test class configuration å’Œ@TestExecutionListeners javadoc\n@Commit @Commitä»£è¡¨æµ‹è¯•æ–¹æ³•çš„äº‹åŠ¡ä¼šåœ¨æµ‹è¯•æ–¹æ³•å®Œæˆåæäº¤ã€‚ä½ å¯ä»¥å°†@Commitæ›¿æ¢ä¸º@Rollback(false)ã€‚@Commitå’Œ@Rollbackç›¸ä¼¼ï¼Œéƒ½å¯ä»¥å£°æ˜åœ¨ç±»æˆ–æ–¹æ³•ä¸Šã€‚\nä½¿ç”¨å®ä¾‹ï¼š\n@Commit\r@Test\rvoid testProcessWithoutRollback(){\r}\r @Rollback @Rollbackä»£è¡¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œå®Œåï¼Œæ˜¯å¦å›æ»šäº‹åŠ¡ã€‚ä¸ºtrueåˆ™å›æ»šï¼Œå¦åˆ™äº‹åŠ¡ä¼šæäº¤ï¼ˆè·Ÿ@Commitä¸€æ ·ï¼‰ã€‚è¯¥æ³¨è§£çš„é»˜è®¤å€¼ä¸ºtrueï¼Œå°±ç®—æ²¡æœ‰å£°æ˜è¯¥æ³¨è§£ï¼Œäº‹åŠ¡é»˜è®¤ä¹Ÿä¼šå›æ»šã€‚\nå½“ç”³æ˜åœ¨ç±»ä¸Šæ—¶ï¼Œ@Rollbackæ³¨è§£å°†ä¼šå½±å“ç±»çš„æ‰€æœ‰æµ‹è¯•æ–¹æ³•ï¼Œå½“ç”³æ˜åœ¨æ–¹æ³•æ—¶ï¼Œåªä¼šå½±å“æŒ‡å®šæ–¹æ³•ï¼Œå¹¶ä¼šè¦†ç›–ç±»ä¸Šçš„å…¨å±€@Rollbackæˆ–@Commité…ç½®\nä½¿ç”¨å®ä¾‹ï¼š\n@Test\r@Rollback(false)\rvoid testProcessWithoutRollback(){\r}\r @BeforeTransaction å®ƒä»£è¡¨æ³¨è§£çš„voidæ–¹æ³•åº”è¯¥åœ¨äº‹åŠ¡å¯åŠ¨ä¹‹å‰è¿è¡Œï¼Œå¯¹æµ‹è¯•æ–¹æ³•æ¥è¯´ï¼Œå®ƒå·²ç»è¢«é…ç½®å¥½äº†åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œï¼Œæ˜¯é€šè¿‡ä½¿ç”¨Springçš„@Transactionalæ³¨è§£æ¥å®ç°çš„ã€‚@BeforeTransactionæ–¹æ³•æ˜¯ä¸éœ€è¦publicä¿®é¥°çš„ï¼Œå¹¶ä¸”å¯ä»¥å£°æ˜åœ¨java8çš„æ¥å£é»˜è®¤æ–¹æ³•ä¸Šã€‚\nä½¿ç”¨å®ä¾‹ï¼š\n@BeforeTransaction\rvoid beforeTransaction(){}\r @AfterTransaction å®ƒä»£è¡¨æ³¨è§£çš„voidæ–¹æ³•åº”è¯¥åœ¨äº‹åŠ¡ç»“æŸåè¿è¡Œï¼Œå¯¹æµ‹è¯•æ–¹æ³•æ¥è¯´ï¼Œå®ƒå·²ç»è¢«é…ç½®å¥½äº†åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œï¼Œæ˜¯é€šè¿‡ä½¿ç”¨Springçš„@Transactionalæ³¨è§£æ¥å®ç°çš„ã€‚@AfterTransactionæ–¹æ³•æ˜¯ä¸éœ€è¦publicä¿®é¥°çš„ï¼Œå¹¶ä¸”å¯ä»¥å£°æ˜åœ¨java8çš„æ¥å£é»˜è®¤æ–¹æ³•ä¸Šã€‚\n@AfterTransaction\rvoid afterTransaction(){}\r @Sql å®ƒæ˜¯ç”¨æ¥é…ç½®æµ‹è¯•ç±»æˆ–è€…æ–¹æ³•éœ€è¦çš„sqlè„šæœ¬çš„ã€‚\n@Test\r@Sql({\u0026quot;/test-schema.sql\u0026quot;,\u0026quot;/test-user-data.sql\u0026quot;})\rvoid userTest(){}\r è¯¦æƒ…å‚è€ƒExecuting SQL scripts declaratively with @Sql\n@SqlConfig å®ƒç”¨æ¥é…ç½®å¦‚ä½•è§£æå’Œæ‰§è¡Œ@Sqlæ³¨è§£é…ç½®çš„è„šæœ¬ã€‚\n@Test\r@Sql(\rscripts = \u0026quot;/test-user-data.sql\u0026quot;,\rconfig = @SqlConfig(commentPrefix = \u0026quot;`\u0026quot;, separator = \u0026quot;@@\u0026quot;)\r)\rvoid userTest(){}\r @SqlMergeMode å®ƒæ˜¯ç”¨æ¥è®¾ç½®@Sqlæ³¨è§£çš„æ–¹æ³•å’Œç±»çš„sqlè„šæœ¬æ˜¯å¦èåˆåœ¨ä¸€èµ·ã€‚å¦‚æœç±»å’Œæ–¹æ³•ä¸Šéƒ½æ²¡æœ‰@SqlMergeModeæ³¨è§£ï¼Œé‚£ä¹ˆé»˜è®¤çš„OVERRIDEæ¨¡å¼å°†ä¼šè¢«ä½¿ç”¨ã€‚åœ¨OVERRIDEæ¨¡å¼ä¸‹ï¼Œæ–¹æ³•ä¸Šå£°æ˜çš„@Sqlä¼šè¦†ç›–æ‰ç±»ä¸Šçš„@Sqlå£°æ˜ã€‚\næ³¨æ„æ–¹æ³•ä¸Šçš„@SqlMergeModeå£°æ˜ä¼šè¦†ç›–ç±»ä¸Šçš„å£°æ˜ã€‚\nä½œç”¨åœ¨ç±»ä¸Šï¼š\n@SpringJunitConfig(TestConfig.class)\r@Sql(\u0026quot;/test-schema.sql\u0026quot;)\r@SqlMergeMode\rclass UserTests{\r@Test\r@Sql(\u0026quot;/user-test-data-001.sql\u0026quot;)\rvoid standardUserProfile(){\r}\r}\r ä½œç”¨åœ¨æ–¹æ³•ä¸Šï¼š\n@SpringJUnitConfig(TestConfig.class)\r@Sql(\u0026quot;/test-schema.sql\u0026quot;)\rclass UserTests{\r@Test\r@Sql(\u0026quot;/user-test-data-001.sql\u0026quot;)\r@SqlMergeMode(MERGE)\rvoid standardUserProfile(){}\r}\r @SqlGroup å®ƒæ˜¯ä¸€ä¸ªå®¹å™¨æ³¨è§£ï¼Œå†…éƒ¨é›†æˆäº†å¤šä¸ª@Sqlæ³¨è§£ã€‚ä½ å¯ä»¥ä½¿ç”¨@SqlGroupç›´æ¥å£°æ˜å¤šä¸ªé›†æˆçš„@Sqlï¼Œæˆ–è€…ä½ å¯ä»¥é…åˆjava8å¯¹é‡å¤æ³¨è§£çš„æ”¯æŒæ¥ä½¿ç”¨ï¼Œ@Sqlå¯ä»¥åœ¨åŒä¸€ä¸ªç±»å’Œæ–¹æ³•ä¸Šå£°æ˜å¤šæ¬¡ï¼Œéšå¼çš„ç”Ÿæˆæ³¨è§£å®¹å™¨ã€‚\n@Test\r@SqlGroup({\r@Sql(scripts = \u0026quot;/test-schema.sql\u0026quot;,config = @SqlConfig(commentPrefix = \u0026quot;`\u0026quot;)),\r@Sql(\u0026quot;/test-user-data.sql\u0026quot;)\r})\rvoid userTest(){}\r 4.2. æ ‡å‡†æ³¨è§£æ”¯æŒ ä¸‹é¢çš„æ³¨è§£åœ¨ä»»ä½•é…ç½®çš„Spring TestContextæ¡†æ¶çš„æ ‡å‡†è¯­æ³•ä¸­éƒ½æ”¯æŒã€‚æ³¨æ„è¿™äº›æ³¨è§£å¹¶ä¸æ˜¯ä¸“é—¨ç”¨æ¥æµ‹è¯•çš„ï¼Œåœ¨Springæ¡†æ¶çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ã€‚\n @Autowired @Qualifier @Value @Resource(javax.annotation)å¦‚æœJSR-250å­˜åœ¨ @ManagedBean(javax.annotation)å¦‚æœJSR-250å­˜åœ¨ @Inject(javax.inject)å¦‚æœJSR-330å­˜åœ¨ @Named(javax.inject)å¦‚æœJSR-330å­˜åœ¨ @PersistenceContext(javax.persistence)å¦‚æœJPAå­˜åœ¨ @PersistenceUnit(javax.persistence)å¦‚æœJPAå­˜åœ¨ @Required @Transactional(org.springframework.transaction.annotation)éƒ¨åˆ†å±æ€§æ”¯æŒ   JSR-250ç”Ÿå‘½å‘¨æœŸæ³¨è§£\nåœ¨Spring TestContextæ¡†æ¶ä¸­ï¼Œä½ å¯ä»¥åœ¨ApplicationContextå†…éƒ¨é…ç½®çš„ä»»ä½•åº”ç”¨ç»„ä»¶ä¸Šä»¥æ ‡å‡†è¯­æ³•ä½¿ç”¨@PostConstructå’Œ@PreDestroyã€‚ä½†æ˜¯åœ¨å®é™…æµ‹è¯•ç±»ä¸­ï¼Œè¿™äº›ç”Ÿå‘½å‘¨æœŸæ³¨è§£è¿˜æ˜¯æœ‰ä½¿ç”¨é™åˆ¶çš„ã€‚\nå¦‚æœä¸€ä¸ªæ–¹æ³•åœ¨æµ‹è¯•ç±»ä¸­ï¼Œå¹¶ä¸”è¢«æ³¨è§£@PostConstructä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•ä¼šåœ¨åº•å±‚æµ‹è¯•æ¡†æ¶çš„æ‰€æœ‰beforeæ–¹æ³•ä¹‹å‰æ‰§è¡Œï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œä»»ä½•è¢«JUnit Jupiterçš„@BeforeEachæ³¨è§£ä¿®é¥°çš„æ–¹æ³•ï¼‰ï¼Œå¹¶ä¸”ä»–ä¼šè¢«åº”ç”¨åœ¨æµ‹è¯•ç±»ä¸­çš„æ¯ä¸ªæµ‹è¯•æ–¹æ³•ä¸Šã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•åœ¨æµ‹è¯•ç±»ä¸­è¢«@PreDestroyæ³¨è§£ä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æ°¸è¿œä¸ä¼šè¿è¡Œã€‚æ‰€ä»¥ï¼Œåœ¨ä¸€ä¸ªæµ‹è¯•ç±»ä¸­ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨æ¥è‡ªæµ‹è¯•æ¡†æ¶çš„ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒå‡½æ•°ï¼Œè€Œä¸æ˜¯@PostConstructå’Œ@PreDestroyã€‚\n 4.3. Spring JUnit 4 æµ‹è¯•æ³¨è§£ ä¸‹é¢çš„æ³¨è§£ä»…åœ¨ä¸ SpringRunner ï¼ŒSpring\u0026rsquo;s JUnit 4 rules ,æˆ–è€…Springâ€™s JUnit 4 support classes é…åˆä½¿ç”¨æ—¶æ‰æœ‰æ•ˆï¼š\n @IfProfileValue @ProfileValueSourceConfiguration @Timed @Repeat  IfProfileValue å®ƒä»£è¡¨æ³¨è§£ä¿®é¥°çš„æµ‹è¯•åªåœ¨æŒ‡å®šæµ‹è¯•ç¯å¢ƒç”Ÿæ•ˆã€‚å¦‚æœProfileValueSourceçš„å±æ€§valueè·Ÿnameçš„å€¼åŒ¹é…ï¼Œè¿™ä¸ªæµ‹è¯•æ‰ç”Ÿæ•ˆã€‚å¦åˆ™ï¼Œè¿™ä¸ªæµ‹è¯•ä¸ä¼šå¯ç”¨ã€‚\nä½ å¯ä»¥å£°æ˜IfProfileValueåœ¨ç±»æˆ–è€…æ–¹æ³•ä¸Šã€‚ç±»çº§åˆ«çš„ä½¿ç”¨ä¼˜å…ˆäºæ–¹æ³•çº§åˆ«çš„ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•æˆ–è€…æ‰€æœ‰å­ç±»çš„æ—¶å€™ã€‚è¦å¯ç”¨ä¸€ä¸ªæµ‹è¯•ï¼Œä»–çš„ç±»å’Œæ–¹æ³•éƒ½è¦æ˜¯å¯ç”¨çŠ¶æ€ï¼Œä½†æ˜¯åœ¨é»˜è®¤æ²¡æœ‰å£°æ˜IfProfileValueçš„æƒ…å†µä¸‹ï¼Œå°±ä»£è¡¨ç€å¯ç”¨çŠ¶æ€ã€‚JUnit4çš„@Ignoreæ³¨è§£è·Ÿå®ƒç±»ä¼¼ï¼Œé™¤äº†@Ignoreåªèƒ½ç”¨æ¥å±è”½æµ‹è¯•ã€‚\nä½¿ç”¨å®ä¾‹ï¼š\n@IfProfileValue(name = \u0026quot;java.vendor\u0026quot;, value=\u0026quot;Oracle Corporation\u0026quot;)\r@Test\rpublic void testProcessWithRunsOnlyOnOracleJvm(){}\r å¦å¤–ï¼Œä½ å¯ä»¥ä¸º@IfProfileValueé…ç½®ä¸€ä¸ªvaluesé›†åˆï¼Œå°±åƒTestNGåœ¨JUnit4ç¯å¢ƒæ”¯æŒæµ‹è¯•ç»„ä¸€æ ·ï¼š\n@Test\r@IfProfileValue(name = \u0026quot;test-groups\u0026quot;, values={\u0026quot;unit-tests\u0026quot;,\u0026quot;integration-tests\u0026quot;})\rpublic void testProcessWhichRunsForUnitOrIntegrationTestGroups(){}\r @ProfileValueSourceConfiguration å®ƒæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ï¼Œå®ƒæŒ‡å®šäº†å½“é€šè¿‡@IfProfileValueæ³¨è§£æ£€ç´¢é…ç½®å€¼çš„æ—¶å€™è¯¥ä½¿ç”¨ä»€ä¹ˆç±»å‹çš„ProfileValueSourceã€‚å¦‚æœè¯¥æ³¨è§£æ²¡æœ‰åœ¨æµ‹è¯•ä¸Šå£°æ˜ï¼ŒSystemProfileValueSourceä¼šè¢«ä½œä¸ºé»˜è®¤å€¼ã€‚\nä½¿ç”¨å®ä¾‹ï¼š\n@Test\r@ProfileValueSourceConfiguration(CustomProfileValueSource.class)\rpublic class CustomProfileValueSourceTests(){}\r @Timed @Timedä»£è¡¨å¤‡æ³¨æ¥çš„æµ‹è¯•æ–¹æ³•å¿…é¡»åœ¨æŒ‡å®šçš„æ—¶é—´æ®µå†…å®Œæˆï¼ˆå¾®ç§’ï¼‰ã€‚å¦‚æœæµ‹è¯•æ—¶é—´è¶…è¿‡äº†æŒ‡å®šçš„æ—¶é—´æ®µï¼Œåˆ™æµ‹è¯•å¤±è´¥ã€‚\nè¿™ä¸ªæ—¶é—´æ®µåŒ…æ‹¬è¿è¡Œæµ‹è¯•æ–¹æ³•è‡ªèº«çš„æ—¶é—´ï¼Œä»¥åŠé‡å¤æµ‹è¯•çš„æ—¶é—´ï¼ˆ@Repeat)ï¼Œä¹ŸåŒ…æ‹¬å…¶ä»–æµ‹è¯•èµ„æºçš„å®‰è£…å’Œå¸è½½æ—¶é—´ã€‚\n@Timed(millis = 1000)\rpublic void testProcessWithOneSecondTimeout(){\r}\r Springçš„@Timedè¯­æ³•è·ŸJUnit4çš„è¯­æ³•@Test(timeout=...)ä¸åŒï¼Œæ˜¯å› ä¸ºJUnit4å¤„ç†æµ‹è¯•æ‰§è¡Œè¶…æ—¶çš„å¤„ç†æ–¹å¼ï¼ˆåœ¨å•ç‹¬çš„ä¸€ä¸ªåˆ†æ”¯æ‰§è¡Œæµ‹è¯•æ–¹æ³•ï¼‰ï¼Œå¦‚æœæµ‹è¯•è¶…æ—¶@Test(timeout=...)ä¼šç«‹å³è®©æµ‹è¯•å¤±è´¥ã€‚ä½†Springçš„@Timedä¸åŒï¼Œåœ¨æ ‡è¯†å¤±è´¥ä¹‹å‰ï¼Œä»–ä¼šè®©æµ‹è¯•æ–¹æ³•å…ˆèµ°å®Œã€‚\n@Repeat å®ƒä»£è¡¨æ³¨è§£çš„æµ‹è¯•æ–¹æ³•å¿…å®šä¼šé‡å¤æ‰§è¡Œã€‚é‡å¤æ‰§è¡Œçš„æ¬¡æ•°éœ€è¦æŒ‡å®šåœ¨æ³¨è§£å‚æ•°ä¸­\né™¤äº†é‡å¤æ‰§è¡Œæµ‹è¯•æ–¹æ³•æœ¬èº«ï¼Œæµ‹è¯•èµ„æºçš„å®‰è£…å’Œå¸è½½ä¹Ÿä¼šè¢«é‡å¤æ‰§è¡Œã€‚\n@Repeat(10)\r@Test\rpublic void testProcessRepeatedly(){}\r 4.4. Spring JUnit Jupiter æµ‹è¯•æ³¨è§£ ä¸‹é¢çš„æ³¨è§£åªåœ¨é…åˆSpringExtensionå’ŒJUnit Jupiter(ä¹Ÿå°±æ˜¯JUnit5çš„ç¼–ç¨‹æ¨¡å‹)ä½¿ç”¨æ—¶æ‰å¯ç”¨\n @SpringJUnitConfig @SpringJUnitWebConfig @TestConstructor @NestedTestConfiguration @EnabledIf @DisabledIf  @SpringJUnitConfig å®ƒæ˜¯ä¸€ä¸ªé›†æˆçš„æ³¨è§£ï¼Œä»–æ˜¯ç”±æ¥è‡ªJUnit Jupiterçš„@ExtendWith(SpringExtension.class)å’Œæ¥è‡ªSpring TestContextæ¡†æ¶çš„@ContextConfigurationç»„æˆçš„ã€‚ä»–å¯ä»¥ä½œç”¨åœ¨ç±»ä¸Šä»¥æ›¿ä»£@ContextConfigurationã€‚å…³äºé…ç½®é€‰é¡¹ï¼Œ@ContextConfigurationå’Œ@SpringJUnitConfigå”¯ä¸€çš„åŒºåˆ«æ˜¯åœ¨@SpringJUnitConfigå¯ä»¥ç”¨valueå±æ€§å£°æ˜ç»„ä»¶ç±»ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨@SpringJUnitConfigæ³¨è§£æŒ‡å®šä¸€ä¸ªé…ç½®ç±»ï¼š\n@SpringJUnitConfig(TestConfig.class)\rclass ConfigurationClassJUnitJupiterSpringTests{\r}\r ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨@SpringJUnitConfigæ³¨è§£æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼š\n@SpringJUnitConfig(locations = \u0026quot;/test-config.xml\u0026quot;)\rclass XmlJUnitJupiterSpringTests{\r}\r è¯¦æƒ…å‚è€ƒContext Management å’Œ@SpringJUnitConfig ï¼Œ@ContextConfigurationçš„APIæ–‡æ¡£\n@SpringJUnitWebConfig å®ƒæ˜¯ä¸€ä¸ªå¤åˆæ³¨è§£ï¼Œæ˜¯ç”±æ¥è‡ªJUnit Jupiterçš„@ExtendWith(SprintExtension.class)ä¸æ¥è‡ªSpring TestContextæ¡†æ¶çš„ContextConfigurationã€@WebAppConfigurationæ„æˆã€‚ä½ å¯ä»¥å°†ä»–ç”³æ˜åœ¨ç±»ä¸Šï¼Œå®ƒå¯ä»¥ç”¨æ¥ä»£æ›¿@ContextConfigurationå’Œ@WebAppConfigurationã€‚å…³äºé…ç½®é€‰é¡¹ï¼Œ@ContextConfigurationå’Œ@SpringJUnitWebConfigçš„å”¯ä¸€åŒºåˆ«æ˜¯@SpringJUnitWebConfigå¯ä»¥ä½¿ç”¨valueå±æ€§æ¥å£°æ˜ç»„ä»¶ç±»ã€‚å¦å¤–ä½ å¯ä»¥è¦†ç›–@WebAppConfigurationçš„valueå±æ€§ï¼Œé€šè¿‡@SpringJUnitWebConfigçš„resourcePathå±æ€§ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•æŒ‡å®šä¸€ä¸ªé…ç½®ç±»ï¼š\n@SpringJUnitWebConfig(TestConfig.class)\rclass ConfigurationClassJUnitJupiterSpringWebTests{}\r ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼š\n@SpringJUnitWebConfig(locations = \u0026quot;/test-config.xml\u0026quot;)\rclass XmlJUnitJupiterSpringWebTests{}\r è¯¦æƒ…å‚è€ƒContext Management å’Œ@SpringJUnitWebConfig ï¼Œ@ContextConfiguration ï¼Œ@WebAppConfiguration\nTestConstructor å®ƒæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ï¼Œç”¨æ¥é…ç½®å¦‚ä½•å°†æµ‹è¯•çš„ApplicationContextç»„ä»¶å‚æ•°è£…é…åˆ°æµ‹è¯•ç±»æ„é€ æ–¹æ³•çš„å‚æ•°ä¸­ã€‚\nå¦‚æœ@TestConstructorä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„è£…é…æ¨¡å¼è¢«ä½¿ç”¨ã€‚ä¸‹é¢çš„æç¤ºå±•ç¤ºäº†å¦‚ä½•æ”¹å˜é»˜è®¤æ¨¡å¼ã€‚æ³¨æ„ï¼Œå¦‚æœæ„é€ å™¨ä¸Šæœ‰ä¸€ä¸ª@Autowiredæ³¨è§£ï¼Œé‚£ä¹ˆ@TestConstructorå’Œé»˜è®¤æ¨¡å¼éƒ½ä¼šè¢«è¦†ç›–ã€‚\n æ”¹å˜æµ‹è¯•æ„é€ æ–¹æ³•çš„é»˜è®¤è£…é…æ¨¡å¼ è¦æ”¹å˜é»˜è®¤çš„è£…é…æ¨¡å¼å¯ä»¥é€šè¿‡è®¾ç½®spring.test.constructor.autowire.modeJVM ç³»ç»Ÿå±æ€§ä¸ºallã€‚è¿˜å¯ä»¥é€šè¿‡è®¾ç½®SpringPropertiesæœºåˆ¶æ¥å®Œæˆã€‚\nä»Spring Framework 5.3å¼€å§‹ï¼Œé»˜è®¤æ¨¡å¼å¯ä»¥è®¾ç½®ä¸ºä¸€ä¸ªJUnit Platform configuration parameter\nå¦‚æœspring.test.constructor.autowire.modeå±æ€§æ²¡æœ‰è®¾ç½®ï¼Œé‚£ä¹ˆæµ‹è¯•ç±»çš„æ„é€ å‡½æ•°å°†ä¸ä¼šè‡ªåŠ¨è£…é…\n  ä»Spring Framework 5.2å¼€å§‹ï¼Œåœ¨ä½¿ç”¨JUnit Jupiteræ—¶TestConstructoråªèƒ½å’ŒSpringExtensioné…åˆä½¿ç”¨ã€‚æ³¨æ„åœ¨å¤§å¤šæ•°å¢ƒå†µä¸‹ï¼ŒSpringExtensionå·²ç»ä¸ºä½ è‡ªåŠ¨æ³¨å†Œå®Œæˆäº†-æ¯”å¦‚åœ¨ç”¨äº†@SpringJUnitConfigå’Œ@SpringJUnitWebConfigæˆ–è€…å„ç§æ¥è‡ªSpring Bootæµ‹è¯•ç›¸å…³çš„æ³¨è§£æ—¶\n @NestedTestConfiguration å®ƒæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ï¼Œè¢«ç”¨æ¥è®¾ç½®Springæµ‹è¯•é…ç½®æ³¨è§£å¦‚ä½•åœ¨å†…éƒ¨æµ‹è¯•ç±»ä¸­è¿è¡Œã€‚\nå¦‚æœå®ƒæ²¡æœ‰åœ¨æµ‹è¯•ç±»æ˜¾æ€§ç”³æ˜ï¼Œåœ¨ä»–çš„çˆ¶ç±»ç»“æ„ï¼Œæˆ–è€…åœ¨ä»–çš„å°é—­ç±»ç»“æ„ä¸­ï¼Œé»˜è®¤çš„å°é—­é…ç½®ç»§æ‰¿æ¨¡å‹ä¼šè¢«ä½¿ç”¨ã€‚ä¸‹é¢çš„æç¤ºå±•ç¤ºå¦‚ä½•ä¿®æ”¹é»˜è®¤æ¨¡å¼ã€‚\n æ”¹å˜é»˜è®¤çš„å°é—­é…ç½®ç»§æ‰¿æ¨¡å¼\né»˜è®¤çš„å°é—­é…ç½®ç»§æ‰¿æ¨¡å¼æ˜¯INHERITï¼Œè¦æ”¹å˜é»˜è®¤çš„æ¨¡å¼å¯ä»¥é€šè¿‡è®¾ç½®spring.test.enclosing.configurationJVMç³»ç»Ÿå±æ€§ä¸ºOVERRIDE.è¿˜å¯ä»¥é€šè¿‡SpringPropertiesæœºåˆ¶æ¥æ”¹å˜\n æ”¯æŒ@NestedTestConfigurationè¯­æ³•çš„Springæµ‹è¯•æ¡†æ¶æ³¨è§£ï¼š\n @BootstrapWith @ContextConfiguration @WebAppConfiguration @ContextHierarchy @ActiveProfiles @TestPropertySource @DiritesContext @TestExecutionListeners @Transactional @Commit @Rollback @Sql @SqlConfig @SqlMergeMode @TestContructor   é€šå¸¸æƒ…å†µä¸‹@NestedTestConfigurationæ³¨è§£éœ€è¦å’Œ@Nestedæ³¨è§£ç»“åˆä½¿ç”¨åœ¨JUnit Jupiterä¸­æ‰æœ‰æ„ä¹‰ï¼›ä½†æ˜¯å¯èƒ½æœ‰å…¶ä»–Springæ”¯æŒçš„æµ‹è¯•æ¡†æ¶å’Œç»§æ‰¿æµ‹è¯•ç±»ä½¿ç”¨äº†è¯¥æ³¨è§£ã€‚\n è¯¦æƒ…å‚è€ƒ@Nested test class configuration \n@EnabledIf å®ƒè¡¨ç¤ºå®ƒä¿®é¥°çš„JUnit Jupiterç±»æˆ–è€…æµ‹è¯•æ–¹æ³•æ˜¯å¦å¯ç”¨ï¼Œç”±æä¾›çš„expressionç»“æœå†³å®šã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœæ˜¯Boolean.TRUEæˆ–è€…ä¸€ä¸ªStringequalä¸ºtrue(å¿½ç•¥å¤§å°å†™)ï¼Œè¿™ä¸ªæµ‹è¯•å°±æ˜¯å¯ç”¨çš„ã€‚å½“åº”ç”¨äºç±»çº§åˆ«æ—¶ï¼Œæ‰€æœ‰åœ¨è¯¥ç±»ä¸­çš„æµ‹è¯•æ–¹æ³•éƒ½ä¼šé»˜è®¤å¯ç”¨ã€‚\nä»¥ä¸‹çš„è¡¨è¾¾å¼éƒ½å¯ç”¨ï¼š\n Spring Expression Language ã€‚ä¸¾ä¸ªä¾‹å­ï¼š@EnabledIf(\u0026quot;#{systemProperties\\['os.name'].toLowerCase().contains('mac')}\u0026quot;) Spring Environment ä¸­å¯ç”¨çš„å±æ€§å ä½ç¬¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼š@EnabledIf(\u0026quot;${smoke.tests.enabled}\u0026quot;) æ–‡æœ¬ã€‚æ¯”å¦‚ï¼š@EnabledIf(\u0026quot;true\u0026quot;)  æ³¨æ„æ–‡æœ¬è¡¨è¾¾å¼å¦‚æœä¸æ˜¯åŠ¨æ€çš„å±æ€§å ä½ç¬¦çš„è§£æç»“æœï¼Œé‚£å°†æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸º@EnableIf(\u0026quot;false\u0026quot;)ç­‰äº@Disabledï¼Œå¹¶ä¸”@EnabledIf(\u0026quot;true\u0026quot;)ä¹Ÿæ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚\nä½ å¯ä»¥å°†@EnabledIfä½œä¸ºä¸€ä¸ªå…ƒæ³¨è§£å»åˆ›å»ºè‡ªå®šä¹‰çš„å¤åˆæ³¨è§£ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„@EnabledOnMacæ³¨è§£ï¼š\n@Target({ElementType.TYPE, ElementType.METHOD})\r@Retention(RetentionPolicy.RUNTIME)\r@EnabledIf(\rexpression = \u0026quot;#{systemProperties['os.name'].toLowerCase().contains('mac')}\u0026quot;,\rreason = \u0026quot;Enabled on Mac OS\u0026quot;\r)\rpublic @interface EnabledOnMac{}\r @DisabledIf å®ƒè¡¨ç¤ºå®ƒä¿®é¥°çš„JUnit Jupiterç±»æˆ–è€…æµ‹è¯•æ–¹æ³•æ˜¯å¦å¼ƒç”¨ï¼Œç”±æä¾›çš„expressionç»“æœå†³å®šã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœæ˜¯Boolean.TRUEæˆ–è€…ä¸€ä¸ªStringequalä¸ºtrue(å¿½ç•¥å¤§å°å†™)ï¼Œè¿™ä¸ªæµ‹è¯•å°±æ˜¯å¼ƒç”¨çš„ã€‚å½“åº”ç”¨äºç±»çº§åˆ«æ—¶ï¼Œæ‰€æœ‰åœ¨è¯¥ç±»ä¸­çš„æµ‹è¯•æ–¹æ³•éƒ½ä¼šé»˜è®¤å¼ƒç”¨ã€‚\nä»¥ä¸‹çš„è¡¨è¾¾å¼éƒ½å¯ç”¨ï¼š\n Spring Expression Language ã€‚ä¸¾ä¸ªä¾‹å­ï¼š@DisabledIf(\u0026quot;#{systemProperties\\['os.name'].toLowerCase().contains('mac')}\u0026quot;) Spring Environment ä¸­å¯ç”¨çš„å±æ€§å ä½ç¬¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼š@DisabledIf(\u0026quot;${smoke.tests.enabled}\u0026quot;) æ–‡æœ¬ã€‚æ¯”å¦‚ï¼š@DisabledIf(\u0026quot;true\u0026quot;)  æ³¨æ„æ–‡æœ¬è¡¨è¾¾å¼å¦‚æœä¸æ˜¯åŠ¨æ€çš„å±æ€§å ä½ç¬¦çš„è§£æç»“æœï¼Œé‚£å°†æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸º@DisabledIf(\u0026quot;true\u0026quot;)ç­‰äº@Disabledï¼Œå¹¶ä¸”@EnabledIf(\u0026quot;false\u0026quot;)ä¹Ÿæ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚\nä½ å¯ä»¥å°†@DisabledIfä½œä¸ºä¸€ä¸ªå…ƒæ³¨è§£å»åˆ›å»ºè‡ªå®šä¹‰çš„å¤åˆæ³¨è§£ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„@DisabledOnMacæ³¨è§£ï¼š\n@Target({ElementType.TYPE, ElementType.METHOD})\r@Retention(RetentionPolicy.RUNTIME)\r@DisabledIf(\rexpression = \u0026quot;#{systemProperties['os.name'].toLowerCase().contains('mac')}\u0026quot;,\rreason = \u0026quot;Disabled on Mac OS\u0026quot;\r)\rpublic @interface DisabledOnMac {}\r 4.5. æµ‹è¯•å…ƒæ³¨è§£ ä½ å¯ä»¥ä½¿ç”¨å¤§å¤šæ•°æµ‹è¯•ç›¸å…³çš„æ³¨è§£ä½œä¸ºå…ƒæ³¨è§£å»åˆ›å»ºè‡ªå®šä¹‰çš„å¤åˆæ³¨è§£ï¼Œé‚£æ ·å¯ä»¥å‡å°‘æµ‹è¯•å¥—ä»¶çš„é‡å¤é…ç½®ã€‚\nä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢ä»»ä½•ä¸€ä¸ªæ³¨è§£ä½œä¸ºå…ƒæ³¨è§£ï¼š\n @BootstrapWith @ContextConfiguration @ContextHierarchy @ActiveProfiles @TestPropertySource @DirtiesContext @WebAppConfiguration @TestExecutionListeners @Transactional @BeforeTransaction @AfterTransaction @Commit @Rollback @Sql @SqlConfig @SqlMergeMode @SqlGroup @Repeat (only supported on JUnit 4) @Timed (only supported on JUnit 4) @IfProfileValue (only supported on JUnit 4) @ProfileValueSourceConfiguration (only supported on JUnit 4) @SpringJUnitConfig (only supported on JUnit Jupiter) @SpringJUnitWebConfig (only supported on JUnit Jupiter) @TestConstructor (only supported on JUnit Jupiter) @NestedTestConfiguration (only supported on JUnit Jupiter) @EnabledIf (only supported on JUnit Jupiter) @DisabledIf (only supported on JUnit Jupiter)  è€ƒè™‘ä¸‹é¢çš„ä¾‹å­ï¼š\n@RunWith(SpringRunner.class)\r@ContextConfiguration({\u0026quot;/app-config.xml\u0026quot;,\u0026quot;/test-data-access-config.xml\u0026quot;})\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\r@Transactional\rpublic class OrderRepositoryTests{}\r@RunWith(SpringRunner.class)\r@ContextConfiguration({\u0026quot;/app-config.xml\u0026quot;, \u0026quot;/test-data-access-config.xml\u0026quot;})\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\r@Transactional\rpublic class UserRepositoryTests{}\r è§‚å¯Ÿä¸Šé¢çš„Springæµ‹è¯•æ³¨è§£é…ç½®åŸºæœ¬éƒ½æ˜¯é‡å¤çš„ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ³¨è§£åˆå¹¶ä»–ä»¬ï¼š\n@Target(ElementType.TYPE)\r@Retention(RetentionPolicy.RUNTIME)\r@ContextConfiguration({\u0026quot;/app-config.xml\u0026quot;, \u0026quot;/test-data-access-config.xml\u0026quot;})\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\r@Transactional\rpublic @interface TransactionalDevTestConfig {}\r ç„¶åä½ å°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªè‡ªå®šä¹‰æ³¨è§£å»ç®€åŒ–JUnit4ä¸ºåŸºç¡€çš„æµ‹è¯•ç±»ï¼š\n@RunWith(SpringRunner.class)\r@TransactionalDevTestConfig\rpublic class OrderRepositoryTests{}\r@RunWith(SpringRunner.class)\r@TransactionalDevTestConfig\rpublic class UserRepositoryTests {}\r å¦‚æœæˆ‘ä»¬ä½¿ç”¨JUnit Jupiterè¿›è¡Œæµ‹è¯•ç±»ç¼–å†™ï¼Œé‚£ä¹ˆå¯ä»¥è¿›ä¸€æ­¥å‡å°‘é‡å¤ä»£ç ï¼Œå› ä¸ºJUnit 5çš„æ³¨è§£åŒæ ·å¯ä»¥ä½œä¸ºå…ƒæ³¨è§£ï¼š\n@ExtendWith(SpringExtension.class)\r@ContextConfiguration({\u0026quot;/app-config.xml\u0026quot;, \u0026quot;/test-data-access-config.xml\u0026quot;})\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\r@Transactional\rclass OrderRepositoryTest{}\r@ExtendWith(SpringExtension.class)\r@ContextConfiguration({\u0026quot;/app-config.xml\u0026quot;, \u0026quot;/test-data-access-config.xml\u0026quot;})\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\r@Transactional\rclass UserRepositoryTests{}\r è§‚å¯Ÿä¸Šé¢çš„Springæµ‹è¯•æ³¨è§£é…ç½®åŸºæœ¬éƒ½æ˜¯é‡å¤çš„ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ³¨è§£åˆå¹¶ä»–ä»¬ï¼š\n@Target(ElementType.TYPE)\r@Retention(RetentionPolicy.RUNTIME)\r@ExtendWith(SpringExtension.class)\r@ContextConfiguration({\u0026quot;/app-config.xml\u0026quot;, \u0026quot;/test-data-access-config.xml\u0026quot;})\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\r@Transactional\rpublic @interface TransactionalDevTestConfig { }\r ç„¶åä½ å°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªè‡ªå®šä¹‰æ³¨è§£å»ç®€åŒ–JUnit5ä¸ºåŸºç¡€çš„æµ‹è¯•ç±»ï¼š\n@TransactionalDevTestConfig\rclass OrderRepositoryTests { }\r@TransactionalDevTestConfig\rclass UserRepositoryTests { }\r å› ä¸ºJUnit Jupiteræ”¯æŒ@Test,@RepeatedTest,ParameterizedTestç­‰ç­‰ä½œä¸ºæºæ³¨è§£ï¼Œæ‰€ä»¥ä½ ä¹Ÿå¯ä»¥åˆ›å»ºåŸºäºæ–¹æ³•çº§åˆ«çš„è‡ªå®šä¹‰å¤åˆæ³¨è§£ï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ³¨è§£å®ƒç»“åˆäº†æ¥è‡ªJUnit Jupiterçš„@Testï¼Œ@Tagå’Œæ¥è‡ªSpringçš„@Transactionalï¼š\n@Target(ElementType.METHOD)\r@Retention(RetentionPolicy.RUNTIME)\r@Transactional\r@Tag(\u0026quot;integration-test\u0026quot;) // org.junit.jupiter.api.Tag\r@Test // org.junit.jupiter.api.Test\rpublic @interface TransactionalIntegrationTest {\r}\r ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•JUnit Jupiteræµ‹è¯•æ–¹æ³•ä¸Šä½¿ç”¨å®ƒä»¬ï¼š\n@TransactionalIntegrationTest\rvoid saveOrder() { }\r@TransactionalIntegrationTest\rvoid deleteOrder() { }\r è¯¦æƒ…å‚è€ƒSpring Annotation Programming Model\n5. Spring TestContext Framework Spring TestContext Framework(åœ¨org.springframework.test.contextåŒ…ä¸‹)ï¼Œæä¾›äº†é€šç”¨çš„ï¼Œæ³¨è§£é©±åŠ¨çš„å•å…ƒå’Œé›†æˆæµ‹è¯•ï¼Œå¹¶ä¸”ä¸è·Ÿä½ çš„æµ‹è¯•æ¡†æ¶è€¦åˆã€‚TestContext frameworkæ›´çœ‹é‡çº¦å®šè€Œä¸æ˜¯é…ç½®ï¼Œæœ‰åˆç†çš„é»˜è®¤å€¼ï¼Œå¹¶ä¸”ä½ å¯ä»¥é€šè¿‡æ³¨è§£å‚æ•°æ¥ä¿®æ”¹å®ƒã€‚\nå¦å¤–å¯¹äºå¸¸è§çš„æµ‹è¯•æ¶æ„ï¼šJUnit 4ï¼ŒJUnit Jupiter(JUnit 5)ï¼Œå’ŒTestNGï¼ŒTestContext frameworkæä¾›äº†ç‰¹å®šçš„æ”¯æŒã€‚å¯¹äºJUnit4å’ŒTestNGï¼Œspringæä¾›äº†abstractæ”¯æŒç±»ã€‚æ­¤å¤–ï¼ŒSpringä¸ºJUnit4æä¾›äº†è‡ªå®šä¹‰JUnitRunnerå’Œè‡ªå®šä¹‰JUnitRulesï¼Œå¹¶ä¸”ä¸ºJUnit Jupiteræä¾›äº†è‡ªå®šä¹‰çš„Extensionï¼Œå®ƒä»¬å¯ä»¥è®©ä½ ç¼–å†™æ‰€è°“çš„POJOæµ‹è¯•ç±»ã€‚POJOæµ‹è¯•ç±»å°±æ˜¯æµ‹è¯•ç±»ä¸éœ€è¦ç»§æ‰¿ä¸€ä¸ªç‰¹å®šçš„ç±»ç»“æ„ï¼Œæ¯”å¦‚abstarctçˆ¶ç±»ã€‚\nä¸‹é¢çš„ç« èŠ‚æä¾›äº†ä¸€ä¸ªTestContext frameworkçš„æ¦‚è§ˆã€‚å¦‚æœä½ åªå¯¹ä½¿ç”¨æ¡†æ¶æœ‰å…´è¶£ï¼Œå¯¹æ‰©å±•è‡ªå®šä¹‰ç›‘å¬æˆ–è€…è‡ªå®šä¹‰åŠ è½½å™¨ä¸æ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡è¿™ä¸ªç« èŠ‚ã€‚\n5.1. å…³é”®æŠ½è±¡æ¦‚å¿µ æ¡†æ¶çš„æ ¸å¿ƒæ˜¯ç”±TestContextManagerã€TestContextã€TestExecutionListenerã€å’ŒSmartContextLoaderæ¥å£ç»„æˆã€‚æ¯ä¸ªæµ‹è¯•ç±»éƒ½ä¼šåˆ›å»ºä¸€ä¸ªTestContextManagerã€‚åè¿‡æ¥ï¼ŒTestContextMangerç®¡ç†ç€ä¸€ä¸ªTestContextï¼Œè¿™ä¸ªTestContextä¿å­˜ç€å½“å‰æµ‹è¯•çš„ä¸Šä¸‹æ–‡å‚æ•°ã€‚åœ¨æµ‹è¯•è¿›è¡Œä¸­TestContextMangeråŒæ—¶ä¹Ÿæ›´æ–°TestContextçš„çŠ¶æ€ï¼Œå¹¶ä¸”å§”æ‰˜ç»™TestExecutionListenerçš„å®ç°ï¼Œå®ƒä¼šé€šè¿‡ä¾èµ–æ³¨å…¥æ¥æ£€æµ‹å®é™…æµ‹è¯•çš„è¿è¡Œï¼Œç®¡ç†äº‹åŠ¡ç­‰ç­‰ã€‚ä¸€ä¸ªSmartContextLoaderè´Ÿè´£ä¸ºä¸€ä¸ªç»™å®šçš„æµ‹è¯•ç±»åŠ è½½ApplicationContextã€‚è¯¦æƒ…å‚è€ƒjavadoc\nTestContext TestContextå°è£…äº†æµ‹è¯•è¿è¡Œæ‰€åœ¨çš„ä¸Šä¸‹æ–‡ï¼ˆå¿½ç•¥å…·ä½“çš„æµ‹è¯•æ¡†æ¶ï¼‰å¹¶ä¸ºå…¶æ‰€è´Ÿè´£çš„æµ‹è¯•å®ä¾‹æä¾›ä¸Šä¸‹æ–‡ç®¡ç†å’Œç¼“å­˜æ”¯æŒã€‚TestContextè¿˜èƒ½å§”æ‰˜SmarkContextLoaderå»åŠ è½½ApplicationContextã€‚\nTestContextManager TestContextMangeræ˜¯Spring TestContext Frameworkçš„ä¸»è¦åˆ‡å…¥ç‚¹ï¼Œå®ƒè´Ÿè´£ç®¡ç†ä¸€ä¸ªå•ç‹¬çš„TestContextå¹¶ä¸”ç»™æ¯ä¸ªå·²ç»æ³¨å†Œçš„TestExcutionListeneråœ¨ä»¥ä¸‹å®šä¹‰è‰¯å¥½çš„æµ‹è¯•æ‰§è¡Œç‚¹å‘é€ä¿¡å·ï¼š\n åœ¨ä»»ä½•\u0026quot;before class\u0026quot;æˆ–è€…\u0026quot;before all\u0026quot;æ–¹æ³•ä¹‹å‰ æµ‹è¯•å®ä¾‹çš„åæœŸå¤„ç† åœ¨ä»»ä½•\u0026quot;before\u0026quot;æˆ–è€…\u0026quot;before each\u0026quot;æ–¹æ³•ä¹‹å‰ åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰ä½†åœ¨æµ‹è¯•åˆå§‹åŒ–ä¹‹å åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åä½†åœ¨æµ‹è¯•é”€æ¯ä¹‹å‰ åœ¨ä»»ä½•\u0026quot;after\u0026quot;æˆ–è€…\u0026quot;after each\u0026quot;æ–¹æ³•æ‰§è¡Œä¹‹å åœ¨ä»»ä½•\u0026quot;after class\u0026quot;æˆ–è€…\u0026quot;after all\u0026quot;æ–¹æ³•æ‰§è¡Œä¹‹å  TestExecutionListener TestExecutionListenerå®šä¹‰äº†ä¸€ç³»åˆ—æµ‹è¯•ç›‘å¬APIï¼Œå®ƒä»¬åˆTestContextManageræ³¨å†Œå’Œå‘å¸ƒã€‚è¯¦æƒ…å‚è€ƒTestExecutionListener Configuration\nContextLoaders ContextLoadersæ˜¯ä¸€ä¸ªç­–ç•¥æ¥å£ä¸ºä¸€ä¸ªSpring TestContext Frameworkç®¡ç†çš„é›†æˆæµ‹è¯•åŠ è½½ä¸€ä¸ªApplicationContextã€‚è¦æä¾›ç»„ä»¶ç±»ï¼Œæ¿€æ´»beanå®šä¹‰é…ç½®ï¼Œæµ‹è¯•å±æ€§èµ„æºï¼Œä¸Šä¸‹æ–‡ç»“æ„ï¼Œå’ŒWebApplicationContextçš„æ”¯æŒä½ åº”è¯¥å®ç°SmartContextLoaderè€Œä¸æ˜¯è¿™ä¸ªæ¥å£ã€‚\nSmartContextLoaderæ˜¯ContextLoaderæ¥å£çš„æ‰©å±•ï¼Œå®ƒæ¥æ›¿äº†åŸå§‹ContextLoaderæå°‘çš„SPIã€‚å…·ä½“æ¥è¯´ï¼Œä¸€ä¸ªSmartContextLoaderå¯ä»¥é€‰æ‹©å»å¤„ç†èµ„æºä½ç½®ï¼Œç»„ä»¶ç±»ï¼Œæˆ–è€…ä¸Šä¸‹æ–‡åˆå§‹åŒ–ã€‚å…¶æ¬¡ï¼Œä¸€ä¸ªSmartContextLoaderå¯ä»¥è®¾ç½®å¯ç”¨beanå®šä¹‰é…ç½®å’Œä¸Šä¸‹æ–‡åŠ è½½çš„æµ‹è¯•å±æ€§èµ„æºã€‚\nSpringæä¾›äº†ä¸‹é¢çš„å®ç°ï¼š\n DelegatingSmartContextLoaderï¼šä¸¤ä¸ªé»˜è®¤åŠ è½½å™¨ä¹‹ä¸€ï¼Œå®ƒå§”æ‰˜ç»™å†…éƒ¨çš„ä¸€ä¸ªAnnotationConfigContextLoaderï¼Œä¸€ä¸ªGenericXmlContextLoaderï¼Œæˆ–è€…ä¸€ä¸ªGenericGroovyXmlContextLoaderï¼Œå–å†³äºæµ‹è¯•ç±»çš„é…ç½®å£°æ˜ï¼Œæˆ–è€…å­˜åœ¨çš„é»˜è®¤ä½ç½®æˆ–è€…é»˜è®¤é…ç½®ç±»ã€‚Groovyæ”¯æŒåªåœ¨classpathç›®å½•ä¸‹æœ‰Groovyæ—¶æ‰å¯ç”¨ã€‚ WebDelegatingSmartContextLoader:ä¸¤ä¸ªé»˜è®¤åŠ è½½å™¨ä¹‹ä¸€,å®ƒå§”æ‰˜ç»™å†…éƒ¨çš„ä¸€ä¸ªAnnotationConfigWebContextLoaderï¼Œä¸€ä¸ªGenericXmlWebContextLoaderï¼Œæˆ–è€…ä¸€ä¸ªGenericGroovyXmlWebContextLoaderï¼Œå–å†³äºæµ‹è¯•ç±»çš„é…ç½®å£°æ˜ï¼Œæˆ–è€…å­˜åœ¨çš„é»˜è®¤ä½ç½®æˆ–è€…é»˜è®¤é…ç½®ç±»ã€‚åªæœ‰åœ¨æµ‹è¯•ç±»ä¸Šæœ‰@WebAppConfigurationå­˜åœ¨æ—¶ï¼Œæ‰èƒ½ä½¿ç”¨webContextLoaderã€‚Groovyæ”¯æŒåªåœ¨classpathç›®å½•ä¸‹æœ‰Groovyæ—¶æ‰å¯ç”¨ã€‚ AnnotationConfigContextLoader:ç”¨ç»„ä»¶ç±»åŠ è½½ä¸€ä¸ªæ ‡å‡†çš„ApplicationContext AnnotationConfigWebContextLoader:ç”¨ç»„ä»¶ç±»åŠ è½½ä¸€ä¸ªWebApplicationContext GenericGroovyXmlContextLoader:ç”¨Groovyè„šæœ¬æˆ–è€…XMLé…ç½®æ–‡ä»¶åŠ è½½ä¸€ä¸ªæ ‡å‡†çš„ApplicationContext GenericGroovyXmlWebContextLoader:ç”¨Groovyè„šæœ¬æˆ–è€…XMLé…ç½®æ–‡ä»¶åŠ è½½ä¸€ä¸ªWebApplicationContext GenericXmlContextLoader:ç”¨XMLèµ„æºåœ°å€åŠ è½½ä¸€ä¸ªæ ‡å‡†çš„ApplicationContext GenericXmlWebContextLoader:ç”¨XMLèµ„æºåœ°å€åŠ è½½ä¸€ä¸ªWepApplicationContext  5.2. å¼•å¯¼TestContext Framework Spring TestContext Frameworkå†…éƒ¨çš„é»˜è®¤é…ç½®å¯¹äºä¸€èˆ¬çš„ä½¿ç”¨æƒ…å†µå·²ç»è¶³å¤Ÿäº†ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å¼€å‘å›¢é˜Ÿæˆ–è€…ç¬¬ä¸‰æ–¹æ¡†æ¶æƒ³æ”¹å˜é»˜è®¤çš„ContextLoaderï¼Œå®ç°è‡ªå®šä¹‰çš„TestContextæˆ–è€…ContextCacheï¼Œå¢åŠ é»˜è®¤çš„ContextCustomizerFactoryå’ŒTestExecutionListenerå®ç°é›†åˆç­‰ç­‰æ“ä½œã€‚å¯¹äºè¿™ç§å¯¹TestContext æ¡†æ¶æ“ä½œçš„åº•å±‚çš„æ§åˆ¶ï¼ŒSpringæä¾›äº†ä¸€ä¸ªå¼•å¯¼ç­–ç•¥ã€‚\nTestContextBootstrapperä¸ºTestContextæ¡†æ¶å®šä¹‰äº†SPIã€‚ä¸€ä¸ªTestContextBootstrapperé€šè¿‡TextContextManagerè¢«ç”¨æ¥ä¸ºå½“å‰æµ‹è¯•åŠ è½½TestExecutionListenerå®ç°å’Œæ„å»ºä»–ç®¡ç†çš„TestContextã€‚ä½ å¯ä»¥é€šè¿‡@BootstrapWithä¸ºæµ‹è¯•ç±»ï¼ˆæˆ–è€…æµ‹è¯•ç±»ç»“æ„ï¼‰é…ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„å¼•å¯¼ç­–ç•¥ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨@BootstrapWithæˆ–è€…æŠŠå®ƒä½œä¸ºä¸€ä¸ªå…ƒæ³¨è§£.å¦‚æœæ²¡æœ‰æ˜¾å¼çš„æŒ‡å®š@BootstrapWithï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨DefaultTestContextBootstrapperæˆ–è€…WebTestContextBootstrapperï¼Œå–å†³äº@WebAppConfigurationæ˜¯å¦å­˜åœ¨\nå› ä¸ºTestContextBootstrapperSPIå¾ˆå¯èƒ½åœ¨æœªæ¥æ›´æ”¹(å»é€‚åº”æ–°éœ€æ±‚),æˆ‘ä»¬å¼ºçƒˆå»ºè®®ç»§æ‰¿AbstractTestContextBootstrapperç±»æˆ–è€…ä»–çš„æŸä¸ªå…·ä½“çš„å­—ç±»,è€Œä¸æ˜¯å®ç°TestContextBootstrapperè¿™ä¸ªæ¥å£\n5.3. TestExecutionListeneré…ç½® Springæä¾›äº†ä¸‹é¢çš„TestExecutionListenerå®ç°ï¼Œä»–ä»¬æ˜¯è¢«é»˜è®¤æ³¨å†Œçš„ï¼ŒæŒ‰ç…§ä¸‹é¢çš„é¡ºåºï¼š\n ServletTestExecutionListener:ä¸ºWebApplicationContexté…ç½®Servlet APIæ¨¡æ‹Ÿã€‚ DirtiesContextBeforeModesTestExecutionListener:ä¸º\u0026quot;before\u0026quot;æ¨¡å¼å¤„ç†@DirtiesContextæ³¨è§£ã€‚ DependencyInjectionTestExecutionListener:ä¸ºæµ‹è¯•å®ä¾‹æä¾›ä¾èµ–æ³¨å…¥. DirtiesContextTestExecutionListener:ä¸º\u0026quot;after\u0026quot;æ¨¡å¼å¤„ç†@DirtiesContextæ³¨è§£ã€‚ TransactionalTestExecutionListener:æä¾›é»˜è®¤çš„rollbackçš„äº‹åŠ¡æµ‹è¯•æ‰§è¡Œã€‚ SqlScriptsTestExecutionListener:ä½¿ç”¨@Sqlæ³¨è§£æ—¶è¿è¡Œé…ç½®çš„SQLè„šæœ¬. EventPublishingTestExecutionListener:ä¸ºæµ‹è¯•çš„ApplicationContextå‘å¸ƒæµ‹è¯•æ‰§è¡Œäº‹ä»¶(å‚ç…§Test Execution Events) ã€‚  æ³¨å†ŒTestExecutionListenerå®ç° ä½ å¯ä»¥ä¸ºæµ‹è¯•ç±»å’Œå…¶å­—ç±»æ³¨å†ŒTestExecutionListenerå®ç°é€šè¿‡ä½¿ç”¨@TestExecutionListenersæ³¨è§£ã€‚è¯¦æƒ…å‚è€ƒannotation support ,@TestExecutionListeners\nè‡ªåŠ¨åŒ–æ¢ç´¢é»˜è®¤çš„TestExecutionListenerå®ç° é€šè¿‡ä½¿ç”¨@TestExecutionListenersæ¥æ³¨å†ŒTestExecutionListenerå®ç°,é€‚åˆæœ‰é™æµ‹è¯•æ–¹æ¡ˆçš„è‡ªå®šä¹‰ç›‘å¬å™¨ã€‚å¦‚æœè‡ªå®šä¹‰ç›‘å¬å™¨è¦è·¨è¶Šæ•´ä¸ªæµ‹è¯•å¥—ä»¶,é‚£ä¹ˆä»–å°±ä¼šå˜å¾—ååˆ†è‡ƒè‚¿ã€‚è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦é€šè¿‡æ”¯æŒè‡ªåŠ¨æ¢ç´¢é»˜è®¤çš„TestExecutionListenerå®ç°æ¥å®Œæˆï¼ŒèƒŒåä¾é SpringFactoriesLoaderæœºåˆ¶æ¥å®ç°ã€‚\nå…·ä½“æ¥è¯´ï¼Œspring-testæ¨¡å—ç”³æ˜æ‰€æœ‰çš„æ ¸å¿ƒé»˜è®¤TestExecutionListenerå®ç°éƒ½åœ¨META-INF/spring.factorieså±æ€§æ–‡ä»¶ä¸­çš„org.springframework.test.context.TestExecutionListenerkeyä¸‹ã€‚ç¬¬ä¸‰æ–¹æ¡†æ¶å’Œå¼€å‘è€…å¯ä»¥è´¡çŒ®ä»–ä»¬è‡ªå·±çš„TestExecutionListeneråˆ°é»˜è®¤çš„ç›‘å¬è€…åˆ—è¡¨ï¼ŒåŒæ ·é€šè¿‡META-INF/spring.factorieså±æ€§æ–‡ä»¶ã€‚\nTestExecutionListenerå®ç°çš„é¡ºåº å½“TestContextæ¡†æ¶å‘ç°äº†é»˜è®¤çš„TesetExecutionListenerå®ç°é€šè¿‡å‰é¢æåˆ°çš„SpringFactoriesLoaderæœºåˆ¶ï¼Œè¿™äº›åˆå§‹åŒ–çš„ç›‘å¬å™¨é€šè¿‡springçš„AnnotationAwareOrderComparatoræ¥æ’åºï¼Œè€Œå®ƒåˆä½¿ç”¨Springçš„Orderedæ¥å£å’Œ@Orderæ³¨è§£æ¥æ’åºã€‚AbstractTestExecutionListenerå’Œæ‰€æœ‰é»˜è®¤çš„TestExecutionListeneréƒ½ä»¥é€‚å½“çš„å€¼å®ç°äº†Orderedã€‚æ‰€ä»¥ç¬¬ä¸‰æ–¹æ¡†æ¶å’Œå¼€å‘è€…åº”è¯¥ç¡®ä¿ä»–ä»¬çš„é»˜è®¤TestExecutionListenerå®ç°æ˜¯æ˜¯implementsOrderedçš„æˆ–è€…ç”±@Orderæ³¨è§£ã€‚é€šè¿‡TestExecutionListenerå®ç°çš„getOrder()æ–¹æ³•æ¥æŸ¥çœ‹æ ¸å¿ƒç›‘å¬å™¨çš„é¡ºåºå€¼ã€‚\nåˆå¹¶TestExecutionListenerå®ç° å¦‚æœä¸€ä¸ªè‡ªå®šä¹‰TestExecutionListeneræ˜¯é€šè¿‡@TestExecutionListenersæ³¨å†Œçš„ï¼Œé‚£ä¹ˆé»˜è®¤çš„ç›‘å¬å™¨å°†ä¸ä¼šè¢«æ³¨å†Œã€‚åœ¨å¤§å¤šæ•°æµ‹è¯•åœºæ™¯ä¸­ï¼Œè¿™ä¼šå¼ºåˆ¶è¦æ±‚å¼€å‘è€…æ‰‹åŠ¨ç”³æ˜æ‰€æœ‰é»˜è®¤çš„ç›‘å¬å™¨åŠ ä¸Šç”¨æˆ·è‡ªå®šä¹‰çš„ç›‘å¬å™¨ï¼š\n@ContextConfiguration\r@TestExecutionListeners({\rMyCustomTestExecutionListener.class,\rServletTestExecutionListener.class,\rDirtiesContextBeforeModesTestExecutionListener.class,\rDependencyInjectionTestExecutionListener.class,\rDirtiesContextTestExecutionListener.class,\rTransactionalTestExecutionListener.class,\rSqlScriptsTestExecutionListener.class\r})\rclass MyTest {\r// class body...\r}\r è¿™ç§æ–¹æ³•å¸¦æ¥çš„æŒ‘æˆ˜æ˜¯ï¼Œä½ å¿…é¡»è¦è®°å¾—æ‰€æœ‰çš„é»˜è®¤ç›‘å¬å™¨ã€‚å¹¶ä¸”æ¯ä¸ªå‘å¸ƒç‰ˆæœ¬çš„ç›‘å¬å™¨å¯èƒ½æ”¹å˜-ä¸¾ä¸ªä¾‹å­SqlScriptsTestExecutionListeneræ˜¯åœ¨Spring Framework 4.1å¼•å…¥çš„ï¼Œè€ŒDirtiesContextBeforeModesTestExecutionListenerå®åœ¨Spring Framework 4.2å¼•å…¥çš„ã€‚æ­¤å¤–ï¼Œç¬¬ä¸‰æ–¹æ¡†æ¶æ¯”å¦‚Spring Bootå’ŒSpring Securityé€šè¿‡å‰é¢æåˆ°çš„automatic discovery mechanismæ³¨å†Œäº†ä»–ä»¬è‡ªå·±çš„é»˜è®¤TestExecutionListenerå®ç°ã€‚\nä¸ºäº†é¿å…è®°ä½å’Œé‡æ–°å£°æ˜æ‰€æœ‰é»˜è®¤çš„ç›‘å¬å™¨ï¼Œä½ å¯ä»¥è®¾ç½®@TestExecutionListenersçš„mergeModeå±æ€§ä¸ºMergeMode.MERGE_WITH_DEFAULTSã€‚è¿™ä¸ªå±æ€§å€¼è¡¨å®æœ¬åœ°ç”³æ˜çš„ç›‘å¬å™¨åº”è¯¥å’Œé»˜è®¤ç›‘å¬å™¨åˆå¹¶ã€‚è¿™ä¸ªåˆå¹¶ç®—æ³•ä¼šç§»é™¤é‡å¤çš„ç”³æ˜ï¼Œå¹¶ä¸”ä¼šæ ¹æ®AnnotationAwareOrderComparatoræ’åºã€‚å¦‚æœç›‘å¬å™¨å®ç°äº†Orderedæˆ–è€…ç”±@Orderæ³¨è§£ä¿®é¥°ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥å½±å“é»˜è®¤ç›‘å¬å™¨çš„æ’åºã€‚å¦åˆ™ï¼Œæœ¬åœ°å£°æ˜çš„ç›‘å¬å™¨ä¼šè¿½åŠ åˆ°é»˜è®¤ç›‘å¬å™¨åˆ—è¡¨çš„æœ«å°¾ã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœMyCustomTestExecutionListenerç±»é…ç½®äº†orderå€¼ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œ500ï¼‰æ¯”ServletTestExecutionListenerçš„orderå€¼å°(æ°å¥½æ˜¯1000)ï¼ŒMyCustomTestExecutionListenerå¯ä»¥è‡ªåŠ¨åˆå¹¶åˆ°é»˜è®¤é›†åˆä¸­å¹¶åœ¨ServletTestExecutionListenerä¹‹å‰ï¼Œä¹‹å‰çš„ä¾‹å­å¯ä»¥æ›¿æ¢æˆä¸‹é¢çš„ä»£ç ï¼š\n@ContextConfiguration\r@TestExecutionListeners(\rlisteners = MyCustomTestExecutionListener.class,\rmergeMode = MERGE_WITH_DEFAULTS\r)\rclass MyTest {\r// class body...\r}\r 5.4. æµ‹è¯•æ‰§è¡Œäº‹ä»¶ Spring Framework 5.2å¼•å…¥äº†EventPublishingTestExecutionListener ï¼Œæä¾›äº†ä¸€ä¸ªå®ç°è‡ªå®šä¹‰TestExecutionListenerçš„æ›¿ä»£æ–¹æ³•ã€‚åœ¨æµ‹è¯•ApplicationContextä¸­çš„ç»„ä»¶å¯ä»¥é€šè¿‡EventPublishingTestExecutionListenerç›‘å¬ä¸‹åˆ—çš„äº‹ä»¶ï¼Œæ¯ä¸ªäº‹ä»¶å¯¹åº”TestExecutionListenerAPIä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚\n BeforeTestClassEvent PrepareTestInstanceEvent BeforeTestMethodEvent BeforeTestExecutionEvent AfterTestExecutionEvent AfterTestMethodEvent AfterTestClassEvent   è¿™äº›äº‹ä»¶åªæœ‰åœ¨ApplicationContextå·²ç»åŠ è½½åæ‰å‘å¸ƒ\n è¿™äº›äº‹ä»¶å¯èƒ½å› ä¸ºå¤šç§åŸå› è¢«æ¶ˆè´¹ï¼Œæ¯”å¦‚é‡è®¾æ¨¡æ‹Ÿbeanæˆ–è€…è¿½è¸ªæµ‹è¯•æ‰§è¡Œã€‚é€‰æ‹©æ¶ˆè´¹æµ‹è¯•æ‰§è¡Œäº‹ä»¶ï¼Œè€Œä¸æ˜¯å®ç°ä¸€ä¸ªè‡ªå®šä¹‰TestExecutionListenerï¼Œå…¶ä¸­çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯æµ‹è¯•æ‰§è¡Œäº‹ä»¶å¯ä»¥è¢«ä»»ä½•åœ¨æµ‹è¯•ApplicationContextä¸­æ³¨å†Œçš„Spring beanæ¶ˆè€—ï¼Œè¿™äº›beanå¯ä»¥ç›´æ¥å—åˆ©äºä¾èµ–æ³¨å…¥æˆ–è€…ApplicationContextçš„å…¶ä»–ç‰¹æ€§ã€‚ç›¸å¯¹åº”çš„ï¼Œåœ¨ApplicationContextä¸­çš„TestExecutionListenerå¹¶ä¸æ˜¯ä¸€ä¸ªbeanã€‚\nä¸ºäº†ç›‘å¬æµ‹è¯•æ‰§è¡Œäº‹ä»¶ï¼Œä¸€ä¸ªSpring beanå¯ä»¥é€‰æ‹©å»å®ç°org.springframework.context.ApplicationListeneræ¥å£ã€‚ä¹Ÿå¯ä»¥ç”¨@EventListenerä¿®é¥°ç›‘å¬æ–¹æ³•å¹¶ä¸”é…ç½®ç›‘å¬ä¸Šé¢æåˆ°çš„æŒ‡å®šäº‹ä»¶ç±»å‹ä¸­çš„ä¸€ä¸ªã€‚å› ä¸ºè¿™ä¸ªæ–¹æ³•çš„æµè¡Œï¼ŒSpringæä¾›äº†ä»¥ä¸‹ä¸“ç”¨çš„@EventListeneræ³¨è§£å»ç®€åŒ–æµ‹è¯•æ‰§è¡Œäº‹ä»¶ç›‘å¬å™¨çš„æ³¨å†Œã€‚è¿™äº›æ³¨è§£æ˜¯åœ¨org.springframework.test.context.event.annotationåŒ…ä¸‹çš„ã€‚\n @BeforeTestClass @PrepareTestInstance @BeforeTestMethod @BeforeTestExecution @AfterTestExecution @AfterTestMethod @AfterTestClass  å¼‚å¸¸å¤„ç† é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªæµ‹è¯•æ‰§è¡Œäº‹ä»¶ç›‘å¬å™¨åœ¨æ¶ˆè´¹äº‹ä»¶æ—¶æŠ›å‡ºäº†ä¸€ä¸ªå¼‚å¸¸ï¼Œè¿™ä¸ªå¼‚å¸¸ä¼šä¼ é€’åˆ°åº•å±‚ä½¿ç”¨çš„æµ‹è¯•æ¡†æ¶ä¸Šï¼ˆæ¯”å¦‚JUnitæˆ–è€…TestNGï¼‰ã€‚æ¯”å¦‚åœ¨æ¶ˆè´¹BeforeTestMethodEventæ—¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œå¯¹åº”çš„æµ‹è¯•æ–¹æ³•å°†ä¼šå¤±è´¥ã€‚ç›¸åï¼Œå¦‚æœä¸€ä¸ªå¼‚æ­¥çš„æµ‹è¯•æ‰§è¡Œäº‹ä»¶ç›‘å¬å™¨æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè¿™ä¸ªå¼‚å¸¸æ˜¯ä¸ä¼šä¼ é€’åˆ°åº•å±‚çš„æµ‹è¯•æ¡†æ¶çš„ã€‚å¼‚æ­¥å¼‚å¸¸å¤„ç†çš„è¯¦æƒ…ï¼ŒæŸ¥é˜…ç±»çº§åˆ«@EventListenerçš„javadocã€‚\nå¼‚æ­¥ç›‘å¬å™¨ å¦‚æœä½ æƒ³è¦ä¸€ä¸ªç‰¹åˆ«çš„æµ‹è¯•æ‰§è¡Œäº‹ä»¶ç›‘å¬å™¨å»å¼‚æ­¥å¤„ç†äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨Springçš„å¸¸è§„@Asyncæ”¯æŒ ã€‚è¯¦æƒ…æŸ¥é˜…ç±»çº§åˆ«@EventListenerçš„javadocã€‚\n5.5. ä¸Šä¸‹æ–‡ç®¡ç† æ¯ä¸ªTestContextéƒ½ä¸ºå®ƒè´Ÿè´£çš„æµ‹è¯•å®ä¾‹æä¾›äº†ä¸Šä¸‹æ–‡ç®¡ç†å’Œç¼“å­˜æ”¯æŒã€‚æµ‹è¯•å®ä¾‹ä¸ä¼šè‡ªåŠ¨æ¥æ”¶å¯¹é…ç½®ApplicationContextçš„è®¿é—®ã€‚ä½†æ˜¯ï¼Œå¦‚æœæµ‹è¯•ç±»å®ç°äº†ApplicationContextAwareæ¥å£ï¼Œä¼šä¸ºæµ‹è¯•å®ä¾‹æä¾›ä¸€ä¸ªApplicationContextçš„å¼•ç”¨ã€‚æ³¨æ„AbstractJUnit4SpringContextTestså’ŒAbstractTestNGSpringContextTestså®ç°äº†ApplicationContextAwareï¼Œæ‰€ä»¥è‡ªåŠ¨æä¾›å¯¹ApplicationContextçš„è®¿é—®ã€‚\n @Autowired ApplicationContext ä½œä¸ºä¸€ä¸ªå®ç°ApplicationContextAwareæ¥å£çš„æ›¿ä»£æ–¹æ³•ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½®@Autowiredæ³¨è§£åœ¨å­—æ®µä¸Šæˆ–è€…setteræ–¹æ³•ä¸Šæ¥æ³¨å…¥application contextï¼š\n@SpringJUnitConfig\rclass MyTest {\r@Autowired ApplicationContext applicationContext;\r// class body...\r}\r åŒæ ·ï¼Œå¦‚æœä½ çš„æµ‹è¯•éœ€è¦åŠ è½½ä¸€ä¸ªWebApplicationContext:\n@SpringJUnitWebConfig\rclass MyWebAppTest {\r@Autowired WebApplicationContext wac;\r// class body...\r}\r é€šè¿‡ä½¿ç”¨@Autowiredè¿›è¡Œä¾èµ–æ³¨å…¥æ˜¯é€šè¿‡DependencyInjectionTestExecutionListeneræ¥æä¾›çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹å°±ä¼šå¯¹å®ƒè¿›è¡Œé…ç½®(å‚è€ƒhttps://docs.spring.io/spring-framework/docs/current/reference/html/testing.html#testcontext-fixture-di)\n ä½¿ç”¨TestContextæ¡†æ¶çš„æµ‹è¯•ç±»ä¸éœ€è¦extendsä»»ä½•ç‰¹å®šçš„ç±»æˆ–è€…å®ç°ä»»ä½•ç‰¹å®šæ¥å£å»é…ç½®ä»–ä»¬çš„application contextã€‚ä½ åªéœ€è¦åœ¨ç±»çº§åˆ«å£°æ˜ä¸€ä¸ª@ContextConfigurationæ³¨è§£å³å¯ã€‚å¦‚æœä½ çš„æµ‹è¯•ç±»æ²¡æœ‰æ˜¾æ€§çš„å£°æ˜application contextèµ„æºä½ç½®æˆ–è€…ç»„ä»¶ç±»ï¼Œé…ç½®çš„ContextLoaderä¼šå†³å®šæ€æ ·ä»ä¸€ä¸ªé»˜è®¤çš„ä½ç½®æˆ–è€…é»˜è®¤çš„é…ç½®ç±»åŠ è½½ä¸€ä¸ªcontextã€‚é™¤äº†èµ„æºä½ç½®å’Œç»„ä»¶ç±»ï¼Œä¸€ä¸ªapplication contextè¿˜å¯ä»¥é€šè¿‡application contextåˆå§‹åŒ–ç¨‹åºé…ç½®ã€‚\nä¸‹é¢çš„å‡ ä¸ªç« èŠ‚é˜è¿°äº†æ€æ ·ä½¿ç”¨Srpingçš„@ContextConfigurationæ³¨è§£å»é…ç½®ä¸€ä¸ªæµ‹è¯•çš„ApplicationContexté€šè¿‡ä½¿ç”¨XMLé…ç½®æ–‡ä»¶ï¼ŒGroovyè„šæœ¬ï¼Œç»„ä»¶ç±»ï¼ˆå…¸å‹çš„@Configurationç±»ï¼‰ï¼Œæˆ–è€…ä¸Šä¸‹æ–‡åˆå§‹åŒ–ç¨‹åºã€‚å¦å¤–ï¼Œä½ å¯ä»¥å®ç°å¹¶é…ç½®ä½ è‡ªå®šä¹‰çš„SmartContextLoaderä¸ºé«˜çº§çš„ä½¿ç”¨åœºæ™¯ã€‚\n Context Configuration with XML resources Context Configuration with Groovy Scripts Context Configuration with Component Classes Mixing XML, Groovy Scripts, and Component Classes Context Configuration with Context Initializers Context Configuration Inheritance Context Configuration with Environment Profiles Context Configuration with Test Property Sources Context Configuration with Dynamic Property Sources Loading a WebApplicationContext Context Caching Context Hierarchies  Context Configuration with XML resources é€šè¿‡XMLé…ç½®æ–‡ä»¶ä¸ºä½ çš„æµ‹è¯•åŠ è½½ApplicationContextï¼Œéœ€è¦ç”¨@ContextConfigurationæ³¨è§£ä¿®é¥°ä½ çš„æµ‹è¯•ç±»ï¼Œå¹¶ç”¨ä¸€ä¸ªç”±XMLæ–‡ä»¶ä½ç½®æ„æˆçš„æ•°ç»„æ¥ç»™locationså±æ€§èµ‹å€¼ã€‚ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼ˆæ¯”å¦‚context.xmlï¼‰ä¼šè¢«çœ‹åšä¸€ä¸ªclasspathèµ„æºå¹¶ä¸”ä¼šå…³è”åˆ°æµ‹è¯•ç±»å®šä¹‰çš„åŒ…ä¸‹ã€‚ä¸€ä¸ªä»¥æ–œçº¿å¼€å¤´çš„è·¯å¾„ä¼šè¢«çœ‹ä½œç»å¯¹çš„classpathè·¯å¾„ï¼ˆæ¯”å¦‚/org/example/config.xmlï¼‰ã€‚ä¸€ä¸ªè·¯å¾„ä»£è¡¨ä¸€ä¸ªèµ„æºURL(æ¯”å¦‚ä¸€ä¸ªè·¯å¾„çš„å‰ç¼€æ˜¯classpath:,file:,http:,ç­‰ç­‰)ã€‚\n@ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from \u0026quot;/app-config.xml\u0026quot; and\r// \u0026quot;/test-config.xml\u0026quot; in the root of the classpath\r@ContextConfiguration(locations={\u0026quot;/app-config.xml\u0026quot;, \u0026quot;/test-config.xml\u0026quot;}) class MyTest {\r// class body...\r}n\r @ContextConfigurationé€šè¿‡æ ‡å‡†çš„Javavalueå±æ€§ä¸ºlocationså±æ€§æä¾›äº†ä¸€ä¸ªåˆ«åã€‚æ‰€ä»¥å¦‚æœä½ ä¸åœ¨@ContextConfigurationç”³æ˜é¢å¤–çš„å±æ€§ï¼Œä½ å¯ä»¥çœç•¥locationsï¼š\n@ExtendWith(SpringExtension.class)\r@ContextConfiguration({\u0026quot;/app-config.xml\u0026quot;, \u0026quot;/test-config.xml\u0026quot;}) class MyTest {\r// class body...\r}\r å¦‚æœä½ locationså’Œvalueå±æ€§éƒ½æ²¡æœ‰å£°æ˜ï¼Œé‚£ä¹ˆTestContextæ¡†æ¶ä¼šå°è¯•æ£€æµ‹é»˜è®¤çš„XMLèµ„æºè·¯å¾„ã€‚å…·ä½“æ¥è¯´ï¼ŒGenericXmlContextLoader å’ŒGenericXmlWebContextLoader ä¼šåŸºäºæµ‹è¯•ç±»çš„åç§°æ£€æµ‹èµ„æºè·¯å¾„ã€‚å¦‚æœä½ çš„ç±»åä¸ºcom.example.MyTestï¼ŒGenericXmlContextLoaderä¼šä»classpath:com/example/MyTest-context.xmlåŠ è½½ä½ çš„application contextã€‚\n@ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from\r// \u0026quot;classpath:com/example/MyTest-context.xml\u0026quot;\r@ContextConfiguration class MyTest {\r// class body...\r}\r Context Configuration with Groovy Scripts é€šè¿‡ä½¿ç”¨Groovy Bean Definition DSL ç”Ÿæˆçš„Groovyè„šæœ¬å¯ä»¥ä¸ºä½ çš„æµ‹è¯•ç”ŸæˆApplicationContextï¼Œé…ç½®Groovyçš„è„šæœ¬å¯ä»¥é€šè¿‡@ContextConfigurationçš„locationså’Œvalueå±æ€§æ¥è®¾ç½®Groovyè„šæœ¬çš„èµ„æºä½ç½®ã€‚èµ„æºæŸ¥æ‰¾è¯­æ³•è·ŸXMLæ–‡ä»¶é…ç½®ä¸€æ ·ã€‚\n å¯ç”¨Groovyè„šæœ¬æ”¯æŒ\nå¦‚æœGroovyåœ¨classpathè·¯å¾„ä¸‹ï¼ŒSpring TestContextæ¡†æ¶ä¼šè‡ªåŠ¨æ”¯æŒç”¨Groovyè„šæœ¬åŠ è½½ApplicationContext\n @ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from \u0026quot;/AppConfig.groovy\u0026quot; and\r// \u0026quot;/TestConfig.groovy\u0026quot; in the root of the classpath\r@ContextConfiguration({\u0026quot;/AppConfig.groovy\u0026quot;, \u0026quot;/TestConfig.Groovy\u0026quot;}) class MyTest {\r// class body...\r}\r å¦‚æœä½ åŒæ—¶å¿½ç•¥locationså’Œvalueå±æ€§ï¼Œæµ‹è¯•æ¡†æ¶ä¼šå°è¯•æ£€æµ‹é»˜è®¤çš„Groovyè„šæœ¬ã€‚å…·ä½“æ¥è¯´ï¼ŒGenericGroovyXmlContextLoaderå’ŒGenericGroovyXmlWebContextLoaderä¼šæ£€æµ‹ä¸€ä¸ªé»˜è®¤çš„è·¯å¾„ï¼ŒåŸºäºæµ‹è¯•ç±»çš„åç§°ã€‚å¦‚æœä½ çš„ç±»åä¸ºcom.example.MyTsetï¼ŒGroovyä¸Šä¸‹æ–‡åŠ è½½å™¨ä¼šä»classpath:com/example/MyTestContext.groovyåŠ è½½ä¸Šä¸‹æ–‡ã€‚\n@ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from\r// \u0026quot;classpath:com/example/MyTestContext.groovy\u0026quot;\r@ContextConfiguration class MyTest {\r// class body...\r}\r  åŒæ—¶å£°æ˜XMLé…ç½®å’ŒGroovyè„šæœ¬\nä½ å¯ä»¥åŒæ—¶ç”³æ˜XMLé…ç½®å’ŒGroovyè„šæœ¬é€šè¿‡@Configurationè„šæœ¬çš„locationså’Œvalueå±æ€§ã€‚å¦‚æœé…ç½®è·¯å¾„ä»¥.xmlè·¯å¾„ç»“å°¾ï¼ŒXmlBeanDefinitionReaderä¼šç”¨æ¥åŠ è½½é…ç½®ã€‚å¦åˆ™ä¼šä½¿ç”¨GroovyBeanDefinitionReaderã€‚\n@ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from\r// \u0026quot;/app-config.xml\u0026quot; and \u0026quot;/TestConfig.groovy\u0026quot;\r@ContextConfiguration({ \u0026quot;/app-config.xml\u0026quot;, \u0026quot;/TestConfig.groovy\u0026quot; })\rclass MyTest {\r// class body...\r}\r  Context Configuration with Component Classes ä½¿ç”¨ç»„ä»¶ç±»ä¸ºä½ çš„æµ‹è¯•åŠ è½½ä¸€ä¸ªApplicationContextï¼Œä½ å¯ä»¥é€šè¿‡@ContextConfigurationæ³¨è§£ï¼Œå¹¶é…ç½®classeså±æ€§ï¼š\n@ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from AppConfig and TestConfig\r@ContextConfiguration(classes = {AppConfig.class, TestConfig.class}) class MyTest {\r// class body...\r}\r  Component Classes\n\u0026ldquo;Component Class\u0026quot;ç»„ä»¶ç±»æŒ‡çš„æ˜¯ï¼š\n è¢«@Configurationä¿®é¥°çš„ç±» ä¸€ä¸ªç»„ä»¶ï¼ˆå°±æ˜¯è¢«@Componentï¼Œ@Serviceï¼Œ@Repositoryï¼Œæˆ–è€…å…¶ä»–åŸå§‹æ³¨è§£ä¿®é¥°çš„ç±»ï¼‰ ä¸€ä¸ªJSR-330ç¼–è¯‘çš„ç±»ï¼Œå°±æ˜¯è¢«javax.injectæ³¨è§£ä¿®é¥°çš„ç±» ä»»ä½•ç±»åŒ…å«@Beanæ–¹æ³• ä»»ä½•å…¶ä»–ç±»å°è¯•å»æ³¨å†Œä¸ºä¸€ä¸ªSpringç»„ä»¶(å°±æ˜¯è¯´ä¸€ä¸ªåœ¨ApplicationContexté‡Œçš„Spring bean)ï¼Œå¯èƒ½æ˜¯åˆ©ç”¨å•ä¸ªæ„é€ æ–¹æ³•çš„è‡ªåŠ¨è£…é…ï¼Œè€Œä¸æ˜¯Springæ³¨è§£ æŸ¥çœ‹@Configuration å’Œ@Bean çš„javadocæŸ¥æ‰¾æ›´å¤šè¯¦æƒ…ã€‚å…³äºæ³¨è§£ç±»çš„é…ç½®å’Œè¯­æ³•ï¼Œç‰¹åˆ«æ³¨æ„@BeanLiteæ¨¡å¼çš„è®¨è®ºã€‚   å¦‚æœå¿½ç•¥classeså±æ€§ï¼ŒTestContextæ¡†æ¶ä¼šå°è¯•æ£€æµ‹é»˜è®¤é…ç½®ç±»æ˜¯å¦å­˜åœ¨ã€‚å…·ä½“æ¥è¯´ï¼ŒAnnotationConfigContextLoaderå’ŒAnnotationConfigWebContextLoaderä¼šæ£€æµ‹æ‰€æœ‰æ»¡è¶³é…ç½®ç±»å®ç°éœ€æ±‚çš„staticé›†æˆç±»ï¼Œè¯¦æƒ…å‚è€ƒ@Configuration javadocã€‚æ³¨æ„é…ç½®ç±»çš„åç§°æ˜¯ä»»æ„çš„ã€‚å¦å¤–ï¼Œå¦‚æœæµ‹è¯•ç±»æ„¿æ„çš„è¯ä»–å¯ä»¥åŒ…å«å¤šä¸ªstaticé›†æˆé…ç½®ç±»ã€‚ä¸‹é¢çš„ä¾‹å­é‡Œ,OrderServiceTestç±»å£°æ˜äº†ä¸€ä¸ªstaticé›†æˆé…ç½®ç±»å«åšConfigï¼Œä»–ä¼šè¢«ç”¨æ¥ä¸ºæµ‹è¯•ç±»è‡ªåŠ¨åŠ è½½ApplicationContextï¼š\n@SpringJUnitConfig // ApplicationContext will be loaded from the\r// static nested Config class\rclass OrderServiceTest {\r@Configuration\rstatic class Config {\r// this bean will be injected into the OrderServiceTest class\r@Bean\rOrderService orderService() {\rOrderService orderService = new OrderServiceImpl();\r// set properties, etc.\rreturn orderService;\r}\r}\r@Autowired\rOrderService orderService;\r@Test\rvoid testOrderService() {\r// test the orderService\r}\r}\r Mixing XML, Groovy Scripts, and Component Classes æœ‰æ—¶å€™ä¼šå­˜åœ¨æ··åˆXMLæ–‡ä»¶,Groovyè„šæœ¬ï¼Œå’Œç»„ä»¶ç±»å»é…ç½®ä¸€ä¸ªApplicationContextçš„æƒ…å†µã€‚\nä¸€äº›ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼ˆæ¯”å¦‚SpringBootï¼‰å¯¹è¿™ç§æ··åˆç±»å‹åŠ è½½æä¾›äº†è‰¯å¥½çš„æ”¯æŒã€‚ä½†æ˜¯å¯¹Springæ¡†æ¶æœ¬èº«æ¥è¯´ï¼Œå› ä¸ºä¹‹å‰Springä¸æ”¯æŒè¿™ç§å½¢å¼çš„åŠ è½½ï¼Œæ‰€ä»¥åœ¨Spring-testæ¨¡å—ä¸­ï¼Œå¤§å¤šæ•°SmartContextLoaderå®ç°æ˜¯åªæ”¯æŒä¸€ç§èµ„æºç±»å‹çš„ã€‚ä½†æ˜¯ï¼Œè¿™ä¸æ„å‘³ç€ä½ å†™ä»£ç çš„æ—¶å€™åªèƒ½ç”¨ä¸€ç§ç±»å‹ã€‚GenericGroovyXmlContextLoaderå’ŒGenericGroovyXmlWebContextLoaderæœ‰äº›ä¸åŒï¼Œä»–ä»¬åŒæ—¶æ”¯æŒXMLé…ç½®æ–‡ä»¶å’ŒGroovyè„šæœ¬ã€‚æ­¤å¤–ï¼Œç¬¬ä¸‰æ–¹æ¡†æ¶å¯ä»¥é€šè¿‡@ContextConfigurationçš„å±æ€§locationså’Œclassesæ¥å®ç°å¤šç±»å‹èµ„æºæ”¯æŒï¼Œå¹¶ä¸”ï¼Œæœ‰TestContextæ¡†æ¶çš„æ ‡å‡†æµ‹è¯•æ”¯æŒï¼Œä½ è¿˜å¯ä»¥æœ‰å¦‚ä¸‹é€‰é¡¹ï¼š\nå¦‚æœä½ æƒ³ä½¿ç”¨ä¸€ç»„èµ„æºä½ç½®(xml,groovyè„šæœ¬)å’Œä¸€ç»„@Configurationç±»æ¥é…ç½®ä½ çš„æµ‹è¯•ï¼Œä½ å¿…é¡»é€‰æ‹©ä¸€ä¸ªä½œä¸ºå…¥å£ï¼Œè¿™ä¸ªå…¥å£å¿…é¡»includeæˆ–è€…importå…¶ä»–çš„èµ„æºã€‚æ¯”å¦‚è¯´ï¼Œåœ¨XMLæˆ–è€…Groovyè„šæœ¬ä¸­ï¼Œä½ å¯ä»¥include@Configurationç±»é€šè¿‡componentæ‰«ææˆ–è€…æŠŠä»–ä»¬ä½œä¸ºä¸€èˆ¬çš„Spring Beanå®šä¹‰ï¼Œåä¹‹ï¼Œåœ¨@Configurationç±»ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨@ImportResourceå»å¯¼å…¥XMLé…ç½®æ–‡ä»¶æˆ–è€…Groovyè„šæœ¬ã€‚æ³¨æ„è¿™ä¸ªæ–¹å¼åœ¨è¯­ä¹‰ä¸Šè·Ÿç”Ÿäº§é…ç½®åº”ç”¨ç›¸åŒï¼šåœ¨ç”Ÿäº§é…ç½®ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰XMLæˆ–è€…Groovyèµ„æºé›†åˆæŠ‘æˆ–@Configurationç±»é›†åˆå»åŠ è½½ä½ çš„ApplicationContextï¼Œä½†æ˜¯ä½ ä»ç„¶å¯ä»¥é€‰æ‹©includeæˆ–è€…importå…¶ä»–ç±»å‹çš„é…ç½®ã€‚\nContext Configuration with Context Initializers éœ€è¦é€šè¿‡åˆå§‹åŒ–ç¨‹åºæ„é€ ApplicationContextï¼Œä½¿ç”¨@ContextConfigurationæ³¨è§£çš„initializerså±æ€§å³å¯ï¼Œè¯¥å±æ€§éœ€è¦ä¸€ä¸ªå®ç°ApplicationcontextInitializerç±»çš„å¼•ç”¨æ•°ç»„ã€‚ç”³æ˜åˆå§‹åŒ–æ„é€ å™¨ä¹‹åï¼Œä»–ä»¬ä¼šè¢«æ‹¿æ¥åˆå§‹åŒ–ConfigurableApplicationContextã€‚æ³¨æ„æ¯ä¸ªåˆå§‹åŒ–ç¨‹åºæ”¯æŒçš„å…·ä½“ConfigurableApplicationContextç±»å‹å¿…é¡»è·Ÿä½¿ç”¨ä¸­çš„SmartContextLoaderæ‰€åˆ›å»ºçš„ApplicationContextç±»å‹å…¼å®¹ï¼ˆé€šå¸¸æ˜¯GenericApplicationContextï¼‰ã€‚æ­¤å¤–ï¼Œåˆå§‹åŒ–ç¨‹åºçš„è°ƒç”¨é¡ºåºä¾èµ–äºä»–ä»¬æ˜¯å¦å®ç°äº†Springçš„Orderedæ¥å£æˆ–è€…ä»¥@Orderæ³¨è§£ä¿®é¥°æˆ–è€…æ ‡å‡†çš„@Priorityæ³¨è§£ã€‚\n@ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from TestConfig\r// and initialized by TestAppCtxInitializer\r@ContextConfiguration(\rclasses = TestConfig.class,\rinitializers = TestAppCtxInitializer.class) class MyTest {\r// class body...\r}\r å¦‚æœä½ æ²¡æœ‰ç”³æ˜ä»»ä½•xmlï¼Œgroovyè„šæœ¬æˆ–è€…ç»„ä»¶ç±»ï¼Œä»…ä»…å£°æ˜äº†åˆå§‹åŒ–ç¨‹åºï¼Œé‚£ä¹ˆåˆå§‹åŒ–ç¨‹åºå°†è´Ÿè´£åŠ è½½contextä¸­çš„bean-ä¸¾ä¸ªä¾‹å­ï¼Œé€šè¿‡ç¼–ç¨‹æ–¹å¼ä»xmlæ–‡ä»¶æˆ–è€…é…ç½®ç±»ä¸­åŠ è½½beanå®šä¹‰ã€‚\n@ExtendWith(SpringExtension.class)\r// ApplicationContext will be initialized by EntireAppInitializer\r// which presumably registers beans in the context\r@ContextConfiguration(initializers = EntireAppInitializer.class) class MyTest {\r// class body...\r}\r Context Configuration Inheritance @ContextConfigurationæä¾›äº†inheritLocationså’ŒinheritInitializerså±æ€§æ¥è®¾ç½®å½“å‰æµ‹è¯•ç±»æ˜¯å¦ä»çˆ¶ç±»ç»§æ‰¿ èµ„æºä½ç½®æˆ–è€…ç»„ä»¶ç±»å’Œåˆå§‹åŒ–ç¨‹åº\n ä»Spring Framework 5.3å¼€å§‹ï¼Œå±æ€§ä¸ºfalseï¼Œé…ç½®ä¿¡æ¯è¿˜æ˜¯å¯ä»¥ä»åŒ…å›´ç±»ç»§æ‰¿\n ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†æµ‹è¯•ç±»ExtendedTestså¦‚ä½•æŒ‰ç…§base-config.xmlï¼Œextended-config.xmlçš„é¡ºåºåŠ è½½ApplicaitonContextã€‚extened-config.xmlå¯ä»¥è¦†ç›–base-config.xmlä¸­çš„beané…ç½®ã€‚\n@ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from \u0026quot;/base-config.xml\u0026quot;\r// in the root of the classpath\r@ContextConfiguration(\u0026quot;/base-config.xml\u0026quot;) class BaseTest {\r// class body...\r}\r// ApplicationContext will be loaded from \u0026quot;/base-config.xml\u0026quot; and\r// \u0026quot;/extended-config.xml\u0026quot; in the root of the classpath\r@ContextConfiguration(\u0026quot;/extended-config.xml\u0026quot;) class ExtendedTest extends BaseTest {\r// class body...\r}\r ç»„ä»¶ç±»ä¹ŸæŒ‰ç…§åŒæ ·çš„åŠ è½½é¡ºåºï¼Œè¦†ç›–è§„åˆ™ä¹Ÿå®Œå…¨ä¸€æ ·ï¼š\n// ApplicationContext will be loaded from BaseConfig\r@SpringJUnitConfig(BaseConfig.class) class BaseTest {\r// class body...\r}\r// ApplicationContext will be loaded from BaseConfig and ExtendedConfig\r@SpringJUnitConfig(ExtendedConfig.class) class ExtendedTest extends BaseTest {\r// class body...\r}\r ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†åˆå§‹åŒ–ç¨‹åºçš„ç»§æ‰¿å…³ç³»ï¼Œä»–ä»¬çš„æ‰§è¡Œé¡ºåºè·Ÿçˆ¶å­å…³ç³»æ— å…³ï¼Œå‚è€ƒä¸Šä¸€ç« èŠ‚å¯¹åˆå§‹åŒ–ç¨‹åºæ‰§è¡Œé¡ºåºçš„æè¿°ï¼š\n// ApplicationContext will be initialized by BaseInitializer\r@SpringJUnitConfig(initializers = BaseInitializer.class) class BaseTest {\r// class body...\r}\r// ApplicationContext will be initialized by BaseInitializer\r// and ExtendedInitializer\r@SpringJUnitConfig(initializers = ExtendedInitializer.class) class ExtendedTest extends BaseTest {\r// class body...\r}\r Context Configuration with Environment Profiles å½“æœ‰å¤šä¸ªç¯å¢ƒçš„é…ç½®æ—¶ï¼ŒSpringæä¾›@ActiveProfilesæ³¨è§£ï¼Œå¯ä»¥è®©ä½ æŒ‡å®šå½“å‰æ¿€æ´»çš„ç¯å¢ƒé…ç½®ã€‚\n ä½ å¯ä»¥åœ¨ä»»ä½•SmartContextLoaderçš„å®ç°ç±»ä¸Šä½¿ç”¨@ActvieProfilesæ³¨è§£ï¼Œä½†æ˜¯æ—§çš„ContextLoaderå®ç°ä¸Šæ˜¯ä¸æ”¯æŒçš„\n ä¸‹é¢æ˜¯ä¸€ä¸ªxmlé…ç½®å’Œä¸€ä¸ª@Configurationé…ç½®ç±»\n\u0026lt;!-- app-config.xml --\u0026gt;\r\u0026lt;beans xmlns=\u0026quot;http://www.springframework.org/schema/beans\u0026quot;\rxmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxmlns:jdbc=\u0026quot;http://www.springframework.org/schema/jdbc\u0026quot;\rxmlns:jee=\u0026quot;http://www.springframework.org/schema/jee\u0026quot;\rxsi:schemaLocation=\u0026quot;...\u0026quot;\u0026gt;\r\u0026lt;bean id=\u0026quot;transferService\u0026quot;\rclass=\u0026quot;com.bank.service.internal.DefaultTransferService\u0026quot;\u0026gt;\r\u0026lt;constructor-arg ref=\u0026quot;accountRepository\u0026quot;/\u0026gt;\r\u0026lt;constructor-arg ref=\u0026quot;feePolicy\u0026quot;/\u0026gt;\r\u0026lt;/bean\u0026gt;\r\u0026lt;bean id=\u0026quot;accountRepository\u0026quot;\rclass=\u0026quot;com.bank.repository.internal.JdbcAccountRepository\u0026quot;\u0026gt;\r\u0026lt;constructor-arg ref=\u0026quot;dataSource\u0026quot;/\u0026gt;\r\u0026lt;/bean\u0026gt;\r\u0026lt;bean id=\u0026quot;feePolicy\u0026quot;\rclass=\u0026quot;com.bank.service.internal.ZeroFeePolicy\u0026quot;/\u0026gt;\r\u0026lt;beans profile=\u0026quot;dev\u0026quot;\u0026gt;\r\u0026lt;jdbc:embedded-database id=\u0026quot;dataSource\u0026quot;\u0026gt;\r\u0026lt;jdbc:script\rlocation=\u0026quot;classpath:com/bank/config/sql/schema.sql\u0026quot;/\u0026gt;\r\u0026lt;jdbc:script\rlocation=\u0026quot;classpath:com/bank/config/sql/test-data.sql\u0026quot;/\u0026gt;\r\u0026lt;/jdbc:embedded-database\u0026gt;\r\u0026lt;/beans\u0026gt;\r\u0026lt;beans profile=\u0026quot;production\u0026quot;\u0026gt;\r\u0026lt;jee:jndi-lookup id=\u0026quot;dataSource\u0026quot; jndi-name=\u0026quot;java:comp/env/jdbc/datasource\u0026quot;/\u0026gt;\r\u0026lt;/beans\u0026gt;\r\u0026lt;beans profile=\u0026quot;default\u0026quot;\u0026gt;\r\u0026lt;jdbc:embedded-database id=\u0026quot;dataSource\u0026quot;\u0026gt;\r\u0026lt;jdbc:script\rlocation=\u0026quot;classpath:com/bank/config/sql/schema.sql\u0026quot;/\u0026gt;\r\u0026lt;/jdbc:embedded-database\u0026gt;\r\u0026lt;/beans\u0026gt;\r\u0026lt;/beans\u0026gt;\r @ExtendWith(SpringExtension.class)\r// ApplicationContext will be loaded from \u0026quot;classpath:/app-config.xml\u0026quot;\r@ContextConfiguration(\u0026quot;/app-config.xml\u0026quot;)\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\rclass TransferServiceTest {\r@Autowired\rTransferService transferService;\r@Test\rvoid testTransferService() {\r// test the transferService\r}\r}\r å½“TransferServiceTestè¿è¡Œæ—¶ï¼Œä»–çš„ApplicationContextä¼šä»app-config.xmlé…ç½®æ–‡ä»¶åŠ è½½ã€‚æŸ¥çœ‹app-config.xmlä½ ä¼šå‘ç°ï¼ŒaccountRepositoryæœ‰ä¸€ä¸ªdataSourcebeanä¾èµ–ï¼Œä½†æ˜¯è¿™ä¸ªdataSourcebeanæ²¡æœ‰å®šä¹‰ä¸ºä¸€ä¸ªé¡¶çº§çš„beanï¼Œç›¸åï¼ŒdataSourcebeanå®šä¹‰äº†ä¸‰æ¬¡ï¼Œåˆ†åˆ«åœ¨productionprofileï¼Œdevprofileï¼Œå’Œdefaultprofileã€‚\né€šè¿‡@ActiveProfiles(\u0026quot;dev\u0026quot;)ï¼Œæˆ‘ä»¬å‘½ä»¤Springå¯ç”¨{\u0026quot;dev\u0026quot;}é…ç½®ä¿¡æ¯å»åŠ è½½ApplicationContextã€‚æœ€ç»ˆï¼Œä¼šåˆ›å»ºä¸€ä¸ªé›†æˆæ•°æ®åº“å¹¶å¡«å……æµ‹è¯•æ•°æ®ï¼Œå¹¶ä¸”accountRepositroyè£…é…æ—¶ä¼šå¸¦ä¸Šä¸€ä¸ªå¼€å‘çš„DataSourceå¼•ç”¨ã€‚\nå½“æ²¡æœ‰æ˜ç¡®æŒ‡å®šä¸€ä¸ªprofileæ—¶ï¼ŒSpringä¼šå¯ç”¨defaultprofileã€‚ä»–å¯ä»¥ä½œä¸ºä¸€ä¸ªé»˜è®¤çš„å¤‡ç”¨æ–¹æ¡ˆã€‚\nä¸‹é¢å±•ç¤ºå¦‚ä½•ä½¿ç”¨@Configurationæ›¿ä»£xmlé…ç½®ï¼š\n@Configuration\r@Profile(\u0026quot;dev\u0026quot;)\rpublic class StandaloneDataConfig {\r@Bean\rpublic DataSource dataSource() {\rreturn new EmbeddedDatabaseBuilder()\r.setType(EmbeddedDatabaseType.HSQL)\r.addScript(\u0026quot;classpath:com/bank/config/sql/schema.sql\u0026quot;)\r.addScript(\u0026quot;classpath:com/bank/config/sql/test-data.sql\u0026quot;)\r.build();\r}\r}\r @Configuration\r@Profile(\u0026quot;production\u0026quot;)\rpublic class JndiDataConfig {\r@Bean(destroyMethod=\u0026quot;\u0026quot;)\rpublic DataSource dataSource() throws Exception {\rContext ctx = new InitialContext();\rreturn (DataSource) ctx.lookup(\u0026quot;java:comp/env/jdbc/datasource\u0026quot;);\r}\r}\r @Configuration\r@Profile(\u0026quot;default\u0026quot;)\rpublic class DefaultDataConfig {\r@Bean\rpublic DataSource dataSource() {\rreturn new EmbeddedDatabaseBuilder()\r.setType(EmbeddedDatabaseType.HSQL)\r.addScript(\u0026quot;classpath:com/bank/config/sql/schema.sql\u0026quot;)\r.build();\r}\r}\r @Configuration\rpublic class TransferServiceConfig {\r@Autowired DataSource dataSource;\r@Bean\rpublic TransferService transferService() {\rreturn new DefaultTransferService(accountRepository(), feePolicy());\r}\r@Bean\rpublic AccountRepository accountRepository() {\rreturn new JdbcAccountRepository(dataSource);\r}\r@Bean\rpublic FeePolicy feePolicy() {\rreturn new ZeroFeePolicy();\r}\r}\r @SpringJUnitConfig({\rTransferServiceConfig.class,\rStandaloneDataConfig.class,\rJndiDataConfig.class,\rDefaultDataConfig.class})\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\rclass TransferServiceTest {\r@Autowired\rTransferService transferService;\r@Test\rvoid testTransferService() {\r// test the transferService\r}\r}\r ä¸Šé¢çš„ä¾‹å­ä¸­å°†xmlé…ç½®æ–‡ä»¶æ‹†åˆ†æˆå››ä¸ªç‹¬ç«‹çš„@Configurationç±»ï¼š\n TransferServiceConfigï¼šä½¿ç”¨@Autowiredæ³¨è§£é€šè¿‡ä¾èµ–æ³¨å…¥è·å–ä¸€ä¸ªdataSource StandaloneDataConfigï¼šä¸ºå¼€å‘æµ‹è¯•å®šä¹‰ä¸€ä¸ªdataSourceï¼Œå®ƒé›†æˆäº†ä¸€ä¸ªæ•°æ®åº“ JndiDataCOnfigï¼šä¸ºç”Ÿäº§ç¯å¢ƒå®šä¹‰ä¸€ä¸ªdataSrouceï¼Œä»JNDIæ£€ç´¢è€Œå¾— DefaultDataConfigï¼šå®šä¹‰ä¸€ä¸ªé»˜è®¤ç¯å¢ƒï¼Œç”³æ˜äº†ä¸€ä¸ªé›†æˆçš„æ•°æ®åº“  è·Ÿxmlé…ç½®ä¸€æ ·,TransferServiceTeståŒæ ·å£°æ˜äº†@ActiveProfiles(\u0026quot;dev\u0026quot;)ï¼Œä½†æ˜¯è¿™æ¬¡ç”³æ˜äº†æ‰€æœ‰ç»„ä»¶ç±»ã€‚æµ‹è¯•ç±»çš„å…·ä½“å†…å®¹æ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚\né€šå¸¸æƒ…å†µä¸‹ï¼Œé…ç½®ä¿¡å¿ƒä¼šç”¨åœ¨å¤šä¸ªæµ‹è¯•ç±»ä¸Šï¼Œä¸ºäº†é¿å…é‡å¤ç”³æ˜ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåŸºç±»å»é…ç½®@ActiveProfilesæ³¨è§£ï¼Œä»¥åŠå…¶ä»–æ³¨è§£é…ç½®ï¼Œç„¶åå…¶ä»–çš„æµ‹è¯•ç±»éƒ½å®ç°è¿™ä¸ªåŸºç±»ï¼š\n ä»Spring Framework 5.3å¼€å§‹ï¼Œæµ‹è¯•é…ç½®å¯ä»¥ä»åŒ…å›´ç±»ç»§æ‰¿\n @SpringJUnitConfig({\rTransferServiceConfig.class,\rStandaloneDataConfig.class,\rJndiDataConfig.class,\rDefaultDataConfig.class})\r@ActiveProfiles(\u0026quot;dev\u0026quot;)\rabstract class AbstractIntegrationTest {\r}\r // \u0026quot;dev\u0026quot; profile inherited from superclass\rclass TransferServiceTest extends AbstractIntegrationTest {\r@Autowired\rTransferService transferService;\r@Test\rvoid testTransferService() {\r// test the transferService\r}\r}\r @ActvieProfilesæ³¨è§£æ”¯æŒinheritProfileså±æ€§ï¼Œæä¾›ä¸€ä¸ªbooleanå€¼å°±å¯ä»¥é…ç½®æ˜¯å¦ä»çˆ¶ç±»é›†æˆé…ç½®ä¿¡æ¯ï¼š\n// \u0026quot;dev\u0026quot; profile overridden with \u0026quot;production\u0026quot;\r@ActiveProfiles(profiles = \u0026quot;production\u0026quot;, inheritProfiles = false)\rclass ProductionTransferServiceTest extends AbstractIntegrationTest {\r// test body\r}\r æ­¤å¤–ï¼Œæœ‰äº›æ—¶å€™åªèƒ½ç”¨ç¼–ç¨‹çš„å½¢å¼è§£æè¦æ¿€æ´»å“ªä¸ªé…ç½®ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ç”¨å£°æ˜çš„æ–¹å¼-åŸºäºä¸‹é¢è¿™å‡ ä¸ªæ–¹é¢ï¼š\n å½“å‰çš„æ“ä½œç³»ç»Ÿ æµ‹è¯•æ˜¯å¦è¿è¡Œåœ¨ä¸€ä¸ªä¸æ–­é›†æˆæ„å»ºçš„æœåŠ¡ æ˜¯å¦å­˜åœ¨æŸä¸€ç¯å¢ƒå‚æ•° æ˜¯å¦å­˜åœ¨ç±»çº§åˆ«çš„è‡ªå®šä¹‰æ³¨è§£ å…¶ä»–æƒ…å†µ  é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼è§£ææ¿€æ´»çš„é…ç½®ï¼Œä½ éœ€è¦å®ç°ActiveProfilesResolverå¹¶ä¸”é€šè¿‡resolverå±æ€§å»æ³¨å†Œå®ƒã€‚æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒjavadoc ï¼š\n// \u0026quot;dev\u0026quot; profile overridden programmatically via a custom resolver\r@ActiveProfiles(\rresolver = OperatingSystemActiveProfilesResolver.class,\rinheritProfiles = false)\rclass TransferServiceTest extends AbstractIntegrationTest {\r// test body\r}\r public class OperatingSystemActiveProfilesResolver implements ActiveProfilesResolver {\r@Override\rpublic String[] resolve(Class\u0026lt;?\u0026gt; testClass) {\rString profile = ...;\r// determine the value of profile based on the operating system\rreturn new String[] {profile};\r}\r}\r Context Configuration with Test Property Sources ç›¸å¯¹äº@Configurationé…ç½®çš„@PropertySourceï¼Œä½ åŒæ ·å¯ä»¥ä½¿ç”¨@TestPropertySourceåœ¨æµ‹è¯•ç±»ä¸Šå»å£°æ˜å±æ€§èµ„æºã€‚è¿™äº›ç”³æ˜çš„æµ‹è¯•å±æ€§èµ„æºä¼šè¢«æ·»åŠ åˆ°Environmentä¸­çš„PropertySourceé›†åˆä¸­ï¼Œä¸ºæ³¨è§£çš„é›†æˆæµ‹è¯•ç±»åŠ è½½ApplicationContextã€‚\n ä½ å¯ä»¥åœ¨ä»»ä½•å®ç°SmartContextLoaderçš„ç±»ä¸Šä½¿ç”¨@TestPropertySourceï¼Œä½†æ˜¯ä»–ä¸æ”¯æŒåœ¨ContextLoaderçš„å®ç°ä¸Šç”³æ˜ã€‚\nSmartContextLoaderçš„å®ç°å¯ä»¥é€šè¿‡MergedContextConfiguraitonä¸­çš„getPropertySourceLocations()å’ŒgetPropertySourceProperties()æ–¹æ³•æ¥åˆå¹¶æµ‹è¯•å±æ€§èµ„æºå€¼ã€‚\n å£°æ˜æµ‹è¯•å±æ€§èµ„æº ä½ å¯ä»¥é€šè¿‡@TestPropertySourceçš„locationså’Œvalueå±æ€§æ¥é…ç½®æµ‹è¯•çš„å±æ€§æ–‡ä»¶ã€‚\nä¼ ç»Ÿçš„å’ŒXMLåŸºç¡€çš„å±æ€§æ–‡ä»¶æ ¼å¼éƒ½æ”¯æŒ-ä¸¾ä¸ªä¾‹å­classpath:/com/example/test.propertiesæˆ–è€…file:///path/to/file.xml\næ¯ä¸ªpathéƒ½ä¼šè¢«ç¿»è¯‘ä¸ºä¸€ä¸ªSpringResourceã€‚ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼ˆæ¯”å¦‚\u0026quot;test.properties)ä¼šè¢«çœ‹åšä¸€ä¸ªclasspathèµ„æºï¼Œä»–æŒ‡å‘äº†å½“å‰æµ‹è¯•ç±»æ‰€åœ¨çš„åŒ…ã€‚å¦‚æœä¸€ä¸ªè·¯å¾„æ˜¯ä»¥æ–œçº¿å¼€å¤´ï¼Œä¼šè¢«å½“åšç»å¯¹è·¯å¾„ï¼ˆæ¯”å¦‚ï¼š\u0026quot;/org/example/test.xml\u0026rdquo;ï¼‰ã€‚å¼•ç”¨äº†URLçš„è·¯å¾„ï¼ˆæ¯”å¦‚è¯´ï¼Œä»¥classpath:ï¼Œfile:ï¼Œæˆ–è€…http:å¼€å¤´çš„è·¯å¾„ï¼‰ä¼šä½¿ç”¨æŒ‡å®šçš„èµ„æºåè®®å»åŠ è½½ã€‚èµ„æºä½ç½®é€šé…ç¬¦ï¼ˆæ¯”å¦‚*/.propertiesï¼‰æ˜¯ä¸å…è®¸çš„ï¼šæ¯ä¸ªä½ç½®å¿…é¡»è¢«è§£æä¸ºä¸€ä¸ªå…·ä½“çš„.propertiesæˆ–è€….xmlèµ„æºã€‚\n@ContextConfiguration\r@TestPropertySource(\u0026quot;/test.properties\u0026quot;) class MyIntegrationTests {\r// class body...\r}\r ä½ å¯ä»¥é…ç½®å†…è”å±æ€§é€šè¿‡propertieså±æ€§ï¼Œä»¥key-valueçš„ç»“æ„èµ‹å€¼ï¼Œä¸‹é¢çš„ä¾‹å­ä¼šå±•ç¤ºå¦‚ä½•ä½¿ç”¨ã€‚æ‰€æœ‰çš„key-valueå€¼å¯¹ä¼šè¢«æ·»åŠ åˆ°åŒ…å›´çš„Environmentä¸­ï¼Œå¯¹ä¸€ä¸ªå•ç‹¬æµ‹è¯•PropertySourceå®ƒä»¬æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ã€‚\nkey-valueå€¼å¯¹æ”¯æŒçš„è¯­æ³•è·Ÿjavaå±æ€§æ–‡ä»¶ä¸­çš„é”®å€¼å®šä¹‰è¯­æ³•ä¸€æ ·ï¼š\n key=value key:value key value  @ContextConfiguration\r@TestPropertySource(properties = {\u0026quot;timezone = GMT\u0026quot;, \u0026quot;port: 4242\u0026quot;}) class MyIntegrationTests {\r// class body...\r}\r  ä»Spring Framework 5.2å¼€å§‹ï¼Œ@TestPropertySourceå¯ä»¥è¢«ç”¨ä½œå¯é‡å¤æ³¨è§£ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä¸ºä¸€ä¸ªæµ‹è¯•ç±»å£°æ˜å¤šæ¬¡è¯¥æ³¨è§£ã€‚åé¢çš„@TestPropertySourceçš„locationså’Œpropertieså±æ€§ä¼šè¦†ç›–ä¹‹å‰@TestPropertySourceå£°æ˜çš„ã€‚\nå¦å¤–ï¼Œä½ ç”³æ˜çš„å¤åˆæ³¨è§£é‡Œé¢å¯èƒ½éƒ½åŒ…å«äº†@TestPropertySourceï¼Œé‚£ä¹ˆæ‰€æœ‰çš„@TestPropertySourceéƒ½ä¼šä¸ºä½ çš„æµ‹è¯•å±æ€§æä¾›èµ„æºã€‚\nç›´æ¥å£°æ˜çš„@TestPropertySourceçš„ä¼˜å…ˆçº§éƒ½ä¼šé«˜äºå¤åˆæ³¨è§£ä¸­çš„å£°æ˜\n é»˜è®¤å±æ€§æ–‡ä»¶æ£€æµ‹ å¦‚æœ@TestPropertySourceæ³¨è§£çš„locationså’Œpropertieså±æ€§éƒ½æ²¡æœ‰å£°æ˜ï¼Œé‚£ä¹ˆä»–ä¼šæŸ¥æ‰¾ä¸€ä¸ªé»˜è®¤çš„å±æ€§æ–‡ä»¶ï¼Œè·¯å¾„åŸºäºå½“å‰æ³¨è§£ä¿®é¥°çš„æµ‹è¯•ç±»æ‰€åœ¨ä½ç½®ã€‚æ¯”å¦‚æµ‹è¯•ç±»åœ¨com.example.MyTestï¼Œé‚£ä¹ˆé»˜è®¤çš„å±æ€§æ–‡ä»¶è·¯å¾„ä¸ºclasspath:com/example/MyTest.propertiesã€‚å¦‚æœæ‰¾ä¸åˆ°é»˜è®¤æ–‡ä»¶ï¼Œé‚£ä¹ˆå°†ä¼šæŠ›å‡ºä¸€ä¸ªIllegalStateExceptionã€‚\nä¼˜å…ˆçº§ æµ‹è¯•é…ç½®çš„å±æ€§ä¼˜å…ˆçº§æ¯”æ“ä½œç³»ç¯å¢ƒï¼Œjavaç³»ç»Ÿï¼Œæˆ–è€…ä»»ä½•é€šè¿‡@PropertySourceæˆ–è€…ç¼–ç¨‹æ–¹å¼å£°æ˜çš„å±æ€§é…ç½®ä¼˜å…ˆçº§éƒ½è¦é«˜ã€‚å› æ­¤æµ‹è¯•å±æ€§å¯ä»¥é€‰æ‹©æ€§çš„è¦†ç›–æ‰€æœ‰ç³»ç»Ÿå±æ€§å’Œapplicationå±æ€§èµ„æºã€‚æ­¤å¤–ï¼Œå†…è”å±æ€§çš„ä¼˜å…ˆçº§æ˜¯é«˜äºèµ„æºä½ç½®çš„ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸ªä¾‹å¤–ï¼Œç”±@DynamicPropertySourceç”³æ˜çš„å±æ€§ä¼˜å…ˆçº§æ˜¯é«˜äº@TestPropertySourceçš„ã€‚\nä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œtimezoneå’Œportå±æ€§å’Œå®šä¹‰åœ¨/test.propertiesä¸­çš„æ‰€æœ‰å±æ€§ä¼šè¦†ç›–åœ¨ç³»ç»Ÿæˆ–è€…applicationä¸­ç›¸åŒçš„å±æ€§åç§°é…ç½®ã€‚æ­¤å¤–å¦‚æœ/test.propertiesä¸­ä¹Ÿæœ‰timezoneå’Œportå±æ€§ï¼Œé‚£ä¹ˆä»–ä»¬ä¼šè¢«ç”±propertieså£°æ˜å†…è”å±æ€§æ‰€è¦†ç›–ã€‚\n@ContextConfiguration\r@TestPropertySource(\rlocations = \u0026quot;/test.properties\u0026quot;,\rproperties = {\u0026quot;timezone = GMT\u0026quot;, \u0026quot;port: 4242\u0026quot;}\r)\rclass MyIntegrationTests {\r// class body...\r}\r ç»§æ‰¿å¹¶è¦†ç›–æµ‹è¯•å±æ€§èµ„æº @TestPropertySourceæ”¯æŒinheritLocationså’ŒinheritPropertieså±æ€§æ¥è®¾ç½®æ˜¯å¦ä»çˆ¶ç±»ç»§æ‰¿é…ç½®ä½ç½®å’Œå†…è”å±æ€§ä¿¡æ¯ï¼Œè¿™ä¸¤ä¸ªå‚æ•°çš„é»˜è®¤å€¼éƒ½ä¸ºtureã€‚åœ¨å€¼ä¸ºtureçš„æƒ…å†µä¸‹ï¼Œå°±ä»£è¡¨å¯ä»¥ä»çˆ¶ç±»ç»§æ‰¿é…ç½®ä¿¡æ¯ï¼Œå¹¶ä¸”å¦‚æœæœ‰ç›¸åŒåç§°çš„é…ç½®ï¼Œé‚£ä¹ˆåå‡ºç°çš„ä¼šè¦†ç›–ä¹‹å‰çš„ã€‚å…¶ä»–çš„ä¼˜å…ˆçº§ä¿¡æ¯è·Ÿå‰é¢ç« èŠ‚æåˆ°çš„ä¸€è‡´ã€‚\nå¦‚æœinheritLocationså’ŒinheritPropertieså±æ€§ä¸ºfalseï¼Œé‚£ä¹ˆä¸€ä¸å°±æ˜¯ä¸ä»çˆ¶ç±»ç»§æ‰¿é…ç½®ä¿¡æ¯ï¼Œå½“å‰æµ‹è¯•ç±»çš„é…ç½®ä¼šæ›¿ä»£çˆ¶ç±»çš„ã€‚\n ä»Spring Framework 5.3å¼€å§‹ï¼Œæµ‹è¯•é…ç½®å¯ä»¥ä»ç¯ç»•ç±»ä¸­è·å–\n ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†æ€ä¹ˆä»çˆ¶ç±»ç»§æ‰¿é…ç½®èµ„æºä½ç½®ä¿¡æ¯ï¼š\n@TestPropertySource(\u0026quot;base.properties\u0026quot;)\r@ContextConfiguration\rclass BaseTest {\r// ...\r}\r@TestPropertySource(\u0026quot;extended.properties\u0026quot;)\r@ContextConfiguration\rclass ExtendedTest extends BaseTest {\r// ...\r}\r ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä»çˆ¶ç±»ç»§æ‰¿å†…è”å±æ€§ï¼š\n@TestPropertySource(properties = \u0026quot;key1 = value1\u0026quot;)\r@ContextConfiguration\rclass BaseTest {\r// ...\r}\r@TestPropertySource(properties = \u0026quot;key2 = value2\u0026quot;)\r@ContextConfiguration\rclass ExtendedTest extends BaseTest {\r// ...\r}\r Context Configuration with Dynamic Property Sources ä»Spring Framework 5.2.5ç‰ˆæœ¬å¼€å§‹ï¼ŒTestContext æ¡†æ¶é€šè¿‡@DynamicPropertySourceæ³¨è§£æä¾›äº†åŠ¨æ€å±æ€§çš„æ”¯æŒã€‚è¿™ä¸ªæ³¨è§£å¯ä»¥åœ¨ç»§æ‰¿æµ‹è¯•ç±»éœ€è¦åŠ¨æ€èµ„æºå±æ€§çš„æ—¶å€™æä¾›å¸®åŠ©ã€‚\nç›¸å¯¹äºä½œç”¨åœ¨ç±»çº§åˆ«çš„@TestPropertySourceï¼Œ@DynamicPropertySourceåªèƒ½ä½œç”¨åœ¨é™æ€æ–¹æ³•ä¸Šï¼Œå¹¶ä¸”è¯¥æ–¹æ³•å¿…é¡»æœ‰ä¸€ä¸ªDynamicPropertyRegistryå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°è¢«ç”¨æ¥å‘Environmentæ·»åŠ  name-value æ ¼å¼çš„æ•°æ®ã€‚è¿™äº›åŠ¨æ€çš„å‚æ•°å€¼éƒ½æ˜¯é€šè¿‡ä¸€ä¸ªSupplieræ¥æä¾›çš„ï¼Œå®ƒåªæœ‰åœ¨å±æ€§è¢«è§£æçš„æ—¶å€™æ‰ä¼šè°ƒç”¨ã€‚é€šå¸¸æ¥è¯´ï¼Œæ–¹æ³•å¼•ç”¨å°±æ˜¯è¢«ç”¨æ¥æä¾›å‚æ•°çš„ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­ä¸€æ ·ï¼Œä½¿ç”¨TestContainersé¡¹ç›®å»ç®¡ç†ä¸€ä¸ªåœ¨Spring ApplicationContextä¹‹å¤–çš„Redis containerã€‚é€šè¿‡redis.hostå’Œredis.portå±æ€§ï¼Œè®©rediså®¹å™¨ç®¡ç†çš„ipå’Œhostä¹Ÿå¯¹testApplicationContextçš„ç»„ä»¶å¯ç”¨ã€‚è¿™äº›å±æ€§å¯ä»¥é€šè¿‡Springçš„EnvironmentæŠ½è±¡è®¿é—®æˆ–è€…ç›´æ¥åœ¨Springç®¡ç†çš„ç»„ä»¶ä¸­æ³¨å…¥-ä¸¾ä¸ªä¾‹å­ï¼Œåˆ†åˆ«é€šè¿‡@Value(\u0026quot;${redis.host}\u0026quot;)å’Œ@Value(\u0026quot;${redis.port}\u0026quot;)èµ‹å€¼\n å¦‚æœä½ çš„@DynamicPropertySourceå£°æ˜åœ¨åŸºç±»ï¼Œå¹¶ä¸”å­ç±»æµ‹è¯•å¤±è´¥ï¼Œå› ä¸ºå±æ€§å€¼åœ¨å­ç±»ä¹‹ä¸­å·²ç»è¢«æ”¹å˜ã€‚é‚£ä¹ˆä½ éœ€è¦åœ¨åŸºç±»ä¸Šå£°æ˜@DirtiesContextï¼Œä»¥ç¡®ä¿æ¯ä¸ªå­ç±»çš„ApplcationContextéƒ½æœ‰æ­£ç¡®çš„å±æ€§å€¼\n @SpringJUnitConfig(/* ... */)\r@Testcontainers\rclass ExampleIntegrationTests {\r@Container\rstatic RedisContainer redis = new RedisContainer();\r@DynamicPropertySource\rstatic void redisProperties(DynamicPropertyRegistry registry) {\rregistry.add(\u0026quot;redis.host\u0026quot;, redis::getContainerIpAddress);\rregistry.add(\u0026quot;redis.port\u0026quot;, redis::getMappedPort);\r}\r// tests ...\r}\r ä¼˜å…ˆçº§ åŠ¨æ€å±æ€§æ‹¥æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œæ„æ€å°±æ˜¯ä¼šè¦†ç›–æ¥è‡ª@TestPropertySourceã€æ“ä½œç³»ç»Ÿç¯å¢ƒã€javaç³»ç»Ÿå±æ€§ã€æˆ–è€…é€šè¿‡@PropertySourceå’Œç¼–ç æ–¹å¼ç”³æ˜çš„å±æ€§ã€‚å› ä¸ºä»–çš„é«˜ä¼˜å…ˆçº§ç‰¹æ€§ï¼Œå¯ä»¥ç”¨æ¥è¦†ç›–æŒ‡å®šçš„å±æ€§å€¼ã€‚\nLoading a WebApplicationContext å¦‚æœä½ éœ€è¦çš„ä¸Šä¸‹æ–‡å¯¹è±¡æ˜¯WebApplcationContextè€Œä¸æ˜¯ApplicationContextï¼Œé‚£ä½ éœ€è¦åœ¨æ¯ä¸ªæµ‹è¯•ç±»ä¸Šå£°æ˜@WebAppConfigurationæ³¨è§£ã€‚\nåœ¨TestContextæ¡†æ¶ä¸ºä½ çš„æµ‹è¯•ç±»ç”ŸæˆWebApplicationContextæ—¶ï¼Œä¼šåœ¨åå°ä¸ºä½ çš„WebApplicationContextæä¾›ä¸€ä¸ªMockServletContextã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMockServletContextçš„åŸºç¡€èµ„æºè·¯å¾„è¢«è®¾å®šä¸ºsrc/main/webappã€‚è¿™ä¸ªç›¸å¯¹è·¯å¾„è·ŸJVMçš„æ ¹è·¯å¾„å…³è”ï¼ˆä¸€èˆ¬æ¥è¯´å°±æ˜¯ä½ çš„é¡¹ç›®è·¯å¾„ï¼‰ã€‚å¦‚æœä½ ç†Ÿæ‚‰mavené¡¹ç›®çš„Webåº”ç”¨ç›®å½•ç»“æ„ï¼Œä½ è‚¯å®šçŸ¥é“WARæ ¹ç›®å½•çš„é»˜è®¤ä½ç½®å°±æ˜¯src/main/webappã€‚ä½ å¯ä»¥æä¾›è‡ªå®šä¹‰è·¯å¾„å»è¦†ç›–é»˜è®¤çš„ï¼ˆ@WebAppConfiguration(\u0026quot;src/test/webapp\u0026quot;)ï¼‰ã€‚å¦‚æœä½ æƒ³å¼•ç”¨çš„åŸºç¡€èµ„æºè·¯å¾„æ˜¯æ¥è‡ªclasspathè€Œä¸æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨Springçš„classpath:å‰ç¼€ã€‚\næ³¨æ„Springæµ‹è¯•å¯¹WebApplicationContextå®ç°çš„æ”¯æŒç­‰åŒäºå¯¹ApplicationContextå®ç°çš„æ”¯æŒã€‚è¿™å¥è¯çš„æ„æ€å°±æ˜¯ApplicationContextå¯ç”¨çš„æ³¨è§£ï¼ŒWebaApplicationContextåŒæ ·å¯ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨æ–¹å¼ä¹Ÿä¸€æ ·-ä¾‹å¦‚ï¼š@Configurationã€@ContextConfigurationã€@ActiveProfilesã€@TestExecutionListenersã€@Sqlã€@Rollbackï¼Œç­‰ç­‰å…¶ä»–æ³¨è§£ã€‚\nä¸‹é¢ä¾‹å­å±•ç¤ºå¦‚æœåŠ è½½WebApplicationContextã€‚ç¬¬ä¸€ä¸ªä¾‹å­å±•ç¤ºé»˜è®¤é…ç½®ï¼š\n@ExtendWith(SpringExtension.class)\r// defaults to \u0026quot;file:src/main/webapp\u0026quot;\r@WebAppConfiguration\r// detects \u0026quot;WacTests-context.xml\u0026quot; in the same package\r// or static nested @Configuration classes\r@ContextConfiguration\rclass WacTests {\r//...\r}\r å¦‚æœ@WebAppConfigurationæ²¡æœ‰æŒ‡å®šä¸€ä¸ªåŸºç¡€èµ„æºè·¯å¾„ï¼Œé‚£ä¹ˆé»˜è®¤çš„file:src/main/webappè·¯å¾„å°†ä¼šä½¿ç”¨ã€‚åŒæ ·çš„ï¼Œå¦‚æœç”³æ˜@ContextConfigurationæ²¡æœ‰æŒ‡å®šèµ„æºlocationsï¼Œç»„ä»¶ç±»ï¼Œæˆ–è€…contextinitializersï¼ŒSpringä¼šå°è¯•åœ¨å½“å‰æµ‹è¯•ç±»çš„æ‰€åœ¨è·¯å¾„æ£€æµ‹WacTests-context.xmlæ–‡ä»¶ï¼Œæˆ–è€…é™æ€é›†æˆçš„@Configurationç±»ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•æ¸…æ™°çš„å£°æ˜ä¸€ä¸ª@WebAppConfigurationåŸºç¡€èµ„æºè·¯å¾„ï¼Œå’Œ@ContextConfigurationçš„XMLèµ„æºè·¯å¾„ï¼š\n@ExtendWith(SpringExtension.class)\r// file system resource\r@WebAppConfiguration(\u0026quot;webapp\u0026quot;)\r// classpath resource\r@ContextConfiguration(\u0026quot;/spring/test-servlet-config.xml\u0026quot;)\rclass WacTests {\r//...\r}\r è¿™é‡Œæœ‰ä¸ªé‡è¦çš„äº‹æƒ…éœ€è¦æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ@WebAppConfigurationèµ„æºè·¯å¾„æ˜¯ä»¥æ–‡ä»¶ç³»ç»Ÿä¸ºåŸºç¡€çš„ï¼Œç„¶è€Œ@ContextConfigurationèµ„æºè·¯å¾„æ˜¯ä»¥classpathä¸ºåŸºç¡€çš„ã€‚\nä¸‹é¢å±•ç¤ºäº†å¦‚æœé€šè¿‡Springå‰ç¼€æ”¹å˜é»˜è®¤çš„è·¯å¾„è¯­æ³•ï¼š\n@ExtendWith(SpringExtension.class)\r// classpath resource\r@WebAppConfiguration(\u0026quot;classpath:test-web-resources\u0026quot;)\r// file system resource\r@ContextConfiguration(\u0026quot;file:src/main/webapp/WEB-INF/servlet-config.xml\u0026quot;)\rclass WacTests {\r//...\r}\r Web Mocks ä¸ºäº†æä¾›å®Œæ•´çš„æµ‹è¯•æ”¯æŒï¼ŒTestContextæ¡†æ¶é»˜è®¤å¯ç”¨äº†ServletTestExecutionListenerã€‚å½“åœ¨æµ‹è¯•ä¸€ä¸ªWebApplcationContextæ—¶ï¼ŒTestExecutionListeneråœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•ä¹‹å‰ï¼Œé€šè¿‡Spring Webçš„RequestContextHolderé…ç½®å¥½é»˜è®¤çš„çº¿ç¨‹æœ¬åœ°çŠ¶æ€ï¼Œå¹¶ä¸”åŸºäº@WebAppConfigurationé…ç½®çš„åŸºç¡€èµ„æºè·¯å¾„åˆ›å»ºMockHttpServletRequestï¼ŒMockHttpServletResponseï¼Œå’ŒServletWebRequestã€‚ServletTestExecutionListeneråŒæ—¶ä¹Ÿç¡®ä¿äº†MockHttpServletRequestå’ŒMockHttpServletResponseèƒ½å¤Ÿæ³¨å…¥åˆ°æµ‹è¯•å®ä¾‹å½“ä¸­ï¼Œå½“æµ‹è¯•å®Œæ¯•ï¼Œä»–ä¼šæ¸…ç©ºçº¿ç¨‹æœ¬åœ°çŠ¶æ€ã€‚\nä¸‹é¢çš„å®ä¾‹å±•ç¤ºäº†é‚£äº›mockå¯¹è±¡å¯ä»¥æ³¨å…¥åˆ°ä½ çš„æµ‹è¯•å®ä¾‹å½“ä¸­ã€‚æ³¨æ„WebApplicationContextå’ŒMockServletContextéƒ½æ˜¯è¢«ç¼“å­˜èµ·æ¥çš„é€šç”¨æµ‹è¯•å¯¹è±¡ï¼Œç„¶è€Œå…¶ä»–çš„mockå¯¹è±¡éƒ½æ˜¯æ¯ä¸ªæµ‹è¯•æ–¹æ³•ç»´æŠ¤ä¸€ä¸ªï¼Œå…¶ä¸­çš„é€»è¾‘æ˜¯é€šè¿‡ServletTestExecutionListeneræ¥å®ç°çš„ã€‚\n@SpringJUnitWebConfig\rclass WacTests {\r@Autowired\rWebApplicationContext wac; // cached\r@Autowired\rMockServletContext servletContext; // cached\r@Autowired\rMockHttpSession session;\r@Autowired\rMockHttpServletRequest request;\r@Autowired\rMockHttpServletResponse response;\r@Autowired\rServletWebRequest webRequest;\r//...\r}\r Context Caching ä¸€æ—¦TestContextæ¡†æ¶ä¸ºä¸€ä¸ªæµ‹è¯•åŠ è½½äº†ApplicationContext(æˆ–è€…WebApplicationContext)ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¼šè¢«ç¼“å­˜å¹¶ä¸”åœ¨æ¥ä¸‹æ¥çš„æµ‹è¯•ä¸­å¤ç”¨ã€‚æµ‹è¯•çš„ä¸Šä¸‹æ–‡å¯¹è±¡æ˜¯å¦ä»ç¼“å­˜ä¸­è¯»å–ï¼Œè¦çœ‹ä»–æ˜¯å¦ç”³æ˜äº†ç›¸åŒå”¯ä¸€çš„ä¸Šä¸‹æ–‡é…ç½®ï¼Œå¹¶ä¸”æ˜¯åœ¨åŒä¸€ä¸ªæµ‹è¯•å¥—ä»¶ä¸­ã€‚è¦äº†è§£æµ‹è¯•æ¡†æ¶çš„ç¼“å­˜æœºåˆ¶ï¼Œå°±å¿…é¡»çŸ¥é“å”¯ä¸€å’Œæµ‹è¯•å¥—ä»¶åˆ†åˆ«ä»£è¡¨äº†ä»€ä¹ˆã€‚\nSpringæµ‹è¯•æ¡†æ¶ä¼šæ ¹æ®contextçš„é…ç½®å‚æ•°ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„keyå€¼ã€‚ä¸‹é¢æ˜¯å½±å“è¿™ä¸ªkeyå€¼çš„é…ç½®å‚æ•°ï¼š\n locations (from @ContextConfiguration) classes (from @ContextConfiguration) contextInitializerClasses (from @ContextConfiguration) contextCustomizers (from ContextCustomizerFactory) â€“ è¿™ä¸ªåŒ…å«äº†@DynamicPropertySourceçš„æ–¹æ³•ä»¥åŠSpring Bootæ”¯æŒçš„æµ‹è¯•ç‰¹æ€§ï¼Œæ¯”å¦‚@MockBeanå’Œ@SpyBean contextLoader (from @ContextConfiguration) parent (from @ContextHierarchy) activeProfiles (from @ActiveProfiles) propertySourceLocations (from @TestPropertySource) propertySourceProperties (from @TestPropertySource) resourceBasePath (from @WebAppConfiguration)  ä¸¾ä¸ªä¾‹å­ï¼ŒTestClassAæ ¹æ®@ContextConfigurationçš„å±æ€§{\u0026quot;app-config.xml\u0026quot;, \u0026quot;test-config.xml\u0026quot;}åˆå§‹åŒ–äº†contextï¼Œæ¥ä¸‹æ¥æµ‹è¯•æ¡†æ¶ä¼šåŠ è½½è¯¥ApplicationContextå¹¶ä¸”æ ¹æ®å‰é¢çš„è·¯å¾„ç”Ÿæˆä¸€ä¸ªkeyï¼Œä¿å­˜åˆ°staticä¸Šä¸‹æ–‡ç¼“å­˜ä¸­ã€‚å¦‚æœTestClassBåŒæ ·ç”³æ˜äº†{\u0026quot;app-config.xml\u0026quot;, \u0026quot;test-config.xml\u0026quot;}ï¼Œå¹¶ä¸”æ²¡æœ‰@WebAppConfigurationï¼Œä¸ä¸€æ ·çš„ContextLoaderï¼Œä¸ä¸€æ ·çš„å¯ç”¨é…ç½®ï¼Œ ä¸ä¸€æ ·çš„ä¸Šä¸‹æ–‡åˆå§‹åŒ–ç¨‹åºï¼Œä¸ä¸€æ ·çš„æµ‹è¯•å±æ€§èµ„æºï¼Œæˆ–è€…ä¸ä¸€æ ·çš„çˆ¶ä¸Šä¸‹æ–‡ç±»ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç±»å°±ä¼šå…±äº«åŒä¸€ä¸ªApplicationContextã€‚\n æµ‹è¯•å¥—ä»¶å’Œåˆ†æ”¯è¿›ç¨‹\nSpringæµ‹è¯•æ¡†æ¶ç¼“å­˜ä¸Šä¸‹æ–‡å¯¹è±¡åœ¨ä¸€ä¸ªé™æ€çš„å‚æ•°é‡Œï¼Œæ„æ€å°±æ˜¯å¦‚æœæµ‹è¯•ç±»æ¥è‡ªä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹ï¼Œå°±ç®—æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶ï¼Œç¼“å­˜æœºåˆ¶ä¹Ÿä¸å¯èƒ½ç”Ÿæ•ˆã€‚\nå› æ­¤å¦‚æœæƒ³åˆ©ç”¨Springæµ‹è¯•çš„ä¸Šä¸‹æ–‡ç¼“å­˜æœºåˆ¶ï¼Œå¿…é¡»ç¡®ä¿åœ¨åŒä¸€ä¸ªè¿›ç¨‹æˆ–è€…åŒä¸€ä¸ªæµ‹è¯•å¥—ä»¶ä¸­ã€‚åŒæ ·ï¼Œå¦‚æœé€šè¿‡buildæ¡†æ¶æ‰§è¡Œçš„æµ‹è¯•ï¼Œæ¯”å¦‚Antï¼ŒMavenï¼Œæˆ–è€…Gradleï¼Œå¿…é¡»ç¡®ä¿buildæ¡†æ¶åœ¨æµ‹è¯•ä¹‹é—´æ²¡æœ‰forkã€‚æ¯”å¦‚è¯´ï¼ŒMaven Surefireæ’ä»¶çš„forkModeå¦‚æœè®¾ç½®ä¸ºalwaysæˆ–è€…pertestï¼Œé‚£ä¹ˆä¸Šä¸‹æ–‡ç¼“å­˜å°±ä¸ä¼šç”Ÿæ•ˆã€‚\n ä¸Šä¸‹æ–‡ç¼“å­˜çš„æœ€å¤§ä¸ªæ•°æ˜¯32ä¸ªã€‚å½“è¾¾åˆ°æœ€å¤§å€¼æ—¶ï¼Œä¸€ä¸ªæœ€è¿‘ä½¿ç”¨æœ€å°‘(LRU)çš„é©±é€ç­–ç•¥å°†ä¼šè¢«ä½¿ç”¨æ¥é©±é€å’Œå…³é—­é™ˆæ—§çš„ä¸Šä¸‹æ–‡ã€‚æƒ³é…ç½®ç¼“å­˜çš„æœ€å¤§æ•°é‡ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæˆ–è€…JVMç³»ç»Ÿå±æ€§çš„æ„å»ºè„šæœ¬ï¼Œåå­—å«spring.test.context.cache.maxSizeã€‚æˆ–è€…é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼ä½¿ç”¨SpringPropertiesè®¾ç½®ç›¸åŒçš„å±æ€§ã€‚\nç¼“å­˜å¤šä¸ªåº”ç”¨ä¸Šä¸‹æ–‡åœ¨ç»™å®šæµ‹è¯•å¥—ä»¶ä¸­ä¼šé€ æˆæµ‹è¯•å¥—ä»¶æ— æ„ä¹‰çš„é•¿æ—¶é—´è¿è¡Œï¼Œå½“ç„¶æœ€å¥½æ˜¯èƒ½çŸ¥é“ç›®å‰æœ‰å¤šå°‘ä¸ªä¸Šä¸‹æ–‡ç¼“å­˜ã€‚é€šè¿‡è®¾ç½®org.springframework.test.context.cacheçš„logç­‰çº§ä¸ºDEBUGå³å¯å®ç°ã€‚\næå°‘æ•°æƒ…å†µæµ‹è¯•ä¼šæ±¡æŸ“ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆæ¯”å¦‚ä¿®æ”¹beançš„å®šä¹‰æˆ–è€…ä¸Šä¸‹æ–‡å¯¹è±¡çš„çŠ¶æ€ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨@DirtiesContextæ³¨è§£æ¥è¡¨ç¤ºä¸‹æ¬¡æµ‹è¯•è¿è¡Œä¹‹å‰é‡è½½ä¸Šä¸‹æ–‡ã€‚è¿™ä¸ªæ³¨è§£æ˜¯DirtiesContextBeforeModesTestExecutionListenerå’ŒDirtiesContextTestExecutionListeneræä¾›çš„ï¼Œä»–ä»¬ä¸¤ä¸ªéƒ½æ˜¯é»˜è®¤å¯ç”¨ã€‚\nContext Hierarchies æœ‰æ—¶å€™éœ€è¦ç”¨åˆ°ä¸Šä¸‹æ–‡çš„å±‚æ¬¡ç»“æ„ï¼Œæ¯”å¦‚è¯´åœ¨å¼€å‘Spring MVC Webåº”ç”¨çš„æ—¶å€™ï¼Œä½ éœ€è¦ä¸€ä¸ªç”±SpringContextLoaderListeneråŠ è½½çš„æ ¹WebApplicationContextï¼Œå’Œä¸€ä¸ªç”±SpringDispatcherServletåŠ è½½çš„å­WebApplicationContextã€‚ç”±æ ¹å¯¹è±¡çš„ç”³æ˜çš„ç»„ä»¶å’ŒåŸºç¡€é…ç½®ä¼šåœ¨å­å¯¹è±¡ä¸­é€šè¿‡webæŒ‡å®šçš„ç»„ä»¶å»è°ƒç”¨ã€‚\n@ContextHierarchyæ³¨è§£å¯ä»¥ç”³æ˜contextçš„å±‚æ¬¡ç»“æ„ã€‚å¦‚æœä¸€ä¸ªå±‚æ¬¡ç»“æ„ä¸­çš„å¤šä¸ªç±»éƒ½æœ‰è¯¥æ³¨è§£ï¼Œé‚£ä¹ˆä½ å¯ä»¥åˆå¹¶æˆ–è€…è¦†ç›–æŒ‡å®šçš„å¹¶å·²å‘½åçš„å±‚çº§ã€‚å½“éœ€è¦åˆå¹¶ä¸€ä¸ªç»™å®šå±‚çº§çš„é…ç½®æ—¶ï¼Œä»–ä»¬çš„èµ„æºç±»å‹å¿…é¡»ä¸€æ ·ï¼ˆXMLï¼Œæˆ–è€…ç»„ä»¶ç±»ï¼‰ï¼Œå¦åˆ™å°†ä¼šè¢«è§†ä¸ºä¸¤ä¸ªå±‚çº§ã€‚\nä¸‹é¢çš„ä¾‹å­æ˜¯ä»¥JUnit Jupiterä¸ºåŸºç¡€çš„ï¼Œå±•ç¤ºäº†éœ€è¦ä½¿ç”¨ä¸Šä¸‹æ–‡å±‚æ¬¡çš„å¸¸è§åœºæ™¯ã€‚\nå•ä¸ªç±»æœ‰ä¸Šä¸‹æ–‡å±‚æ¬¡ ControllerIntegrationTestså±•ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„Spring MVC webåº”ç”¨çš„æµ‹è¯•åœºæ™¯ï¼Œç”³æ˜çš„ä¸Šä¸‹æ–‡å±‚æ¬¡åŒ…å«ä¸¤ä¸ªå±‚çº§ï¼Œä¸€ä¸ªæ˜¯æ ¹WebApplicaitonContextï¼Œå¦å¤–ä¸€ä¸ªæ˜¯dispatcher servletWebApplicationContextã€‚æµ‹è¯•ç±»ä¸­çš„wacå‚æ•°ï¼Œæ³¨å…¥çš„æ˜¯ä¸Šä¸‹æ–‡å±‚æ¬¡ç»“æ„ä¸­æœ€åçš„é‚£ä¸€ä¸ªã€‚\n@ExtendWith(SpringExtension.class)\r@WebAppConfiguration\r@ContextHierarchy({\r@ContextConfiguration(classes = TestAppConfig.class),\r@ContextConfiguration(classes = WebConfig.class)\r})\rclass ControllerIntegrationTests {\r@Autowired\rWebApplicationContext wac;\r// ...\r}\r ç±»å±‚æ¬¡ä¸­æœ‰éšå¼çš„çˆ¶context ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†çˆ¶å­ç±»çš„å±‚æ¬¡ç»“æ„ï¼Œä¸€å…±ä¼šåŠ è½½ä¸‰ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œ æ¯ä¸ªå­ç±»ä¸Šä¸‹æ–‡éƒ½æ˜¯åŸºäºçˆ¶ç±»ä¸Šä¸‹æ–‡ï¼š\n@ExtendWith(SpringExtension.class)\r@WebAppConfiguration\r@ContextConfiguration(\u0026quot;file:src/main/webapp/WEB-INF/applicationContext.xml\u0026quot;)\rpublic abstract class AbstractWebTests {}\r@ContextHierarchy(@ContextConfiguration(\u0026quot;/spring/soap-ws-config.xml\u0026quot;))\rpublic class SoapWebServiceTests extends AbstractWebTests {}\r@ContextHierarchy(@ContextConfiguration(\u0026quot;/spring/rest-ws-config.xml\u0026quot;))\rpublic class RestWebServiceTests extends AbstractWebTests {}\r ç±»å±‚æ¬¡ä¸­æœ‰åˆå¹¶çš„ä¸Šä¸‹æ–‡å±‚æ¬¡é…ç½® ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•é€šè¿‡æŒ‡å®šå±‚çº§åç§°å»åˆå¹¶ä¸Šä¸‹æ–‡é…ç½®ã€‚ä¸€å…±ä¼šåŠ è½½ä¸‰ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯parentï¼Œä¸€ä¸ªæ˜¯çˆ¶ç±»childï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯çˆ¶ç±»å’Œå­ç±»childå±‚çº§ä¹‹å’Œã€‚\n@ExtendWith(SpringExtension.class)\r@ContextHierarchy({\r@ContextConfiguration(name = \u0026quot;parent\u0026quot;, locations = \u0026quot;/app-config.xml\u0026quot;),\r@ContextConfiguration(name = \u0026quot;child\u0026quot;, locations = \u0026quot;/user-config.xml\u0026quot;)\r})\rclass BaseTests {}\r@ContextHierarchy(\r@ContextConfiguration(name = \u0026quot;child\u0026quot;, locations = \u0026quot;/order-config.xml\u0026quot;)\r)\rclass ExtendedTests extends BaseTests {}\r ç±»å±‚æ¬¡ä¸­æœ‰è¦†ç›–ä¸Šä¸‹æ–‡å±‚æ¬¡é…ç½® ç›¸å¯¹äºä¸Šä¸€ä¸ªä¾‹å­ï¼Œä¸‹é¢è¦å±•ç¤ºçš„æ˜¯å¦‚æœè¦†ç›–çˆ¶ç±»çš„å±‚çº§é…ç½®ã€‚é€šè¿‡è®¾å®š@ContextConfigurationçš„å‚æ•°inheritLocationsä¸ºfalseï¼Œå³å¯è®©å­ç±»è¦†ç›–childå±‚çº§çš„é…ç½®ï¼Œå¹¶åŒæ—¶ç»§æ‰¿parentå±‚çº§ã€‚\n@ExtendWith(SpringExtension.class)\r@ContextHierarchy({\r@ContextConfiguration(name = \u0026quot;parent\u0026quot;, locations = \u0026quot;/app-config.xml\u0026quot;),\r@ContextConfiguration(name = \u0026quot;child\u0026quot;, locations = \u0026quot;/user-config.xml\u0026quot;)\r})\rclass BaseTests {}\r@ContextHierarchy(\r@ContextConfiguration(\rname = \u0026quot;child\u0026quot;,\rlocations = \u0026quot;/test-user-config.xml\u0026quot;,\rinheritLocations = false\r))\rclass ExtendedTests extends BaseTests {}\r  å¦‚æœä½ åœ¨æµ‹è¯•ä¸­ä½¿ç”¨@DirtiesContextï¼Œå¹¶ä¸”å¯¹åº”çš„ä¸Šä¸‹æ–‡å¯¹è±¡è¿˜åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡å±‚çº§ç»“æ„ä¸­ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡hierarchyModeå»æ§åˆ¶ä¸Šä¸‹æ–‡ç¼“å­˜å¦‚ä½•æ¸…ç†ï¼Œè¯¦æƒ…å‚è€ƒ@DirtiesContext in Spring Testing Annotations å’Œ@DirtiesContext\n 5.6. æµ‹è¯•èµ„æºçš„ä¾èµ–æ³¨å…¥ å½“ä½ ä½¿ç”¨DependencyInjectionTestExecutionListenerï¼ˆé»˜è®¤é…ç½®ï¼‰ï¼Œæµ‹è¯•å®ä¾‹ä¸­çš„ä¾èµ–ä¼šä»ä¸Šä¸‹æ–‡ä¸­çš„beanä¸­æ³¨å…¥ã€‚ä½ å¯ä»¥ä½¿ç”¨setteræ³¨å…¥ï¼Œå­—æ®µæ³¨å…¥ï¼Œæˆ–è€…ä¸¤è€…åŒæ—¶å­˜åœ¨ï¼Œå–å†³äºä½ é€‰æ‹©å“ªä¸ªæ³¨è§£å’Œä½ æ˜¯å¦è¦å°†ä»–ä»¬æ”¾è¿›setteræ–¹æ³•ã€‚å¦‚æœä½¿ç”¨JUnit Jupiterä½ è¿˜å¯ä»¥é€‰æ‹©æ„é€ å™¨æ³¨å…¥ã€‚ä¸ºäº†è·ŸSpringçš„åŸºäºæ³¨è§£çš„æ³¨å…¥æ”¯æŒä¿æŒä¸€è‡´ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨@Autowiredæ³¨è§£æˆ–è€…@Injectæ³¨è§£æ¥è‡ªJSR-330ç”³æ˜åœ¨å­—æ®µæˆ–è€…setterä¸Šã€‚\n å¯¹äºJUnit Jupiterä»¥å¤–çš„æµ‹è¯•æ¡†æ¶ï¼ŒTestContextæ¡†æ¶æ˜¯ä¸å‚ä¸æµ‹è¯•ç±»çš„åˆå§‹åŒ–çš„ã€‚å› æ­¤ï¼Œå¦‚æœä½¿ç”¨@Autowiredæˆ–è€…@Injectåœ¨æ„é€ å™¨ä¸Šï¼Œå°†ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœ\n  è™½ç„¶ç”Ÿäº§ä»£ç ä¸é¼“åŠ±ä½¿ç”¨å­—æ®µæ³¨å…¥ï¼Œä½†æ˜¯åœ¨æµ‹è¯•ä»£ç ä¸­æ²¡æœ‰è¿™ä¸ªæè®®ã€‚å…¶ä¸­å·®åˆ«çš„åŸç†æ˜¯å› ä¸ºä½ æ°¸è¿œä¸ä¼šç›´æ¥å®ä¾‹åŒ–ä½ çš„æµ‹è¯•ç±»ã€‚å› æ­¤ï¼Œæ²¡å¿…è¦ä¿è¯èƒ½å¤Ÿè°ƒç”¨æµ‹è¯•ç±»çš„publicæ„é€ æˆ–è€…setteræ–¹æ³•ã€‚\n å› ä¸º@Autowiredæ˜¯æ ¹æ®ç±»å‹çš„è‡ªåŠ¨è£…é…ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªbeanå®šä¹‰äº†ç›¸åŒçš„ç±»å‹ï¼Œé‚£ä¹ˆä½ å°±æ— æ³•é€šè¿‡è¿™ç§æ–¹å¼è·å–æ­£ç¡®çš„beanã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥æ­é…@Qualifierä½¿ç”¨@Autowiredã€‚æˆ–è€…ä½¿ç”¨@Injectæ­é…@Namedä½¿ç”¨ã€‚å¦å¤–ï¼Œå¦‚æœä½ çš„æµ‹è¯•å¯ä»¥è®¿é—®ä»–çš„ApplicationContextï¼Œä½ å¯ä»¥ç›´æ¥æŸ¥æ‰¾å¯¹åº”beanï¼šapplicationContext.getBean(\u0026quot;titleRepository\u0026quot;,TitleRepository.class)ã€‚\nå¦‚æœä½ ä¸æƒ³ä¾èµ–æ³¨å…¥åº”ç”¨åˆ°ä½ çš„æµ‹è¯•å®ä¾‹ä¸Šï¼Œä¸åœ¨å­—æ®µæˆ–è€…setteræ–¹æ³•ä¸Šä½¿ç”¨@Autowiredæˆ–è€…@Injectã€‚ä½ å¯ä»¥æ•´ä¸ªå…³æ‰ä¾èµ–æ³¨å…¥ï¼Œé€šè¿‡ç›´æ¥é…ç½®@TestExecutionListenersï¼Œå¹¶ä¸”åœ¨ç›‘å¬å™¨é›†åˆä¸­çœç•¥DependencyInjectionTestExecutionListener.classã€‚\nè€ƒè™‘æµ‹è¯•ç±»ä¸­è°ƒç”¨HibernateTitleRepositoryç±»è®¿é—®æ•°æ®åº“çš„åœºæ™¯ï¼Œä¸‹é¢çš„ä¾‹å­é€šè¿‡ä¾èµ–æ³¨å…¥å®ç°äº†æµ‹è¯•ã€‚ä»–ä»¬çš„ä¸Šä¸‹æ–‡é…ç½®åœ¨æ‰€æœ‰çš„æ ·ä¾‹ä»£ç ä¹‹åã€‚\n ä¸‹é¢çš„ä¾èµ–æ³¨å…¥è¡Œä¸ºä¸æ˜¯JUnit Jupiterç‰¹æœ‰çš„ï¼Œæ‰€æœ‰æ”¯æŒçš„æµ‹è¯•æ¡†æ¶éƒ½èƒ½é€‚é…ã€‚\nä¸‹é¢ä¾‹å­ä¸­è°ƒç”¨çš„é™æ€æ–­è¨€æ–¹æ³•ï¼Œçœç•¥äº†import\n @Autowired field\n@ExtendWith(SpringExtension.class)\r// specifies the Spring configuration to load for this test fixture\r@ContextConfiguration(\u0026quot;repository-config.xml\u0026quot;)\rclass HibernateTitleRepositoryTests {\r// this instance will be dependency injected by type\r@Autowired\rHibernateTitleRepository titleRepository;\r@Test\rvoid findById() {\rTitle title = titleRepository.findById(new Long(10));\rassertNotNull(title);\r}\r}\r @Autowired setter\n@ExtendWith(SpringExtension.class)\r// specifies the Spring configuration to load for this test fixture\r@ContextConfiguration(\u0026quot;repository-config.xml\u0026quot;)\rclass HibernateTitleRepositoryTests {\r// this instance will be dependency injected by type\rHibernateTitleRepository titleRepository;\r@Autowired\rvoid setTitleRepository(HibernateTitleRepository titleRepository) {\rthis.titleRepository = titleRepository;\r}\r@Test\rvoid findById() {\rTitle title = titleRepository.findById(new Long(10));\rassertNotNull(title);\r}\r}\r ä¸Šé¢çš„æµ‹è¯•ç±»ç”¨äº†ç›¸åŒçš„XMLä¸Šä¸‹æ–‡æ–‡ä»¶ï¼ˆrepository-config.xmlï¼‰ï¼š\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r\u0026lt;beans xmlns=\u0026quot;http://www.springframework.org/schema/beans\u0026quot;\rxmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxsi:schemaLocation=\u0026quot;http://www.springframework.org/schema/beans\rhttps://www.springframework.org/schema/beans/spring-beans.xsd\u0026quot;\u0026gt;\r\u0026lt;!-- this bean will be injected into the HibernateTitleRepositoryTests class --\u0026gt;\r\u0026lt;bean id=\u0026quot;titleRepository\u0026quot; class=\u0026quot;com.foo.repository.hibernate.HibernateTitleRepository\u0026quot;\u0026gt;\r\u0026lt;property name=\u0026quot;sessionFactory\u0026quot; ref=\u0026quot;sessionFactory\u0026quot;/\u0026gt;\r\u0026lt;/bean\u0026gt;\r\u0026lt;bean id=\u0026quot;sessionFactory\u0026quot; class=\u0026quot;org.springframework.orm.hibernate5.LocalSessionFactoryBean\u0026quot;\u0026gt;\r\u0026lt;!-- configuration elided for brevity --\u0026gt;\r\u0026lt;/bean\u0026gt;\r\u0026lt;/beans\u0026gt;\r  å¦‚æœä½ ç»§æ‰¿äº†ä¸€ä¸ªSpringæä¾›çš„æµ‹è¯•åŸºç±»ï¼Œåˆšå¥½å®ƒä½¿ç”¨äº†@Autowiredåœ¨ä¸€ä¸ªsetteræ–¹æ³•ä¸Šï¼Œé‚£ä¹ˆå½±å“çš„ç±»å‹å¯èƒ½æœ‰å¤šä¸ªbeanå®šä¹‰åœ¨ä½ çš„åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œå¤šä¸ªDataSourcebeanï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é‡å†™setteræ–¹æ³•å¹¶ä¸”ä½¿ç”¨@Qualiifieræ³¨è§£å»æŒ‡æ˜ä¸€ä¸ªç‰¹å®šçš„ç›®æ ‡beanï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­ä¸€æ ·ï¼ˆä½†ä¹Ÿç¡®ä¿å§”æ‰˜ç»™è¶…ç±»ä¸­çš„é‡å†™æ–¹æ³•ï¼‰ï¼š\n@Autowired\r@Override\rpublic void setDataSource(@Qualifier(\u0026quot;myDataSource\u0026quot;) DataSource dataSource) {\rsuper.setDataSource(dataSource);\r}\r æŒ‡å®šçš„qualifierå€¼ä»£è¡¨è¦æ³¨å…¥çš„é‚£ä¸ªç›®æ ‡DataSourcebeanã€‚å®ƒçš„å€¼åŒ¹é…çš„æ˜¯å®šä¹‰ä¸­çš„ç”³æ˜ã€‚Beançš„åç§°è¢«ç”¨ä½œåå¤‡çš„qualifierå€¼ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç”¨æ¥æœ‰æ•ˆçš„æŒ‡å‘ç‰¹å®šçš„Beanï¼ˆBean idï¼‰ã€‚\n 5.7. æµ‹è¯•Requestå’ŒSessionèŒƒå›´çš„bean ä»æ—©æœŸå¼€å§‹Springå°±ä¸€ç›´æ”¯æŒRequestå’ŒSessionèŒƒå›´çš„beanï¼Œä½ å¯ä»¥æ ¹æ®ä¸‹é¢çš„æ­¥éª¤æ¥æµ‹è¯•ä½ çš„requestèŒƒå›´å’ŒsessionèŒƒå›´çš„beanï¼š\n ç¡®ä¿ä½ çš„æµ‹è¯•ç±»è¢«@WebAppConfigurationæ³¨è§£ä¿®é¥°ã€‚ æ³¨å…¥æ¨¡æ‹Ÿrequestæˆ–è€…sessionåˆ°ä½ çš„æµ‹è¯•å®ä¾‹ä¸­ï¼Œå¹¶ä¸”æ ¹æ®éœ€è¦å‡†å¤‡ä½ çš„æµ‹è¯•èµ„æºã€‚ é€šè¿‡ä¾èµ–æ³¨å…¥è°ƒç”¨WebApplicationContextä¸­é…ç½®çš„webç»„ä»¶ã€‚ å¯¹æ¨¡æ‹Ÿå¯¹è±¡è¿›è¡Œæ–­è¨€ã€‚  ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ˜¯ä¸€ä¸ªç”¨æˆ·ç™»å½•æ¡ˆä¾‹çš„XMLé…ç½®ã€‚æ³¨æ„userServicebeanæœ‰ä¸€ä¸ªrequestèŒƒå›´çš„loginActionbeanä¾èµ–ã€‚å¹¶ä¸”ï¼ŒLoginActioné€šè¿‡ä½¿ç”¨SpELè¡¨è¾¾å¼åˆå§‹åŒ–ï¼Œè¡¨è¾¾å¼ä»HTTPè¯·æ±‚ä¸­è·å–ç”¨æˆ·åå’Œå¯†ç ã€‚åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡TestContextæ¡†æ¶çš„mockç®¡ç†æ¥é…ç½®è¿™äº›è¯·æ±‚å‚æ•°ã€‚ä¸‹é¢é¦–å…ˆæ˜¯é…ç½®xmlï¼š\n\u0026lt;beans\u0026gt;\r\u0026lt;bean id=\u0026quot;userService\u0026quot; class=\u0026quot;com.example.SimpleUserService\u0026quot;\rc:loginAction-ref=\u0026quot;loginAction\u0026quot;/\u0026gt;\r\u0026lt;bean id=\u0026quot;loginAction\u0026quot; class=\u0026quot;com.example.LoginAction\u0026quot;\rc:username=\u0026quot;#{request.getParameter('user')}\u0026quot;\rc:password=\u0026quot;#{request.getParameter('pswd')}\u0026quot;\rscope=\u0026quot;request\u0026quot;\u0026gt;\r\u0026lt;aop:scoped-proxy/\u0026gt;\r\u0026lt;/bean\u0026gt;\r\u0026lt;/beans\u0026gt;\r åœ¨ä¸‹é¢çš„RequestScopedBeanTestsç±»ä¸­ï¼Œæˆ‘ä»¬åŒæ—¶æ³¨å…¥äº†UserServiceå’ŒMockHttpServletRequeståˆ°æˆ‘ä»¬çš„æµ‹è¯•å®ä¾‹ä¸­ã€‚åœ¨requestScope()æµ‹è¯•æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½®MockHttpServletRequestä¸­çš„requestå‚æ•°æ¥é…ç½®æˆ‘ä»¬çš„æµ‹è¯•èµ„æºã€‚å½“userServiceçš„loginUser()æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šserviceä¸­è®¿é—®çš„loginActionæ˜¯å½“å‰MockHttpServletRequestèŒƒå›´ä¸­çš„ã€‚\n@SpringJUnitWebConfig\rclass RequestScopedBeanTests {\r@Autowired UserService userService;\r@Autowired MockHttpServletRequest request;\r@Test\rvoid requestScope() {\rrequest.setParameter(\u0026quot;user\u0026quot;, \u0026quot;enigma\u0026quot;);\rrequest.setParameter(\u0026quot;pswd\u0026quot;, \u0026quot;$pr!ng\u0026quot;);\rLoginResults results = userService.loginUser();\r// assert results\r}\r}\r ä¸‹é¢çš„ä»£ç ç‰‡æ®µè·Ÿä¹‹å‰çš„è¯·æ±‚èŒƒå›´çš„beanç±»ä¼¼ã€‚ä½†æ˜¯ï¼Œè¿™æ¬¡userServicebeanæœ‰äº†ä¸€ä¸ªsessionèŒƒå›´çš„ä¾èµ–userPreferencesbeanã€‚æ³¨æ„è¿™ä¸ªUserPreferencesbeané€šè¿‡ä¸€ä¸ªSpELè¡¨è¾¾å¼åˆå§‹åŒ–ï¼Œå®ƒä»HTTP sessionä¸­è·å–äº†ä¸»é¢˜å‚æ•°ã€‚åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼Œéœ€è¦é…ç½®mock sessionçš„ä¸»é¢˜å‚æ•°ã€‚\n\u0026lt;beans\u0026gt;\r\u0026lt;bean id=\u0026quot;userService\u0026quot; class=\u0026quot;com.example.SimpleUserService\u0026quot;\rc:userPreferences-ref=\u0026quot;userPreferences\u0026quot; /\u0026gt;\r\u0026lt;bean id=\u0026quot;userPreferences\u0026quot; class=\u0026quot;com.example.UserPreferences\u0026quot;\rc:theme=\u0026quot;#{session.getAttribute('theme')}\u0026quot;\rscope=\u0026quot;session\u0026quot;\u0026gt;\r\u0026lt;aop:scoped-proxy/\u0026gt;\r\u0026lt;/bean\u0026gt;\r\u0026lt;/beans\u0026gt;\r åœ¨ä¸‹é¢çš„SessionScopedBeanTestsç±»ä¸­ï¼Œæˆ‘ä»¬åŒæ—¶æ³¨å…¥UserServiceå’ŒMockHttpServiceåˆ°æˆ‘ä»¬çš„æµ‹è¯•å®ä¾‹å½“ä¸­ã€‚åœ¨sessionScope()æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½®MockHttpSessionä¸­çš„themeå±æ€§æ¥é…ç½®æˆ‘ä»¬çš„æµ‹è¯•èµ„æºï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šserviceå†…éƒ¨è°ƒç”¨çš„userPreferencesæ˜¯å½“å‰MockHttpSessionèŒƒå›´ä¸­çš„ã€‚\n@SpringJUnitWebConfig\rclass SessionScopedBeanTests {\r@Autowired UserService userService;\r@Autowired MockHttpSession session;\r@Test\rvoid sessionScope() throws Exception {\rsession.setAttribute(\u0026quot;theme\u0026quot;, \u0026quot;blue\u0026quot;);\rResults results = userService.processUserPreferences();\r// assert results\r}\r}\r 5.8. äº‹åŠ¡ç®¡ç† åœ¨TestContextæ¡†æ¶ä¸­ï¼Œäº‹åŠ¡ç®¡ç†æ˜¯åœ¨TransactionalTestExecutionListenerä¸­çš„ï¼Œå¹¶ä¸”å®ƒæ˜¯é»˜è®¤é…ç½®ï¼Œå³ä½¿ä½ ä¸æ˜¾å¼çš„åœ¨ä½ çš„æµ‹è¯•ç±»ä¸Šç”³æ˜@TestExecutionListenersã€‚ä¸ºäº†å¼€å¯äº‹åŠ¡æ”¯æŒï¼Œä½ å¿…é¡»é…ç½®ä¸€ä¸ªPlatformTransactionManagerbeanåœ¨ApplicationContextä¸­ï¼Œå®ƒæ˜¯éšç€@ContextConfigurationè¯­æ³•åŠ è½½çš„ï¼ˆè¯¦æƒ…å‚è€ƒä¸‹æ–‡ï¼‰ã€‚å¦å¤–ï¼Œä½ å¿…é¡»ç”³æ˜@Transactionalæ³¨è§£åœ¨æµ‹è¯•ç±»æˆ–è€…æ–¹æ³•ä¸Šã€‚\n5.8.1. æµ‹è¯•ç®¡ç†çš„äº‹åŠ¡ æµ‹è¯•ç®¡ç†çš„æ˜¯äº‹åŠ¡æŒ‡çš„æ˜¯é€šè¿‡ä½¿ç”¨TransactionalTestExecutionListenerç”³æ˜ç®¡ç†çš„æˆ–è€…æ˜¯ç¼–ç¨‹æ–¹å¼é€šè¿‡TestTransactionã€‚ä½ ä¸åº”è¯¥å°†å®ƒå’ŒSpringç®¡ç†çš„äº‹åŠ¡æ··æ·†ï¼ˆç›´æ¥ç”±Springç®¡ç†çš„åœ¨æµ‹è¯•ç±»çš„ApplicationContextä¸­çš„äº‹åŠ¡ï¼‰ï¼Œæˆ–è€…åº”ç”¨ç®¡ç†çš„äº‹åŠ¡æ··æ·†ï¼ˆæµ‹è¯•ä¸­è°ƒç”¨çš„é€šè¿‡ç¼–ç æ–¹å¼ç›´æ¥ç®¡ç†çš„åœ¨åº”ç”¨ä»£ç ä¸­çš„äº‹åŠ¡ï¼‰ã€‚Springç®¡ç†çš„äº‹åŠ¡å’Œåº”ç”¨ç®¡ç†çš„äº‹åŠ¡é€šå¸¸éƒ½å¯ä»¥å‚ä¸åˆ°æµ‹è¯•ç®¡ç†çš„äº‹åŠ¡å½“ä¸­ã€‚ä½†æ˜¯ï¼Œå½“Springç®¡ç†æˆ–è€…åº”ç”¨ç®¡ç†çš„äº‹åŠ¡é…ç½®çš„æ˜¯ä»»ä½•ä¼ æ’­ç±»å‹ï¼Œè€Œä¸æ˜¯REQUIREDæˆ–è€…SUPPORTSç±»å‹æ—¶ï¼Œéœ€è¦ç‰¹åˆ«å°å¿ƒï¼ˆè¯¦æƒ…å‚è€ƒtransaction propagation\n æŠ¢å å¼è¶…æ—¶å’Œæµ‹è¯•ç®¡ç†çš„äº‹åŠ¡\nå½“ä½¿ç”¨æ¥è‡ªæµ‹è¯•æ¡†æ¶ä»»ä½•å½¢å¼çš„æŠ¢å å¼è¶…æ—¶å’ŒSpringçš„æµ‹è¯•ç®¡ç†äº‹åŠ¡é…åˆä½¿ç”¨æ—¶ä¸€å®šè¦å°å¿ƒã€‚ å…¸å‹çš„å°±æ˜¯ï¼ŒSpringæµ‹è¯•æ”¯æŒç»‘å®šäº‹åŠ¡çŠ¶æ€åˆ°å½“å‰çš„çº¿ç¨‹ä¸Šï¼ˆé€šè¿‡ä¸€ä¸ªjava.lang.ThreadLocalå‚æ•°ï¼‰åœ¨å½“å‰çš„æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰ã€‚å¦‚æœæµ‹è¯•æ¡†æ¶ä¸ºäº†æ”¯æŒæŠ¢å å¼è¶…æ—¶ï¼Œåœ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹è°ƒç”¨å½“å‰çš„æµ‹è¯•æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨å½“å‰æµ‹è¯•æ–¹æ³•ä¸­çš„ä»»ä½•actionéƒ½ä¸ä¼šåœ¨æµ‹è¯•ç®¡ç†çš„äº‹åŠ¡å½“ä¸­è¢«è°ƒç”¨ã€‚ç»“æœå°±æ˜¯ï¼Œæµ‹è¯•ç®¡ç†çš„äº‹åŠ¡ä¸ä¼šå›æ»šä»»ä½•actionã€‚ç›¸å¯¹çš„ï¼Œè¿™äº›actionä¼šè¢«æäº¤åˆ°æŒä¹…å‚¨å­˜ä¸­ã€‚\nä¸‹é¢å°±æ˜¯å¯èƒ½å¼•èµ·è¿™ç§é—®é¢˜çš„æƒ…å½¢ï¼Œä½†å¹¶ä¸æ˜¯å…¨éƒ¨ï¼š\n JUnit 4çš„@Test(timeout = ...)æ”¯æŒå’ŒTimeOutè§„åˆ™ã€‚ JUnit Jupiter åœ¨org.junit.jupiter.api.Assertionsç±»ä¸­çš„assertTimeoutPreemptively(...)æ–¹æ³•ã€‚ TestNGçš„@Test(timeOut=...)æ”¯æŒ   5.8.2 å¯ç”¨å’Œå…³é—­äº‹åŠ¡ ç”¨@Transactionalä¿®é¥°ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œå¯ä»¥è®©æµ‹è¯•åœ¨äº‹åŠ¡ä¸­è¿è¡Œï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥äº‹åŠ¡ä¼šåœ¨æµ‹è¯•å®Œæˆåè‡ªåŠ¨å›æ»šã€‚å¦‚æœæµ‹è¯•ç±»è¢«@Transactionalä¿®é¥°ï¼Œç±»å±‚æ¬¡ç»“æ„ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šåœ¨äº‹åŠ¡ä¸­è¿è¡Œã€‚æµ‹è¯•æ–¹æ³•å¦‚æœæ²¡æœ‰è¢«@Transactionalæ³¨è§£ä¿®é¥°ï¼ˆåœ¨ç±»æˆ–è€…æ–¹æ³•ä¸Šï¼‰ï¼Œé‚£ä¹ˆæµ‹è¯•å°±ä¸ä¼šåœ¨äº‹åŠ¡ä¸­è¿è¡Œã€‚æ³¨æ„@Transactionalä¸æ”¯æŒæµ‹è¯•ç”Ÿå‘½å‘¨æœŸæ–¹æ³•â€”â€”æ¯”å¦‚è¯´ï¼Œæ–¹æ³•æœ‰Jupiterçš„@BeforeAllï¼Œ@BeforeEachï¼Œç­‰ç­‰ã€‚æ­¤å¤–ï¼Œæµ‹è¯•æœ‰@Transactionalæ³¨è§£ä½†æ˜¯propagationå±æ€§æ˜¯NOT_SUPPORTEDæˆ–è€…NEVERï¼Œæ–¹æ³•ä¹Ÿä¸ä¼šåœ¨äº‹åŠ¡ä¸­è¿è¡Œã€‚\n@Transactionalå±æ€§æ”¯æŒ\n   å±æ€§ æ˜¯å¦æ”¯æŒæµ‹è¯•ç®¡ç†çš„äº‹åŠ¡     valueå’ŒtransactionManager yes   propagation åªæœ‰Propagation.NOT_SUPPORTEDå’ŒPropagation.NEVERæ”¯æŒ   isolation no   timeout no   readOnly no   rollbackForå’ŒrollbackForClassName no:ä½¿ç”¨TestTransaction.flagForRollback()æ›¿ä»£   noRollbackForå’ŒnoRollbackForClassName no:ä½¿ç”¨TestTransaction.flagForCommit()ä»£æ›¿     æ–¹æ³•çº§åˆ«çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°â€”â€”ä¸¾ä¸ªä¾‹å­ï¼Œè¢«JUnit jupiterçš„@BeforeEachæˆ–è€…@AfterEachæ³¨è§£ä¿®é¥°çš„â€”â€”æ˜¯è¿è¡Œåœ¨æµ‹è¯•ç®¡ç†çš„äº‹åŠ¡ä¸­çš„ã€‚å¦ä¸€æ–¹æ³•ï¼Œsuiteçº§åˆ«å’Œç±»çº§åˆ«çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•â€”â€”ä¸¾ä¸ªä¾‹å­ï¼Œè¢«JUnit Jupiterçš„@BeforeAllæˆ–è€…AfterAllæ³¨è§£ä¿®é¥°çš„å’Œè¢«TestNGçš„@BeforeSuiteï¼Œ@AfterSuiteï¼Œ@BeforeClassï¼Œæˆ–è€…@AfterClassæ³¨è§£ä¿®é¥°çš„æ–¹æ³•â€”â€”æ˜¯ä¸ä¼šè¿è¡Œåœ¨æµ‹è¯•ç®¡ç†çš„äº‹åŠ¡å½“ä¸­çš„ã€‚\nå¦‚æœä½ éœ€è¦åœ¨äº‹åŠ¡ä¸­è¿è¡Œsuitçº§åˆ«æˆ–è€…ç±»çº§åˆ«çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä½ å¯ä»¥æ³¨å…¥å¯¹åº”çš„PlatformTransactionManageråˆ°ä½ çš„æµ‹è¯•ç±»ä¸­ï¼Œç„¶åå’ŒTransactionTempalteä¸€èµ·ä½¿ç”¨ï¼Œé€šè¿‡ç¼–ç çš„æ–¹å¼å®ç°äº‹åŠ¡ç®¡ç†ã€‚\n æ³¨æ„ï¼ŒAbstractTransactionalJUnit4SpringContextTestså’ŒAbstractTransactionalTestNGSpringContextTestsåœ¨ç±»çº§åˆ«å·²ç»é¢„é…ç½®äº†äº‹åŠ¡çš„æ”¯æŒã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªå¸¸ç”¨çš„åœºæ™¯ï¼šä¸ºä¸€ä¸ªHibernateä¸ºåŸºç¡€çš„UserRepositoryå†™ä¸€ä¸ªé›†æˆæµ‹è¯•ã€‚\n@SpringJUnitConfig(TestConfig.class)\r@Transactional\rclass HibernateUserRepositoryTests {\r@Autowired\rHibernateUserRepository repository;\r@Autowired\rSessionFactory sessionFactory;\rJdbcTemplate jdbcTemplate;\r@Autowired\rvoid setDataSource(DataSource dataSource) {\rthis.jdbcTemplate = new JdbcTemplate(dataSource);\r}\r@Test\rvoid createUser() {\r// track initial state in test database:\rfinal int count = countRowsInTable(\u0026quot;user\u0026quot;);\rUser user = new User(...);\rrepository.save(user);\r// Manual flush is required to avoid false positive in test\rsessionFactory.getCurrentSession().flush();\rassertNumUsers(count + 1);\r}\rprivate int countRowsInTable(String tableName) {\rreturn JdbcTestUtils.countRowsInTable(this.jdbcTemplate, tableName);\r}\rprivate void assertNumUsers(int expected) {\rassertEquals(\u0026quot;Number of rows in the [user] table.\u0026quot;, expected, countRowsInTable(\u0026quot;user\u0026quot;));\r}\r}\r è¿™é‡Œæ˜¯ä¸éœ€è¦åœ¨createUser()æ–¹æ³•æ‰§è¡Œåå†å»æ¸…ç†æ•°æ®åº“çš„ï¼Œå› ä¸ºä»»ä½•æ”¹å˜éƒ½ä¼šé€šè¿‡TransactionalTestExecutionListenerè‡ªåŠ¨å›æ»šã€‚\n5.8.3. äº‹åŠ¡å›æ»šå’Œæäº¤è¡Œä¸º é»˜è®¤æƒ…å†µä¸‹ï¼Œæµ‹è¯•æ‰§è¡Œå®Œæˆåä¼šé»˜è®¤å›æ»šï¼›ä½†æ˜¯äº‹åŠ¡æäº¤å’Œå›æ»šæ˜¯å¯ä»¥é…ç½®çš„ï¼Œé€šè¿‡@Commitå’Œ@Rollbackæ³¨è§£ã€‚\n5.8.4. æ‰‹å†™äº‹åŠ¡ç®¡ç† ä½ å¯ä»¥é€šè¿‡åœ¨TestTransactionä¸­çš„é™æ€æ–¹æ³•æ¥ä»¥ç¼–ç çš„æ–¹å¼ç®¡ç†äº‹åŠ¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥åœ¨æµ‹è¯•æ–¹æ³•ï¼Œbeforeæ–¹æ³•ï¼Œå’Œafteræ–¹æ³•ä¸­startæˆ–è€…endå½“å‰æµ‹è¯•ç®¡ç†çš„äº‹åŠ¡æˆ–è€…è¯´rollbackæˆ–è€…commitå½“å‰æµ‹è¯•ç®¡ç†çš„äº‹åŠ¡ã€‚æ¯å½“TransactionalTestExecutionListenerå¯ç”¨ï¼ŒTestTransactionå°±æ˜¯è‡ªåŠ¨æ”¯æŒçš„ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†TestTransactionçš„éƒ¨åˆ†ç‰¹å¾ï¼Œè¯¦æƒ…å‚è€ƒTestTransaction\n@ContextConfiguration(classes = TestConfig.class)\rpublic class ProgrammaticTransactionManagementTests extends\rAbstractTransactionalJUnit4SpringContextTests {\r@Test\rpublic void transactionalTest() {\r// assert initial state in test database:\rassertNumUsers(2);\rdeleteFromTables(\u0026quot;user\u0026quot;);\r// changes to the database will be committed!\rTestTransaction.flagForCommit();\rTestTransaction.end();\rassertFalse(TestTransaction.isActive());\rassertNumUsers(0);\rTestTransaction.start();\r// perform other actions against the database that will\r// be automatically rolled back after the test completes...\r}\rprotected void assertNumUsers(int expected) {\rassertEquals(\u0026quot;Number of rows in the [user] table.\u0026quot;, expected, countRowsInTable(\u0026quot;user\u0026quot;));\r}\r}\r 5.8.5. åœ¨ä¸€ä¸ªäº‹åŠ¡ä¹‹å¤–è¿è¡Œä»£ç  æœ‰äº›æ—¶å€™ï¼Œä½ å¯èƒ½éœ€è¦åœ¨äº‹åŠ¡æµ‹è¯•æ–¹æ³•ä¹‹å‰æˆ–è€…ä¹‹åè¿è¡Œä»£ç ï¼Œå¹¶ä¸”åœ¨äº‹åŠ¡ä¸Šä¸‹æ–‡ä¹‹å¤–â€”â€”ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨è¿è¡Œæµ‹è¯•ä¹‹å‰éªŒè¯åˆå§‹åŒ–æ•°æ®åº“çš„çŠ¶æ€ï¼Œæˆ–è€…åœ¨è¿è¡Œæµ‹è¯•ä¹‹åéªŒè¯é¢„æœŸçš„äº‹åŠ¡æäº¤è¡Œä¸ºã€‚TransactionalTestExecutionListenerä¸ºè¿™ç§åœºæ™¯æä¾›äº†@BeforeTransactionå’Œ@AfterTransactionæ³¨è§£ã€‚ä½ å¯ä»¥æŠŠä»–ä»¬ä¸­çš„ä¸€ä¸ªç”¨åœ¨æµ‹è¯•ç±»çš„voidæ–¹æ³•ä¸Šï¼Œæˆ–è€…æµ‹è¯•æ¥å£çš„ä»»ä½•defaultvoidæ–¹æ³•ï¼Œç„¶åTransactionalTestExecutionListenerç¡®ä¿æ–¹æ³•åœ¨åˆé€‚çš„æ—¶é—´è¿è¡Œã€‚\n ä»»ä½•beforeæ–¹æ³•(æ¯”å¦‚JUnit Jupiterçš„@BeforeEach)å’Œä»»ä½•afteræ–¹æ³•ï¼ˆæ¯”å¦‚JUnit Jupiterçš„@AfterEachï¼‰æ˜¯è¿è¡Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­çš„ã€‚æ­¤å¤–ï¼Œè¢«@BeforeTransactionæˆ–è€…@AfterTransactionä¿®é¥°çš„æ–¹æ³•ï¼Œä¸ä¼šåœ¨æ²¡æœ‰äº‹åŠ¡çš„æµ‹è¯•æ–¹æ³•æ‰§è¡Œæµç¨‹ä¸­è¿è¡Œã€‚\n 5.8.6. é…ç½®ä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨ TransactionalTestExecutionListeneræ˜¯æœŸæœ›åœ¨æµ‹è¯•çš„ApplicationContextä¸­æœ‰ä¸€ä¸ªPlatformTransactionManagerçš„ã€‚å¦‚æœåœ¨æµ‹è¯•çš„ApplicationContextä¸­æœ‰å¤šä¸ªPlatformTransactionManagerbeanï¼Œä½ å¯ä»¥é€šè¿‡@Transactional(\u0026quot;myTxMgr\u0026quot;)ç”³æ˜qualifierï¼Œæˆ–è€…@Transactional(transactionManager = \u0026quot;myTxMgr\u0026quot;)ï¼Œæˆ–è€…TransactionManagementConfigurerçš„@Configurationç±»å®ç°ã€‚è¯¦æƒ…å‚è€ƒjavadoc for TestContextTransactionUtils.retrieveTransactionManager()\n5.8.7. å±•ç¤ºæ‰€æœ‰äº‹åŠ¡ç›¸å…³çš„æ³¨è§£ ä¸‹é¢å±•ç¤ºäº†æ‰€æœ‰æ”¯æŒçš„äº‹åŠ¡ç›¸å…³çš„æ³¨è§£ï¼š\n@SpringJUnitConfig\r@Transactional(transactionManager = \u0026quot;txMgr\u0026quot;)\r@Commit\rclass FictitiousTransactionalTest {\r@BeforeTransaction\rvoid verifyInitialDatabaseState() {\r// logic to verify the initial state before a transaction is started\r}\r@BeforeEach\rvoid setUpTestDataWithinTransaction() {\r// set up test data within the transaction\r}\r@Test\r// overrides the class-level @Commit setting\r@Rollback\rvoid modifyDatabaseWithinTransaction() {\r// logic which uses the test data and modifies database state\r}\r@AfterEach\rvoid tearDownWithinTransaction() {\r// run \u0026quot;tear down\u0026quot; logic within the transaction\r}\r@AfterTransaction\rvoid verifyFinalDatabaseState() {\r// logic to verify the final state after transaction has rolled back\r}\r}\r  å½“æµ‹è¯•ORMä»£ç æ—¶é¿å…è¯¯æŠ¥ å½“ä½ çš„æµ‹è¯•åº”ç”¨ä»£ç ä¿®æ”¹Hibernate sessionæˆ–è€…JPAæŒä¹…ä¸Šä¸‹æ–‡çŠ¶æ€æ—¶ï¼Œç¡®ä¿åˆ·æ–°åº•å±‚çš„å·¥ä½œå•å…ƒã€‚æœªèƒ½åˆ·æ–°åº•å±‚çš„å·¥ä½œå•å…ƒå¯èƒ½äº§ç”Ÿè¯¯æŠ¥ï¼šä½ çš„æµ‹è¯•é€šè¿‡ï¼Œä½†æ˜¯ç›¸åŒçš„ä»£ç åœ¨çº¿ä¸Šç”Ÿäº§ç¯å¢ƒæŠ›å¼‚å¸¸ã€‚æ³¨æ„ï¼Œè¿™å¯ä»¥é€‚ç”¨äºä»»ä½•åœ¨å†…å­˜ä¸­ç»´æŠ¤å·¥ä½œå•å…ƒçš„ORMæ¡†æ¶ã€‚\nä¸‹é¢çš„Hibernateä¸ºåŸºç¡€çš„æµ‹è¯•å®ä¾‹ï¼Œä¸€ä¸ªæ–¹æ³•å±•ç¤ºäº†è¯¯æŠ¥ï¼Œå¦å¤–ä¸€ä¸ªæ–¹æ³•æ­£ç¡®çš„æš´éœ²äº†åˆ·æ–°sessionçš„ç»“æœï¼š\n// ...\r@Autowired\rSessionFactory sessionFactory;\r@Transactional\r@Test // no expected exception!\rpublic void falsePositive() {\rupdateEntityInHibernateSession();\r// False positive: an exception will be thrown once the Hibernate\r// Session is finally flushed (i.e., in production code)\r}\r@Transactional\r@Test(expected = ...)\rpublic void updateWithSessionFlush() {\rupdateEntityInHibernateSession();\r// Manual flush is required to avoid false positive in test\rsessionFactory.getCurrentSession().flush();\r}\r// ...\r ä¸‹é¢çš„ä¾‹å­å±•ç¤ºçš„æ˜¯JPAçš„ï¼š\n// ...\r@PersistenceContext\rEntityManager entityManager;\r@Transactional\r@Test // no expected exception!\rpublic void falsePositive() {\rupdateEntityInJpaPersistenceContext();\r// False positive: an exception will be thrown once the JPA\r// EntityManager is finally flushed (i.e., in production code)\r}\r@Transactional\r@Test(expected = ...)\rpublic void updateWithEntityManagerFlush() {\rupdateEntityInJpaPersistenceContext();\r// Manual flush is required to avoid false positive in test\rentityManager.flush();\r}\r// ...\r  5.9. æ‰§è¡ŒSQLè„šæœ¬ åœ¨å¯¹ä¸€ä¸ªå…³ç³»æ•°æ®åº“å†™é›†æˆæµ‹è¯•çš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦è¿è¡ŒSQLè„šæœ¬å»ä¿®æ”¹æ•°æ®åº“çš„schemaæˆ–è€…æ’å…¥æµ‹è¯•æ•°æ®åˆ°è¡¨ä¸­ã€‚spring-jdbcæ¨¡å—æä¾›äº†åˆå§‹åŒ–é›†æˆæˆ–è€…å·²å­˜åœ¨æ•°æ®åº“çš„æ”¯æŒï¼Œé€šè¿‡åœ¨ApplicationContextåŠ è½½æ—¶æ‰§è¡ŒSQLè„šæœ¬ã€‚\nä¸‹é¢çš„ç« èŠ‚æ˜¯å¦‚ä½•ä»¥ç¼–ç çš„å½¢å¼å’Œç”³æ˜çš„å½¢å¼è¿è¡ŒSQLè„šæœ¬\n5.9.1. ç¼–ç å½¢å¼æ‰§è¡ŒSQLè„šæœ¬ Springæä¾›äº†ä¸‹é¢çš„é€‰é¡¹ï¼Œä»¥åœ¨é›†æˆæµ‹è¯•æ–¹æ³•ä¸­ç¼–ç çš„å½¢å¼æ‰§è¡ŒSQLè„šæœ¬ã€‚\n org.springframework.jdbc.datasource.init.ScriptUtils org.springframework.jdbc.datasource.init.ResourceDatabasePopulator org.springframework.test.context.junit4.AbstractTransactionalJUnit4SpringContextTests org.springframework.test.context.testng.AbstractTransactionalTestNGSpringContextTests  ScriptUtilsæä¾›äº†ä¸€ä¸ªæœ‰å…³SQLè„šæœ¬çš„é™æ€å®ç”¨æ–¹æ³•é›†åˆï¼Œå¹¶ä¸”ä»–ä¸»è¦æ˜¯ä¸ºæ¡†æ¶å†…éƒ¨ä½¿ç”¨çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ éœ€è¦å®Œå…¨çš„æ§åˆ¶SQLè„šæœ¬çš„è§£æå’Œè¿è¡Œï¼ŒScriptUtilså¯èƒ½æ¯”ä¹‹åæåˆ°çš„å·¥å…·æ›´ç¬¦åˆä½ çš„éœ€æ±‚ã€‚è¯¦æƒ…å‚è€ƒä»–çš„javadoc\nResourceDatabasePopulatoræä¾›äº†ä¸€ä¸ªå¯¹è±¡åŸºç¡€çš„APIé€šè¿‡å®šä¹‰åœ¨å¤–éƒ¨çš„SQLè„šæœ¬ï¼Œæ‰‹åŠ¨ç¼–ç æ‰§è¡Œå¡«å……ï¼Œåˆå§‹åŒ–ï¼Œæˆ–è€…æ¸…é™¤æ•°æ®åº“ã€‚ResourceDatabasePopulatoræä¾›è®¸å¤šå‚æ•°ï¼ŒåŒ…æ‹¬ï¼šé…ç½®å­—ç¬¦ç¼–ç ï¼Œè¯­å¥åˆ†éš”ç¬¦ï¼Œæ³¨é‡Šåˆ†éš”ç¬¦ï¼Œå’Œå¼‚å¸¸å¤„ç†ã€‚æ¯ä¸ªé…ç½®å‚æ•°éƒ½æœ‰ä¸€ä¸ªåˆç†çš„é»˜è®¤å€¼ã€‚è¯¦æƒ…å‚è€ƒjavadoc ã€‚è¦è¿è¡ŒResourceDatabasePopulatoré…ç½®çš„è„šæœ¬ï¼Œé’ˆå¯¹java.sql.Connectionä½ å¯ä»¥è°ƒç”¨populate(Connection)æ–¹æ³•ï¼Œé’ˆå¯¹javax.sql.DataSourceä½ å¯ä»¥è°ƒç”¨execute(DataSource)æ–¹æ³•ã€‚\nä¸‹é¢çš„ä¾‹å­æŒ‡å®šäº†ä¸€ä¸ªæœ‰å…³æµ‹è¯•schemaå’Œæµ‹è¯•æ•°æ®çš„SQLå«é˜¿è‹¯ï¼Œè®¾ç½®äº†è¯­å¥åˆ†éš”ç¬¦ä¸º@@ï¼Œå¹¶ä¸”é’ˆå¯¹DataSourceè¿è¡Œè„šæœ¬ã€‚\n@Test\rvoid databaseTest() {\rResourceDatabasePopulator populator = new ResourceDatabasePopulator();\rpopulator.addScripts(\rnew ClassPathResource(\u0026quot;test-schema.sql\u0026quot;),\rnew ClassPathResource(\u0026quot;test-data.sql\u0026quot;));\rpopulator.setSeparator(\u0026quot;@@\u0026quot;);\rpopulator.execute(this.dataSource);\r// run code that uses the test schema and data\r}\r æ³¨æ„ResourceDatabasePopulatorå†…éƒ¨å§”æ‰˜äº†ScriptUtilså»è§£æå’Œè¿è¡ŒSQLè„šæœ¬ã€‚ç±»ä¼¼çš„æ˜¯ï¼Œåœ¨AbstractTransactionalJUnit4SpringContextTestså’ŒAbstractTransactionalTestNGSpringContextTestsä¸­çš„executeSqlScript(..)æ–¹æ³•ï¼Œå†…éƒ¨ä½¿ç”¨çš„æ˜¯ResourceDatabasePopulatorå»è¿è¡ŒSQLè„šæœ¬ã€‚\n5.9.2. é€šè¿‡æ³¨è§£@Sqlæ‰§è¡Œè„šæœ¬ é™¤äº†å‰é¢æåˆ°è¿‡çš„é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼å®ç°è„šæœ¬æ‰§è¡Œï¼ŒSpring TestContextæ¡†æ¶è¿˜æ”¯æŒé€šè¿‡æ³¨è§£æ‰§è¡Œè„šæœ¬ï¼Œé€šè¿‡æ³¨è§£ä½ å¯ä»¥åœ¨æµ‹è¯•æ–¹æ³•ä¹‹å‰æˆ–è€…ä¹‹åæ‰§è¡Œè„šæœ¬ã€‚@Sqlå¯ä»¥ä¿®é¥°åˆ°ç±»æˆ–è€…æ–¹æ³•ä¸Šï¼Œå¯ä»¥é…ç½®ç‹¬ç«‹çš„sqlè„šæœ¬æˆ–è€…sqlè„šæœ¬çš„èµ„æºè·¯å¾„ï¼Œä»–çš„æ”¯æŒç”±SqlScriptsTestExecutionListeneræä¾›ï¼Œè¿™ä¸ªlisteneræ˜¯é»˜è®¤å¯ç”¨çš„ã€‚\n æ–¹æ³•çº§åˆ«çš„@Sqlç”³æ˜ä¼šé»˜è®¤è¦†ç›–ç±»çº§åˆ«çš„å£°æ˜ã€‚ä»Spring Framework 5.2å¼€å§‹ï¼Œæ˜¯å¦è¦†ç›–å¯ä»¥é€šè¿‡@SqlMergeModeæ¥é…ç½®ï¼Œä»–å¯ä»¥åœ¨ç±»çº§åˆ«æˆ–è€…æ–¹æ³•çº§åˆ«é…ç½®ï¼Œè¯¦æƒ…å‚è€ƒä¹‹å‰æåˆ°çš„@SqlMergeMode\n 5.9.3. è·¯å¾„èµ„æºè¯­æ³• æ¯ä¸ªpathéƒ½ä¼šè¢«ç¿»è¯‘ä¸ºSpringçš„Resourceã€‚ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼ˆæ¯”å¦‚ï¼Œ\u0026quot;schema.sql\u0026quot;ï¼‰ä¼šè¢«å½“åšclasspathèµ„æºï¼Œä»–ä¼šè·Ÿæµ‹è¯•ç±»æ‰€åœ¨çš„åŒ…ç›¸å…³è”ã€‚è·¯å¾„ä»¥æ–œæ å¼€å¤´ä¼šè¢«å½“åšç»å¯¹è·¯å¾„ï¼ˆæ¯”å¦‚\u0026quot;/org/example/schema.sql\u0026quot;ï¼‰ã€‚ä¸€ä¸ªè·¯å¾„å¼•ç”¨äº†ä¸€ä¸ªURLï¼ˆæ¯”å¦‚ï¼Œä¸€ä¸ªpathä»¥classpath:ï¼Œfile:ï¼Œhttp:å¼€å¤´ï¼‰ä¼šæŒ‰ç…§æŒ‡å®šçš„èµ„æºåè®®æ¥åŠ è½½ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†åœ¨ä¸€ä¸ªä»¥JUnit Jupiterä¸ºåŸºç¡€çš„æµ‹è¯•ç±»ä¸­ï¼Œç±»å’Œæ–¹æ³•éƒ½è¢«@Sqlä¿®é¥°çš„ä¾‹å­ï¼š\n@SpringJUnitConfig\r@Sql(\u0026quot;/test-schema.sql\u0026quot;)\rclass DatabaseTests {\r@Test\rvoid emptySchemaTest() {\r// run code that uses the test schema without any test data\r}\r@Test\r@Sql({\u0026quot;/test-schema.sql\u0026quot;, \u0026quot;/test-user-data.sql\u0026quot;})\rvoid userTest() {\r// run code that uses the test schema and test data\r}\r}\r 5.9.4. é»˜è®¤è„šæœ¬æ£€æµ‹ å¦‚æœ@Sqlæ³¨è§£æ²¡æœ‰å£°æ˜ä»»ä½•è„šæœ¬æˆ–è€…èµ„æºä½ç½®ï¼Œé‚£ä¹ˆä¼šå»æ£€æµ‹é»˜è®¤çš„è„šæœ¬ä½ç½®ï¼Œå…·ä½“é»˜è®¤ä½ç½®å–å†³äºæ³¨è§£ç”³æ˜ä½ç½®ï¼Œåœ¨ç±»å’Œæ–¹æ³•ä¸Šç•¥æœ‰åŒºåˆ«ã€‚å¦‚æœæ²¡æœ‰åœ¨é»˜è®¤ä½ç½®æ‰¾åˆ°å¯¹åº”çš„sqlè„šæœ¬ï¼Œä¼šæŠ›å‡ºIllegalStateExceptionå¼‚å¸¸ã€‚\n ç±»çº§åˆ«çš„ç”³æ˜ï¼šå¦‚æœæ³¨è§£çš„æµ‹è¯•ç±»æ˜¯com.example.MyTestï¼Œé‚£ä¹ˆå¯¹åº”çš„é»˜è®¤è„šæœ¬å°±æ˜¯classpath:com/example/MyTest.sqlã€‚ æ–¹æ³•çº§åˆ«çš„ç”³æ˜ï¼šå¦‚æœæ³¨è§£çš„æ–¹æ³•å«åštestMethod()å¹¶ä¸”å®ƒæ˜¯å®šä¹‰åœ¨com.example.MyTestç±»ä¸­ï¼Œé‚£ä¹ˆå¯¹åº”çš„é»˜è®¤è„šæœ¬æ˜¯classpath:com/example/MyTest.testMethod.sqlã€‚  5.9.5. ç”³æ˜å¤šä¸ª@Sqlé›† å¦‚æœä½ éœ€è¦å¯¹ä¸€ä¸ªæµ‹è¯•ç±»æˆ–è€…æµ‹è¯•æ–¹æ³•é…ç½®å¤šä¸ªSQLè„šæœ¬é›†åˆï¼Œä»–ä»¬å¯èƒ½æœ‰ä¸åŒçš„è¯­æ³•é…ç½®ï¼Œä¸åŒçš„å¼‚å¸¸å¤„ç†è§„åˆ™ï¼Œæˆ–è€…ä¸åŒçš„æ‰§è¡Œé˜¶æ®µï¼Œä½ å¯ä»¥ç”³æ˜å¤šä¸ª@Sqlå®ä¾‹ã€‚å¦‚æœæ˜¯Java 8 ï¼Œé‚£ä¹ˆä½ å¯ä»¥é‡å¤ä½¿ç”¨@Sqlæ³¨è§£ã€‚å¦åˆ™ï¼Œä½ éœ€è¦ä½¿ç”¨@SqlGroupæ³¨è§£å»åŒ…å«å¤šä¸ª@Sqlå®ä¾‹ã€‚\nä¸‹é¢çš„ä¾‹å­æ˜¯Java 8çš„é‡å¤æ³¨è§£ç”³æ˜ï¼š\n@Test\r@Sql(scripts = \u0026quot;/test-schema.sql\u0026quot;, config = @SqlConfig(commentPrefix = \u0026quot;`\u0026quot;))\r@Sql(\u0026quot;/test-user-data.sql\u0026quot;)\rvoid userTest() {\r// run code that uses the test schema and test data\r}\r åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œtest-schema.sqlè„šæœ¬ä½¿ç”¨äº†ä¸€ä¸ªä¸åŒçš„è¯­æ³•ï¼šå•è¡Œæ³¨é‡Šã€‚\nä¸‹é¢çš„ä¾‹å­è·Ÿä¹‹å‰çš„ä¾‹å­ç›¸åŒï¼Œåªä¸è¿‡æ˜¯@Sqlè¢«@SqlGroupåŒ…è£…äº†ä¸€ä¸‹ã€‚ä¸Šé¢çš„ä¾‹å­åœ¨Java8çš„èƒŒæ™¯ä¸‹ï¼Œ@SqlGroupæ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯ä¸ºäº†å…¼å®¹æ€§ï¼Œæ¯”å¦‚éœ€è¦å…¼å®¹Kotlinï¼Œé‚£ä¹ˆä½ åªèƒ½é€‰æ‹©@SqlGroupã€‚\n@Test\r@SqlGroup({\r@Sql(scripts = \u0026quot;/test-schema.sql\u0026quot;, config = @SqlConfig(commentPrefix = \u0026quot;`\u0026quot;)),\r@Sql(\u0026quot;/test-user-data.sql\u0026quot;)\r)}\rvoid userTest() {\r// run code that uses the test schema and test data\r}\r 5.9.6. è„šæœ¬æ‰§è¡Œé˜¶æ®µ é»˜è®¤æƒ…å†µä¸‹@Sqlçš„è„šæœ¬éƒ½æ˜¯åœ¨æµ‹è¯•æ–¹æ³•ä¹‹å‰æ‰§è¡Œçš„ï¼Œå¦‚æœä½ éœ€è¦åœ¨æµ‹è¯•æ–¹æ³•ä¹‹åæ‰§è¡Œï¼ˆæ¯”å¦‚ï¼Œæ¸…æ¥šæ•°æ®åº“çŠ¶æ€ï¼‰ï¼Œé‚£ä¹ˆ@Sqlçš„å±æ€§executionPhaseå¯ä»¥å¸®åˆ°ä½ ã€‚\n@Test\r@Sql(\rscripts = \u0026quot;create-test-data.sql\u0026quot;,\rconfig = @SqlConfig(transactionMode = ISOLATED)\r)\r@Sql(\rscripts = \u0026quot;delete-test-data.sql\u0026quot;,\rconfig = @SqlConfig(transactionMode = ISOLATED),\rexecutionPhase = AFTER_TEST_METHOD\r)\rvoid userTest() {\r// run code that needs the test data to be committed\r// to the database outside of the test's transaction\r}\r æ³¨æ„ISOLATEDå’ŒAFTER_TEST_METHODæ˜¯åˆ†åˆ«ä»Sql.TransactionModeå’ŒSql.ExecutionPhaseé™æ€å¯¼å…¥çš„ã€‚\n5.9.7. é€šè¿‡@SqlConfigè¿›è¡Œè„šæœ¬é…ç½® ä½ å¯ä»¥é…ç½®è„šæœ¬è§£ææˆ–è€…å¼‚å¸¸å¤„ç†é€šè¿‡ä½¿ç”¨@SqlConfigæ³¨è§£ã€‚å½“ä½œä¸ºä¸€ä¸ªç±»çº§åˆ«çš„æ³¨è§£ç”³æ˜æ—¶ï¼Œ@SqlConfigæœåŠ¡äºæ•´ä¸ªæµ‹è¯•ç±»çš„å±‚æ¬¡ç»“æ„ï¼Œå¯¹å…¶ä¸­çš„æ‰€æœ‰SQLè„šæœ¬ç”Ÿæ•ˆã€‚å½“é€šè¿‡configå±æ€§ç›´æ¥ç”³æ˜åˆ°@Sqlæ³¨è§£é‡Œçš„æ—¶å€™ï¼Œ@SqlConfigä½œä¸ºä¸€ä¸ªæœ¬åœ°é…ç½®æœåŠ¡ï¼Œåªå¯¹@Sqlæ³¨è§£èŒƒå›´å†…çš„SQLè„šæœ¬ç”Ÿæ•ˆã€‚æ¯ä¸ª@SqlConfigçš„å±æ€§éƒ½æœ‰ä¸€ä¸ªéšæ€§çš„é»˜è®¤å€¼ã€‚å› ä¸ºJavaè¯­è¨€è§„èŒƒä¸­å®šä¹‰çš„æ³¨è§£å±æ€§è§„åˆ™ï¼Œæ³¨è§£å±æ€§æ˜¯ä¸èƒ½åˆ†é…nullå€¼çš„ã€‚å› æ­¤ï¼Œä¸ºäº†æ”¯æŒè¦†ç›–ç»§æ‰¿çš„å…¨å±€å±æ€§ï¼Œ@SqlConfigå±æ€§æœ‰ä¸€ä¸ªæ˜¾æ€§çš„é»˜è®¤å€¼ä¸º \u0026ldquo;\u0026quot;(å­—ç¬¦ä¸²)ï¼Œ{}(æ•°ç»„)ï¼Œæˆ–è€…DEFAULT(æšä¸¾)ã€‚è¿™ç§æ–¹æ³•å…è®¸æœ¬åœ°çš„@SqlConfigæä¾›é™¤äº†\u0026rdquo;\u0026quot;ï¼Œ{}ï¼Œæˆ–è€…DEFAULTä»¥å¤–çš„å€¼æ¥é€‰æ‹©æ€§çš„è¦†ç›–æ¥è‡ªå…¨å±€çš„æ¯ä¸ªå±æ€§ã€‚åªè¦æœ¬åœ°@SqlConfigæ²¡æœ‰æä¾›ä¸€ä¸ªæ˜¾æ€§çš„å±æ€§å€¼ï¼ˆ\u0026quot;\u0026quot;,{},DEFAULTé™¤å¤–ï¼‰ï¼Œé‚£ä¹ˆå¯¹åº”å±æ€§ä»ç„¶ä»å…¨å±€ç»§æ‰¿ã€‚\n@Sqlå’Œ@SqlConfigæä¾›çš„é…ç½®é€‰é¡¹è·ŸScriptUtilså’ŒResourceDatabasePopulatoræä¾›çš„ç›¸ç­‰ï¼Œä½†æ˜¯æ˜¯\u0026lt;jdbc:initialize-database/\u0026gt;æä¾›çš„XMLå‘½åç©ºé—´å…ƒç´ çš„è¶…é›†ã€‚è¯¦æƒ…å‚è€ƒ@Sql å’Œ@SqlConfig\n5.9.8. @Sqlçš„äº‹åŠ¡ç®¡ç† é»˜è®¤æƒ…å†µä¸‹ï¼ŒSqlScriptsTestExecutionListenerä¼šæ¨æ–­@Sqlé…ç½®çš„è„šæœ¬æœŸæœ›çš„äº‹åŠ¡è¯­ä¹‰ã€‚å…·ä½“æ¥è¯´ï¼ŒSQLè„šæœ¬æ²¡æœ‰è¿è¡Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œä½†åœ¨ä¸€ä¸ªSpringç®¡ç†çš„äº‹åŠ¡ä¸­ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç”±TransactionalTestExecutionListenerç®¡ç†çš„äº‹åŠ¡ï¼Œå½“æµ‹è¯•è¢«@Transactionalæ³¨è§£ä¿®é¥°æ—¶ï¼‰ï¼Œæˆ–è€…åœ¨ä¸€ä¸ªéš”ç¦»çš„äº‹åŠ¡å½“ä¸­ï¼Œå–å†³äº@SqlConfigå±æ€§transactionModeçš„å–å€¼å’Œæµ‹è¯•ApplicationContextä¸­æ˜¯å¦æœ‰PlatformTransactionManagerå­˜åœ¨ã€‚å°±ç®—æœ€ä½çš„è¦æ±‚ï¼Œä¹Ÿéœ€è¦ä¸€ä¸ªjavax.sql.DataSourceåœ¨æµ‹è¯•ApplicationContextä¸­å­˜åœ¨ã€‚\nå¦‚æœSqlScriptsTestExecutionListenerä½¿ç”¨çš„ç®—æ³•é€šè¿‡æ£€æµ‹DataSourceå’ŒPlatformTransactionManageræ¥æ¨æ–­çš„äº‹åŠ¡è¯­ä¹‰ä¸ç¬¦åˆä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥æŒ‡å®šæ˜¾å¼åç§°é€šè¿‡è®¾ç½®@SqlConfigçš„å±æ€§dataSourceå’ŒtransactionManagerã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥ç©ºå€¼äº‹åŠ¡çš„ä¼ æ’­æ–¹å¼é€šè¿‡è®¾ç½®@SqlConfigçš„transactionModeå±æ€§ï¼ˆæ¯”å¦‚ï¼Œæ˜¯å¦è„šæœ¬åº”è¯¥è¿è¡Œåœ¨ä¸€ä¸ªéš”ç¦»çš„äº‹åŠ¡ä¸­ï¼‰ã€‚è¯¦æƒ…å‚è€ƒ@SqlConfig å’Œ SqlScriptsTestExecutionListener\n@SpringJUnitConfig(TestDatabaseConfig.class)\r@Transactional\rclass TransactionalSqlScriptsTests {\rfinal JdbcTemplate jdbcTemplate;\r@Autowired\rTransactionalSqlScriptsTests(DataSource dataSource) {\rthis.jdbcTemplate = new JdbcTemplate(dataSource);\r}\r@Test\r@Sql(\u0026quot;/test-data.sql\u0026quot;)\rvoid usersTest() {\r// verify state in test database:\rassertNumUsers(2);\r// run code that uses the test data...\r}\rint countRowsInTable(String tableName) {\rreturn JdbcTestUtils.countRowsInTable(this.jdbcTemplate, tableName);\r}\rvoid assertNumUsers(int expected) {\rassertEquals(expected, countRowsInTable(\u0026quot;user\u0026quot;),\r\u0026quot;Number of rows in the [user] table.\u0026quot;);\r}\r}\r æ³¨æ„è¿™é‡Œä¸éœ€è¦åœ¨æ‰§è¡Œå®ŒuserTest()æ–¹æ³•åæ¸…ç†æ•°æ®åº“ï¼Œå› ä¸ºæ‰€æœ‰å¯¹æ•°æ®åº“çš„ä¿®æ”¹ï¼ˆä¸ç®¡æ˜¯æµ‹è¯•æ–¹æ³•ä¸­çš„ï¼Œè¿˜æ˜¯/test-data.sqlè„šæœ¬ä¸­çš„ï¼‰éƒ½ä¼šç”±TransactionalTestExecutionListenerè‡ªåŠ¨å›æ»šã€‚\n5.9.9. @SqlMergeModeåˆå¹¶æˆ–è€…è¦†ç›–é…ç½® ä»Spring Framework 5.2å¼€å§‹ï¼Œåˆå¹¶æ–¹æ³•çº§åˆ«çš„å’Œç±»çº§åˆ«çš„@Sqlç”³æ˜æˆä¸ºå¯èƒ½ã€‚æ¯”å¦‚è¯´ï¼Œè¿™èƒ½è®©ä½ ä¸ºæ¯ä¸ªæµ‹è¯•ç±»æä¾›ä¸€æ¬¡æ•°æ®åº“schemaé…ç½®æˆ–è€…æä¾›ä¸€äº›å¸¸è§çš„æµ‹è¯•æ•°æ®ï¼Œç„¶ååœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•æä¾›æŒ‡å®šçš„æµ‹è¯•æ•°æ®ã€‚è¦å¼€å¯@Sqlåˆå¹¶ï¼Œåœ¨ä½ çš„æµ‹è¯•ç±»æˆ–è€…æ–¹æ³•ä¸Šä¿®é¥°@SqlMergeMode(MERGE)ã€‚è¦ä¸ºæŒ‡å®šçš„æ–¹æ³•æˆ–è€…å­ç±»å…³é—­åˆï¼Œä½ å¯ä»¥è®¾ç½®æ¨¡å¼ä¸º@SqlMergeMode(OVERRIDE)ã€‚\n5.10. å¹¶å‘æµ‹è¯•æ‰§è¡Œ Spring Framework 5.0å¼•å…¥äº†åœ¨å•ä¸ªJVMä¸­å¹¶å‘æ‰§è¡Œæµ‹è¯•çš„åŸºç¡€æ”¯æŒï¼Œå½“ç„¶æ˜¯ä½¿ç”¨Spring TestContextæ¡†æ¶å‰æä¸‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™æ„å‘³ç€å¤§å¤šæ•°æµ‹è¯•ç±»æˆ–è€…æµ‹è¯•æ–¹æ³•éƒ½å¯ä»¥åœ¨ä¸ä¿®æ”¹ä»»ä½•æµ‹è¯•ä»£ç æˆ–è€…é…ç½®çš„å‰æä¸‹å¹¶å‘çš„æ‰§è¡Œã€‚\n æ€æ ·è®¾ç½®å¹¶å‘æµ‹è¯•æ‰§è¡Œï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒä½ ä½¿ç”¨çš„æµ‹è¯•æ¡†æ¶ï¼Œæ„å»ºå·¥å…·ï¼Œæˆ–è€…IDEã€‚\n è®°ä½åœ¨ä½ çš„æµ‹è¯•å¥—ä»¶ä¸­å¼•å…¥å¹¶å‘å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ï¼Œå¥‡æ€ªçš„è¿è¡Œæ—¶è¡Œä¸ºï¼Œå’Œé—´æ­‡çš„æµ‹è¯•å¤±è´¥æˆ–è€…äº§ç”Ÿéšæœºæ€§ã€‚å› æ­¤Springå›¢é˜Ÿå¯¹äºä½•æ—¶ä¸é€‚äºä½¿ç”¨å¹¶å‘æµ‹è¯•æœ‰ä»¥ä¸‹æ€»ç»“ï¼š\n ä½¿ç”¨Springæ¡†æ¶çš„@DirtiesContextã€‚ ä½¿ç”¨Spring Bootçš„@MockBeanæˆ–è€…@SpyBeanã€‚ ä½¿ç”¨JUnit 4çš„@FixMethodOrderæˆ–è€…ä»»ä½•æ˜¯è®¾è®¡æ¥ç¡®ä¿æµ‹è¯•æ–¹æ³•æŒ‰ç…§æŒ‡å®šé¡ºåºæ‰§è¡Œçš„æ¡†æ¶ç‰¹å¾ã€‚æ³¨æ„ï¼Œå½“æ•´ä¸ªæµ‹è¯•ç±»æ˜¯å¹¶å‘è¿è¡Œçš„æ—¶å€™ï¼Œå¹¶ä¸é€‚ç”¨ã€‚ æ”¹å˜å…±äº«æœåŠ¡æˆ–è€…ç³»ç»Ÿçš„çŠ¶æ€ï¼ˆæ¯”å¦‚æ•°æ®åº“ï¼Œæ¶ˆæ¯ä»£ç†ï¼Œæ–‡ä»¶ç³»ç»Ÿç­‰ç­‰ï¼‰ã€‚è¿™é€‚ç”¨äºé›†æˆæˆ–è€…å¤–éƒ¨ç³»ç»Ÿã€‚   å¦‚æœå¹¶å‘æµ‹è¯•æ‰§è¡Œå¤±è´¥è¿‡åï¼Œå½“å‰æµ‹è¯•çš„ApplicationContextä¸å†å¯ç”¨ï¼Œè¿™é€šå¸¸æ„å‘³ç€ApplicationContextåœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­è¢«ä»ContextCacheä¸­ç§»é™¤äº†ã€‚\nè¿™å¯èƒ½æ˜¯å› ä¸º@DirtiesContextæˆ–è€…æ˜¯ContextCacheè‡ªåŠ¨æ¸…é™¤çš„ã€‚å¦‚æœ@DirtiesContextæ˜¯ç½ªé­ç¥¸é¦–ï¼Œä½ è¦ä¹ˆé¿å…ä½¿ç”¨@DirtiesContextï¼Œè¦ä¹ˆé¿å…ä½¿ç”¨å¹¶å‘æµ‹è¯•ã€‚å¦‚æœæ˜¯ç”±äºContextCacheå·²ç»è¶…è¿‡æœ€å¤§å®¹é‡ï¼Œä½ å¯ä»¥å¢åŠ ç¼“å­˜æ•°é‡çš„æœ€å¤§å€¼ã€‚\n  åœ¨Spring TestContextæ¡†æ¶ä¸­æµ‹è¯•è¦å¹¶å‘æ‰§è¡Œï¼Œåªæœ‰åº•å±‚TestContextå®ç°æä¾›äº†ä¸€ä¸ª copy constructoræ—¶æ‰æœ‰æ•ˆ(å‚è€ƒjavadoc )ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„è‡ªå®šä¹‰TestContextå®ç°ï¼Œä½ éœ€è¦éªŒè¯å®ƒæ˜¯å¦é€‚é…å¹¶å‘æµ‹è¯•çš„æ‰§è¡Œã€‚\n 5.11. TestContext æ¡†æ¶æ”¯æŒç±» è¿™ä¸ªç« èŠ‚æè¿°äº†Spring TestContextæ¡†æ¶æ”¯æŒçš„å„ç§ç±»ã€‚\n5.11.1. Spring JUnit 4 Runner TestContextæ¡†æ¶æä¾›äº†å®Œæ•´çš„JUnit 4é›†æˆï¼Œé€šè¿‡ä¸€ä¸ªè‡ªå®šä¹‰çš„runnerï¼ˆåœ¨JUnit4.12æˆ–è€…æ›´é«˜ç‰ˆæœ¬æ”¯æŒï¼‰ã€‚é€šè¿‡ä¿®é¥°æµ‹è¯•@RunWith(SpringJUnit4ClassRunner.class)æˆ–è€…æ›´çŸ­çš„å˜ä½“@RunWith(SpringRunner.class)ï¼Œå¼€å‘è€…å¯ä»¥å®ç°JUnit 4ä¸ºåŸºç¡€çš„å•å…ƒå’Œé›†æˆæµ‹è¯•å¹¶ä¸”åŒäº‹è·å¾—TestContextæ¡†æ¶å¸¦æ¥çš„å¥½å¤„ï¼Œæ¯”å¦‚åŠ è½½ApplicationContextï¼Œæµ‹è¯•ç¤ºä¾‹çš„ä¾èµ–æ³¨å…¥ï¼Œæµ‹è¯•æ–¹æ³•çš„äº‹åŠ¡ç®¡ç†ç­‰ç­‰ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨å…¶ä»–çš„runnerï¼ˆæ¯”å¦‚JUnit 4çš„Parameterizedrunnerï¼‰æˆ–è€…ç¬¬ä¸‰æ–¹çš„runnerï¼ˆæ¯”å¦‚MockitoJUnitRunnerï¼‰ï¼Œæ›´å¤šå‚è€ƒSpringâ€™s support for JUnit rules\nä¸‹é¢çš„ä»£ç å±•ç¤ºäº†é…ç½®ä¸€ä¸ªæµ‹è¯•ç±»è¿è¡Œè‡ªå®šä¹‰SpringRunnerçš„æœ€ä½éœ€æ±‚ï¼š\n@RunWith(SpringRunner.class)\r@TestExecutionListeners({})\rpublic class SimpleTest {\r@Test\rpublic void testMethod() {\r// test logic...\r}\r}\r ä¸Šé¢çš„ä¾‹å­ä¸­@TestExecutionListenersè¢«é…ç½®ä¸ºä¸€ä¸ªç©ºçš„listï¼Œè¿™æ ·ä¼šå…³é—­æ‰€æœ‰é»˜è®¤çš„listenerï¼Œå¦åˆ™éœ€è¦é€šè¿‡@ContextConfigurationé…ç½®ä¸€ä¸ªApplicationContextã€‚\n5.11.2. Spring JUnit è§„åˆ™ org.springframework.test.context.junit4.rulesåŒ…æä¾›äº†ä»¥ä¸‹JUnit 4è§„åˆ™ï¼ˆåœ¨JUnit4.12æˆ–è€…æ›´é«˜ç‰ˆæœ¬æ”¯æŒï¼‰ï¼š\n SpringClassRule SpringMethodRule  SpringClassRuleæ˜¯ä¸€ä¸ªJUnitTestRuleï¼Œä»–æ”¯æŒTestContextæ¡†æ¶ç±»çº§åˆ«çš„ç‰¹å¾ï¼Œä½†æ˜¯SpringMethodRuleæ˜¯ä¸€ä¸ªJUnitMethodRuleï¼Œä»–æ”¯æŒTestContextæ¡†æ¶å®ä¾‹çº§åˆ«æˆ–è€…æ–¹æ³•çº§åˆ«çš„ç‰¹å¾ã€‚\nç›¸å¯¹äºSpringRunnerï¼ŒSpringè§„åˆ™åŸºç¡€çš„Junitæ”¯æŒå…·æœ‰ç‹¬ç«‹äºä»»ä½•org.junit.runner.Runnerå®ç°çš„æœ‰ç‚¹ï¼Œå› æ­¤ï¼Œå¯ä»¥å’Œå·²å­˜åœ¨çš„runnerï¼ˆæ¯”å¦‚JUnit4çš„Parameterizedï¼‰æˆ–è€…ç¬¬ä¸‰æ–¹çš„runnerç»“åˆä½¿ç”¨ï¼ˆMockitoJUnitRunnerï¼‰ã€‚\nä¸ºäº†æ”¯æŒTestContextæ¡†æ¶çš„å®Œæ•´åŠŸèƒ½ï¼Œä½ å¿…é¡»ç»“åˆä¸€ä¸ªSpringClassRuleå’Œä¸€ä¸ªSpringMethodRuleã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†åœ¨ç»§æ‰¿æµ‹è¯•ä¸­å¦‚ä½•æ­£ç¡®çš„ç”³æ˜è¿™äº›è§„åˆ™ï¼š\n// Optionally specify a non-Spring Runner via @RunWith(...)\r@ContextConfiguration\rpublic class IntegrationTest {\r@ClassRule\rpublic static final SpringClassRule springClassRule = new SpringClassRule();\r@Rule\rpublic final SpringMethodRule springMethodRule = new SpringMethodRule();\r@Test\rpublic void testMethod() {\r// test logic...\r}\r}\r 5.11.3. JUnit 4 æ”¯æŒç±» org.springframework.test.context.junit4ä¸ºJUnit4(åœ¨JUnit4.12æˆ–è€…æ›´é«˜ç‰ˆæœ¬æ”¯æŒ)ä¸ºåŸºç¡€çš„æµ‹è¯•æ¡ˆä¾‹æä¾›äº†ä»¥ä¸‹æ”¯æŒç±»ï¼š\n AbstractJUnit4SpringContextTests AbstractTransactionalJUnit4SpringContextTests  AbstractJUnit4SpringContextTestsæ˜¯ä¸€ä¸ªæŠ½è±¡æµ‹è¯•åŸºç±»ï¼Œä»–é›†æˆäº†åœ¨JUnit 4ç¯å¢ƒçš„TestContextæ¡†æ¶å¸¦æœ‰æ˜¾å¼çš„ApplicationContextæµ‹è¯•æ”¯æŒã€‚å½“ä½ extendAbstractJUnit4SpringContextTestsï¼Œä½ å¯ä»¥è®¿é—®ä¸€ä¸ªprotected``applicationContextå®ä¾‹å‚æ•°ï¼Œç”¨å®ƒæ¥æ‰§è¡Œæ˜¾å¼çš„beanæŸ¥æ‰¾æˆ–è€…æµ‹è¯•æ•´ä¸ªä¸Šä¸‹æ–‡çš„çŠ¶æ€ã€‚\nAbstractTransactionalJUnit4SpringContextTestsæ˜¯å¯¹AbstractJUnit4SpringContextTestsçš„ä¸€ä¸ªæŠ½è±¡äº‹ç‰©çš„æ‰©å±•ï¼Œå®ƒæ–°å¢äº†ä¸€äº›æœ‰å…³JDBCçš„ä¾¿æ·è®¿é—®ã€‚è¿™ä¸ªç±»éœ€è¦ApplicationContextä¸­å®šä¹‰äº†ä¸€ä¸ªjavax.sql.DataSourcebeanå’Œä¸€ä¸ªPlatformTransactionManagerbeanã€‚å½“ä½ extendAbstractTransactionalJUnit4SpringContextTestsï¼Œä½ å¯ä»¥è®¿é—®ä¸€ä¸ªprotected``jdbcTemplateå®ä¾‹å‚æ•°ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥è·‘SQLè¯­å¥ã€‚ä½ å¯ä»¥åœ¨æ•°æ®åº“ç›¸å…³ä»£ç è¿è¡Œå‰åç¡®å®šæ•°æ®åº“çš„çŠ¶æ€ï¼ŒSpringä¼šç¡®ä¿åº”ç”¨ä»£ç çš„queryåœ¨ç›¸åŒçš„äº‹åŠ¡ä¸­ã€‚å½“é…åˆORMå·¥å…·ä½¿ç”¨æ—¶ï¼Œéœ€è¦ç¡®ä¿é¿å…false positivesï¼Œä¹‹å‰æåˆ°è¿‡ã€‚AbstractTransactionalJUnit4SpringContextTestsä¹Ÿæä¾›äº†å¿«æ·æ–¹æ³•ï¼Œä»–ä»¬éƒ½æ˜¯å§”æ‰˜JdbcTestUtilsçš„æ–¹æ³•å®Œæˆçš„é€šè¿‡å‰é¢æåˆ°çš„jdbcTemplateã€‚æ­¤å¤–ï¼ŒAbstractTransactionalJUnit4SpringContextTestsæä¾›äº†ä¸€ä¸ªexecuteSqlScript(..)æ–¹æ³•å¯ä»¥è¿è¡ŒSQLè„šæœ¬ã€‚\n è¿™äº›ç±»æ–¹ä¾¿äº†æ‰©å±•ã€‚ä½†æ˜¯å¦‚æœä½ ä¸åƒä½ çš„æµ‹è¯•ç±»è·ŸSpringæŒ‡å®šçš„ç±»ç»“æ„ç»‘å®šï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡@RunWith(SpringRunner.class)æˆ–è€… Springâ€™s JUnit rulesã€‚\n 5.11.4. SpringExtension for JUnit Jupiter TestContextæ¡†æ¶ä¸ºJUnit5å¼•å…¥çš„JUnit Jupiteræµ‹è¯•æ¡†æ¶æä¾›äº†å®Œæ•´çš„é›†æˆã€‚é€šè¿‡æ³¨è§£æµ‹è¯•ç±»@ExtendWith(SpringExtension.class)ï¼Œä½ å¯ä»¥å®ç°æ ‡å‡†çš„JUnit Jupiterä¸ºåŸºç¡€çš„å•å…ƒæˆ–è€…é›†æˆæµ‹è¯•åŒäº‹ä¹Ÿå¯ä»¥ä»TestContextæ¡†æ¶ä¸­å—ç›Šã€‚\næ­¤å¤–ï¼Œå¤šäºäº†JUnit Jupiterä¸°å¯Œçš„æ‰©å±•ï¼ŒSpringæä¾›äº†ä»¥ä¸‹ç‰¹å¾ï¼Œå®ƒæ¯”Springå¯¹JUnit4å’ŒTestNGç‰¹å¾çš„æ”¯æŒè¦æ›´å¤šæ›´å®Œå–„ï¼š\n æµ‹è¯•æ„é€ æ–¹æ³•ï¼Œæµ‹è¯•æ–¹æ³•ï¼Œå’Œæµ‹è¯•å£°æ˜å‘¨æœŸå›è°ƒæ–¹æ³•çš„ä¾èµ–æ³¨å…¥ã€‚è¯¦æƒ…å‚è€ƒDependency Injection with SpringExtension å¼ºåŠ›æ”¯æŒåŸºäºSpELè¡¨è¾¾å¼çš„æ¡ä»¶åŒ–æµ‹è¯•æ‰§è¡Œ ï¼Œç¯å¢ƒå˜é‡ï¼Œç³»ç»Ÿå±æ€§ç­‰ç­‰ã€‚å‚è€ƒ@EnabledIfå’Œ@DisabledIfåœ¨Spring JUnit Jupiter Testing Annotations ä¸­ è‡ªå®šä¹‰å¤åˆæ³¨è§£ç”±Springå’ŒJUnit Jupiterçš„æ³¨è§£ç»„æˆã€‚å‚è€ƒ@TransactionalDevTestConfigå’Œ@TransactionalIntegrationTestçš„ä¾‹å­åœ¨Meta-Annotation Support for Testing  ä¸‹é¢çš„ä¾‹å­æ˜¯ä¸€ä¸ªä½¿ç”¨å®ä¾‹ï¼š\n// Instructs JUnit Jupiter to extend the test with Spring support.\r@ExtendWith(SpringExtension.class)\r// Instructs Spring to load an ApplicationContext from TestConfig.class\r@ContextConfiguration(classes = TestConfig.class)\rclass SimpleTests {\r@Test\rvoid testMethod() {\r// test logic...\r}\r}\r å› ä¸ºä½ ä¹Ÿå¯ä»¥ä½¿ç”¨JUnit 5çš„æ³¨è§£ä½œä¸ºå…ƒæ³¨è§£ï¼Œæ‰€ä»¥Springæä¾›äº†@SpringJUnitConfigå’Œ@SpringJUnitWebConfigä»–ä»¬ç»„åˆäº†å¿…è¦çš„æ³¨è§£ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ª@SpringJUnitConfigçš„ä¾‹å­ï¼š\n// Instructs Spring to register the SpringExtension with JUnit\r// Jupiter and load an ApplicationContext from TestConfig.class\r@SpringJUnitConfig(TestConfig.class)\rclass SimpleTests {\r@Test\rvoid testMethod() {\r// test logic...\r}\r}\r åŒæ ·çš„ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ª@SpringJUnitWebConfigä¾‹å­ï¼Œä¸ºJUnit Jupiteråˆ›å»ºäº†ä¸€ä¸ªWebApplicationContextï¼š\n// Instructs Spring to register the SpringExtension with JUnit\r// Jupiter and load a WebApplicationContext from TestWebConfig.class\r@SpringJUnitWebConfig(TestWebConfig.class)\rclass SimpleWebTests {\r@Test\rvoid testMethod() {\r// test logic...\r}\r}\r è¯¦æƒ…å‚è€ƒSpring JUnit Jupiter Testing Annotations\n5.11.5. Dependency Injection with SpringExtension SpringExtensionå®ç°äº†æ¥è‡ªJUnit Jupiterçš„ParameterResoleræ‰©å±•APIï¼Œå®ƒè®©Springä¸ºæµ‹è¯•æ„é€ å‡½æ•°ï¼Œæµ‹è¯•æ–¹æ³•ï¼Œå’Œæµ‹è¯•ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°æä¾›äº†ä¾èµ–æ³¨å…¥ã€‚\nå…·ä½“æ¥è¯´ï¼ŒSpringExtensionä½ å¯ä»¥æ³¨å…¥æ¥è‡ªæµ‹è¯•çš„ApplicationContextä¸­çš„ä¾èµ–åˆ°æµ‹è¯•æ„é€ å‡½æ•°å’Œè¢«@BeforeAll, @AfterAll, @BeforeEach, @AfterEach, @Test, @RepeatedTest, @ParameterizedTestï¼Œå’Œå…¶ä»–æ³¨è§£ä¿®é¥°çš„æ–¹æ³•ä¸­ã€‚\næ„é€ å‡½æ•°æ³¨å…¥ å¦‚æœæ„é€ å™¨ä¸­çš„æŒ‡å®šå‚æ•°æ˜¯ApplicationContextç±»å‹ï¼ˆæˆ–è€…å…¶å­ç±»å‹ï¼‰æˆ–è€…æ˜¯å…¶è¢«ä»¥ä¸‹æ³¨è§£æˆ–è€…å…ƒæ³¨è§£ä¿®é¥°ï¼š@Autowiredï¼Œ@Qualifierï¼Œæˆ–è€…@Valueï¼ŒSpringä¼šæ ¹æ®æ¥è‡ªæµ‹è¯•ApplicationContextä¸­å¯¹åº”beanæˆ–è€…valueæ¥æ³¨å…¥å€¼ã€‚\nSpringå¯ä»¥ä¸ºæµ‹è¯•ç±»çš„æ„é€ å‡½æ•°é…ç½®è‡ªåŠ¨è£…é…æ‰€æœ‰çš„å‚æ•°ï¼Œå¦‚æœæ„é€ å‡½æ•°æ˜¯è€ƒè™‘æˆä¸ºè‡ªåŠ¨è£…é…åŒ–çš„ã€‚ä¸€ä¸ªæ„é€ å‡½æ•°æ˜¯å¦è€ƒè™‘è‡ªåŠ¨è£…é…åŒ–ï¼Œä¸‹é¢çš„æ¡ä»¶æœ‰ä¸€ä¸ªæ»¡è¶³å°±å¯ä»¥ï¼ˆæŒ‰ä¼˜å…ˆé¡ºåºï¼‰ã€‚\n æ„é€ å‡½æ•°è¢«@Autowiredä¿®é¥°ã€‚ @TestConstructoræ³¨è§£åœ¨æµ‹è¯•ç±»ä¸Šå­˜åœ¨æˆ–è€…ä»–çš„å…ƒæ³¨è§£ï¼Œå¹¶ä¸”autowireModeå±æ€§è¦ä¸ºALLã€‚ é»˜è®¤çš„æµ‹è¯•æ„é€ å‡½æ•°è‡ªåŠ¨è£…é…æ¨¡å¼æ”¹ä¸ºäº†ALLã€‚  è¯¦æƒ…å‚è€ƒ@TestConstructor\n å¦‚æœæµ‹è¯•ç±»çš„æ„é€ å‡½æ•°è€ƒè™‘æˆä¸ºè‡ªåŠ¨è£…é…åŒ–çš„ï¼ŒSpringä¼šæ‰¿æ‹…æ„é€ å‡½æ•°æ‰€æœ‰å‚æ•°çš„è§£æå·¥ä½œã€‚è¿™ä¼šå¯¼è‡´ï¼Œè¿™æ ·çš„æ„é€ å‡½æ•°ä¸ä¼šæœ‰å…¶ä»–é€šè¿‡JUnit Jupiteræ³¨å†Œçš„ParameterResolverèƒ½å¤Ÿè§£æä»–çš„å‚æ•°ã€‚\n  å¦‚æœæµ‹è¯•æ–¹æ³•ç”³æ˜äº†@DirtiesContextæ¥åœ¨æ–¹æ³•æ‰§è¡Œå‰æˆ–è€…æ‰§è¡Œåå…³é—­ApplicationContextï¼Œé‚£ä¹ˆå°±ä¸èƒ½å°†æ„é€ å™¨æ³¨å…¥å’ŒJUnit Jupiterçš„@TestInstance(PER_CLASS)é…åˆä½¿ç”¨ã€‚\nåŸå› æ˜¯å› ä¸º@TestInstance(PER_CLASS)è®©JUnit Jupiterå»ç¼“å­˜äº†æµ‹è¯•æ–¹æ³•è°ƒç”¨ä¹‹é—´çš„æµ‹è¯•å®ä¾‹ã€‚å› æ­¤ï¼Œæµ‹è¯•å®ä¾‹å°†ä¼šä¿ç•™å³å°†è¢«å…³é—­çš„ApplicationContextä¸­çš„beanå¼•ç”¨ã€‚å› ä¸ºåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæµ‹è¯•ç±»çš„æ„é€ å™¨åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œä¾èµ–æ³¨å…¥ä¸ä¼šå†æ¬¡æ‰§è¡Œï¼Œæ¥ä¸‹æ¥çš„æµ‹è¯•äº¤äº’çš„éƒ½æ˜¯ä¸€ä¸ªå…³é—­çš„ApplicationContextï¼Œä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚\nè¦é…åˆ@TestInstance(PER_CLASS)ä½¿ç”¨before test methodæˆ–è€…after test methodæ¨¡å¼çš„@DirtiesContextï¼Œå¿…é¡»è¦é€šè¿‡å­—æ®µæˆ–è€…setteræ–¹å¼çš„ä¾èµ–æ³¨å…¥ï¼Œè¿™æ ·å°±èƒ½åœ¨æµ‹è¯•æ–¹æ³•è°ƒç”¨ä¹‹é—´é‡æ–°æ³¨å…¥ã€‚\n ä¸‹é¢çš„ä¾‹å­ä¸­ï¼ŒSpringæ³¨å…¥æ¥è‡ªApplicationContextçš„OrderServicebeanåˆ°OrderServiceIntegrationTestsæ„é€ æ–¹æ³•ä¸­ã€‚\n@SpringJUnitConfig(TestConfig.class)\rclass OrderServiceIntegrationTests {\rprivate final OrderService orderService;\r@Autowired\rOrderServiceIntegrationTests(OrderService orderService) {\rthis.orderService = orderService;\r}\r// tests that use the injected OrderService\r}\r æ³¨æ„è¿™ä¸ªç‰¹å¾è®©æµ‹è¯•ä¾èµ–æˆä¸ºfinalï¼Œå› æ­¤ä¸èƒ½æ›´æ”¹ã€‚\nå¦‚æœspring.test.constructor.autowire.modeå±æ€§å€¼æ˜¯all(è¯¦æƒ…å‚è€ƒ@TestConstructor )ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥ä¹‹å‰ä¾‹å­ä¸­æ„é€ æ–¹æ³•ä¸Šçš„@Autowiredï¼Œç»“æœå¦‚ä¸‹ï¼š\n@SpringJUnitConfig(TestConfig.class)\rclass OrderServiceIntegrationTests {\rprivate final OrderService orderService;\rOrderServiceIntegrationTests(OrderService orderService) {\rthis.orderService = orderService;\r}\r// tests that use the injected OrderService\r}\r æ–¹æ³•æ³¨å…¥ å¦‚æœJUnit Jupiteræµ‹è¯•æ–¹æ³•æˆ–è€…æµ‹è¯•å£°æ˜å‘¨æœŸå›è°ƒæ–¹æ³•çš„ä¸€ä¸ªå‚æ•°æ˜¯ApplicationContextç±»å‹ï¼ˆæˆ–è€…æ˜¯å…¶å­ç±»å‹ï¼‰æˆ–è€…æ˜¯è¢«ä¸€ä¸‹æ³¨è§£æˆ–å…ƒæ³¨è§£ä¿®é¥°çš„ï¼š@Autowirdï¼Œ@Qualifierï¼Œæˆ–è€…@Valueï¼ŒSpringä¼šä¸ºæŒ‡å®šçš„å‚æ•°æ³¨å…¥ApplicationContextä¸­å¯¹åº”çš„beanã€‚\nä¸‹é¢çš„å°±æ˜¯ä¸€ä¸ªæ–¹æ³•æ³¨å…¥çš„å®ä¾‹ï¼š\n@SpringJUnitConfig(TestConfig.class)\rclass OrderServiceIntegrationTests {\r@Test\rvoid deleteOrder(@Autowired OrderService orderService) {\r// use orderService from the test's ApplicationContext\r}\r}\r å› ä¸ºåœ¨JUnit Jupiterä¸­å¯¹ParameterResolveræ”¯æŒçš„ç¨³å¥æ€§ï¼Œä½ å¯ä»¥æœ‰å¤šä¸ªä¾èµ–æ³¨å…¥åˆ°å•ä¸ªæ–¹æ³•ä¸­ï¼Œä¸ä»…æ˜¯æ¥è‡ªSpringï¼Œä¹Ÿå¯ä»¥æ˜¯æ¥è‡ªJUnit Jupiteræˆ–è€…å…¶ä»–ç¬¬ä¸‰æ–¹çš„æ‰©å±•ã€‚\nä¸‹é¢çš„ä¾‹å­å±•ç¤ºå¦‚ä½•åŒæ—¶æœ‰Springå’ŒJUnit Jupiterçš„æ³¨å…¥åˆ°åŒä¸€ä¸ªæµ‹è¯•æ–¹æ³•ä¸­ï¼š\n@SpringJUnitConfig(TestConfig.class)\rclass OrderServiceIntegrationTests {\r@RepeatedTest(10)\rvoid placeOrderRepeatedly(RepetitionInfo repetitionInfo,\r@Autowired OrderService orderService) {\r// use orderService from the test's ApplicationContext\r// and repetitionInfo from JUnit Jupiter\r}\r}\r æ³¨æ„ä½¿ç”¨æ¥è‡ªJUnit Jupiterçš„@RepeatedTestï¼Œå¯ä»¥è®©æ–¹æ³•æœ‰æƒé™è®¿é—®RepetitionInfoã€‚\n5.11.6. @Nestedæµ‹è¯•ç±»é…ç½® ä»Spring Framework 5.0å¼€å§‹ï¼ŒSpring TestContextæ¡†æ¶æ”¯æŒåœ¨JUnit Jupiterçš„@Nestedæµ‹è¯•ç±»ä¸Šä½¿ç”¨æµ‹è¯•ç›¸å…³çš„æ³¨è§£ï¼›ä½†æ˜¯ï¼Œç›´åˆ°Spring Framework5.3ï¼Œç±»çº§åˆ«çš„æµ‹è¯•é…ç½®æ³¨è§£æ‰ä»å°é—­ç±»ç»§æ‰¿è€Œæ¥ï¼Œå°±åƒä»–ä»¬ç»§æ‰¿æ¥è‡ªçˆ¶ç±»çš„ä¸€æ ·ã€‚\nSpring Framework 5.3 å¼•å…¥äº†è‰¯å¥½çš„å†…éƒ¨ç±»é…ç½®ç»§æ‰¿æ”¯æŒï¼Œå¹¶ä¸”å°†ä¼šé»˜è®¤å¯ç”¨ã€‚è¦æ”¹å˜é»˜è®¤çš„INHERITæ¨¡å¼ä¸ºOVERRIDEæ¨¡å¼ï¼Œä½ å¯ä»¥ç»™æ¯ä¸ª@Nestedæµ‹è¯•ç±»æ·»åŠ ä¸€ä¸ª@NestedTestConfiguration(EnclosingConfiguration.OVERRIDE)ã€‚ä¸€ä¸ªæ˜¾å¼@NestedTestConfigurationç”³æ˜ä¸ä»…å¯¹æ³¨è§£ä¿®é¥°çš„æµ‹è¯•ç±»æœ‰æ•ˆä¹Ÿå¯¹å…¶å­ç±»å’Œé›†æˆçš„ç±»æœ‰æ•ˆã€‚å› æ­¤ï¼Œä½ å¯ä»¥ç”¨@NestedTestConfigurationæ³¨è§£ä¿®é¥°é¡¶çº§æµ‹è¯•ç±»ï¼Œè®©åé€’å½’åº”ç”¨åˆ°å…¶æ‰€æœ‰é›†æˆçš„æµ‹è¯•ç±»ä¸Šã€‚\nä¸ºäº†å…è®¸å¼€å‘å›¢é˜Ÿä¿®æ”¹é»˜è®¤çš„æ¨¡å‹ä¸ºOVERRIDEâ€”â€”ä¸¾ä¸ªä¾‹å­ï¼Œä¸ºäº†å…¼å®¹Spring Framework 5.0åˆ°5.2â€”â€”é»˜è®¤çš„æ¨¡å‹å¯ä»¥å…¨å±€ä¿®æ”¹é€šè¿‡JVMç³»ç»Ÿå±æ€§æˆ–è€…ä¸€ä¸ªåœ¨classpathæ ¹è·¯å¾„ä¸‹çš„spring.propertiesæ–‡ä»¶ã€‚è¯¦æƒ…å‚è€ƒ\u0026ldquo;Changing the default enclosing configuration inheritance mode\u0026rdquo;\nä¸‹é¢çš„Hello Worldä¾‹å­æ˜¯éå¸¸ç®€å•çš„ï¼Œä»–å±•ç¤ºäº†æ€æ ·ç”³æ˜å¸¸ç”¨çš„é…ç½®åˆ°é¡¶çº§ç±»ä¸Šï¼Œæ–¹ä¾¿å®ƒçš„é›†æˆç±»èƒ½å¤Ÿç»§æ‰¿è¿™äº›é…ç½®ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåªæœ‰TestConfigé…ç½®ç±»æ˜¯ç»§æ‰¿çš„ã€‚æ¯ä¸ªé›†æˆæµ‹è¯•ç±»æä¾›äº†å®ƒè‡ªå·±çš„æ¿€æ´»é…ç½®æ–‡ä»¶ï¼Œç»“æœå°±æ˜¯æ¯ä¸ªç»§æ‰¿æµ‹è¯•ç±»éƒ½æœ‰ä¸€ä¸ªä¸åŒçš„ApplicationContextã€‚\n@SpringJUnitConfig(TestConfig.class)\rclass GreetingServiceTests {\r@Nested\r@ActiveProfiles(\u0026quot;lang_en\u0026quot;)\rclass EnglishGreetings {\r@Test\rvoid hello(@Autowired GreetingService service) {\rassertThat(service.greetWorld()).isEqualTo(\u0026quot;Hello World\u0026quot;);\r}\r}\r@Nested\r@ActiveProfiles(\u0026quot;lang_de\u0026quot;)\rclass GermanGreetings {\r@Test\rvoid hello(@Autowired GreetingService service) {\rassertThat(service.greetWorld()).isEqualTo(\u0026quot;Hallo Welt\u0026quot;);\r}\r}\r}\r 5.11.7. TestNGæ”¯æŒç±» org.springframework.test.context.testngä¸ºTestNGä¸ºåŸºç¡€çš„æµ‹è¯•æ¡ˆä¾‹æä¾›äº†ä»¥ä¸‹æ”¯æŒç±»ï¼š\n AbstractTestNGSpringContextTests AbstractTransactionalTestNGSpringContextTests  AbstractTestNGSpringContextTestsæ˜¯ä¸€ä¸ªæŠ½è±¡æµ‹è¯•åŸºç±»ï¼Œä»–é›†æˆäº†åœ¨TestNGç¯å¢ƒçš„TestContextæ¡†æ¶å¸¦æœ‰æ˜¾å¼çš„ApplicationContextæµ‹è¯•æ”¯æŒã€‚å½“ä½ extendAbstractTestNGSpringContextTestsï¼Œä½ å¯ä»¥è®¿é—®ä¸€ä¸ªprotected``applicationContextå®ä¾‹å‚æ•°ï¼Œç”¨å®ƒæ¥æ‰§è¡Œæ˜¾å¼çš„beanæŸ¥æ‰¾æˆ–è€…æµ‹è¯•æ•´ä¸ªä¸Šä¸‹æ–‡çš„çŠ¶æ€ã€‚\nAbstractTransactionalTestNGSpringContextTestsæ˜¯å¯¹AbstractTestNGSpringContextTestsçš„ä¸€ä¸ªæŠ½è±¡äº‹ç‰©çš„æ‰©å±•ï¼Œå®ƒæ–°å¢äº†ä¸€äº›æœ‰å…³JDBCçš„ä¾¿æ·è®¿é—®ã€‚è¿™ä¸ªç±»éœ€è¦ApplicationContextä¸­å®šä¹‰ä¸€ä¸ªjavax.sql.DataSourcebeanå’Œä¸€ä¸ªPlatformTransactionManagerbeanã€‚å½“ä½ extendAbstractTransactionalTestNGSpringContextTestsï¼Œä½ å¯ä»¥è®¿é—®ä¸€ä¸ªprotected``jdbcTemplateå®ä¾‹å‚æ•°ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥è·‘SQLè¯­å¥ã€‚ä½ å¯ä»¥åœ¨æ•°æ®åº“ç›¸å…³ä»£ç è¿è¡Œå‰åç¡®å®šæ•°æ®åº“çš„çŠ¶æ€ï¼ŒSpringä¼šç¡®ä¿åº”ç”¨ä»£ç çš„queryåœ¨ç›¸åŒçš„äº‹åŠ¡ä¸­ã€‚å½“é…åˆORMå·¥å…·ä½¿ç”¨æ—¶ï¼Œéœ€è¦ç¡®ä¿é¿å…false positivesï¼Œä¹‹å‰æåˆ°è¿‡ã€‚AbstractTransactionalTestNGSpringContextTestsä¹Ÿæä¾›äº†å¿«æ·æ–¹æ³•ï¼Œä»–ä»¬éƒ½æ˜¯å§”æ‰˜JdbcTestUtilsçš„æ–¹æ³•å®Œæˆçš„é€šè¿‡å‰é¢æåˆ°çš„jdbcTemplateã€‚æ­¤å¤–ï¼ŒAbstractTransactionalTestNGSpringContextTestsæä¾›äº†ä¸€ä¸ªexecuteSqlScript(..)æ–¹æ³•å¯ä»¥è¿è¡ŒSQLè„šæœ¬ã€‚\n è¿™äº›ç±»æ–¹ä¾¿äº†æ‰©å±•ã€‚å¦‚æœä½ ä¸æƒ³ä½ çš„æµ‹è¯•ç±»å’ŒSpringæŒ‡å®šçš„ç±»ç»“æ„ç»‘å®šï¼Œä½ å¯ä»¥é…ç½®ä½ è‡ªå·±çš„è‡ªå®šä¹‰æµ‹è¯•ç±»ï¼Œé€šè¿‡ä½¿ç”¨@ContextConfiguration,@TestExecutionListenersç­‰ï¼Œå¹¶ä¸”é€šè¿‡TestContextManageræ‰‹åŠ¨æ£€æµ‹ä½ çš„æµ‹è¯•ç±»ã€‚å…³äºå¦‚ä½•æ£€æµ‹ä½ çš„æµ‹è¯•ç±»ï¼Œå‚è€ƒAbstractTestNGSpringContextTestsæºç ã€‚\n 6. WebTestClient WebTestClientæ˜¯ä¸€ä¸ªè®¾è®¡ç”¨äºæµ‹è¯•æœåŠ¡åº”ç”¨çš„HTTPå®¢æˆ·ç«¯ã€‚å®ƒåŒ…è£…äº†Springçš„WebClient ï¼Œå¹¶ä¸”ç”¨å®ƒæ¥æ‰§è¡Œè¯·æ±‚ï¼Œå¹¶ä¸”æš´éœ²ä¸€ä¸ªéªŒè¯responseçš„æµ‹è¯•é—¨é¢ã€‚WebTestClientå¯ä»¥ç”¨æ¥æ‰§è¡Œç«¯å¯¹ç«¯çš„HTTPæµ‹è¯•ã€‚å®ƒä¹Ÿå¯ä»¥ç”¨æ¥æµ‹è¯•Spring MVCå’ŒSpring WebFluxåº”ç”¨ï¼Œè€Œä¸”ä¸éœ€è¦è¿è¡ŒæœåŠ¡ï¼Œé€šè¿‡æ¨¡æ‹Ÿè¯·æ±‚å’Œè¿”å›å¯¹è±¡ã€‚\n Kotlinç”¨æˆ·ï¼šæŸ¥çœ‹this section ç›¸å…³çš„WebTestClientä½¿ç”¨ã€‚\n 6.1. é…ç½® è¦é…ç½®ä¸€ä¸ªWebTestClientï¼Œä½ éœ€è¦é€‰æ‹©ä¸€ä¸ªæœåŠ¡é…ç½®æ¥ç»‘å®šã€‚è¿™å¯ä»¥æ˜¯ä¼—å¤šæ¨¡æ‹ŸæœåŠ¡å™¨é…ç½®ä¸­çš„ä¸€ä¸ªæˆ–è€…ä¸€ä¸ªå®æ—¶çº¿ä¸ŠæœåŠ¡å™¨çš„è¿æ¥ã€‚\nç»‘å®šåˆ°Controller è¿™ä¸ªé…ç½®å…è®¸ä½ æµ‹è¯•æŒ‡å®šçš„controlleré€šè¿‡è™šæ‹Ÿçš„requestå’Œresponseå¯¹è±¡ï¼Œå¹¶ä¸”ä¸éœ€è¦è¿è¡ŒæœåŠ¡ã€‚\nå¯¹äºWebFluxåº”ç”¨ï¼Œä½¿ç”¨ä¸‹é¢çš„ä»£ç åŠ è½½åŸºç¡€æ¡†æ¶ç­‰äºWebFlux Java config ï¼Œæ³¨å†Œç»™å®šçš„controllerï¼Œç„¶ååˆ›å»ºä¸€ä¸ªWebHandler chain å»å¤„ç†requestï¼š\nWebTestClient client =\rWebTestClient.bindToController(new TestController()).build();\r å¯¹äºSpring MVCï¼Œä½¿ç”¨ä¸‹é¢çš„ä»£ç å§”æ‰˜StandaloneMockMvcBuilderå»åŠ è½½ä¸WebMvc Java config ç­‰æ•ˆçš„åŸºç¡€æ¶æ„ï¼Œæ³¨å†Œç»™å®šçš„controllerï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªMockMvc å®ä¾‹å»å¤„ç†requestï¼š\nWebTestClient client =\rMockMvcWebTestClient.bindToController(new TestController()).build();\r ç»‘å®šåˆ° ApplicationContext è¿™ä¸ªé…ç½®å…è®¸ä½ é€šè¿‡Spring MVCæˆ–è€…Spring WebFluxåŸºç¡€æ¡†æ¶å’Œcontrollerç”³æ˜æ¥åŠ è½½Springé…ç½®ï¼Œå¹¶ä¸”é€šè¿‡æ¨¡æ‹Ÿçš„requestå’Œresponseå¯¹è±¡å¤„ç†å»å¤„ç†è¯·æ±‚ï¼Œè€Œæ— éœ€è¿è¡ŒæœåŠ¡ã€‚\nå¯¹äºWebFluxï¼Œä½¿ç”¨ä»¥ä¸‹å†…å®¹ä¼ é€’SpringApplicationContextåˆ°WebHttpHandlerBuilder ä¸­å»åˆ›å»ºWebHandler chain ä»¥å¤„ç†è¯·æ±‚ï¼š\n@SpringJUnitConfig(WebConfig.class) class MyTests {\rWebTestClient client;\r@BeforeEach\rvoid setUp(ApplicationContext context) { client = WebTestClient.bindToApplicationContext(context).build(); }\r}\r å¯¹äºSpring MVCï¼Œä½¿ç”¨ä»¥ä¸‹å†…å®¹ä¼ é€’SpringApplicationContextåˆ°MockMvcBuilders.webAppContextSetup å»åˆ›å»ºä¸€ä¸ªMockMvc å®ä¾‹ä»¥å¤„ç†è¯·æ±‚ï¼š\n@ExtendWith(SpringExtension.class)\r@WebAppConfiguration(\u0026quot;classpath:META-INF/web-resources\u0026quot;) @ContextHierarchy({\r@ContextConfiguration(classes = RootConfig.class),\r@ContextConfiguration(classes = WebConfig.class)\r})\rclass MyTests {\r@Autowired\rWebApplicationContext wac; WebTestClient client;\r@BeforeEach\rvoid setUp() {\rclient = MockMvcWebTestClient.bindToApplicationContext(this.wac).build(); }\r}\r ç»‘å®šåˆ° Router Function è¿™ä¸ªé…ç½®å…è®¸ä½ åœ¨ä¸å¯åŠ¨æœåŠ¡çš„æƒ…å†µä¸‹é€šè¿‡æ¨¡æ‹Ÿrequestå’Œresponseå¯¹è±¡æµ‹è¯•functional endpoints\nå¯¹äºWebFluxï¼Œä½¿ç”¨ä¸‹é¢å†…å®¹å§”æ‰˜ç»™RouterFunctions.toWebHandlerå»åˆ›å»ºä¸€ä¸ªæœåŠ¡é…ç½®ä»¥å¤„ç†è¯·æ±‚ï¼š\nRouterFunction\u0026lt;?\u0026gt; route = ...\rclient = WebTestClient.bindToRouterFunction(route).build();\r å¯¹äºSpring MVCï¼Œç›®å‰è¿˜æ²¡æœ‰æµ‹è¯•WebMvc functional endpoints çš„é€‰é¡¹ã€‚\nç»‘å®šåˆ°æœåŠ¡å™¨ è¿™ä¸ªé…ç½®è¿æ¥åˆ°ä¸€ä¸ªè¿è¡Œçš„æœåŠ¡ä¸Šä»¥è¿›è¡Œå®Œæ•´çš„ï¼Œç«¯å¯¹ç«¯çš„HTTPæµ‹è¯•ï¼š\nclient = WebTestClient.bindToServer().baseUrl(\u0026quot;http://localhost:8080\u0026quot;).build();\r å®¢æˆ·ç«¯é…ç½® é™¤äº†ä¹‹å‰æ¢¯çº§çš„æœåŠ¡é…ç½®ä»¥å¤–ï¼Œä½ è¿˜å¯ä»¥é…ç½®å®¢æˆ·ç«¯é€‰é¡¹ï¼ŒåŒ…æ‹¬ base URLï¼Œé»˜è®¤ headersï¼Œå®¢æˆ·ç«¯è¿‡æ»¤å™¨ç­‰ç­‰ã€‚è¿™äº›é€‰é¡¹åœ¨bindToServcer()ä¹‹åéƒ½æ˜¯å¾ˆå®¹æ˜“è·å¾—çš„ã€‚å¯¹äºå…¶ä»–é…ç½®é€‰é¡¹ï¼Œä½ å¯ä»¥ä½¿ç”¨configureClient()å°†æœåŠ¡è½¬ä¸ºå®¢æˆ·ç«¯é…ç½®ï¼š\nclient = WebTestClient.bindToController(new TestController())\r.configureClient()\r.baseUrl(\u0026quot;/test\u0026quot;)\r.build();\r 6.2. å†™æµ‹è¯• ç›´åˆ°é€šè¿‡exchange()æ‰§è¡Œè¯·æ±‚ä¸ºæ­¢ï¼ŒWebTestClientæä¾›å’ŒWebClient ç›¸åŒçš„APIã€‚å‚è€ƒWebClient æ–‡æ¡£ä»¥æŸ¥æ‰¾å¦‚ä½•å‡†å¤‡ä¸€ä¸ªæœ‰ä»»ä½•å†…å®¹çš„è¯·æ±‚ï¼ŒåŒ…æ‹¬ form dataï¼Œ multipart dataï¼Œç­‰ç­‰ã€‚\nåœ¨è°ƒç”¨exchange()ä¹‹åï¼ŒWebTestClientä»WebClientåç¦»ï¼Œè½¬å˜å·¥ä½œæµçš„æ–¹å‘å»éªŒè¯responseã€‚\nä½¿ç”¨ä¸‹é¢å†…å®¹å»æ–­è¨€responseçš„çŠ¶æ€å’Œheaderï¼š\nclient.get().uri(\u0026quot;/persons/1\u0026quot;)\r.accept(MediaType.APPLICATION_JSON)\r.exchange()\r.expectStatus().isOk()\r.expectHeader().contentType(MediaType.APPLICATION_JSON)\r ç„¶åä½ å¯ä»¥é€šè¿‡ä¸‹é¢ä»»ä½•ä¸€ç§æ–¹æ³•å»è§£ç reponseçš„bodyï¼š\n expectBody(Class)ï¼šè§£ç ä¸ºå•ä¸ªå¯¹è±¡ã€‚ expectBodyList(Class)ï¼šè§£ç å¹¶æ”¶é›†å¯¹è±¡åˆ°Listã€‚ expectBody()ï¼šè§£ç åˆ°JSON Content æˆ–è€…ä¸€ä¸ªç©ºçš„body byte[]  ç„¶ååœ¨é«˜ç­‰çº§çš„ç»“æœå¯¹è±¡ä¸Šæ‰§è¡Œæ–­è¨€ï¼š\nclient.get().uri(\u0026quot;/persons\u0026quot;)\r.exchange()\r.expectStatus().isOk()\r.expectBodyList(Person.class).hasSize(3).contains(person);\r å¦‚æœå†…ç½®çš„æ–­è¨€æ•ˆç‡å¤ªä½ï¼Œä½ è¿˜å¯ä»¥ç”¨å…¶ä»–çš„æ–­è¨€ä»£æ›¿ï¼š\nimport org.springframework.test.web.reactive.server.expectBody\rclient.get().uri(\u0026quot;/persons/1\u0026quot;)\r.exchange()\r.expectStatus().isOk()\r.expectBody(Person.class)\r.consumeWith(result -\u0026gt; {\r// custom assertions (e.g. AssertJ)...\r});\r æˆ–è€…ä½ å¯ä»¥é€€å‡ºå·¥ä½œæµï¼Œå¹¶è·å–ä¸€ä¸ªEntityExchangeResultï¼š\nEntityExchangeResult\u0026lt;Person\u0026gt; result = client.get().uri(\u0026quot;/persons/1\u0026quot;)\r.exchange()\r.expectStatus().isOk()\r.expectBody(Person.class)\r.returnResult();\r  å½“ä½ éœ€è¦è§£ç çš„ç›®æ ‡ç±»å‹æ˜¯ä¸€ä¸ªæ³›å‹æ—¶ï¼Œè¯·å¯»æ‰¾æ¥å—ParameterizedTypeReference è€Œä¸æ˜¯Class\u0026lt;T\u0026gt;çš„é‡è½½æ–¹æ³•\n No Content å¦‚æœä¸æœŸå¾…responseä¼šè¿”å›ä»»ä½•å†…å®¹ï¼Œä½ å¯ä»¥è¿™æ ·æ–­è¨€ï¼š\nclient.post().uri(\u0026quot;/persons\u0026quot;)\r.body(personMono, Person.class)\r.exchange()\r.expectStatus().isCreated()\r.expectBody().isEmpty();\r å¦‚æœéœ€è¦å¿½ç•¥responseå†…å®¹ï¼Œä¸‹é¢å°±æ˜¯æ˜¯é‡Šæ”¾å†…å®¹å¹¶ä¸éœ€è¦ä»»ä½•æ–­è¨€ï¼š\nclient.get().uri(\u0026quot;/persons/123\u0026quot;)\r.exchange()\r.expectStatus().isNotFound()\r.expectBody(Void.class);\r JSON Content ä½ å¯ä»¥ä½¿ç”¨expectBody()ï¼Œä»–æ²¡æœ‰ç›®æ ‡ç±»å‹ï¼Œä»–æ–­è¨€çš„ç›®æ ‡æ˜¯ä¸ºåŠ å·¥çš„å†…å®¹è€Œä¸æ˜¯é«˜ç­‰çº§çš„å¯¹è±¡ã€‚\nç”¨JSONAssert éªŒè¯å®Œæ•´çš„JSONå†…å®¹ï¼š\nclient.get().uri(\u0026quot;/persons/1\u0026quot;)\r.exchange()\r.expectStatus().isOk()\r.expectBody()\r.json(\u0026quot;{\\\u0026quot;name\\\u0026quot;:\\\u0026quot;Jane\\\u0026quot;}\u0026quot;)\r ç”¨JSONPath éªŒè¯JSONå†…å®¹ï¼š\nclient.get().uri(\u0026quot;/persons\u0026quot;)\r.exchange()\r.expectStatus().isOk()\r.expectBody()\r.jsonPath(\u0026quot;$[0].name\u0026quot;).isEqualTo(\u0026quot;Jane\u0026quot;)\r.jsonPath(\u0026quot;$[1].name\u0026quot;).isEqualTo(\u0026quot;Jason\u0026quot;);\r Streaming Responses è¦æµ‹è¯•ä¸€ä¸ªå¯èƒ½æ— ç©·å°½çš„æµï¼Œæ¯”å¦‚è¯´\u0026quot;text/event-stream\u0026quot;æˆ–è€…\u0026quot;application/x-ndjson\u0026quot;ï¼Œé€šè¿‡éªŒè¯responseçŠ¶æ€å’Œheaderå¼€å§‹ï¼Œç„¶åè·å–ä¸€ä¸ªFluxExchangeResultï¼š\nFluxExchangeResult\u0026lt;MyEvent\u0026gt; result = client.get().uri(\u0026quot;/events\u0026quot;)\r.accept(TEXT_EVENT_STREAM)\r.exchange()\r.expectStatus().isOk()\r.returnResult(MyEvent.class);\r ç°åœ¨ä½ å·²ç»å‡†å¤‡å¥½é€šè¿‡æ¥è‡ªreactor-testçš„StepVerifierå»æ¶ˆè€—responseæµäº†ï¼š\nFlux\u0026lt;Event\u0026gt; eventFlux = result.getResponseBody();\rStepVerifier.create(eventFlux)\r.expectNext(person)\r.expectNextCount(4)\r.consumeNextWith(p -\u0026gt; ...)\r.thenCancel()\r.verify();  MockMvcæ–­è¨€ WebTestClientæ˜¯ä¸€ä¸ªHTTPå®¢æˆ·ç«¯ï¼Œå› æ­¤ä»–åªèƒ½éªŒè¯å®¢æˆ·ç«¯çš„responseï¼ŒåŒ…æ‹¬çŠ¶æ€ï¼Œhead,å’Œbodyã€‚\nå½“ç”¨ä¸€ä¸ªMockMVCæœåŠ¡é…ç½®æµ‹è¯•ä¸€ä¸ªSpring MVCåº”ç”¨æ—¶ï¼Œä½ æœ‰ä¸€ä¸ªé¢å¤–çš„é€‰æ‹©å¯ä»¥åœ¨æœåŠ¡responseä¸Šæ‰§è¡Œæ›´å¤šçš„æ–­è¨€ã€‚é€šè¿‡åœ¨æ–­è¨€bodyåè·å–ä¸€ä¸ªExchangeResultæ¥å®ç°ï¼š\n// For a response with a body\rEntityExchangeResult\u0026lt;Person\u0026gt; result = client.get().uri(\u0026quot;/persons/1\u0026quot;)\r.exchange()\r.expectStatus().isOk()\r.expectBody(Person.class)\r.returnResult();\r// For a response without a body\rEntityExchangeResult\u0026lt;Void\u0026gt; result = client.get().uri(\u0026quot;/path\u0026quot;)\r.exchange()\r.expectBody().isEmpty();\r ç„¶ååˆ‡æ¢åˆ°MockMvcæœåŠ¡responseæ–­è¨€ï¼š\nMockMvcWebTestClient.resultActionsFor(result)\r.andExpect(model().attribute(\u0026quot;integer\u0026quot;, 3))\r.andExpect(model().attribute(\u0026quot;string\u0026quot;, \u0026quot;a string value\u0026quot;));\r 7. MockMvc Spring MVC Test æ¡†æ¶ï¼Œä¹Ÿå«ä½œMockMvcï¼Œä¸ºæµ‹è¯•Spring MVCåº”ç”¨æä¾›äº†æ”¯æŒã€‚ä»–æ‰§è¡Œäº†å®Œæ•´çš„Spring MVCè¯·æ±‚å¤„ç†ï¼Œä½†æ˜¯æ˜¯é€šè¿‡æ¨¡æ‹Ÿçš„requestå’Œresponseå¯¹è±¡ä»è€Œä»£æ›¿ä¸€ä¸ªè¿è¡Œçš„æœåŠ¡ã€‚\nMockMvcå¯ä»¥ç”¨åœ¨å®ƒè‡ªå·±èº«ä¸Šå»æ”¯æŒè¯·æ±‚å’ŒresponseéªŒè¯ã€‚å®ƒä¹Ÿå¯ä»¥é€šè¿‡WebTestClientæ¥ä½¿ç”¨ï¼Œä»–æ˜¯é€šè¿‡æ’å…¥åˆ°WebTestClientä¸­ä½œä¸ºå¤„ç†è¯·æ±‚çš„æœåŠ¡ã€‚WebTestClientå¸¦æ¥çš„å¥½å¤„æ˜¯å¯ä»¥ä¸ç”¨å†çœ‹ç€æœªåŠ å·¥çš„æ•°æ®ï¼Œå¯ä»¥å°†response bodyè§£ç åˆ°é«˜ç­‰çº§å¯¹è±¡ä¸­ï¼Œå¹¶ä¸”è¿˜å¯ä»¥åˆ‡æ¢åˆ°å®Œæ•´çš„ç«¯å¯¹ç«¯çš„HTTPæµ‹è¯•ï¼Œå¹¶ä¸”ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„æµ‹è¯•APIã€‚\n7.1. å¤§çº² ä½ å¯ä»¥åœ¨æ™®é€šçš„å•å…ƒæµ‹è¯•ä¸­ä½¿ç”¨controllerï¼Œé€šè¿‡åˆå§‹åŒ–ä¸€ä¸ªcontrollerï¼Œæ³¨å…¥ä»–çš„ä¾èµ–ï¼Œå¹¶è°ƒç”¨ä»–çš„æ–¹æ³•ã€‚ ä½†æ˜¯ï¼Œè¿™æ ·çš„æµ‹è¯•ä¸èƒ½éªŒè¯ request mappings, data binding, message conversion, type conversion, validation, å¹¶ä¸”ä¸èƒ½æ¶‰åŠä»»ä½•æ”¯æŒ@InitBinderï¼Œ@ModelAttributeï¼Œæˆ–è€…@ExceptionHandlerçš„æ–¹æ³•ã€‚\nSpring MVC Testæ¡†æ¶ï¼Œä¹Ÿå«MockMVCï¼Œæ—¨åœ¨ä¸éœ€è¦è¿è¡ŒæœåŠ¡çš„æƒ…å†µä¸‹æä¾›æ›´å®Œæ•´çš„Spring MVC controlleræµ‹è¯•æ”¯æŒã€‚è¿™æ˜¯é€šè¿‡è°ƒç”¨DispacherServletå¹¶ä¸”ä¼ é€’äº†ä¸€ä¸ªæ¥è‡ªspring-testæ¨¡ç»„çš„æ¨¡æ‹Ÿçš„Servlet APIå®ç° ï¼Œå®ƒå¤åˆ¶äº†å®Œæ•´çš„Spring MVCè¯·æ±‚å¤„ç†é€»è¾‘ï¼Œå¹¶ä¸”ä¸éœ€è¦å¯åŠ¨æœåŠ¡ã€‚\nMockMvc æ˜¯ä¸€ä¸ªæœåŠ¡ç«¯çš„æµ‹è¯•æ¡†æ¶ï¼Œä»–é€šè¿‡ä½¿ç”¨è½»é‡å’Œç›®æ ‡æ€§çš„æµ‹è¯•å¯ä»¥è®©ä½ éªŒè¯Spring MVCåº”ç”¨çš„å¤§å¤šæ•°åŠŸèƒ½ã€‚\né™æ€å¯¼å…¥ å½“ä½¿ç”¨MockMvcç›´æ¥æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä½ ä¼šéœ€è¦é™æ€å¯¼å…¥ï¼š\n MockMvcBuilders.* MockMvcRequestBuilders.* MockMvcResultMatchers.* MockMvcResultHandlers.*  ä¸€ä¸ªç®€å•çš„æ–¹æ³•å»è®°ä½è¿™äº›ç±»ï¼Œå¯ä»¥é€šè¿‡ideæœç´¢MockMvc*ã€‚\nå½“é€šè¿‡WebTestClientä½¿ç”¨MockMvcæ—¶ï¼Œä½ ä¸éœ€è¦é™æ€å¯¼å…¥ã€‚WebTestClientæä¾›äº†æµç•…çš„APIå¹¶ä¸”ä¸éœ€è¦é™æ€å¯¼å…¥ã€‚\né…ç½®é€‰æ‹© MockMvcå¯ä»¥æœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥é…ç½®ã€‚ä¸€ä¸ªæ˜¯ç›´æ¥æŒ‡å‡ºä½ æƒ³è¦æµ‹è¯•çš„controllerï¼Œå¹¶ä¸”ä»¥ç¼–ç¨‹çš„æ–¹å¼é…ç½®Spring MVCåŸºç¡€ç»“æ„ã€‚å¦å¤–ä¸€ä¸ªæ˜¯æŒ‡å‡ºå¸¦æœ‰Spring MVCå’ŒcontrolleråŸºç¡€ç»“æ„çš„Springé…ç½®ã€‚\né…ç½®MockMvcå»æµ‹è¯•ä¸€ä¸ªæŒ‡å®šçš„controllerï¼š\nclass MyWebTests {\rMockMvc mockMvc;\r@BeforeEach\rvoid setup() {\rthis.mockMvc = MockMvcBuilders.standaloneSetup(new AccountController()).build();\r}\r// ...\r}\r å½“é€šè¿‡WebTestClientä½¿ç”¨æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªé…ç½®ï¼Œå®ƒä¼šå§”æ‰˜ç»™è·Ÿä¸Šé¢ç›¸åŒçš„æ„é€ å™¨ã€‚\né€šè¿‡Springé…ç½®æ¥åˆå§‹åŒ–MockMvcï¼š\n@SpringJUnitWebConfig(locations = \u0026quot;my-servlet-context.xml\u0026quot;)\rclass MyWebTests {\rMockMvc mockMvc;\r@BeforeEach\rvoid setup(WebApplicationContext wac) {\rthis.mockMvc = MockMvcBuilders.webAppContextSetup(this.wac).build();\r}\r// ...\r}\r æˆ–è€…åœ¨é€šè¿‡WebTestClientä½¿ç”¨æ—¶ä»ç„¶å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„é…ç½®ï¼ŒWebTestClientå§”æ‰˜ç»™è·Ÿä¸Šé¢ç›¸åŒçš„builderæ¥å®Œæˆã€‚\nä½ åº”è¯¥ä½¿ç”¨å“ªä¸ªé…ç½®é€‰é¡¹ï¼Ÿ\nwebAppContextSetupåŠ è½½ä½ å®é™…çš„Spring MVCé…ç½®ï¼Œç”Ÿæˆä¸€ä¸ªæ›´åŠ å®Œæ•´çš„é›†æˆæµ‹è¯•ã€‚å› ä¸ºTestContextæ¡†æ¶åŠ è½½äº†Springé…ç½®ï¼Œå®ƒå¸®åŠ©æµ‹è¯•æ›´å¿«çš„è¿è¡Œï¼Œå³ä½¿ä½ åœ¨ä½ çš„æµ‹è¯•å¥—ä»¶ä¸­å¼•å…¥äº†æ›´å¤šçš„æµ‹è¯•ã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥é€šè¿‡Springé…ç½®æ³¨å…¥æ¨¡æ‹Ÿserviceåˆ°controllerä¸­ä»¥åœ¨webå±‚æµ‹è¯•ä¸Šä¿æŒä¸“æ³¨ã€‚ä¸‹é¢çš„ä¾‹å­é€šè¿‡Mockitoç”³æ˜äº†ä¸€ä¸ªæ¨¡æ‹Ÿçš„serviceï¼š\n\u0026lt;bean id=\u0026quot;accountService\u0026quot; class=\u0026quot;org.mockito.Mockito\u0026quot; factory-method=\u0026quot;mock\u0026quot;\u0026gt;\r\u0026lt;constructor-arg value=\u0026quot;org.example.AccountService\u0026quot;/\u0026gt;\r\u0026lt;/bean\u0026gt;\r ç„¶åä½ å¯ä»¥å°†è¿™ä¸ªæ¨¡æ‹Ÿserviceæ³¨å…¥åˆ°æµ‹è¯•ä¸­ï¼Œé…ç½®å¹¶éªŒè¯ä½ çš„æœŸæœ›ç»“æœï¼š\n@SpringJUnitWebConfig(locations = \u0026quot;test-servlet-context.xml\u0026quot;)\rclass AccountTests {\r@Autowired\rAccountService accountService;\rMockMvc mockMvc;\r@BeforeEach\rvoid setup(WebApplicationContext wac) {\rthis.mockMvc = MockMvcBuilders.webAppContextSetup(wac).build();\r}\r// ...\r}\r å¦ä¸€æ–¹é¢ï¼ŒstandaloneSetupæ›´æ¥è¿‘äºå•å…ƒæµ‹è¯•ã€‚ä»–ä¸€æ¬¡æµ‹è¯•ä¸€ä¸ªcontrollerã€‚ä½ å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿä¾èµ–æ‰‹åŠ¨æ³¨å…¥controllerï¼Œå¹¶ä¸”ä¸ä¼šæ¶‰åŠåŠ è½½Springé…ç½®ã€‚è¿™æ ·çš„æµ‹è¯•æ›´ä¸“æ³¨äºæ ·å¼ï¼Œä½¿å¾—æŸ¥çœ‹è¢«æµ‹è¯•çš„controllerï¼Œæˆ–æ˜¯ä»»ä½•æŒ‡å®šçš„Spring MVCé…ç½®æ˜¯å¦æ˜¯è¿è¡Œçš„å¿…è¦æ¡ä»¶ç­‰ç­‰æ“ä½œæ›´åŠ å®¹æ˜“ã€‚ç”¨standaloneSetupå†™ä¸´æ—¶çš„æµ‹è¯•å»éªŒè¯æŒ‡å®šçš„æ“ä½œæˆ–è€…debugä¸€ä¸ªé—®é¢˜éƒ½éå¸¸æ–¹ä¾¿ã€‚\nåƒå¤§å¤šæ•°çš„â€œé›†æˆæµ‹è¯•å’Œå•å…ƒæµ‹è¯•å¯¹æ¯”â€çš„è®¨è®ºï¼Œéƒ½æ²¡æœ‰å®Œå…¨æ­£ç¡®æˆ–è€…é”™è¯¯çš„ç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œä½¿ç”¨standaloneSetupç¡®å®ä¼šéœ€è¦ä¸€äº›é¢å¤–çš„webAppContextSetupæµ‹è¯•ï¼Œè¿™æ˜¯ä¸ºäº†éªŒè¯ä½ çš„Spring MVCé…ç½®ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠæ‰€æœ‰çš„æµ‹è¯•éƒ½ç”¨webAppContextSetupæ¥å†™ï¼Œå¯ä»¥è®©ä½ çš„æµ‹è¯•éƒ½æ˜¯åŸºäºå®é™…çš„Spring MVCé…ç½®è¿›è¡Œã€‚\né…ç½®ç‰¹å¾ ä¸ç®¡ä½¿ç”¨å“ªç§MockMvcæ„å»ºæ–¹æ³•ï¼Œæ‰€æœ‰çš„MockMvcBuilderå®ç°éƒ½æä¾›äº†ä¸€äº›å¸¸ç”¨å¹¶ä¸”éå¸¸æœ‰ç”¨çš„ç‰¹å¾ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ä¸ºæ‰€æœ‰çš„requestç”³æ˜ä¸€ä¸ªAcceptheaderå¹¶ä¸”å‡å®šæ‰€æœ‰responseçš„çŠ¶æ€éƒ½æ˜¯200å¹¶ä¸”è¿˜å¸¦ä¸€ä¸ªContent-typeheaderï¼š\n// static import of MockMvcBuilders.standaloneSetup\rMockMvc mockMvc = standaloneSetup(new MusicController())\r.defaultRequest(get(\u0026quot;/\u0026quot;).accept(MediaType.APPLICATION_JSON))\r.alwaysExpect(status().isOk())\r.alwaysExpect(content().contentType(\u0026quot;application/json;charset=UTF-8\u0026quot;))\r.build();\r æ­¤å¤–ï¼Œç¬¬ä¸‰æ–¹æ¡†æ¶ï¼ˆå’Œåº”ç”¨ï¼‰å¯ä»¥é¢„åŒ…è£…é…ç½®æŒ‡ä»¤ï¼Œå°±åƒMockMvcConfigurerä¸­çš„ä¸€æ ·ã€‚Springæ¡†æ¶ä¹Ÿæœ‰ä¸€ä¸ªç»§æ‰¿çš„å®ç°ï¼Œå¯ä»¥å¸®åŠ©ä½ åœ¨requestä¹‹é—´ä¿å­˜å’Œå¤ç”¨HTTP sessionï¼š\n// static import of SharedHttpSessionConfigurer.sharedHttpSession\rMockMvc mockMvc = MockMvcBuilders.standaloneSetup(new TestController())\r.apply(sharedHttpSession())\r.build();\r// Use mockMvc to perform requests...\r è¯¦æƒ…å‚è€ƒConfigurableMockMvcBuilder åˆ—å‡ºäº†æ‰€æœ‰MockMvc builderçš„ç‰¹å¾ã€‚\næ‰§è¡Œè¯·æ±‚ è¿™ä¸ªç« èŠ‚è®²è¿°MockMvcè‡ªèº«æ€æ ·æ‰§è¡Œè¯·æ±‚å’ŒéªŒè¯responseã€‚å¦‚æœæ˜¯é€šè¿‡WebTestClientä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰çš„ç« èŠ‚ã€‚\nä½¿ç”¨ä»»ä½•HTTPæ–¹æ³•æ‰§è¡Œè¯·æ±‚ï¼š\nmockMvc.perform(post(\u0026quot;/hotels/{id}\u0026quot;, 42).accept(MediaType.APPLICATION_JSON));\r ä½ ä¹Ÿå¯ä»¥æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨çš„æ˜¯MockMultipartHttpServletRequestï¼Œæ²¡æœ‰å®é™…è§£æä¸€ä¸ªmultipart requestï¼š\nmockMvc.perform(multipart(\u0026quot;/doc\u0026quot;).file(\u0026quot;a1\u0026quot;, \u0026quot;ABC\u0026quot;.getBytes(\u0026quot;UTF-8\u0026quot;)));\r ä½ å¯ä»¥åœ¨URIæ¨¡æ¿æ ·å¼ä¸­æŒ‡å®šè¯·æ±‚å‚æ•°ï¼š\nmockMvc.perform(get(\u0026quot;/hotels?thing={thing}\u0026quot;, \u0026quot;somewhere\u0026quot;));\r ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼å‘ˆç°å‚æ•°ï¼š\nmockMvc.perform(get(\u0026quot;/hotels\u0026quot;).param(\u0026quot;thing\u0026quot;, \u0026quot;somewhere\u0026quot;));\r å¦‚æœåº”ç”¨ä»£ç ä¾èµ–Servletè¯·æ±‚å‚æ•°ï¼Œå¹¶ä¸”æ²¡æœ‰æ¸…æ™°çš„æ£€æŸ¥è¯·æ±‚string(å¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯è¿™æ ·)ï¼Œé‚£ä¹ˆä½ é€‰æ‹©é‚£ä¸ªæ–¹æ³•éƒ½æ²¡æœ‰å…³ç³»ã€‚ä½†æ˜¯ï¼Œè¯·è®°ä½ï¼ŒURIæ¨¡æ¿æä¾›çš„è¯·æ±‚å‚æ•°æ˜¯å·²ç»è§£ç çš„ï¼Œä½†æ˜¯é€šè¿‡param(...)æä¾›çš„è¯·æ±‚å‚æ•° are expected to already be decodedã€‚\nåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ›´åå‘äºå°†context pathå’ŒServlet pathä»è¯·æ±‚URIä¸­åˆ†ç¦»ã€‚å¦‚æœä½ å¿…é¡»æµ‹è¯•ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚URIï¼Œé‚£ä¹ˆè¯·ç¡®ä¿contextPathå’ŒservletPathçš„å‡†ç¡®æ€§ï¼š\nmockMvc.perform(get(\u0026quot;/app/main/hotels/{id}\u0026quot;).contextPath(\u0026quot;/app\u0026quot;).servletPath(\u0026quot;/main\u0026quot;))\r åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœæ¯ä¸ªè¯·æ±‚éƒ½é™„å¸¦contextPathå’ŒservletPathæ˜¯ååˆ†ç¬¨é‡çš„ã€‚ç›¸å¯¹çš„ï¼Œä½ å¯ä»¥æå‰è®¾ç½®å¥½é»˜è®¤å±æ€§ï¼š\nclass MyWebTests {\rMockMvc mockMvc;\r@BeforeEach\rvoid setup() {\rmockMvc = standaloneSetup(new AccountController())\r.defaultRequest(get(\u0026quot;/\u0026quot;)\r.contextPath(\u0026quot;/app\u0026quot;).servletPath(\u0026quot;/main\u0026quot;)\r.accept(MediaType.APPLICATION_JSON)).build();\r}\r}\r ä¸Šé¢çš„å±æ€§é€šè¿‡MockMvcå½±å“æ¯ä¸€ä¸ªè¯·æ±‚æ‰§è¡Œã€‚å¦‚æœç»™å®šçš„è¯·æ±‚æŒ‡å®šäº†åŒæ ·çš„å±æ€§ï¼Œé‚£ä¹ˆå®ƒä¼šè¦†ç›–é»˜è®¤å€¼ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆé»˜è®¤è¯·æ±‚ä¸­çš„HTTPæ–¹æ³•å’ŒURIæ— å…³ç´§è¦çš„åŸå› ï¼Œå› ä¸ºä»–ä»¬éƒ½å¿…é¡»åœ¨æ¯ä¸ªè¯·æ±‚ä¸­æŒ‡å®šã€‚\nå®šä¹‰é¢„æœŸç»“æœ ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªæˆ–è€…å¤šä¸ª.andExpect(..)å®šä¹‰é¢„æœŸç»“æœï¼š\nmockMvc.perform(get(\u0026quot;/accounts/1\u0026quot;)).andExpect(status().isOk());\r MockMvcResultMatchers.*æä¾›äº†å¾ˆå¤šé¢„æœŸç»“æœï¼Œä»–ä»¬ä¸­çš„ä¸€äº›å¯ä»¥åµŒå¥—ä¸ºæ›´è¯¦æƒ…çš„ç»“æœã€‚\né¢„æœŸç»“æœå¯ä»¥åˆ’åˆ†ä¸ºä¸¤ä¸ªå¤§è‡´çš„ç§ç±»ã€‚ä¸€ä¸ªæ˜¯éªŒè¯responseçš„å±æ€§ï¼ˆæ¯”å¦‚ï¼Œresponse status,header,å’Œå†…å®¹ï¼‰ã€‚è¿™æ˜¯è¦æ–­è¨€çš„æœ€é‡è¦çš„ç»“æœå†…å®¹ã€‚\nç¬¬äºŒä¸ªæ–­è¨€çš„åˆ†ç±»è¶…å‡ºäº†responseçš„èŒƒå›´ã€‚è¿™äº›æ–­è¨€è®©ä½ æ£€æŸ¥Spring MVCæŒ‡å®šçš„åˆ‡é¢ï¼Œæ¯”å¦‚å“ªä¸ªcontrolleræ–¹æ³•å¤„ç†äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ˜¯å¦æœ‰å¼‚å¸¸å‡ºç°å¹¶è¢«å¤„ç†ï¼Œmodelçš„å…·ä½“å†…å®¹ï¼Œé‚£ä¸ªviewè¢«é€‰ä¸­ï¼Œä»€ä¹ˆflashå±æ€§è¢«æ·»åŠ ç­‰ç­‰ã€‚ä»–ä»¬ä¹Ÿèƒ½è®©ä½ æ£€æŸ¥ServletæŒ‡å®šçš„åˆ‡é¢ï¼Œæ¯”å¦‚è¯´requestå’Œsessionå±æ€§ã€‚\nä¸‹é¢çš„æµ‹è¯•æ–­è¨€äº†ç»‘å®šæˆ–è€…éªŒè¯å¤±è´¥ï¼š\nmockMvc.perform(post(\u0026quot;/persons\u0026quot;))\r.andExpect(status().isOk())\r.andExpect(model().attributeHasErrors(\u0026quot;person\u0026quot;));\r è®¸å¤šæ—¶å€™ï¼Œè½¬å­˜æ‰§è¡Œæµ‹è¯•è¯·æ±‚åçš„ç»“æœéƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä½ å¯ä»¥åƒä¸‹è¾¹è¿™æ ·åšï¼Œprint()æ˜¯ç”±MockMvcResultHandlersé™æ€å¯¼å…¥çš„ï¼š\nmockMvc.perform(post(\u0026quot;/persons\u0026quot;))\r.andDo(print())\r.andExpect(status().isOk())\r.andExpect(model().attributeHasErrors(\u0026quot;person\u0026quot;));\r åªè¦è¯·æ±‚è¿›ç¨‹ä¸ä¼šäº§ç”Ÿä¸€ä¸ªä¸èƒ½å¤„ç†çš„å¼‚å¸¸ï¼Œprint()æ–¹æ³•å°±ä¼šæ‰“å°æ‰€æœ‰å¯ç”¨çš„ç»“æœæ•°æ®åˆ°System.outä¸­ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªlog()æ–¹æ³•å’Œä¸¤ä¸ªé¢å¤–çš„print()æ–¹æ³•çš„å˜ä½“ï¼Œä¸€ä¸ªæ¥æ”¶OutputStreamï¼Œå¦å¤–ä¸€ä¸ªæ¥æ”¶Writerã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè°ƒç”¨print(System.err)æ‰“å°ç»“æœåˆ°System.errï¼Œå½“è°ƒç”¨print(myWriter)æ‰“å°ç»“æœåˆ°ä¸€ä¸ªè‡ªå®šä¹‰çš„writerã€‚å¦‚æœä½ æƒ³ç”¨logçš„å½¢å¼è€Œä¸æ˜¯printï¼Œé‚£ä¹ˆä½ å¯ä»¥è°ƒç”¨log()æ–¹æ³•ï¼Œä»–ä¼šå°†ç»“æœæ•°æ®ä½œä¸ºä¸€æ¡å•ä¸€çš„DEUBGä¿¡æ¯åœ¨org.springframework.test.web.servlet.resultloggingç›®å½•ä¸‹ã€‚\næŸäº›æƒ…å†µä½ å¯èƒ½æƒ³ç›´æ¥è·å¾—ç»“æœå¯¹è±¡è¿›è¡ŒéªŒè¯ï¼Œä½ å¯ä»¥é€šè¿‡.andReturn()ï¼Œåœ¨æ‰€æœ‰çš„expectæ–¹æ³•ä¹‹åè°ƒç”¨ï¼š\nMvcResult mvcResult = mockMvc.perform(post(\u0026quot;/persons\u0026quot;)).andExpect(status().isOk()).andReturn();\r// ...\r å¦‚æœæ‰€æœ‰çš„æµ‹è¯•éƒ½æ£€æµ‹ä¸€ä¸ªé¢„æœŸç»“æœï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨æ„å»ºMockMvcæ—¶å°±è®¾ç½®é»˜è®¤çš„é¢„æœŸç»“æœï¼š\nstandaloneSetup(new SimpleController())\r.alwaysExpect(status().isOk())\r.alwaysExpect(content().contentType(\u0026quot;application/json;charset=UTF-8\u0026quot;))\r.build()\r æ³¨æ„è¿™äº›é€šç”¨çš„é¢„æœŸç»“æœå§‹ç»ˆéƒ½æ˜¯å¯ç”¨çš„ï¼Œå¹¶ä¸”ä¸èƒ½å¤Ÿè¢«è¦†ç›–ï¼Œé™¤éåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„MockMvcå®ä¾‹ã€‚\nå½“ä¸€ä¸ªJSON responseå†…å®¹åŒ…å«ä¸€ä¸ªç”±Spring HATEOAS åˆ›å»ºçš„å¤šåª’ä½“è¿æ¥ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨JsonPathè¡¨è¾¾å¼æ¥éªŒè¯ç»“æœè¿æ¥ï¼š\nmockMvc.perform(get(\u0026quot;/people\u0026quot;).accept(MediaType.APPLICATION_JSON))\r.andExpect(jsonPath(\u0026quot;$.links[?(@.rel == 'self')].href\u0026quot;).value(\u0026quot;http://localhost:8080/people\u0026quot;));\r å½“XML responseå†…å®¹åŒ…å«ä¸€ä¸ªç”±Spring HATEOAS åˆ›å»ºçš„å¤šåª’ä½“è¿æ¥ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨XPathè¡¨è¾¾å¼éªŒè¯ç»“æœè¿æ¥ã€‚\nMap\u0026lt;String, String\u0026gt; ns = Collections.singletonMap(\u0026quot;ns\u0026quot;, \u0026quot;http://www.w3.org/2005/Atom\u0026quot;);\rmockMvc.perform(get(\u0026quot;/handle\u0026quot;).accept(MediaType.APPLICATION_XML))\r.andExpect(xpath(\u0026quot;/person/ns:link[@rel='self']/@href\u0026quot;, ns).string(\u0026quot;http://localhost:8080/people\u0026quot;));\r å¼‚æ­¥è¯·æ±‚ è¿™ä¸ªç« èŠ‚å±•ç¤ºæ€æ ·ä½¿ç”¨MockMvcè¿›è¡Œå¼‚æ­¥è¯·æ±‚å¤„ç†ã€‚å¦‚æœé€šè¿‡WebTestClientä½¿ç”¨MockMvcï¼Œé‚£ä¹ˆæ˜¯ä¸éœ€è¦ç‰¹åˆ«å¤„ç†çš„ï¼Œå› ä¸ºé»˜è®¤å°±æ˜¯å¼‚æ­¥è¯·æ±‚ã€‚\nSpring MVCæ”¯æŒServlet 3.0 å¼‚æ­¥è¯·æ±‚ ï¼Œæ˜¯é€šè¿‡é€€å‡ºServletå®¹å™¨çº¿ç¨‹ï¼Œå¹¶å…è®¸åº”ç”¨å¼‚æ­¥è®¡ç®—responseï¼Œç„¶åé€šè¿‡å¼‚æ­¥è°ƒåº¦å»å®Œæˆå¯¹Servletå®¹å™¨çº¿ç¨‹çš„å¤„ç†ã€‚\nåœ¨Spring MVCæµ‹è¯•ä¸­ï¼Œå¼‚æ­¥è¯·æ±‚å¯ä»¥é€šè¿‡å…ˆæ–­è¨€äº§ç”Ÿçš„å¼‚æ­¥valueå¼€å§‹ï¼Œç„¶åæ‰‹åŠ¨æ‰§è¡Œå¼‚æ­¥è°ƒåº¦ï¼Œå¹¶ä¸”æœ€ç»ˆéªŒè¯responseã€‚ä¸‹é¢çš„ä¾‹å­æµ‹è¯•çš„controlleræ–¹æ³•è¿”å›çš„deferredResultï¼ŒCallableï¼Œæˆ–è€…äº¤äº’ç±»å‹æ¯”å¦‚ReactorMonoï¼š\n@Test\rvoid test() throws Exception {\rMvcResult mvcResult = this.mockMvc.perform(get(\u0026quot;/path\u0026quot;))\r//æ£€æµ‹responseçŠ¶æ€æ˜¯ä»ç„¶æœªæ”¹å˜çš„\r.andExpect(status().isOk()) //å¼‚æ­¥å¤„ç†å¿…é¡»æœ‰ä¸€ä¸ªstarted\r.andExpect(request().asyncStarted())\r//ç­‰å¾…å¹¶æ–­è¨€å¼‚æ­¥ç»“æœ\r.andExpect(request().asyncResult(\u0026quot;body\u0026quot;)) .andReturn();\r//æ‰‹åŠ¨æ‰§è¡Œå¼‚æ­¥è°ƒåº¦ï¼ˆå› ä¸ºæ²¡æœ‰è¿è¡Œçš„å®¹å™¨ï¼‰\rthis.mockMvc.perform(asyncDispatch(mvcResult))\r//éªŒè¯æœ€ç»ˆresponse .andExpect(status().isOk()) .andExpect(content().string(\u0026quot;body\u0026quot;));\r}\r Streaming Response åœ¨Spring MVCæµ‹è¯•ä¸­æ˜¯æœ‰æ²¡æœ‰é€‰é¡¹å»æµ‹è¯•æ— å®¹å™¨çš„è¿”å›æµçš„ã€‚ä½†æ˜¯ä½ å¯ä»¥é€šè¿‡WebTestClientè¯·æ±‚å»æµ‹è¯•æµã€‚åœ¨Spring Bootä¸­ä½ å¯ä»¥æµ‹è¯•ä¸€ä¸ªè¿è¡Œçš„æœåŠ¡ é€šè¿‡WebTestClientã€‚å¦å¤–ä¸€ä¸ªä¼˜åŠ¿æ˜¯ä»–æœ‰èƒ½åŠ›ä½¿ç”¨æ¥è‡ªé¡¹ç›®Reactorçš„StepVerifierï¼Œå¯ä»¥å…è®¸åœ¨æµæ•°æ®ä¸Šç”³æ˜é¢„æœŸç»“æœã€‚\nè¿‡æ»¤å™¨æ³¨å†Œ å½“é…ç½®ä¸€ä¸ªMockMvcå®ä¾‹æ—¶ï¼Œä½ å¯ä»¥æ³¨å†Œä¸€ä¸ªæˆ–è€…å¤šä¸ªServletFilterå®ä¾‹ï¼š\nmockMvc = standaloneSetup(new PersonController()).addFilters(new CharacterEncodingFilter()).build();\r æ³¨å†Œçš„è¿‡æ»¤å™¨æ˜¯é€šè¿‡æ¥è‡ªspring-testçš„MockFilterChainæ¥è°ƒç”¨çš„ï¼Œå¹¶ä¸”æœ€åä¸€ä¸ªè¿‡æ»¤å™¨å§”æ‰˜ç»™äº†DispacherServletã€‚\næ›´å¤šä»£ç å®ä¾‹ MockMvc ï¼ŒWebTestClient\n8. æµ‹è¯•å®¢æˆ·ç«¯åº”ç”¨ ä½ å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯æµ‹è¯•ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨çš„æ˜¯RestTemplateã€‚è¿™ä¸ªé€»è¾‘æ˜¯ç”³æ˜æœŸå¾…çš„è¯·æ±‚å’Œæä¾›\u0026quot;stub\u0026quot;responseï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨ä¸è¿è¡ŒæœåŠ¡çš„æƒ…å†µä¸‹æ£€æµ‹ä»£ç ã€‚\nRestTemplate restTemplate = new RestTemplate();\rMockRestServiceServer mockServer = MockRestServiceServer.bindTo(restTemplate).build();\rmockServer.expect(requestTo(\u0026quot;/greeting\u0026quot;)).andRespond(withSuccess());\r// Test code that uses the above RestTemplate ...\rmockServer.verify();\r åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­ï¼ŒMockRestServiceServerï¼ˆå®¢æˆ·ç«¯RESTæµ‹è¯•çš„æ ¸å¿ƒç±»ï¼‰ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ClientHttpRequestFactoryé…ç½®äº†RestTemplateï¼Œå¹¶æ–­è¨€äº†ä¸€ä¸ªé¢„æœŸçš„çœŸå®è¯·æ±‚å’Œè¿”å›\u0026quot;stub\u0026quot;responseã€‚åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æœŸå¾…ä¸€ä¸ªåˆ°/greetingçš„è¯·æ±‚ï¼Œå¹¶ä¸”å¸Œæœ›è¿”å›ä¸€ä¸ª200 responseï¼Œå¹¶å¸¦ç€text/plainå†…å®¹ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦å®šä¹‰å…¶ä»–çš„è¯·æ±‚å’Œstub responseã€‚å½“æˆ‘ä»¬å®šä¹‰æœŸå¾…çš„requestå’Œstub responseæ—¶ï¼ŒrestTemplateå¯ä»¥ç…§å¸¸åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ä½¿ç”¨ã€‚åœ¨æµ‹è¯•ç»“æŸæ—¶ï¼ŒmockServer.verify()å¯ä»¥ç”¨æ¥éªŒè¯æ‰€æœ‰çš„æœŸæœ›ç»“æœæ˜¯å¦éƒ½è¢«æ»¡è¶³äº†ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œè¯·æ±‚åº”æŒ‰ç…§expectç”³æ˜æœŸæœ›çš„é¡ºåºæ‰§è¡Œã€‚å½“æ„å»ºæœåŠ¡æ—¶ä½ å¯ä»¥è®¾ç½®ignoreExpectOrderé€‰é¡¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¼šæ£€æµ‹æ‰€æœ‰çš„expectä»¥æ‰¾åˆ°ä¸€ä¸ªè·Ÿç»™å®šrequeståŒ¹é…ã€‚è¿™æ„å‘³ç€è¯·æ±‚å¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿›å…¥ï¼š\nserver = MockRestServiceServer.bindTo(restTemplate).ignoreExpectOrder(true).build();\r å³ä½¿æ”¹ä¸ºæ— åºè¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚ä¹Ÿåªå…è®¸è¿è¡Œä¸€æ¬¡ã€‚expectæ–¹æ³•æä¾›ä¸€ä¸ªé‡è½½å˜ä½“ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ªExpectedCountå‚æ•°ä»¥æŒ‡å®šä¸€ä¸ªæ•°é‡èŒƒå›´ï¼ˆæ¯”å¦‚è¯´ï¼Œä¸€æ¬¡ï¼Œå¤šæ¬¡ï¼Œmax,min,between,ç­‰ç­‰ï¼‰ã€‚ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨äº†timesï¼š\nRestTemplate restTemplate = new RestTemplate();\rMockRestServiceServer mockServer = MockRestServiceServer.bindTo(restTemplate).build();\rmockServer.expect(times(2), requestTo(\u0026quot;/something\u0026quot;)).andRespond(withSuccess());\rmockServer.expect(times(3), requestTo(\u0026quot;/somewhere\u0026quot;)).andRespond(withSuccess());\r// ...\rmockServer.verify();\r æ³¨æ„ï¼Œå½“ignoreExpectOrderæ²¡æœ‰è®¾ç½®çš„æ—¶å€™ï¼ˆé»˜è®¤æƒ…å†µï¼‰ï¼Œè¯·æ±‚ä¼šæŒ‰ç…§expectç”³æ˜æœŸæœ›çš„é¡ºåºï¼Œå¹¶ä¸”è¿™ä¸ªé¡ºåºåªä¼šå¯¹ç¬¬ä¸€æ¬¡å‡ºç°çš„æœŸæœ›è¯·æ±‚æœ‰æ•ˆã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœ/somethingæœŸå¾…å‡ºç°ä¸¤æ¬¡æ¥ä¸‹æ¥æ˜¯ä¸‰æ¬¡/somewhereï¼Œè¿™é‡Œåº”è¯¥æœ‰ä¸€ä¸ª/somethingè¯·æ±‚æ˜¯åœ¨/somewhereè¯·æ±‚ä¹‹å‰çš„ï¼Œä½†æ˜¯å‰©ä¸‹çš„è¯·æ±‚å¯ä»¥åœ¨ä»»ä½•æ—¶é—´è¿›å…¥ã€‚\nå¯¹äºä¸Šé¢çš„æ‰€æœ‰å†…å®¹ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªå®ç°æ–¹å¼ï¼Œå®¢æˆ·ç«¯çš„æµ‹è¯•æ”¯æŒä¹Ÿæä¾›äº†ä¸€ä¸ªClientHttpRequestFactoryå®ç°ï¼Œä½ å¯ä»¥é…ç½®åˆ°ä¸€ä¸ªRestTemplateä¸­å»å°†å®ƒç»‘å®šåˆ°MockMvcå®ä¾‹ä¸Šã€‚å®ƒå…è®¸ä½ ä½¿ç”¨æœåŠ¡ç«¯çš„é€»è¾‘å¤„ç†è¯·æ±‚å¹¶ä¸”ä¸éœ€è¦è¿è¡Œä¸€ä¸ªæœåŠ¡ï¼š\nMockMvc mockMvc = MockMvcBuilders.webAppContextSetup(this.wac).build();\rthis.restTemplate = new RestTemplate(new MockMvcClientHttpRequestFactory(mockMvc));\r// Test code that uses the above RestTemplate ...\r 8.1. é™æ€å¯¼å…¥ ä½œä¸ºæœåŠ¡ç«¯çš„æµ‹è¯•ï¼Œè¦æµç•…æµ‹è¯•å®¢æˆ·ç«¯éœ€è¦ä¸€äº›é™æ€å¯¼å…¥ã€‚åªè¦æœç´¢MockRest*å³å¯ã€‚\n8.2. æ›´å¤šä»£ç å®ä¾‹ Client-side test\n","id":126,"section":"posts","summary":"1. æ¦‚è§ˆ ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬è¦æµ‹è¯•é¡¹ç›®æˆ–è€…å¹³å°çš„æŸä¸ªåŠŸèƒ½ï¼Œå…ˆè¦éƒ¨ç½²å¯åŠ¨åº”ç”¨æ‰èƒ½è¿›è¡Œï¼Œå¦‚æœåœ¨ä¸å¯åŠ¨åº”ç”¨æˆ–è€…è¿æ¥å…¶ä»–ä¼ä¸šçº§å¹³å°çš„æƒ…å†µä¸‹ï¼Œå°±èƒ½åšç›¸åº”çš„é›†æˆ","tags":["spring","unit-test","junit4","junit5","testng","mockmvc"],"title":"Springé›†æˆæµ‹è¯•","uri":"https://www.mingaccount.com/2017/09/spring-test/","year":"2017"},{"content":"vi run.sh\r# æŸ¥çœ‹å½“å‰è„šæœ¬æ ¼å¼ï¼Œå¦‚æœç»“æœæ˜¯:fileformat=dosï¼Œåˆ™éœ€è¦æ”¹ä¸ºunix\r:set ff\r# æ›´æ”¹è„šæœ¬æ ¼å¼ä¸ºunix\r:set ff=unix\r ","id":127,"section":"posts","summary":"vi run.sh # æŸ¥çœ‹å½“å‰è„šæœ¬æ ¼å¼ï¼Œå¦‚æœç»“æœæ˜¯:fileformat=dosï¼Œåˆ™éœ€è¦æ”¹ä¸ºunix :set ff # æ›´æ”¹è„šæœ¬æ ¼å¼ä¸ºunix :set ff=unix","tags":["linux"],"title":"linux shæ–‡ä»¶è¿è¡Œå¼‚å¸¸ï¼Œå‡ºç°å¼‚å¸¸æ–‡ä»¶ç»“å°¾æˆ–è€…ä¹±ç å­—ç¬¦","uri":"https://www.mingaccount.com/2017/09/linux-sh-exception/","year":"2017"},{"content":" QPSï¼šQuery Per Second TPSï¼šTransaction Per Second PVï¼šPage View RTï¼šResponse Time UVï¼šUnique Visitor DAUï¼šDaily Actived Users MAUï¼šMonthly Actived Users IaaS: Infrastructure as a service PaaS: Platform as a service SaaS: Software as a service LXC: Linux Containers CI/CD: Continuous Integration (CI) and Continuous Deployment or Continuous Delivery (CD)  ","id":128,"section":"posts","summary":"QPSï¼šQuery Per Second TPSï¼šTransaction Per Second PVï¼šPage View RTï¼šResponse Time UVï¼šUnique Visitor DAUï¼šDaily Actived Users M","tags":["website build"],"title":"QPSã€TPSã€PVç­‰ç½‘ç«™ä¸šåŠ¡å…³é”®å­—é‡Šä¹‰","uri":"https://www.mingaccount.com/2017/09/qps-tps-pv-andsoon/","year":"2017"},{"content":"å®Œå…¨å¤„ç†åçš„controller @RestController\rpublic class TestController{\r@GetMapping\r@UnknownExceptionHandler(msg = \u0026quot;test1 exception\u0026quot;, baseException = TestException.class)\rpublic String test(String arg) {\rif(StringUtils.isEmpty(arg)){\rthrow new TestException(\u0026quot;å‚æ•°argä¸èƒ½ä¸ºç©º\u0026quot;);\r}\rreturn \u0026quot;test\u0026quot;;\r}\r@PostMapping\r@UnknownExceptionHandler(msg = \u0026quot;test2 exception\u0026quot;, baseException = TestException.class)\rpublic Map\u0026lt;String, String\u0026gt; test2(String arg) {\r//...\rreturn map;\r}\r@GetMapping\r@UnknownExceptionHandler( baseException = TestException.class)\rpublic void test3(String arg) {\r//... }\r}\r ç»Ÿä¸€å¤„ç†è¿”å›ç»“æœå’Œä¸šåŠ¡å¼‚å¸¸åï¼Œä¸éœ€è¦åœ¨controllerå†™try/catchæ•è·æœªçŸ¥å¼‚å¸¸ï¼Œé€šè¿‡@UnknownExceptionHandlerç›´æ¥å°†æœªçŸ¥å¼‚å¸¸åŒ…è£…ä¸ºåŒ…å«æç¤ºä¿¡æ¯çš„æŒ‡å®šä¸šåŠ¡å¼‚å¸¸ï¼›åŒæ—¶controllerçš„è¿”å›å€¼ä¹Ÿä¸éœ€è¦å»æ‰‹åŠ¨åŒ…è£…ï¼Œç›´æ¥è¿”å›å³å¯ã€‚\nä¸ç®¡å¼‚å¸¸è¿˜æ˜¯æ­£å¸¸ç»“æœï¼Œéƒ½ç»Ÿä¸€åŒ…è£…ä¸ºä¸‹è¾¹çš„æ ¼å¼ï¼š\n{\r\u0026quot;code\u0026quot;: 1000,\r\u0026quot;msg\u0026quot;: \u0026quot;success\u0026quot;,\r\u0026quot;data\u0026quot;: {\u0026quot;id\u0026quot;: \u0026quot;...\u0026quot;,\u0026quot;name\u0026quot;: \u0026quot;...\u0026quot;...}\r}\r ç»Ÿä¸€Exceptionå¤„ç†å’Œç»“æœå¤„ç† @RestControllerAdvice\r@Slf4j\rpublic class CustomResponseBodyAdvice implements ResponseBodyAdvice\u0026lt;Object\u0026gt; {\rprivate static final Class\u0026lt;? extends Annotation\u0026gt; ANNOTATION_TYPE = RequestMapping.class;\r/**\r* ç›®æ ‡è¿”å›å€¼åŒ…è£…æ–¹æ³•æ˜¯å…ƒæ³¨è§£ä¸­æœ‰@RequestMappingçš„æ–¹æ³•\r*/\r@Override\rpublic boolean supports(MethodParameter methodParameter, Class\u0026lt;? extends HttpMessageConverter\u0026lt;?\u0026gt;\u0026gt; aClass) {\rreturn AnnotatedElementUtils.hasMetaAnnotationTypes(methodParameter.getMethod(),ANNOTATION_TYPE);\r}\r/**\r* åŒ…è£…controlleræ–¹æ³•çš„è¿”å›ç»“æœ\r* @param o\r* @param methodParameter\r* @param mediaType\r* @param aClass\r* @param serverHttpRequest\r* @param serverHttpResponse\r* @return\r*/\r@Override\rpublic Object beforeBodyWrite(Object o, MethodParameter methodParameter, MediaType mediaType, Class\u0026lt;? extends HttpMessageConverter\u0026lt;?\u0026gt;\u0026gt; aClass, ServerHttpRequest serverHttpRequest, ServerHttpResponse serverHttpResponse) {\rif (o instanceof ResultEntity) {\rreturn o;\r}\rreturn ResultEntity.builder().code(ResponseInfoEnum.SUCCESS.getCode()).msg(ResponseInfoEnum.SUCCESS.getMessage()).data(o).build();\r}\r/**\r* å·²çŸ¥å¼‚å¸¸å¤„ç†\r* @param baseException è‡ªå®šä¹‰å¼‚å¸¸çˆ¶ç±»\r* @return å¼‚å¸¸ç»“æœåŒ…è£…\r*/\r@ExceptionHandler(value = BaseException.class)\rpublic ResultEntity baseExceptionHandler(BaseException baseException) {\rlog.error(baseException.getMessage(), baseException);\rreturn baseException.getResultEntity();\r}\r/**\r* æœªçŸ¥å¼‚å¸¸å¤„ç†\r* @param e æœªçŸ¥å¼‚å¸¸\r* @return å¼‚å¸¸ç»“æœåŒ…è£…\r*/\r@ExceptionHandler(value = Exception.class)\rpublic ResultEntity unknownExceptionHandler(Exception e) {\rlog.error(e.getMessage(), e);\rreturn new BaseException() {\r@Override\rprotected ResponseInfoEnum getInfoEnum() {\rreturn ResponseInfoEnum.UNKNOWN_EXCEPTION;\r}\r}.getResultEntity();\r}\r}\r å¼‚å¸¸çˆ¶ç±» public abstract class BaseException extends RuntimeException {\r/**\r* ç»™å‰ç«¯å±•ç¤ºçš„ä¿¡æ¯\r*/\rprivate String viewMessage;\rpublic BaseException(){\rsuper();\r}\rpublic BaseException(String message) {\rsuper(message);\rviewMessage = message;\r}\rpublic BaseException(String message, Throwable cause) {\rsuper(message, cause);\rviewMessage = message;\r}\rpublic BaseException(Throwable cause) {\rsuper(cause);\r}\rpublic BaseException(String message, Throwable cause, boolean enableSuppression, boolean writableStackTrace) {\rsuper(message, cause, enableSuppression, writableStackTrace);\rviewMessage = message;\r}\rpublic ResultEntity getResultEntity() {\rResultEntity resultEntity = new ResultEntity();\rresultEntity.setData(null);\rresultEntity.setCode(getInfoEnum().getCode());\rresultEntity.setMsg(viewMessage == null ? getInfoEnum().getMessage() : viewMessage);\rreturn resultEntity;\r}\r/**\r* è·å–{@link ResponseInfoEnum}\r* @return\r*/\rprotected abstract ResponseInfoEnum getInfoEnum();\r}\r æµ‹è¯•å¼‚å¸¸å­ç±» public class TestException extends BaseException {\rprivate final ResponseInfoEnum responseInfoEnum = ResponseInfoEnum.TEST_EXCEPTION;\rpublic TestException() {\rsuper();\r}\rpublic TestException(String message) {\rsuper(message);\r}\rpublic TestException(String message, Throwable cause) {\rsuper(message, cause);\r}\rpublic TestException(Throwable cause) {\rsuper(cause);\r}\rpublic TestException(String message, Throwable cause, boolean enableSuppression, boolean writableStackTrace) {\rsuper(message, cause, enableSuppression, writableStackTrace);\r}\r@Override\rprotected ResponseInfoEnum getInfoEnum() {\rreturn responseInfoEnum;\r}\r}\r å¼‚å¸¸ä¿¡æ¯æšä¸¾ public enum ResponseInfoEnum {\rTEST_EXCEPTION(1001,\u0026quot;æµ‹è¯•å¼‚å¸¸\u0026quot;);\r//å¼‚å¸¸ç \rprivate int code;\r//å¼‚å¸¸ä¿¡æ¯\rprivate String msg;\rResponseInfoEnum(int code, String msg) {\rthis.code = code;\rthis.msg = msg;\r}\rpublic int getCode() {\rreturn code;\r}\rpublic String getMessage() {\rreturn msg;\r}\rpublic void setMsg(String msg) {\rthis.msg = msg;\r}\r}\r ç»Ÿä¸€è¿”å›å¯¹è±¡ @Data\r@NoArgsConstructor\r@AllArgsConstructor\r@Builder\rpublic class ResultEntity\u0026lt;T\u0026gt; {\rprivate int code;\rprivate String msg;\rprivate T data;\r}\r @UnknownExceptionHandleråˆ‡é¢ æ³¨è§£å®šä¹‰ï¼š\n@Retention(RetentionPolicy.RUNTIME)\r@Target(ElementType.METHOD)\rpublic @interface UnknownExceptionHandler {\rString msg() default \u0026quot;\u0026quot;;\rClass\u0026lt;? extends BaseException\u0026gt; baseException();\r}\r åˆ‡é¢ä»£ç ï¼š\n@Aspect\r@Component\rpublic class UnknownExceptionAdvice {\r@Pointcut(\u0026quot;within(com.ming.dictionary..*)\u0026quot;)\rpublic void withinPackage() {}\r/**\r* é€šè¿‡æ³¨è§£{@link UnknownExceptionHandler}æ”¯æŒçš„æœªçŸ¥å¼‚å¸¸å¤„ç†\r* å¦‚æœé¡¹ç›®åŸºç¡€å¼‚å¸¸{@link BaseException}çš„å­ç±»ï¼Œç›´æ¥æŠ›å‡º\r* å¦‚æœæ˜¯æœªçŸ¥å¼‚å¸¸ï¼Œåˆ™éœ€è¦è·å–{@link UnknownExceptionHandler}æ³¨è§£çš„å¼‚å¸¸ä¿¡æ¯\r* @param ex æ–¹æ³•æœ¬æ¥æŠ›å‡ºçš„å¼‚å¸¸\r* @param unknownExceptionHandler ç›®æ ‡æ–¹æ³•çš„æ³¨è§£\r* @throws Throwable æŠ›å‡ºåŸæœ¬å¼‚å¸¸æˆ–è€…åŒ…è£…å¼‚å¸¸\r*/\r@AfterThrowing(pointcut = \u0026quot;@annotation(unknownExceptionHandler)\u0026quot; +\r\u0026quot;\u0026amp;\u0026amp; withinPackage() \u0026quot;\r, throwing = \u0026quot;ex\u0026quot;\r, argNames = \u0026quot;ex,unknownExceptionHandler\u0026quot;\r)\rpublic void unknownExceptionHandler(Throwable ex, UnknownExceptionHandler unknownExceptionHandler) throws Throwable {\rif (ex instanceof BaseException) {\rthrow ex;\r}else{\rBaseException baseException;\rtry {\rString msg = unknownExceptionHandler.msg();\rif(StringUtils.isNotEmpty(msg)) {\rbaseException = unknownExceptionHandler.baseException().getConstructor(String.class,Throwable.class).newInstance(msg,ex);\r}else{\rbaseException = unknownExceptionHandler.baseException().getConstructor(Throwable.class).newInstance(ex);\r}\r} catch (Exception e) {\rthrow new BaseException() {\r@Override\rprotected ResponseInfoEnum getInfoEnum() {\rreturn ResponseInfoEnum.UNKNOWN_EXCEPTION;\r}\r};\r}\rthrow baseException;\r}\r}\r}\r ","id":129,"section":"posts","summary":"å®Œå…¨å¤„ç†åçš„controller @RestController public class TestController{ @GetMapping @UnknownExceptionHandler(msg = \u0026quot;test1 exception\u0026quot;, baseException = TestException.class) public String test(String arg) { if(StringUtils.isEmpty(arg)){ throw new TestException(\u0026quot;å‚æ•°argä¸èƒ½ä¸ºç©º\u0026quot","tags":["java","spring"],"title":"ç»Ÿä¸€ç»“æœå¤„ç†å’Œä¸šåŠ¡å¼‚å¸¸åŒ…è£…","uri":"https://www.mingaccount.com/2017/08/exception-and-result-handler/","year":"2017"},{"content":"objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\r ","id":130,"section":"posts","summary":"objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);","tags":["jackson"],"title":"Jacksonååºåˆ—åŒ–çš„æ—¶å€™å¿½ç•¥å®ä½“ä¸­ä¸å­˜åœ¨çš„å…ƒç´ ","uri":"https://www.mingaccount.com/2017/08/jackson-deserialize-ignore-absence-element/","year":"2017"},{"content":"ç®€ä»‹ maven profileæ’ä»¶å¯ä»¥æ ¹æ®ç¯å¢ƒå‚æ•°ï¼Œç³»ç»Ÿosï¼Œæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå’ŒJDKç‰ˆæœ¬ç­‰æ¡ä»¶å†³å®šæ˜¯å¦æ¿€æ´»é…ç½®ã€‚æ¿€æ´»çš„é…ç½®å¯ä»¥æ˜¯ç¯å¢ƒå‚æ•°çš„èµ‹å€¼ï¼Œå¯¹åº”ç‰ˆæœ¬çš„ä¾èµ–ï¼Œéƒ¨åˆ†pomæ ‡ç­¾çš„æ›¿æ¢æˆ–è€…æ˜¯æ•´ä¸ªpomçš„æ›¿æ¢ã€‚\n è¯¦æƒ…å‚è€ƒmaven profile\n å®ä¾‹ ä¸‹é¢çš„ä¾‹å­æ˜¯é€šè¿‡profileå¯¹ä¸åŒç¯å¢ƒçš„é…ç½®æ–‡ä»¶è¿›è¡Œç­›é€‰ï¼Œé¦–å…ˆæ˜¯æ–‡ä»¶ç»“æ„ï¼š\n-src.main.resources\r-env\r-dev.properties\r-test.properties\r-prod.properties\r-application.properties\r application.properties spring.datasource.username=@datasource.username@\rspring.datasource.password=@datasource.password@\r å¯ä»¥çœ‹åˆ°æ–‡ä»¶ä¸­åªåŒ…å«äº†æ•°æ®åº“çš„ç”¨æˆ·åå¯†ç ï¼Œæ ¹æ®ç¯å¢ƒçš„ä¸åŒï¼Œå¯¹åº”çš„æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç ä¸åŒã€‚\nè¿™é‡Œç”¨äº†Spring-bootæ¡†æ¶ï¼Œå‚æ•°çš„å¼•ç”¨éœ€è¦ç”¨@åŒ…è£¹ï¼Œå¦‚æœæ˜¯ymlæ–‡ä»¶ï¼Œé™¤äº†@è¿˜éœ€è¦æŠŠæ•´ä¸ªå¼•ç”¨ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œæ¯”å¦‚ï¼š\u0026quot;@datasource.password@\u0026quot;\nenv/*.properties datasource.username=dev\rdatasource.password=123\r envä¸‹æ¯ä¸ªç¯å¢ƒå¯¹åº”çš„propertiesæ–‡ä»¶ï¼Œéƒ½å¯¹datasource.usernameå’Œdatasource.passwordæœ‰æ˜ç¡®èµ‹å€¼ã€‚ä¸‹ä¸€æ­¥å°±æ˜¯è¦å°†è¿™äº›æ–‡ä»¶è·Ÿç¯å¢ƒå˜é‡ç›¸å…³è”ã€‚\npom.xml \u0026lt;project xmlns=\u0026quot;http://maven.apache.org/POM/4.0.0\u0026quot;\u0026gt;\r...\r\u0026lt;profiles\u0026gt;\r\u0026lt;profile\u0026gt;\r\u0026lt;id\u0026gt;dev\u0026lt;/id\u0026gt;\r\u0026lt;activation\u0026gt;\r\u0026lt;activeByDefault\u0026gt;true\u0026lt;/activeByDefault\u0026gt;\r\u0026lt;/activation\u0026gt;\r\u0026lt;properties\u0026gt;\r\u0026lt;env\u0026gt;dev\u0026lt;/env\u0026gt;\r\u0026lt;/properties\u0026gt;\r\u0026lt;/profile\u0026gt;\r\u0026lt;profile\u0026gt;\r\u0026lt;id\u0026gt;test\u0026lt;/id\u0026gt;\r\u0026lt;properties\u0026gt;\r\u0026lt;env\u0026gt;test\u0026lt;/env\u0026gt;\r\u0026lt;/properties\u0026gt;\r\u0026lt;/profile\u0026gt;\r\u0026lt;profile\u0026gt;\r\u0026lt;id\u0026gt;prod\u0026lt;/id\u0026gt;\r\u0026lt;properties\u0026gt;\r\u0026lt;env\u0026gt;prod\u0026lt;/env\u0026gt;\r\u0026lt;/properties\u0026gt;\r\u0026lt;/profile\u0026gt;\r\u0026lt;/profiles\u0026gt;\r\u0026lt;build\u0026gt;\r\u0026lt;!-- filtersç”¨äºå°†ç¯å¢ƒæ–‡ä»¶çš„å‚æ•°å¯¼å…¥åˆ°pomä¸­ï¼Œè®©pomå¯ä»¥é€šè¿‡${}æ–¹å¼è°ƒç”¨æ–‡ä»¶ä¸­çš„å±æ€§ --\u0026gt;\r\u0026lt;filters\u0026gt;\r\u0026lt;filter\u0026gt;src/main/resources/env/${env}.properties\u0026lt;/filter\u0026gt;\r\u0026lt;/filters\u0026gt;\r\u0026lt;/build\u0026gt;\r\u0026lt;!-- resourcesè®©æŒ‡å®šç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶å¯ä»¥é€šè¿‡${}æ–¹å¼è®¿é—®pomä¸­çš„å±æ€§å€¼(spring bootç”¨@åŒ…å›´) --\u0026gt;\r\u0026lt;resources\u0026gt;\r\u0026lt;resource\u0026gt;\r\u0026lt;directory\u0026gt;src/main/resources\u0026lt;/directory\u0026gt;\r\u0026lt;filtering\u0026gt;true\u0026lt;/filtering\u0026gt;\r\u0026lt;includes\u0026gt;\r\u0026lt;include\u0026gt;*.properties\u0026lt;/include\u0026gt;\r\u0026lt;/includes\u0026gt;\r\u0026lt;/resource\u0026gt;\r\u0026lt;/resources\u0026gt;\r\u0026lt;/project\u0026gt;\r ä¸Šé¢çš„é…ç½®ç¼ºä¸€ä¸å¯ã€‚åœ¨profilesä¸­ï¼Œdevæ˜¯é»˜è®¤æ¿€æ´»çš„ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªprofileæ²¡æœ‰é»˜è®¤è§¦å‘æ¡ä»¶ï¼Œåªæœ‰é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ç›´æ¥æ¿€æ´»ã€‚\n# æ›¿æ¢æµ‹è¯•ç¯å¢ƒé…ç½®\rmvn clean verify -Ptest\r# æ›¿æ¢ç”Ÿäº§ç¯å¢ƒé…ç½®\rmvn clean verify -Pprod\r # æ›¿æ¢æµ‹è¯•ç¯å¢ƒé…ç½®\rmvn clean verify -Denv=test\r# æ›¿æ¢ç”Ÿäº§ç¯å¢ƒé…ç½®\rmvn clean verify -Denv=prod\r ä¸Šé¢ä¸¤ç§æ–¹å¼è¾¾åˆ°çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡ä¸€ä¸ªæ˜¯é€šè¿‡profileè§¦å‘çš„ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ç›´æ¥ç»™envå˜é‡èµ‹å€¼è§¦å‘çš„\n","id":131,"section":"posts","summary":"ç®€ä»‹ maven profileæ’ä»¶å¯ä»¥æ ¹æ®ç¯å¢ƒå‚æ•°ï¼Œç³»ç»Ÿosï¼Œæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå’ŒJDKç‰ˆæœ¬ç­‰æ¡ä»¶å†³å®šæ˜¯å¦æ¿€æ´»é…ç½®ã€‚æ¿€æ´»çš„é…ç½®å¯ä»¥æ˜¯ç¯å¢ƒå‚æ•°çš„èµ‹å€¼ï¼Œå¯¹åº”ç‰ˆ","tags":["maven"],"title":"maven profile","uri":"https://www.mingaccount.com/2017/08/maven-profile/","year":"2017"},{"content":"è·Ÿå‚æ•°lower_case_table_namesç›¸å…³\næ‰§è¡Œè¯­å¥ï¼ŒæŸ¥è¯¢è¯¥å‚æ•°å€¼\nSHOW VARIABLES LIKE â€˜%case%â€™\r lower_case_table_nameså‚æ•°å€¼ä¸º0ä»£è¡¨å¤§å°å†™æ•æ„Ÿ\néœ€è¦å°†lower_case_table_namesçš„å€¼æ”¹ä¸º1\nç¼–è¾‘/etcä¸‹çš„my.cnfæ–‡ä»¶ï¼Œå¯èƒ½åœ¨æ ¹ç›®å½•ä¸‹ï¼Œæˆ–è€…åœ¨mysqlç›®å½•ä¸‹\næ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œç„¶åé‡å¯mysql\n[mysqld]\rlower_case_table_names=1\r ","id":132,"section":"posts","summary":"è·Ÿå‚æ•°lower_case_table_namesç›¸å…³ æ‰§è¡Œè¯­å¥ï¼ŒæŸ¥è¯¢è¯¥å‚æ•°å€¼ SHOW VARIABLES LIKE â€˜%case%â€™ lower_case_table_name","tags":["mysql"],"title":"Mysqlè¡¨åå¿½ç•¥å¤§å°å†™","uri":"https://www.mingaccount.com/2017/08/mysql-table-name-case-insensitive/","year":"2017"},{"content":"è¯·æ±‚å¤´æšä¸¾ç±»  public enum HttpHeader {\rAUTHORIZATION(\u0026quot;Authorization\u0026quot;),\rAUTHENTICATION_TYPE_BASIC(\u0026quot;Basic\u0026quot;),\rX_AUTH_TOKEN(\u0026quot;X-AUTH-TOKEN\u0026quot;),\rWWW_Authenticate(\u0026quot;WWW-Authenticate\u0026quot;),\rX_FORWARDED_FOR(\u0026quot;X-Forwarded-For\u0026quot;),\rPROXY_CLIENT_IP(\u0026quot;Proxy-Client-IP\u0026quot;),\rWL_PROXY_CLIENT_IP(\u0026quot;WL-Proxy-Client-IP\u0026quot;),\rHTTP_CLIENT_IP(\u0026quot;HTTP_CLIENT_IP\u0026quot;),\rHTTP_X_FORWARDED_FOR(\u0026quot;HTTP_X_FORWARDED_FOR\u0026quot;);\rprivate String key;\rprivate HttpHeader(String key) {\rthis.key = key;\r}\rpublic String key() {\rreturn this.key;\r}\r}\r å·¥å…·ç±»  public class RemoteIpHelper {\rprivate static final String UNKNOWN = \u0026quot;unknown\u0026quot;;\rpublic static String getRemoteIpFrom(HttpServletRequest request) {\rString ip = null;\rint tryCount = 1;\rwhile (!isIpFound(ip) \u0026amp;\u0026amp; tryCount \u0026lt;= 6) {\rswitch (tryCount) {\rcase 1:\rip = request.getHeader(X_FORWARDED_FOR.key());\r//get first ip\rif (ip != null \u0026amp;\u0026amp; ip.indexOf(\u0026quot;,\u0026quot;) != -1) {\rip = ip.substring(0, ip.indexOf(\u0026quot;,\u0026quot;));\r}\rbreak;\rcase 2:\rip = request.getHeader(PROXY_CLIENT_IP.key());\rbreak;\rcase 3:\rip = request.getHeader(WL_PROXY_CLIENT_IP.key());\rbreak;\rcase 4:\rip = request.getHeader(HTTP_CLIENT_IP.key());\rbreak;\rcase 5:\rip = request.getHeader(HTTP_X_FORWARDED_FOR.key());\rbreak;\rdefault:\rip = request.getRemoteAddr();\r}\rtryCount++;\r}\rreturn ip;\r}\rprivate static boolean isIpFound(String ip) {\rreturn ip != null \u0026amp;\u0026amp; ip.length() \u0026gt; 0 \u0026amp;\u0026amp; !UNKNOWN.equalsIgnoreCase(ip);\r}\r}\r ","id":133,"section":"posts","summary":"è¯·æ±‚å¤´æšä¸¾ç±» public enum HttpHeader { AUTHORIZATION(\u0026quot;Authorization\u0026quot;), AUTHENTICATION_TYPE_BASIC(\u0026quot;Basic\u0026quot;), X_AUTH_TOKEN(\u0026quot;X-AUTH-TOKEN\u0026quot;), WWW_Authenticate(\u0026quot;WWW-Authenticate\u0026quot;), X_FORWARDED_FOR(\u0026quot;X-Forwarded-For\u0026quot;), PROXY_CLIENT_IP(\u0026quot;Proxy-Client-IP\u0026quot;), WL_PROXY_CLIENT_IP(\u0026quot;WL-Proxy-Client-IP\u0026quot;), HTTP_CLIENT_IP(\u0026quot;HTTP_CLIENT_IP\u0026quot;), HTTP_X_FORWARDED_FOR(\u0026quot;HTTP_X_FORWARDED_FOR\u0026quot;); private String key; private HttpHeader(String key) { this.key = key; } public String key() { return this.key; } } å·¥å…·ç±» public class RemoteIpHelper { private static final String UNKNOWN = \u0026quot;unknown\u0026quot;; public static String getRemoteIpFrom(HttpServletRequest request) { String ip = null; int tryCount = 1; while (!isIpFound(ip) \u0026amp;\u0026amp; tryCount","tags":["java"],"title":"é€šè¿‡requestè·å–å®¢æˆ·ç«¯IP","uri":"https://www.mingaccount.com/2017/08/request-get-client-id/","year":"2017"},{"content":"ç®€ä»‹ Maven releaseä¸åœ¨mavené»˜è®¤ç”Ÿå‘½å‘¨æœŸå†…ï¼Œéœ€è¦é€šè¿‡pluginæ¥å®ç°ã€‚Maven releaseå¯ä»¥è‡ªåŠ¨ç®¡ç†pom.xmlä¸­çš„ç‰ˆæœ¬å·ï¼Œä»¥åŠgit tagçš„ç‰ˆæœ¬å·ã€‚\nå¸¸ç”¨çš„å‘½ä»¤æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š\n mvn release:cleanåˆ é™¤ç”±mvn release:prepareç”Ÿæˆçš„æ‰€æœ‰æ–‡ä»¶ mvn release:prepareå®ƒä¼šè¿è¡Œmvn clean verifyå‘½ä»¤ç”ŸæˆjaråŒ…ï¼Œå¹¶ä¸”ä¼šå¾€gitä¸Šæäº¤å¹¶pushå½“å‰ç‰ˆæœ¬tagï¼ŒåŒæ—¶ä¸ºå½“å‰ç‰ˆæœ¬çš„ä»£ç åˆ›å»ºåˆ†æ”¯ï¼Œç„¶åä¿®æ”¹pomä¸­çš„ç‰ˆæœ¬å·ï¼ˆé»˜è®¤å åŠ 1ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼‰ï¼Œæœ€åcommitå¯¹pom.xmlçš„ä¿®æ”¹ï¼ˆå¯ä»¥é€šè¿‡mvn release:rollbackå‘½ä»¤å›æ»šprepareçš„ä¿®æ”¹ï¼ˆåŒ…æ‹¬gitæäº¤ï¼‰ï¼Œä½†æ˜¯æäº¤çš„tagæ— æ³•å›æ»šï¼‰ã€‚ mvn release:performå®ƒä¼šå°†prepareåˆ›å»ºçš„ç‰ˆæœ¬åˆ†æ”¯ä»£ç æ‹‰å€’æœ¬åœ°ï¼Œå¹¶æ‰§è¡Œmvn deployå‘½ä»¤ï¼Œç›¸å½“äºå®Œæ•´çš„mavené»˜è®¤ç”Ÿå‘½å‘¨æœŸæµç¨‹ã€‚   å‚è€ƒMaven Release Plugin\n è¿è¡Œè¦æ±‚ è¦è¿è¡Œreleaseç›¸å…³å‘½ä»¤ï¼Œé¦–å…ˆéœ€è¦é…ç½®pom.xml\n\u0026lt;project\u0026gt;\r...\r\u0026lt;scm\u0026gt;\r\u0026lt;developerConnection\u0026gt;scm:git:https://github.com/..../....\u0026lt;/developerConnection\u0026gt;\r\u0026lt;/scm\u0026gt;\r\u0026lt;build\u0026gt;\r\u0026lt;plugins\u0026gt;\r\u0026lt;plugin\u0026gt;\r\u0026lt;groupId\u0026gt;org.apache.maven.plugins\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;maven-release-plugin\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;3.0.0-M1\u0026lt;/version\u0026gt;\r\u0026lt;/plugin\u0026gt;\r\u0026lt;/plugins\u0026gt;\r...\r\u0026lt;/build\u0026gt;\r...\r\u0026lt;/project\u0026gt;\r å’Œæ˜¯å¿…ä¸å¯å°‘çš„\nä¸­çš„æŒ‡å‘çš„å°±æ˜¯gitçš„é¡¹ç›®åœ°å€ï¼Œæœ€åä¸åŠ .git\ngitè®¤è¯ é™¤äº†ä¸Šé¢ä¸¤ä¸ªå¿…è¦æ ‡ç­¾ï¼Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯è®¿é—®gitçš„é…ç½®ä¿¡æ¯\nå¯¹äºmavenæ¥è¯´ï¼Œå¹¶ä¸çŸ¥é“ä½ çš„gitç”¨æˆ·åå¯†ç æ‰€ä»¥éœ€è¦åœ¨settings.xmlä¸­æ–°å¢\n\u0026lt;servers\u0026gt;\r\u0026lt;server\u0026gt;\r\u0026lt;id\u0026gt;git\u0026lt;/id\u0026gt;\r\u0026lt;username\u0026gt;*******@outlook.com\u0026lt;/username\u0026gt;\r\u0026lt;password\u0026gt;{wb83456gfhgV71sdfewrvx453EJt4iOVlQ=}\u0026lt;/password\u0026gt;\r\u0026lt;/server\u0026gt;\r\u0026lt;/servers\u0026gt;\r å…¶ä¸­idæ˜¯pom.xmlç”¨æ¥åŒ¹é…å¯¹åº”æœåŠ¡çš„ï¼Œéœ€è¦åœ¨pom.xmlä¸­é…ç½®è¯¥idï¼š\n\u0026lt;properties\u0026gt;\r\u0026lt;project.scm.id\u0026gt;git\u0026lt;/project.scm.id\u0026gt;\r\u0026lt;/properties\u0026gt;\r å¯†ç åŠ å¯† æ­¤å¤–ä¹‹å‰settings.xmlä¸­çš„æ˜¯åŠ å¯†çš„ï¼Œæ²¡æœ‰æ˜æ–‡å¯†ç ã€‚è·å–åŠ å¯†å¯†ç è¿˜éœ€è¦æ›´å¤šé…ç½®ï¼š\n éœ€è¦æ‰§è¡Œmvn --encrypt-master-passwordå‘½ä»¤ï¼Œè·å¾—masterå¯†ç  ç„¶åå°†masterå¯†ç ä¿å­˜åˆ°${user.home}/.m2/settings-security.xmlæ–‡ä»¶ä¸­ï¼Œåªéœ€è¦ä»¥ä¸‹ç»“æ„ï¼š  \u0026lt;settingsSecurity\u0026gt;\r\u0026lt;master\u0026gt;{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=}\u0026lt;/master\u0026gt;\r\u0026lt;/settingsSecurity\u0026gt;\r æ‰§è¡Œmvn --encrypt-passwordå‘½ä»¤ï¼ŒæŒ‰ç…§æç¤ºè¾“å…¥ä½ çš„gitå¯†ç ä»¥è·å–å¯†æ–‡ã€‚   æ›´å¤šå…³äºMavenå¯†ç åŠ å¯†ï¼Œå‚è€ƒMaven Password Encrypt\n  ç”±äºmvn release:performå†…éƒ¨æ‰§è¡Œäº†mvn deployå‘½ä»¤ï¼Œå› æ­¤æƒ³è¦mvn release:performæ­£å¸¸è¿è¡Œï¼Œå¿…é¡»åœ¨pom.xmlä¸­é…ç½®\u0026lt;distributionManagement\u0026gt;\n å‚è€ƒmaven distributionManagement\n å¦‚æœæ²¡æœ‰è®¡åˆ’å°†ç”Ÿæˆçš„jaråŒ…åˆ†å‘åˆ°ä»“åº“ç®¡ç†å™¨ä¸Šï¼ˆä¾‹å¦‚nexusï¼‰ï¼Œåˆæƒ³æ‰§è¡Œperformï¼Œé‚£ä¹ˆå¯ä»¥å°†deployæ’ä»¶å±è”½æ‰\n\u0026lt;project xmlns=\u0026quot;http://maven.apache.org/POM/4.0.0\u0026quot;\u0026gt;\r...\r\u0026lt;plugins\u0026gt;\r...\r\u0026lt;plugin\u0026gt;\r\u0026lt;groupId\u0026gt;org.apache.maven.plugins\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;maven-deploy-plugin\u0026lt;/artifactId\u0026gt;\r\u0026lt;configuration\u0026gt;\r\u0026lt;skip\u0026gt;true\u0026lt;/skip\u0026gt;\r\u0026lt;/configuration\u0026gt;\r\u0026lt;/plugin\u0026gt;\r\u0026lt;/plugins\u0026gt;\r\u0026lt;/project\u0026gt;\r ","id":134,"section":"posts","summary":"ç®€ä»‹ Maven releaseä¸åœ¨mavené»˜è®¤ç”Ÿå‘½å‘¨æœŸå†…ï¼Œéœ€è¦é€šè¿‡pluginæ¥å®ç°ã€‚Maven releaseå¯ä»¥è‡ªåŠ¨ç®¡ç†pom.xmlä¸­çš„ç‰ˆæœ¬å·ï¼Œ","tags":["maven"],"title":"Maven release","uri":"https://www.mingaccount.com/2017/07/maven-release/","year":"2017"},{"content":"å¤šä¸ªwhereæ¡ä»¶ï¼Œæ¯ä¸ªæ¡ä»¶å¯¹åº”çš„æ›´æ–°å€¼ä¸åŒï¼Œéœ€è¦mysqlæ‰¹é‡æ›´æ–°\nUPDATE test_table\rSET\rtest_target = test_id CASE\rWHEN \u0026quot;123\u0026quot; THEN \u0026quot;456\u0026quot;\rWHEN \u0026quot;789\u0026quot; THEN \u0026quot;101\u0026quot;\rEND\rWHERE\rtest_id in ['123','789']\r ä½†æ˜¯åœ¨ç¨‹åºä¸­ï¼Œç›´æ¥å†™å¸¸é‡çš„æƒ…å†µå¤ªå°‘ï¼Œå¤§å¤šæ•°éƒ½éœ€è¦å˜é‡éå†\nä¸‹é¢æ˜¯mybatisçš„åº”ç”¨ï¼š\nUPDATE\rtable\rSET\rtarget = CASE id\r\u0026lt;foreach collection=\u0026quot;items\u0026quot; item=\u0026quot;item\u0026quot; close=\u0026quot; END\u0026quot; \u0026gt;\rWHEN #{item.id} THEN #{item.target}\r\u0026lt;/foreach\u0026gt;\rWHERE\rapply_id IN\r\u0026lt;foreach collection=\u0026quot;items\u0026quot; item=\u0026quot;item\u0026quot; open=\u0026quot;(\u0026quot; close=\u0026quot;)\u0026quot; separator=\u0026quot;,\u0026quot; \u0026gt;\r#{item.id}\r\u0026lt;/foreach\u0026gt;\r ","id":135,"section":"posts","summary":"å¤šä¸ªwhereæ¡ä»¶ï¼Œæ¯ä¸ªæ¡ä»¶å¯¹åº”çš„æ›´æ–°å€¼ä¸åŒï¼Œéœ€è¦mysqlæ‰¹é‡æ›´æ–° UPDATE test_table SET test_target = test_id CASE WHEN \u0026quot;123\u0026quot; THEN \u0026quot;456\u0026quot; WHEN \u0026quot;789\u0026quot; THEN \u0026quot;101\u0026quot; END WHERE test_id in ['123','789'] ä½†æ˜¯åœ¨ç¨‹åºä¸­ï¼Œç›´æ¥å†™å¸¸é‡çš„æƒ…å†µå¤ª","tags":["mysql"],"title":"Mysqlæ‰¹é‡æ›´æ–°","uri":"https://www.mingaccount.com/2017/07/mysql-batch-update/","year":"2017"},{"content":"usermod -d /var/lib/mysql/ mysql\rln -s /var/lib/mysql/mysql.sock /tmp/mysql.sock\rchown -R mysql:mysql /var/lib/mysql\r ","id":136,"section":"posts","summary":"usermod -d /var/lib/mysql/ mysql ln -s /var/lib/mysql/mysql.sock /tmp/mysql.sock chown -R mysql:mysql /var/lib/mysql","tags":["mysql"],"title":"Mysqlå¯åŠ¨æŠ¥é”™mkdir: cannot create directory â€˜//.cacheâ€™: Permission denied","uri":"https://www.mingaccount.com/2017/07/mysql-startup-exception/","year":"2017"},{"content":"lifecycle-phase mavenæœ‰ä¸‰ä¸ªå†…éƒ¨ç”Ÿå‘½å‘¨æœŸï¼šdefaultï¼Œcleanï¼Œå’Œsiteã€‚\næ¯ä¸ªç”Ÿå‘½å‘¨æœŸç”±å¤šä¸ªé˜¶æ®µ(phase)ç»„æˆ\nclean    Phase Description     pre-clean execute processes needed prior to the actual project cleaning   clean remove all files generated by the previous build   post-clean execute processes needed to finalize the project cleaning    default    Phase Description     validate validate the project is correct and all necessary information is available.   initialize initialize build state, e.g. set properties or create directories.   generate-sources generate any source code for inclusion in compilation.   process-sources process the source code, for example to filter any values.   generate-resources generate resources for inclusion in the package.   process-resources copy and process the resources into the destination directory, ready for packaging.   compile compile the source code of the project.   process-classes post-process the generated files from compilation, for example to do bytecode enhancement on Java classes.   generate-test-sources generate any test source code for inclusion in compilation.   process-test-sources process the test source code, for example to filter any values.   generate-test-resources create resources for testing.   process-test-resources copy and process the resources into the test destination directory.   test-compile compile the test source code into the test destination directory   process-test-classes post-process the generated files from test compilation, for example to do bytecode enhancement on Java classes.   test run tests using a suitable unit testing framework. These tests should not require the code be packaged or deployed.   prepare-package perform any operations necessary to prepare a package before the actual packaging. This often results in an unpacked, processed version of the package.   package take the compiled code and package it in its distributable format, such as a JAR.   pre-integration-test perform actions required before integration tests are executed. This may involve things such as setting up the required environment.   integration-test process and deploy the package if necessary into an environment where integration tests can be run.   post-integration-test perform actions required after integration tests have been executed. This may including cleaning up the environment.   verify run any checks to verify the package is valid and meets quality criteria.   install install the package into the local repository, for use as a dependency in other projects locally.   deploy done in an integration or release environment, copies the final package to the remote repository for sharing with other developers and projects.    site    Phase Description     pre-site execute processes needed prior to the actual project site generation   site generate the project\u0026rsquo;s site documentation   post-site execute processes needed to finalize the site generation, and to prepare for site deployment   site-deploy deploy the generated site documentation to the specified web server    phase-goal ç”Ÿå‘½å‘¨æœŸå¯¹åº”çš„æ¯ä¸ªé˜¶æ®µï¼ˆphaseï¼‰ï¼Œéƒ½åº”æœ‰ä¸€ä¸ªç›®æ ‡ï¼ˆgoalï¼‰ï¼Œå®é™…ä¸Šèµ·ä½œç”¨çš„å°±æ˜¯è¿™äº›ç›®æ ‡è¯­å¥ï¼ˆæ²¡æœ‰goalçš„phaseæ²¡æœ‰æ„ä¹‰ï¼‰ã€‚phaseç›¸å½“äºgoalçš„å°è£…ï¼Œä¸€ä¸ªphaseå¯ä»¥å°è£…å¤šä¸ªgoalï¼Œé™¤äº†mavené»˜è®¤çš„goalï¼Œä½ è¿˜å¯ä»¥ç»‘å®šè‡ªå®šä¹‰çš„goalã€‚\næ¯ä¸ªé˜¶æ®µå¯¹åº”çš„ç›®æ ‡ï¼Œæ ¹æ®pom.xmlæ–‡ä»¶ä¸­çš„\u0026lt;packaging\u0026gt;æ ‡ç­¾çš„å€¼è€Œç•¥æœ‰ä¸åŒã€‚è¯¦æƒ…å‚è€ƒBuilt-in Lifecycle Bindings\n","id":137,"section":"posts","summary":"lifecycle-phase mavenæœ‰ä¸‰ä¸ªå†…éƒ¨ç”Ÿå‘½å‘¨æœŸï¼šdefaultï¼Œcleanï¼Œå’Œsiteã€‚ æ¯ä¸ªç”Ÿå‘½å‘¨æœŸç”±å¤šä¸ªé˜¶æ®µ(phase)ç»„æˆ clean Phase Description pre-clean execute processes needed prior to the actual project cleaning clean","tags":["maven"],"title":"Markdownç”Ÿå‘½å‘¨æœŸ","uri":"https://www.mingaccount.com/2017/07/markdown-lifecycle/","year":"2017"},{"content":"compile This is the default scope, used if none is specified. Compile dependencies are available in all classpaths of a project. Furthermore, those dependencies are propagated to dependent projects.\nprovided This is much like compile, but indicates you expect the JDK or a container to provide the dependency at runtime. For example, when building a web application for the Java Enterprise Edition, you would set the dependency on the Servlet API and related Java EE APIs to scope provided because the web container provides those classes. A dependency with this scope is added to the classpath used for compilation and test, but not the runtime classpath. It is not transitive.\nruntime This scope indicates that the dependency is not required for compilation, but is for execution. Maven includes a dependency with this scope in the runtime and test classpaths, but not the compile classpath.\ntest This scope indicates that the dependency is not required for normal use of the application, and is only available for the test compilation and execution phases. This scope is not transitive. Typically this scope is used for test libraries such as JUnit and Mockito. It is also used for non-test libraries such as Apache Commons IO if those libraries are used in unit tests (src/test/java) but not in the model code (src/main/java).\nsystem This scope is similar to provided except that you have to provide the JAR which contains it explicitly. The artifact is always available and is not looked up in a repository.\nimport This scope is only supported on a dependency of type pom in the section. It indicates the dependency is to be replaced with the effective list of dependencies in the specified POM\u0026rsquo;s section. Since they are replaced, dependencies with a scope of import do not actually participate in limiting the transitivity of a dependency.\n è¯¦æƒ…å‚è€ƒMaven Scope\n ","id":138,"section":"posts","summary":"compile This is the default scope, used if none is specified. Compile dependencies are available in all classpaths of a project. Furthermore, those dependencies are propagated to dependent projects. provided This is much like compile, but indicates you expect the JDK or a container to provide the dependency at runtime. For example, when building a web application for the Java Enterprise Edition, you would set the dependency on the Servlet","tags":["maven"],"title":"Mavenä¾èµ–scopeå±æ€§","uri":"https://www.mingaccount.com/2017/06/maven-dependency-scope/","year":"2017"},{"content":"# ç¼–è¯‘é¡¹ç›®\rmvn compile\r# æ‰§è¡Œé¡¹ç›®ä¸­çš„å•å…ƒæµ‹è¯•\r# æŸ¥æ‰¾å•å…ƒæµ‹è¯•ç±»çš„é»˜è®¤è§„åˆ™ï¼š**/*Test.java;**/Test*.java;**/*TestCase.java\r# æ’é™¤å•å…ƒæµ‹è¯•ç±»çš„é»˜è®¤è§„åˆ™ï¼š**/Abstract*Test.java;**/Abstract*TestCase.java\rmvn test\r# ç¼–è¯‘æµ‹è¯•ä»£ç ä½†ä¸æ‰§è¡Œ\rmvn test-compile\r# ç”ŸæˆJARæ–‡ä»¶ï¼Œåœ¨${basedir}/target ç›®å½•ä¸‹\rmvn package\r# å®˜æ–¹é»˜è®¤æ¨èå‘½ä»¤ã€‚ä»£è¡¨æ‰§è¡Œé›†æˆæµ‹è¯•æˆ–è€…ä¸€äº›è´¨é‡éªŒè¯ï¼Œé™¤äº†å¯¹åº”çš„å½“å‰é˜¶æ®µï¼Œè¿˜æ‰§è¡Œäº†validateï¼Œcompileï¼Œtestï¼Œpackage\rmvn verify\r# å°†ç”ŸæˆJARæ–‡ä»¶å®‰è£…åˆ°æœ¬åœ°ä»“åº“ï¼Œæœ¬åœ°ä»“åº“é»˜è®¤è·¯å¾„ï¼š${user.home}/.m2/repository\rmvn install\r# ç”Ÿæˆé¡¹ç›®åŸºç¡€ä¿¡æ¯ç½‘ç«™\rmvn site\r# åˆ é™¤ target ç›®å½•ä¸‹çš„æ‰€æœ‰æ„å»ºæ•°æ®\rmvn clean\r# æ ¹æ®æ¨¡æ¿åˆ›å»ºmavené¡¹ç›®\rmvn archetype:generate\r# æ„å»ºå®Œæ•´ä¾èµ–ï¼Œèƒ½å¤Ÿç‹¬ç«‹è¿è¡Œçš„jaråŒ…\rmvn clean package\r# è¿è¡ŒSpring-booté¡¹ç›®\rmvn spring-boot:run\r# åˆ é™¤targetç›®å½•å†…å®¹ï¼Œé‡æ–°ç¼–è¯‘æµ‹è¯•æ„å»ºï¼Œç„¶åéƒ¨ç½²åˆ°è¿œç¨‹å…±äº«ä»“åº“\rmvn clean deploy\r# ä»æœ¬åœ°ä»“åº“åˆ é™¤æŒ‡å®šjar\rmvn dependency:purge-local-repository -DmanualInclude=\u0026quot;groupId:artifactId, ...\u0026quot;\r# é¡¹ç›®ä¾èµ–ç»“æ„\rmvn dependency:tree\r# é¡¹ç›®ä¾èµ–åˆ†æ\rmvn dependency:analyze\r# pluginè¯¦æƒ…ï¼ŒåŠ ä¸Š-Dgoalå¯ä»¥æŸ¥çœ‹æŒ‡å®šgoalçš„è¯¦æƒ…\rmvn release:help -Ddetail -Dgoal=stage\r# å®‰è£…jaråŒ…åˆ°æœ¬åœ°ä»“åº“\rmvn install:install-file \\\r-Dfile=\u0026lt;path-to-file\u0026gt; \\\r-DgroupId=\u0026lt;group-id\u0026gt; \\\r-DartifactId=\u0026lt;artifact-id\u0026gt; \\\r-Dversion=\u0026lt;version\u0026gt; \\\r-Dpackaging=\u0026lt;packaging\u0026gt; \\\r-DgeneratePom=true\r# ç¦»çº¿æ‰“åŒ…\rmvn -o package\r# æŒ‡å®šè‡ªå®šä¹‰settings.xmlè¿è¡Œå‘½ä»¤\rmvn -s YourOwnSettings.xml clean install\r# åŠ å¯†å¯†ç ï¼Œç”¨äºsettings.xmlä¸­çš„æœåŠ¡å¯†ç ç­‰\rmvn --encrypt-password \u0026lt;password\u0026gt;\r# åŠ è½½èµ„æºæ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæ£€æŸ¥æŒ‡å®š${}æ˜¯å¦æ­£å¸¸èµ‹å€¼\rmvn process-resources\r ","id":139,"section":"posts","summary":"# ç¼–è¯‘é¡¹ç›® mvn compile # æ‰§è¡Œé¡¹ç›®ä¸­çš„å•å…ƒæµ‹è¯• # æŸ¥æ‰¾å•å…ƒæµ‹è¯•ç±»çš„é»˜è®¤è§„åˆ™ï¼š**/*Test.java;**/Test*.java;**/*TestCa","tags":["maven"],"title":"Mavenå‘½ä»¤å¤‡å¿˜","uri":"https://www.mingaccount.com/2017/06/maven-common-command/","year":"2017"},{"content":"GsonBuilder gsonBuilder = new GsonBuilder();\rgsonBuilder.setLongSerializationPolicy( LongSerializationPolicy.STRING );\rGson gson = gsonBuilder.create();\r ","id":140,"section":"posts","summary":"GsonBuilder gsonBuilder = new GsonBuilder(); gsonBuilder.setLongSerializationPolicy( LongSerializationPolicy.STRING ); Gson gson = gsonBuilder.create();","tags":["java"],"title":"é˜»æ­¢Gsonå°†longç±»å‹çš„å­—æ®µè½¬ä¸ºç§‘å­¦è®¡æ•°æ³•","uri":"https://www.mingaccount.com/2017/06/gson-scientific-notation/","year":"2017"},{"content":"1.åˆ‡é¢ç¼–ç¨‹æ ¸å¿ƒæ¦‚å¿µ  åˆ‡é¢ç¼–ç¨‹Aspect-oriented Programming (AOP)\n AOPåªæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œè·ŸSpringæ˜¯ç‹¬ç«‹å…³ç³»\næœ€å…¸å‹çš„AOPå®ç°æ¡†æ¶AspectJï¼Œæ˜¯ä¸€ä¸ªååˆ†æˆç†Ÿçš„æ¡†æ¶ï¼ŒSpring AOPç›¸æ¯”åªæ˜¯åŸºäºå®ƒåšäº†ä¸€äº›åŠŸèƒ½çš„å¼ºåŒ–ï¼Œæ˜¯äº’è¡¥å…³ç³»\nå‡ ä¸ªæ ¸å¿ƒçš„å‚æ•°æ¦‚å¿µï¼ˆåŸºäºAspectJï¼‰\n Aspect: åˆ‡é¢ç¼–ç¨‹çš„æ ¸å¿ƒæ˜¯åˆ‡é¢ï¼Œå› æ­¤é¦–å…ˆéœ€è¦ä¸€ä¸ªåˆ‡é¢ç±»(@Aspectæ³¨è§£ä¿®é¥°çš„ç±») Join point: ä»£è¡¨éœ€è¦åˆ‡é¢å¤„ç†çš„æ–¹æ³•ï¼ˆSpring AOPåªé’ˆå¯¹æ–¹æ³•ï¼Œå› æ­¤ä»¥ä¸‹ç®€ç§°ç›®æ ‡æ–¹æ³•ï¼‰ Advice: åˆ‡é¢ç±»éœ€è¦åœ¨ç›®æ ‡æ–¹æ³•è¿è¡Œçš„å“ªä¸ªé˜¶æ®µè¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚before(è°ƒç”¨ä¹‹å‰)ï¼Œafter(è°ƒç”¨ä¹‹å)ï¼Œaround(å‰åéƒ½è¿›è¡Œå¤„ç†) Pointcut: å½“å‰çš„åˆ‡é¢ç±»éœ€è¦ç›‘å¬çš„ç›®æ ‡æ–¹æ³•æœ‰ä»€ä¹ˆç‰¹å¾ï¼Œæˆ–è€…è¯´åˆ‡é¢ç±»è¦æ€æ ·æ‰¾åˆ°éœ€è¦å¤„ç†çš„ç›®æ ‡æ–¹æ³•ï¼Œæ¯”å¦‚è¢«æ³¨è§£@Logä¿®é¥°çš„æ–¹æ³• Introduction: ç”³æ˜ä¸€ä¸ªé¢å¤–çš„æ–¹æ³•æˆ–è€…å­—æ®µå»ä»£è¡¨ç›®æ ‡æ–¹æ³•çš„å¯¹è±¡ï¼Œæ„æ€å°±æ˜¯ä½ å¯ä»¥ç»™ç›®æ ‡æ–¹æ³•æ‰€åœ¨ç±»è¿½åŠ ä¸€ä¸ªçˆ¶ç±»ï¼ˆæ¥å£ï¼‰ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå®ç°å»ä»£è¡¨å®ƒï¼ˆAspectJç§°ä¸ºinter-type declarationï¼‰ Target object: ç›®æ ‡æ–¹æ³•æ‰€åœ¨çš„å¯¹è±¡ï¼Œä¹Ÿå«ä½œadvised objectã€‚ä½†æ˜¯Spring AOPæ˜¯é€šè¿‡è¿è¡Œæ—¶ä»£ç†å®ç°çš„ï¼Œæ„æ€å°±æ˜¯è¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªä»£ç†ç±»çš„å¯¹è±¡  å®Œæ•´çš„Adviceç±»å‹åŒ…æ‹¬ï¼š\n Before advice: åœ¨ç›®æ ‡æ–¹æ³•ä¹‹å‰ After returning advice: åœ¨ç›®æ ‡æ–¹æ³•returnä¹‹åï¼Œå¦‚æœç›®æ ‡æ–¹æ³•æ²¡æœ‰æŠ›å¼‚å¸¸çš„è¯ After throwing advice: åœ¨ç›®æ ‡æ–¹æ³•æŠ›å®Œå¼‚å¸¸ä¹‹å After (finally) advice: ç›¸å½“äºfinally Around advice: åœ¨æ–¹æ³•æ‰§è¡Œå‰ååšå¤„ç†ï¼Œå¯ä»¥å¤„ç†å‚æ•°ï¼Œæ•è·å¼‚å¸¸ï¼Œä¿®æ”¹è¿”å›ç»“æœ  å»ºè®®ä½¿ç”¨æœ€å°èŒƒå›´çš„Adviceï¼Œæ¯”å¦‚è¯´ä»…éœ€è¦å¤„ç†è¿”å›ç»“æœï¼Œåªéœ€è¦è®¾å®šç±»å‹ä¸ºAfter returning adviceå³å¯\nèƒ½ä¸ä½¿ç”¨Around adviceçš„æ—¶å€™å°½é‡ä¸ä½¿ç”¨ï¼Œå› ä¸ºå®ƒéœ€è¦ä½ æ‰‹åŠ¨å»è°ƒç”¨ç›®æ ‡æ–¹æ³•(é€šè¿‡åŠ¨æ€ä»£ç†)ï¼Œå°½å¯èƒ½åœ°å‡å°‘å‡ºé”™\nSpring AOPé»˜è®¤ä½¿ç”¨æ ‡å‡†çš„JDK dynamic proxiesä½œä¸ºAOPçš„ä»£ç†ï¼Œå°±æ˜¯åˆ‡é¢ç±»ä¸­è°ƒç”¨ç›®æ ‡æ–¹æ³•çš„è¿‡ç¨‹ã€‚\n2.åŸºäºAspectJçš„Spring AOPå®ä¾‹ 2.1 é…ç½®ç±» æ³¨è§£EnableAspectJAutoProxyï¼Œè®©Springåœ¨ç›®æ ‡æ–¹æ³•è¢«æ‰§è¡Œæ—¶ï¼Œè‡ªåŠ¨æ‹¦æˆªæ–¹æ³•è°ƒç”¨å¹¶ç”Ÿæˆä»£ç†ç±»\n@Configuration\r@EnableAspectJAutoProxy\rpublic class AppConfig {\r}\r 2.2 åˆ‡é¢ç±»å£°æ˜ æ³¨æ„åˆ‡é¢ç±»çš„æ–¹æ³•ä¸èƒ½ä½œä¸ºç›®æ ‡æ–¹æ³•è¢«æ‹¦æˆª\npackage org.xyz;\rimport org.aspectj.lang.annotation.Aspect;\r@Component\r@Aspect\rpublic class NotVeryUsefulAspect {\r}\r 2.3 åˆ‡é¢æ–¹æ³•ç‰¹å¾ç”³æ˜(Pointcut) Spring AOPåªæ”¯æŒæ–¹æ³•æ‰§è¡Œçš„åˆ‡å…¥ç‚¹ï¼Œæ‰€ä»¥Pointcutå°±æ˜¯åœ¨ç”³æ˜æ€ä¹ˆåŒ¹é…ç›®æ ‡ç›®æ ‡æ–¹æ³•\nä¸€ä¸ªPointcutçš„å£°æ˜æœ‰ä¸¤ä¸ªéƒ¨åˆ†\n æ–°å»ºä¸€ä¸ªæ–¹æ³•ï¼Œä»»æ„å‚æ•°ï¼Œä»»æ„åç§°ï¼Œè¿”å›å€¼å¿…é¡»æ˜¯void æ–°å»ºçš„æ–¹æ³•éœ€è¦ä¸€ä¸ª@Pointcutæ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£å’Œä»–çš„å‚æ•°å«åšpointcutè¡¨è¾¾å¼  ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œä»£è¡¨pointcutçš„åå­—æ˜¯anyOldTransferï¼ŒåŒ¹é…çš„ç›®æ ‡æ–¹æ³•æ˜¯ä»»ä½•æ–¹æ³•åå«åštransferçš„\n@Pointcut(\u0026quot;execution(* transfer(..))\u0026quot;)\rprivate void andOldTransfer(){}\r æ³¨è§£Pointcutçš„valueå°±æ˜¯AspectJ5çš„pointcutè¡¨è¾¾å¼\n2.3.1 æ”¯æŒçš„Pointcutæ ‡è¯†ç¬¦ åœ¨pointcutè¡¨è¾¾å¼ä¸­ï¼ŒSpring AOPæ”¯æŒä¸‹åˆ—çš„AspectJ pointcut æ ‡è¯†ç¬¦(PCD)ï¼š\n execution: ç”¨äºç›´æ¥åŒ¹é…ç›®æ ‡æ–¹æ³•ã€‚å¯¹Spring AOPæ¥è¯´ï¼Œè¿™æ˜¯ä¸»è¦çš„pointcutæŒ‡ç¤ºç¬¦ within: é™åˆ¶ç›®æ ‡æ–¹æ³•æ˜¯åœ¨åŒ¹é…çš„ç±»å‹ä¸­ç”³æ˜ this: é™åˆ¶ç›®æ ‡æ–¹æ³•ï¼Œå…¶beanå¼•ç”¨(Spring AOPä»£ç†)æ˜¯ç»™å®šç±»å‹çš„å®ä¾‹ target: é™åˆ¶ç›®æ ‡æ–¹æ³•ï¼Œå…¶ç›®æ ‡å¯¹è±¡(æ­£åœ¨ä»£ç†çš„åº”ç”¨ç¨‹åºå¯¹è±¡)æ˜¯ç»™å®šç±»å‹çš„å®ä¾‹ args: é™åˆ¶ç›®æ ‡æ–¹æ³•ï¼Œå…¶å‚æ•°æ˜¯ç»™å®šç±»å‹çš„å®ä¾‹ @target: é™åˆ¶ç›®æ ‡æ–¹æ³•ï¼Œå…¶ç±»æœ‰æŒ‡å®šç±»å‹çš„æ³¨è§£ @args: é™åˆ¶ç›®æ ‡æ–¹æ³•ï¼Œå…¶å®é™…ä¼ è¾“çš„å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°çš„ç±»å‹éƒ½æœ‰ç»™å®šçš„æ³¨è§£ @within: é™åˆ¶ç›®æ ‡æ–¹æ³•ï¼Œå…¶æ‰€åœ¨ç±»å‹æœ‰ç»™å®šçš„æ³¨è§£ @annotation: é™åˆ¶ç›®æ ‡æ–¹æ³•æœ‰ç»™å®šæ³¨è§£  åœ¨AspectJä¸­ï¼Œå› ä¸ºAspectæ˜¯ä¸€ä¸ªåŸºäºç±»å‹çš„è¯­æ³•ï¼Œthiså’Œtargetéƒ½æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚\nä½†åœ¨SpringAOPä¸­ï¼Œthiså’Œtargetæ˜¯æœ‰åŒºåˆ«çš„ï¼ŒSpring AOPæ˜¯åŸºäºä»£ç†çš„ç³»ç»Ÿï¼Œthisä»£è¡¨çš„æ˜¯ä»£ç†å¯¹è±¡ï¼Œtargetä»£è¡¨çš„æ‰æ˜¯ç›®æ ‡æ–¹æ³•æ‰€åœ¨çš„å¯¹è±¡\n Springä¸æ”¯æŒä»¥ä¸‹AspectJçš„pointcutæ ‡è¯†ç¬¦ï¼š\ncall, get, set, preinitialization, staticinitialization, initialization, handler, adviceexecution, withincode, cflow, cflowbelow, if, @this, and @withincode\nå¦‚æœä½¿ç”¨è¿™äº›pointcutæ ‡è¯†ç¬¦ä¼šæŠ›å‡ºIllegalArgumentException\n  å› ä¸ºSpring AOPä»¥ä»£ç†ä¸ºåŸºç¡€çš„ç‰¹æ€§ï¼Œæ˜¯ä¸ä¼šæ‹¦æˆªåœ¨ç›®æ ‡æ–¹æ³•æ‰€åœ¨ç±»ä¸­çš„è°ƒç”¨çš„ï¼Œæ¢å¥è¯è¯´ç›®æ ‡æ–¹æ³•æ‰€åœ¨ç±»çš„å…¶ä»–æ–¹æ³•ä¸­è°ƒç”¨äº†ç›®æ ‡æ–¹æ³•æ˜¯ä¸ä¼šè§¦å‘æ‹¦æˆªçš„ è¿™ä¸ªç‰¹æ€§æ˜¯ç”±Spring AOPé»˜è®¤ä½¿ç”¨çš„JDK proxiesé€ æˆçš„ï¼Œå¯ä»¥é€šè¿‡æ›¿æ¢Spring's proxy-based AOP frameworkä¸ºSpring-driven native AspectJ weaving æ¥è§£å†³ï¼Œä½†æ˜¯éœ€è¦å¯¹wavingæœ‰ä¸€å®šç†Ÿç»ƒåº¦\n Spring AOPæ”¯æŒä¸€ä¸ªé¢å¤–çš„PCDï¼Œå«åšbeanã€‚è¿™ä¸ªæ ‡è¯†ç¬¦å¯ä»¥è®©ä½ é™åˆ¶ç›®æ ‡æ–¹æ³•å»åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šçš„Spring bean(å¤šä¸ªé€šè¿‡é€šé…ç¬¦)\nbean(idOrNameOfBean)\r idOrNameOfBeanå¯ä»¥æ˜¯ä»»ä½•Spring beançš„åç§°ã€‚å¦‚æœä½ ç¡®å®šäº†å¤šä¸ªbeanåç§°çš„è§„åˆ™ï¼Œå¯ä»¥ä¹Ÿåªèƒ½ç”¨*å·å»å†™PCDè¡¨è¾¾å¼æ¥é€‰æ‹©ä»–ä»¬\nå½“beanéœ€è¦å’Œå…¶ä»–çš„PCDä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨\u0026amp;\u0026amp;(and)ï¼Œ!(negation),||(or)æ¥è¿æ¥\n2.3.2 ç»„åˆpointcutè¡¨è¾¾å¼ ä½ å¯ä»¥ç»„åˆpointcutè¡¨è¾¾å¼é€šè¿‡ä½¿ç”¨\u0026amp;\u0026amp;ï¼Œ||å’Œ!\n@Pointcut(\u0026quot;execution(public * *(..))\u0026quot;)\rprivate void anyPublicOperation(){}\r@Pointcut(\u0026quot;within(com.xyz.myapp.trading..*)\u0026quot;)\rprivate void inTrading(){}\r@Pointcut(\u0026quot;anyPublicOperation() \u0026amp;\u0026amp; inTrading()\u0026quot;)\rprivate void tradingOperation(){}\r å¯¹ä¸Šé¢çš„ä¸‰ä¸ªpointcuté€ä¸ªè§£æ\n anyPublicOperation åŒ¹é…ä»»ä½•ç›®æ ‡æ–¹æ³•æ˜¯publicçš„ inTrading åŒ¹é…ä»»ä½•ç›®æ ‡æ–¹æ³•åœ¨tradingæ¨¡å—è·¯å¾„ä¸‹ tradingOperation ä»»ä½•ç›®æ ‡æ–¹æ³•æ˜¯publicï¼Œå¹¶ä¸”åœ¨tradingæ¨¡å—ä¸‹  ä»å°çš„å‘½åç»„ä»¶å®Œæˆäº†ä¸€ä¸ªå¤æ‚çš„pointcutè¡¨è¾¾å¼çš„æ„å»ºï¼Œè¿™æ˜¯ä¸€ä¸ªæœ€å¥½çš„å®ç°æ–¹å¼ï¼Œæ­£å¦‚ä¸Šé¢çš„å®ä¾‹ã€‚\nå½“é€šè¿‡åå­—å¼•ç”¨pointcutï¼Œè·Ÿä¸€èˆ¬javaçš„å¯è§è§„åˆ™ä¸€æ ·(private,protected,public)ï¼Œæ„å‘³ç€ä½ å¯ä»¥å¼•ç”¨å…¶ä»–ç±»çš„pointcutï¼Œåªè¦å¯¹åº”pointcutçš„ç±»ä¿®é¥°ç¬¦å¯è§ã€‚ pointcutçš„å¯è§æ€§ä¸å½±å“åˆ‡é¢çš„åŒ¹é…ï¼Œåªå½±å“pointcutè¡¨è¾¾å¼çš„å¼•ç”¨\n2.3.3 åˆ†äº«å…±ç”¨çš„Pointcutå®šä¹‰ åœ¨å¼€å‘ä¸­æœ‰å¾ˆå¤šåˆ‡é¢æ˜¯ç»å¸¸ä½¿ç”¨åˆ°çš„ï¼Œæ¨èå®šä¹‰ä¸€ä¸ªCommonPointcutsåˆ‡é¢ç±»æ¥å®šä¹‰å…±ç”¨çš„pointcutè¡¨è¾¾å¼\nå…¸å‹çš„ç±»ä¼¼ä¸‹è¾¹çš„è¿™ä¸ªä¾‹å­ï¼š\npackage com.xyz.myapp;\rimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.Pointcut;\r@Aspect\rpublic class CommonPointcuts {\r/**\r* åœ¨webå±‚çš„åˆ‡é¢ï¼Œä»»ä½•åœ¨webç›®å½•ä»¥åŠå­ç›®å½•ç±»ä¸­å®šä¹‰çš„æ–¹æ³•\r*/\r@Pointcut(\u0026quot;within(com.xyz.myapp.web..*)\u0026quot;)\rpublic void inWebLayer() {}\r/**\r* serviceå±‚çš„åˆ‡é¢ï¼Œä»»ä½•åœ¨serviceç›®å½•ä»¥åŠå­ç›®å½•ç±»ä¸­å®šä¹‰çš„æ–¹æ³•\r*/\r@Pointcut(\u0026quot;within(com.xyz.myapp.service..*)\u0026quot;)\rpublic void inServiceLayer() {}\r/**\r* daoå±‚çš„åˆ‡é¢ï¼Œä»»ä½•åœ¨daoç›®å½•ä»¥åŠå­ç›®å½•ç±»ä¸­å®šä¹‰çš„æ–¹æ³•\r*/\r@Pointcut(\u0026quot;within(com.xyz.myapp.dao..*)\u0026quot;)\rpublic void inDataAccessLayer() {}\r/**\r* ä¸šåŠ¡Serviceåˆ‡é¢ï¼Œä»»ä½•åœ¨serviceæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•,å‡å®šæ¥å£åœ¨\u0026quot;service\u0026quot;packageä¸­ï¼Œå¹¶ä¸”å­åŒ…ä¸­æœ‰å…¶å®ç°ç±»\r*\r* ä¹Ÿå¯ä»¥ä½¿ç”¨bean(*Service)ï¼Œä½†æ˜¯è¦ç¡®ä¿Serviceçš„å‘½åè§„åˆ™\r*/\r@Pointcut(\u0026quot;execution(* com.xyz.myapp..service.*.*(..))\u0026quot;)\rpublic void businessService() {}\r/**\r* ä»»ä½•åœ¨daoæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå‡å®šæ¥å£åœ¨\u0026quot;dao\u0026quot;packageä¸­ï¼Œå¹¶ä¸”å­åŒ…æœ‰å…¶å®ç°ç±»\r*/\r@Pointcut(\u0026quot;execution(* com.xyz.myapp.dao.*.*(..))\u0026quot;)\rpublic void dataAccessOperation() {}\r}\r ä½ å¯ä»¥å¼•ç”¨è¿™äº›pointcutå®šä¹‰ï¼Œåœ¨ä»»ä½•ä½ éœ€è¦ä»–ä»¬çš„åœ°æ–¹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç»™æ‰€æœ‰serviceå±‚éƒ½åŠ ä¸Šäº‹åŠ¡ï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š\n\u0026lt;aop:config\u0026gt;\r\u0026lt;aop:advisor\rpointcut=\u0026quot;com.xyz.myapp.CommonPointcuts.businessService()\u0026quot;\radvice-ref=\u0026quot;tx-advice\u0026quot;/\u0026gt;\r\u0026lt;/aop:config\u0026gt;\r\u0026lt;tx:advice id=\u0026quot;tx-advice\u0026quot;\u0026gt;\r\u0026lt;tx:attributes\u0026gt;\r\u0026lt;tx:method name=\u0026quot;*\u0026quot; propagation=\u0026quot;REQUIRED\u0026quot;/\u0026gt;\r\u0026lt;/tx:attributes\u0026gt;\r\u0026lt;/tx:advice\u0026gt;\r å…³äºå…·ä½“çš„\u0026lt;aop:config\u0026gt;å’Œ\u0026lt;aop:advisor\u0026gt;å…ƒç´ ä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒ Schema-based AOP Support\nå…³äºäº‹åŠ¡å…ƒç´ çš„ä½¿ç”¨å¯ä»¥å‚è€ƒ Transaction Management\n2.3.4 å®ä¾‹ Spring AOP çš„ç”¨æˆ·æœ€ç»å¸¸ä½¿ç”¨çš„pointcutæ ‡è¯†ç¬¦æ˜¯executionï¼Œexecutionè¡¨è¾¾å¼çš„æ ¼å¼å¦‚ä¸‹ï¼š\n execution(modifiers-pattern? ret-type-pattern declaring-type-pattern?name-pattern(param-pattern)\rthrows-pattern?)\r   ä»¥ä¸Šè¡¨è¾¾å¼ä¸­ï¼Œé™¤äº†ret-type-patternï¼Œname-patternå’Œparam-patternæ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–çš„éƒ½æ˜¯å¯é€‰å‚æ•°\n  ret-type-patternæŒ‡ä»£è¿”å›ç±»å‹\n *å·æ˜¯æœ€å¸¸ç”¨åˆ°çš„ï¼Œä»£è¡¨å¯ä»¥è¿”å›ä»»ä½•ç±»å‹ ä¸€ä¸ªå®Œå…¨é™å®šçš„ç±»å‹åç§°ï¼Œåªæœ‰åœ¨æ–¹æ³•è¿”å›æŒ‡å®šç±»å‹çš„æ—¶å€™æ‰ä¼šåŒ¹é…    name-pattern æŒ‡ä»£æ–¹æ³•åç§°\n ä½ å¯ä»¥ä½¿ç”¨*å·æ¥ä»£æ›¿éƒ¨åˆ†æˆ–è€…å…¨éƒ¨æ–¹æ³•å å¦‚æœä½ æŒ‡å®šäº†declaring-type-patternï¼Œç”¨.å·è¿æ¥name-component    param-pattern æŒ‡ä»£æ–¹æ³•å‚æ•°\n ()ä»£è¡¨æ–¹æ³•æ²¡æœ‰ä»»ä½•å‚æ•° (..)ä»£è¡¨æ–¹æ³•å¯èƒ½æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿå¯èƒ½æœ‰ä»»æ„æ•°é‡ä»»æ„ç±»å‹çš„å‚æ•° (*) ä»£è¡¨æ–¹æ³•æœ‰ä¸€ä¸ªä»»æ„ç±»å‹çš„å‚æ•° (*,String) ä»£è¡¨æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ä»»æ„ç±»å‹ï¼Œä¸€ä¸ªå¿…é¡»æ˜¯String    å®Œæ•´çš„AspectJ pointcutè¡¨è¾¾å¼è¯­æ³•ç»“æ„å¯ä»¥å‚è€ƒLanguage Semantics\nä¸€ä¸‹çš„å®ä¾‹å±•ç¤ºäº†ç»å¸¸ä½¿ç”¨åˆ°çš„pointcutè¡¨è¾¾å¼ï¼š\n ä»»ä½•æ‰§è¡Œçš„publicæ–¹æ³•   execution(public * *(..))\n  ä»»ä½•æ‰§è¡Œçš„æ–¹æ³•æ˜¯ä»¥setå¼€å¤´çš„   execution(* set*(..))\n  ä»»ä½•æ‰§è¡Œçš„æ–¹æ³•æ˜¯AccountServiceä¸­å®šä¹‰çš„   execution(* com.xyz.service.AccountService.*(..))\n  ä»»ä½•æ‰§è¡Œçš„æ–¹æ³•æ˜¯å®šä¹‰åœ¨serviceåŒ…ä¸­çš„   execution(* com.xyz.service.*.*(..))\n  ä»»ä½•æ‰§è¡Œçš„æ–¹æ³•æ˜¯å®šä¹‰åœ¨serviceåŒ…æˆ–è€…å…¶å­åŒ…ä¸­çš„   execution(* com.xyz.service..*.*(..))\n  ä»»ä½•åœ¨serviceåŒ…ä¸‹çš„æ–¹æ³•   within(com.xyz.service.*)\n  ä»»ä½•åœ¨serviceåŒ…æˆ–å…¶å­åŒ…ä¸‹çš„æ–¹æ³•   within(com.xyz.service..*)\n  ä»»ä½•æ–¹æ³•çš„ä»£ç†æ˜¯å®ç°AccountServiceæ¥å£çš„   this(com.xyz.service.AccountService)\nä¸€èˆ¬ç”¨äºç»‘å®šç»“æ„ï¼Œå…·ä½“ç”¨æ³•åœ¨åé¢ä¼šæåˆ°\n  ä»»ä½•æ–¹æ³•çš„ç›®æ ‡å¯¹è±¡æ˜¯å®ç°AccountServiceæ¥å£çš„   target(com.xyz.service.AccountService)\nä¸€èˆ¬ç”¨äºç»‘å®šç»“æ„ï¼Œå…·ä½“ç”¨æ³•åœ¨åé¢ä¼šæåˆ°\n  ä»»ä½•æ‰§è¡Œçš„æ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªå‚æ•°åœ¨è¿è¡Œæ—¶æ˜¯é€šè¿‡Serializableä¼ é€’çš„   args(java.io.Serializable)\nä¸€èˆ¬ç”¨äºç»‘å®šæ¥å£ï¼Œå…·ä½“ç”¨æ³•åœ¨åé¢ä¼šæåˆ°\næ³¨æ„è¿™é‡Œçš„å‚æ•°åŒ¹é…è·Ÿexecution(* *(java.io.Serializable))æ˜¯ä¸åŒçš„\nargsä»£è¡¨å‚æ•°åœ¨è¿è¡Œæ—¶æ˜¯ä»¥Serializableä¼ é€’çš„\nexecutionä»£è¡¨å‚æ•°å¿…é¡»æ˜¯Serializableç±»å‹\n  ä»»ä½•æ–¹æ³•çš„ç›®æ ‡å¯¹è±¡æœ‰@Transactionalæ³¨è§£   @target(org.springframework.transaction.annotation.Transactional)\nä½ åŒæ ·å¯ä»¥æŠŠä»–ç”¨åœ¨ç»‘å®šç»“æ„ï¼Œå…·ä½“ç”¨æ³•åœ¨åé¢ä¼šæåˆ°\n  ä»»ä½•æ–¹æ³•çš„ç›®æ ‡å¯¹è±¡çš„ç”³æ˜ç±»å‹æœ‰@Transactionalæ³¨è§£   @within(org.springframework.transaction.annotation.Transactional)\nä½ åŒæ ·å¯ä»¥æŠŠä»–ç”¨åœ¨ç»‘å®šç»“æ„ï¼Œå…·ä½“ç”¨æ³•åœ¨åé¢ä¼šæåˆ°\n  ä»»ä½•æ–¹æ³•ä¸Šæœ‰@Transactionalæ³¨è§£   @annotation(org.springframework.transaction.annotation.Transactional)\nä½ åŒæ ·å¯ä»¥æŠŠä»–ç”¨åœ¨ç»‘å®šç»“æ„ï¼Œå…·ä½“ç”¨æ³•åœ¨åé¢ä¼šæåˆ°\n  ä»»ä½•æ–¹æ³•åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¯¥å‚æ•°åœ¨è¿è¡Œæ—¶ä¼ é€’æœ‰@Classifiedæ³¨è§£   @args(com.xyz.security.Classified)\nä½ åŒæ ·å¯ä»¥æŠŠä»–ç”¨åœ¨ç»‘å®šç»“æ„ï¼Œå…·ä½“ç”¨æ³•åœ¨åé¢ä¼šæåˆ°\n  ä»»ä½•æ–¹æ³•æ‰€å±çš„Spring beançš„åç§°æ˜¯tradeService   bean(tradeService)\n  ä»»ä½•æ–¹æ³•æ‰€å±çš„Spring beançš„åç§°æ˜¯ä»¥Serviceç»“å°¾   bean(*Service)\n 2.3.5 å†™å¥½pointcutsè¡¨è¾¾å¼ AspectJä¸ä¼šç›´æ¥é‡‡ç”¨ä½ å†™çš„pointcutè¡¨è¾¾å¼ï¼Œè¿›è¡Œåˆ†ææ ¡éªŒåï¼Œä½ çš„è¡¨è¾¾å¼ä¼šè¢«é‡å†™\nå…³äºè¡¨è¾¾å¼çš„é¡ºåºï¼ŒAspectJä¹Ÿä¼šé‡æ’ï¼Œæ„å‘³ç€ä¸éœ€è¦æ‹…å¿ƒä½ çš„è¡¨è¾¾å¼å†™æ³•ä¼šå½±å“åŒ¹é…æ•ˆç‡\nä½†æ˜¯ä½ ç›´æ¥é€‰ç”¨çš„pointcutæ ‡è¯†ç¬¦è¿˜æ˜¯ä¼šå¯¹åŒ¹é…æ•ˆç‡é€ æˆå½±å“ï¼ŒåŸåˆ™ä¸Šåº”è¯¥é€‰ç”¨æœç´¢èŒƒå›´æ›´å°çš„å®šä¹‰ AspectJçš„æ ‡è¯†ç¬¦å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼šç±»å‹ï¼ŒèŒƒå›´ï¼Œå’Œä¸Šä¸‹æ–‡ï¼š(ä»¥ä¸‹æ ‡è¯†ç¬¦åŒ…æ‹¬Springä¸æ”¯æŒçš„)\n ç±»å‹ï¼šæŒ‡å®šç±»å‹çš„è¿æ¥ç‚¹ï¼šexecution,get,set,call,å’Œwithcode èŒƒå›´ï¼šæŒ‡å®šèŒƒå›´å†…çš„è¿æ¥ç‚¹ï¼šwithinå’Œwithcode ä¸Šä¸‹æ–‡ï¼šæŒ‡å®šä¸Šä¸‹æ–‡ï¼šthis,target,å’Œ@annotation  ä¸€ä¸ªå¥½çš„pointcutè¡¨è¾¾å¼è‡³å°‘è¦åŒ…å«ç±»å‹å’ŒèŒƒå›´ä¸¤ä¸ªç±»å‹\nå¦‚æœåªæœ‰ç±»å‹å’Œä¸Šä¸‹æ–‡ï¼Œä¼šå½±å“æ€§èƒ½ï¼Œå› ä¸ºéœ€è¦ä¸€äº›é¢å¤–çš„å¤„ç†å’Œåˆ†æ\nä½†æ˜¯èŒƒå›´ä¸åŒï¼Œä»–çš„åŒ¹é…é€Ÿåº¦éå¸¸å¿«ï¼Œä¸€ä¸ªå¥½çš„pointcutè¡¨è¾¾å¼åº”è¯¥å°½å¯èƒ½çš„åŒ…å«ä¸€ä¸ª\n2.4 ç”³æ˜Advice Adviceéœ€è¦å…³è”ä¸€ä¸ªpointcutè¡¨è¾¾å¼ï¼Œå¹¶ç”³æ˜åœ¨åŒ¹é…çš„pointcutä¹‹å‰(before)ï¼Œä¹‹å(after)ï¼Œæˆ–è€…å‰å(around)è¿è¡Œ\nå¼•ç”¨pointcutè¡¨è¾¾å¼å¯ç®€å•å¼•ç”¨å·²å‘½åçš„pointcutè¡¨è¾¾å¼ï¼Œæˆ–è€…å°±åœ°ç”³æ˜pointcutè¡¨è¾¾å¼\n2.4.1 Before Advice ä½ å¯ä»¥åœ¨ä¸€ä¸ªåˆ‡é¢ç±»ä¸­ç”³æ˜before adviceé€šè¿‡ä½¿ç”¨@Beforeæ³¨è§£:\nimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.Before;\r@Aspect\rpublic class BeforeExample {\r@Before(\u0026quot;com.xyz.myapp.CommonPointcuts.dataAccessOperation()\u0026quot;)\rpublic void doAccessCheck() {\r// ...\r}\r}\r å¦‚æœæˆ‘ä»¬ä¸å¼•ç”¨å·²å£°æ˜çš„pointcutï¼Œå¯ä»¥ç›´æ¥å°±åœ°ç”³æ˜ï¼š\nimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.Before;\r@Aspect\rpublic class BeforeExample {\r@Before(\u0026quot;execution(* com.xyz.myapp.dao.*.*(..))\u0026quot;)\rpublic void doAccessCheck() {\r// ...\r}\r}\r 2.4.2 After Returning Advice After Returning Adviceåœ¨æ–¹æ³•æ­£å¸¸returnåè¿è¡Œã€‚\nä½ å¯ä»¥ç”³æ˜å®ƒé€šè¿‡ä½¿ç”¨@AfterReturningæ³¨è§£ï¼š\nimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.AfterReturning;\r@Aspect\rpublic class AfterReturningExample {\r@AfterReturning(\u0026quot;com.xyz.myapp.CommonPointcuts.dataAccessOperation()\u0026quot;)\rpublic void doAccessCheck() {\r// ...\r}\r}\r  ä½ å¯ä»¥æ‹¥æœ‰å¤šä¸ªadviceï¼Œåœ¨åŒä¸€ä¸ªåˆ‡é¢ç±»ä¸­\n æœ‰äº›æ—¶å€™ï¼Œä½ éœ€è¦åœ¨adviceæ–¹æ³•ä¸­è®¿é—®ç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼ã€‚ä½ å¯ä»¥ä½¿ç”¨@AfterReturningçš„å‚æ•°ç»“æ„å»ç»‘å®šè¿”å›å‚æ•°ï¼š\nimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.AfterReturning;\r@Aspect\rpublic class AfterReturningExample {\r@AfterReturning(\rpointcut=\u0026quot;com.xyz.myapp.CommonPointcuts.dataAccessOperation()\u0026quot;,\rreturning=\u0026quot;retVal\u0026quot;)\rpublic void doAccessCheck(Object retVal) {\r// ...\r}\r}\r returningå‚æ•°æ‰€ç”¨çš„åå­—ï¼Œå¿…é¡»è·Ÿadviceæ–¹æ³•çš„å‚æ•°åç›¸åŒ\nå¹¶ä¸”è¿”å›å€¼çš„ç±»å‹ä¹Ÿå¿…é¡»åŒ¹é…(è¿™é‡Œç”¨çš„Objectï¼Œå¯åŒ¹é…æ‰€æœ‰è¿”å›å€¼)\næ³¨æ„æƒ³é€šè¿‡after returning adviceè¿”å›ä¸€ä¸ªå®Œå…¨ä¸åŒçš„å¼•ç”¨æ˜¯ä¸å¯èƒ½çš„\n2.4.3 After Throwing Advice After Throwing Adviceå½“ç›®æ ‡æ–¹æ³•æ˜¯å› ä¸ºæŠ›å‡ºå¼‚å¸¸é€€å‡ºçš„æ—¶å€™æ‰§è¡Œã€‚ å¯ä»¥é€šè¿‡@AfterThrowingæ³¨è§£æ¥å®ç°ï¼š\nimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.AfterThrowing;\r@Aspect\rpublic class AfterThrowingExample {\r@AfterThrowing(\u0026quot;com.xyz.myapp.CommonPointcuts.dataAccessOperation()\u0026quot;)\rpublic void doRecoveryActions() {\r// ...\r}\r}\r åœ¨é€šå¸¸ä½¿ç”¨æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦åœ¨æŒ‡å®šå¼‚å¸¸çš„æ—¶å€™è¿è¡ŒAdviceï¼Œæˆ–è€…è·å–æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ï¼ˆæƒ³è·å¾—å¼‚å¸¸ï¼Œåˆä¸æƒ³é™åˆ¶ï¼Œä½¿ç”¨Throwableï¼‰\nä½ å¯ä»¥ä½¿ç”¨@AfterThrowingçš„å±æ€§throwingæ¥å®ç°ï¼š\nimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.AfterThrowing;\r@Aspect\rpublic class AfterThrowingExample {\r@AfterThrowing(\rpointcut=\u0026quot;com.xyz.myapp.CommonPointcuts.dataAccessOperation()\u0026quot;,\rthrowing=\u0026quot;ex\u0026quot;)\rpublic void doRecoveryActions(DataAccessException ex) {\r// ...\r}\r}\r åŒæ ·throwingä¸­çš„åå­—å¿…é¡»è·Ÿadviceæ–¹æ³•çš„å‚æ•°åç§°ç›¸åŒ\nå½“ç„¶ä¹Ÿæœ‰ç±»å‹é™åˆ¶ï¼Œadviceæ–¹æ³•çš„å‚æ•°ç±»å‹ï¼Œå¿…é¡»è·Ÿç›®æ ‡æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ç›¸åŒ\n2.4.4 After (Finally) Advice After (Finally) Adviceæ˜¯åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œé€€å‡ºåè¿è¡Œ\nå®ƒé€šè¿‡æ³¨è§£@Afteræ¥å®ç°ï¼Œç”¨è¯¥æ³¨è§£çš„æ—¶å€™ï¼Œä½ éœ€è¦åŒæ—¶å¤„ç†æ­£å¸¸è¿”å›ç°è±¡å’Œå¼‚å¸¸é€€å‡ºç°è±¡\nè¿™ä¸ªAdviceé€šå¸¸ç”¨æ¥å¤„ç†èµ„æºé‡Šæ”¾é—®é¢˜æˆ–è€…å…¶ä»–ç›¸ä¼¼çš„æƒ…å½¢ï¼š\nimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.After;\r@Aspect\rpublic class AfterFinallyExample {\r@After(\u0026quot;com.xyz.myapp.CommonPointcuts.dataAccessOperation()\u0026quot;)\rpublic void doReleaseLock() {\r// ...\r}\r}\r 2.4.5 Around Advice Around Adviceæ˜¯æœ€åä¸€ä¸ªadviceï¼Œä¹Ÿæ˜¯æœ€å¼ºå¤§çš„ä¸€ä¸ªã€‚ä½ å¯ä»¥åœ¨æ–¹æ³•æ‰§è¡Œå‰ï¼Œæ‰§è¡Œååšå¤„ç†ï¼Œç”šè‡³å¯ä»¥å†³å®šä»€ä¹ˆæ—¶å€™è¿è¡Œï¼Œæ€æ ·è¿è¡Œï¼Œæ˜¯å¦è¿è¡Œç›®æ ‡æ–¹æ³•\nå®ƒç»å¸¸ä½¿ç”¨çš„åœºæ™¯æ˜¯åœ¨æ–¹æ³•è¿è¡Œå‰åæœ‰çŠ¶æ€ä¿¡æ¯éœ€è¦åˆ†äº«çš„ï¼Œæ¯”å¦‚æ–¹æ³•çš„è¿è¡Œæ—¶é—´ç­‰ç­‰\nåœ¨é€‰æ‹©Adviceçš„æ—¶å€™ï¼Œå§‹ç»ˆä½¿ç”¨åŠŸèƒ½æœ€å¼±çš„é‚£ä¸ªï¼Œæ¯”å¦‚èƒ½ç”¨Beforeï¼Œå°±ä¸ç”¨Around\nAround Adviceé€šè¿‡æ³¨è§£@Aroundæ¥ç”³æ˜ã€‚adviceæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹å¿…é¡»æ˜¯ProceedingJoinPoint\nåœ¨adviceæ–¹æ³•ä¸­ï¼Œé€šè¿‡è°ƒç”¨ç¬¬ä¸€ä¸ªå‚æ•°çš„proceed()æ–¹æ³•ï¼Œå¯ä»¥æ‰§è¡Œç›®æ ‡æ–¹æ³•\nproceedå¯ä»¥ä¼ é€’ä¸€ä¸ªObject[]å‚æ•°ï¼Œè¿™ä¸ªæ•°ç»„ï¼Œæ˜¯ç›®æ ‡æ–¹æ³•æ‰€éœ€è¦çš„æ‰€æœ‰å‚æ•° å¦‚ä½•ä½¿ç”¨Around Adviceï¼Ÿä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š\nimport org.aspectj.lang.annotation.Aspect;\rimport org.aspectj.lang.annotation.Around;\rimport org.aspectj.lang.ProceedingJoinPoint;\r@Aspect\rpublic class AroundExample {\r@Around(\u0026quot;com.xyz.myapp.CommonPointcuts.businessService()\u0026quot;)\rpublic Object doBasicProfiling(ProceedingJoinPoint pjp) throws Throwable {\r// start stopwatch\rObject retVal = pjp.proceed();\r// stop stopwatch\rreturn retVal;\r}\r}\r around advice çš„è¿”å›å€¼å°±æ˜¯æ–¹æ³•è°ƒç”¨è€…çœ‹åˆ°çš„è¿”å›å€¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç®€å•çš„ç¼“å­˜åˆ‡é¢ï¼Œå¦‚æœç¼“å­˜é‡Œé¢æœ‰ç›´æ¥ä»ç¼“å­˜è¿”å›ï¼Œå¦‚æœç¼“å­˜é‡Œé¢æ²¡æœ‰å†è°ƒç”¨proceed()æ–¹æ³•ã€‚\næ³¨æ„proceedæœ‰å¯èƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œæˆ–è€…å¤šæ¬¡ï¼Œç”šè‡³ä¸è°ƒç”¨ï¼Œè¿™éƒ½æ˜¯åˆæ³•çš„\n2.4.6 adviceå‚æ•° è®¿é—®å½“å‰çš„ JoinPoint ä»»ä½•çš„adviceæ–¹æ³•éƒ½å¯ä»¥ç”³æ˜JoinPointä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆé™¤äº†aroundä¾‹å¤–ï¼Œä¸è¿‡å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ProceedingJoinPointï¼Œä¹Ÿæ˜¯JoinPointçš„å­ç±»)\nJoinPointæä¾›äº†ä¸€äº›å¾ˆæœ‰ç”¨çš„æ–¹æ³•ï¼š\n getArgs()ï¼šè¿”å›æ–¹æ³•å‚æ•° getThis()ï¼šè¿”å›ä»£ç†å¯¹è±¡ getTarget()ï¼šè¿”å›ç›®æ ‡å¯¹è±¡ getSignature()ï¼šè¿”å›æ–¹æ³•çš„æè¿° toString()ï¼šæ‰“å°æ–¹æ³•æœ‰ç”¨çš„æè¿°  å®Œæ•´APIå‚è€ƒjavadoc\nç»™Adviceä¼ é€’å‚æ•° æˆ‘ä»¬å·²ç»çœ‹è¿‡æ€æ ·ç»‘å®šè¿”å›å€¼å’Œå¼‚å¸¸å€¼ï¼ˆé€šè¿‡ä½¿ç”¨after returningå’Œafter throwingadvice)ã€‚é‚£ä¹ˆå‚æ•°å€¼æ€ä¹ˆç»‘å®šäº†ï¼Œå¯ä»¥ä½¿ç”¨argsè¡¨è¾¾å¼\nå¦‚æœåœ¨argsè¡¨è¾¾å¼é‡Œä½¿ç”¨å¯¹åº”çš„adviceæ–¹æ³•çš„å‚æ•°åä»£æ›¿ç±»å‹åï¼Œå½“adviceè¢«è°ƒç”¨æ—¶å¯¹åº”çš„å‚æ•°å°±ä¼šè¢«æŒ‡å®šç±»å‹çš„åŸæ–¹æ³•å‚æ•°æ›¿æ¢ã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚ä½ çš„ç›®æ ‡æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªç±»å‹ä¸ºAccountçš„å¯¹è±¡ï¼Œä½ éœ€è¦è®¿é—®è¿™ä¸ªaccountå‚æ•°åœ¨adviceçš„æ–¹æ³•ä½“ä¸­ï¼Œä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ï¼š\n@Before(\u0026quot;com.xyz.myapp.CommonPointcuts.dataAccessOperation() \u0026amp;\u0026amp; args(account,..)\u0026quot;)\rpublic void validateAccount(Account account) {\r// ...\r}\r args(account,..)è¿™ä¸ªpointcutè¡¨è¾¾å¼æœ‰ä¸¤ä¸ªç›®çš„\n é™åˆ¶ç›®æ ‡æ–¹æ³•è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªå‚æ•°æ˜¯Accountç±»çš„å®ä¾‹ é€šè¿‡adviceå‚æ•°ä¼ é€’å‚æ•°çš„å€¼  ä¼ é€’å‚æ•°çš„å¦å¤–ä¸€ä¸ªæ–¹æ³•æ˜¯åœ¨ä¸€ä¸ªpointcutè¡¨è¾¾å¼é‡Œé¢ç”³æ˜å¥½ï¼Œadviceç›´æ¥å¼•ç”¨ï¼š\n@Pointcut(\u0026quot;com.xyz.myapp.CommonPointcuts.dataAccessOperation() \u0026amp;\u0026amp; args(account,..)\u0026quot;)\rprivate void accountDataAccessOperation(Account account) {}\r@Before(\u0026quot;accountDataAccessOperation(account)\u0026quot;)\rpublic void validateAccount(Account account) {\r// ...\r}\r thisã€targetã€@withinã€@targetã€@annotationï¼Œå’Œ@argséƒ½å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼ç»‘å®š\nä¸‹é¢çš„ä¸¤ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•åŒ¹é…æœ‰æ³¨è§£@Auditableçš„æ–¹æ³•å’Œå¦‚ä½•æå–æ³¨è§£çš„AuditCodeå‚æ•°\nç¬¬ä¸€ä¸ªä¾‹å­å±•ç¤ºäº†@Auditableæ³¨è§£ï¼š\n@Retention(RetentionPolicy.RUNTIME)\r@Target(ElementType.METHOD)\rpublic @interface Auditable {\rAuditCode value();\r}\r ç¬¬äºŒä¸ªä¾‹å­æ˜¯å¯¹åº”çš„adviceï¼š\n@Before(\u0026quot;com.xyz.lib.Pointcuts.anyPublicMethod() \u0026amp;\u0026amp; @annotation(auditable)\u0026quot;)\rpublic void audit(Auditable auditable) {\rAuditCode code = auditable.value();\r// ...\r}\r Adviceå‚æ•°å’Œæ³›å‹ Spring AOPå¯ä»¥å¤„ç†ç±»æ³›å‹å’Œæ–¹æ³•æ³›å‹\nå‡å¦‚ä½ æœ‰ä¸€ä¸ªæ¥å£å¦‚ä¸‹æ‰€ç¤ºï¼š\npublic interface Sample\u0026lt;T\u0026gt; {\rvoid sampleGenericMethod(T param);\rvoid sampleGenericCollectionMethod(Collection\u0026lt;T\u0026gt; param);\r}\r ä½ å¯ä»¥æŒ‡å®šæ³›å‹ä¸ºä»€ä¹ˆç±»å‹æ—¶æ‰æ‹¦æˆªæ–¹æ³•ï¼š\n@Before(\u0026quot;execution(* ..Sample+.sampleGenericMethod(*)) \u0026amp;\u0026amp; args(param)\u0026quot;)\rpublic void beforeSampleMethod(MyType param) {\r// Advice implementation\r}\r è¿™ä¸ªæ–¹æ³•åœ¨æ³›å‹æŒ‡å‘é›†åˆçš„æ—¶å€™æ˜¯ä¸ç”Ÿæ•ˆçš„ã€‚æ‰€ä»¥ä½ ä¸èƒ½åƒä¸‹è¾¹é‚£æ ·å®šä¹‰pointcutï¼š\n@Before(\u0026quot;execution(* ..Sample+.sampleGenericCollectionMethod(*)) \u0026amp;\u0026amp; args(param)\u0026quot;)\rpublic void beforeSampleMethod(Collection\u0026lt;MyType\u0026gt; param) {\r// Advice implementation\r}\r è¦å®ç°è¿™ç§æƒ…å†µï¼Œä½ éœ€è¦æ”¹å˜å‚æ•°ç±»å‹ä¸ºCollection\u0026lt;?\u0026gt;ï¼Œå¹¶ä¸”ä½ éœ€è¦æ‰‹åŠ¨æ ¡éªŒé›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè¿™æ˜¯ä¸åˆç†çš„ï¼Œå› ä¸ºnullå€¼æ— æ³•å¤„ç†ã€‚\nç¡®å®šå‚æ•°åç§° adviceè°ƒç”¨æ—¶çš„å‚æ•°ç»‘å®šæ˜¯ä¾èµ–äºpointcutè¡¨è¾¾å¼é‡Œé¢çš„åç§°ï¼ˆç”¨äºç”³æ˜adviceå‚æ•°åï¼‰å’Œpointcutæ–¹æ³•ç­¾åçš„åå­—ç›¸åŒ¹é…ï¼Œä½†æ˜¯åœ¨javaåå°„é‡Œè¾¹ï¼Œå‚æ•°åç§°æ˜¯ä¸å¯ç”¨çš„\næ‰€ä»¥Spring AOPé‡‡ç”¨äº†ä»¥ä¸‹ç­–ç•¥å´å†³å®šå‚æ•°åç§°:\n å¦‚æœå‚æ•°åå·²ç»è¢«ç”¨æˆ·æ˜ç¡®æŒ‡å®šï¼Œé‚£ä¹ˆæŒ‡å®šçš„å‚æ•°åä¼šè¢«ä½¿ç”¨ã€‚adviceå’Œpointcutæ³¨è§£éƒ½æœ‰ä¸€ä¸ªå¯é€‰å±æ€§argNamesï¼Œä½ å¯ä»¥ç”¨å®ƒæŒ‡å®šæ³¨è§£æ–¹æ³•çš„å‚æ•°åç§° è¿™äº›å‚æ•°åç§°åœ¨è¿è¡Œæ—¶ä¹Ÿæ˜¯å¯ç”¨çš„ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨argNameså±æ€§ï¼š  @Before(value=\u0026quot;com.xyz.lib.Pointcuts.anyPublicMethod() \u0026amp;\u0026amp; target(bean) \u0026amp;\u0026amp; @annotation(auditable)\u0026quot;,\rargNames=\u0026quot;bean,auditable\u0026quot;)\rpublic void audit(Object bean, Auditable auditable){\rAuditCode code = auditable.value();\r}\r å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é»˜è®¤å‚æ•°JoinPointï¼ŒProceedingJoinPoint,æˆ–è€…JoinPoint.StaticPartï¼Œåœ¨é…ç½®argNamesæ—¶ä½ å¯ä»¥ç›´æ¥å¿½ç•¥è¿™äº›é»˜è®¤å‚æ•°\nä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ ä¿®æ”¹ä¸Šé¢çš„adviceæ–°å¢ä¸€ä¸ªJoinPointå‚æ•°ï¼ŒargNamesä¸éœ€è¦æ¶µç›–å®ƒï¼š\n@Before(value=\u0026quot;com.xyz.lib.Pointcuts.anyPublicMethod() \u0026amp;\u0026amp; target(bean) \u0026amp;\u0026amp; @annotation(auditable)\u0026quot;,\rargNames=\u0026quot;bean,auditable\u0026quot;)\rpublic void audit(JoinPoint joinPoint, Object bean, Auditable auditable){\rAuditCode code = auditable.value();\r}\r å½“adviceæ–¹æ³•åªæœ‰é»˜è®¤å‚æ•°JoinPointï¼ŒPorceedingJoinPointï¼Œå’ŒJoint.StaticPartæ—¶ï¼Œå¯ä»¥ä¸å†™argNames\n@Before(\u0026quot;com.xyz.lib.Pointcuts.anyPublicMethod()\u0026quot;)\rpublic void audit(JoinPoint jp) {\r// ... use jp\r}\r   ä½¿ç”¨argNameså±æ€§æ˜¾å¾—ç¨å¾®æœ‰äº›ç¬¨æ‹™ï¼Œæ‰€ä»¥å½“argNamesæ²¡æœ‰è¢«æŒ‡å®šæ—¶ï¼ŒSpring AOPå°†ä¼šåœ¨ç±»çš„debugä¿¡æ¯ä¸­æŸ¥æ‰¾ï¼Œå¹¶ä»æœ¬åœ°å˜é‡è¡¨ä¸­å†³å®šå‚æ•°åç§°\nåªè¦ç±»ç¼–è¯‘æ—¶æœ‰debugä¿¡æ¯(è‡³å°‘æ˜¯-g:vars)å°±èƒ½å¾—åˆ°è¿™ä¸ªä¿¡æ¯ã€‚\nå¯ç”¨æ­¤æ ‡å¿—è¿›è¡Œç¼–è¯‘çš„ç»“æœæ˜¯ï¼š\n ä½ çš„ä»£ç ä¼šæ›´å®¹æ˜“ç†è§£ï¼ˆåå‘å·¥ç¨‹ï¼‰ classæ–‡ä»¶çš„å¤§å°ä¼šæœ‰è½»å¾®å¢å¤§ï¼ˆä¸€èˆ¬å¯ä»¥å¿½ç•¥ä¸è®¡ï¼‰ ä¼šç§»é™¤ç¼–è¯‘å™¨æ²¡æœ‰ç”¨åˆ°çš„æœ¬åœ°å˜é‡  æ¢å¥è¯è¯´ï¼Œä½¿ç”¨è¿™ä¸ªæ ‡å¿—ä½ ä¸ä¼šç¢°è§ä»»ä½•å›°éš¾\n  å¦‚æœä»£ç è¢«ç¼–è¯‘çš„æ—¶å€™æ²¡æœ‰å¿…é¡»çš„debugä¿¡æ¯ï¼ŒSpring AOPä¼šå°è¯•æ¨æ–­å‚æ•°çš„é…å¯¹å…³ç³»ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœpointcutè¡¨è¾¾å¼é‡Œé¢åªæœ‰ä¸€ä¸ªå‚æ•°ç»‘å®šï¼Œè€Œä¸”adviceä¹Ÿåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªé…å¯¹å…³ç³»å°±å¾ˆæ˜æ˜¾ï¼‰\nå¦‚æœåœ¨å¯ç”¨çš„ä¿¡æ¯é‡Œé¢ç»‘å®šå‚æ•°æ˜¯ä¸ç¡®å®šçš„ï¼Œé‚£ä¹ˆAmbiguousBindingExceptionå¼‚å¸¸å°†ä¼šæŠ›å‡º\n  å¦‚æœä¸Šé¢çš„æ‰€æœ‰ç­–ç•¥éƒ½å¤±è´¥äº†ï¼Œé‚£ä¹ˆIllegalArgumentExceptionå¼‚å¸¸å°†ä¼šæŠ›å‡º\n  proceedæ–¹æ³•å¦‚æœå¸¦å‚æ•° ä¹‹å‰æè¿‡å¦‚ä½•å†™ä¸€ä¸ªå¸¦å‚æ•°çš„proceedè°ƒç”¨ã€‚è¿™ä¸ªè§£å†³æ–¹æ³•éœ€è¦ç¡®ä¿adviceçš„ç­¾åæŒ‰é¡ºåºç»‘å®šäº†ç›®æ ‡æ–¹æ³•çš„æ¯ä¸€ä¸ªå‚æ•°\n@Around(\u0026quot;execution(List\u0026lt;Account\u0026gt; find*(..)) \u0026amp;\u0026amp; \u0026quot; +\r\u0026quot;com.xyz.myapp.CommonPointcuts.inDataAccessLayer() \u0026amp;\u0026amp; \u0026quot; +\r\u0026quot;args(accountHolderNamePattern)\u0026quot;)\rpublic Object preProcessQueryPattern(ProceedingJoinPoint pjp,\rString accountHolderNamePattern) throws Throwable {\rString newPattern = preProcess(accountHolderNamePattern);\rreturn pjp.proceed(new Object[] {newPattern});\r}\r æ— è®ºå¦‚ä½•éƒ½è¦åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·ç»‘å®š\n2.4.7 adviceé¡ºåº å½“å¤šä¸ªadviceåŒæ—¶æŒ‡å‘ä¸€ä¸ªç›®æ ‡æ–¹æ³•æ—¶ï¼ŒSpring AOPå’ŒAspectJéµå¾ªåŒæ ·çš„ä¼˜å…ˆçº§è§„åˆ™ï¼š\n è¿›å…¥æ–¹æ³•ï¼šä¼˜å…ˆçº§é«˜çš„å…ˆæ‰§è¡Œï¼ˆæ¯”å¦‚ä¸¤ä¸ªç»™å®šçš„beforeadviceï¼Œä¼˜å…ˆçº§é«˜çš„å…ˆæ‰§è¡Œï¼‰ ç¦»å¼€æ–¹æ³•ï¼šä¼˜å…ˆçº§é«˜çš„åæ‰§è¡Œï¼ˆæ¯”å¦‚ä¸¤ä¸ªç»™å®šçš„afteradviceï¼Œä¼˜å…ˆçº§é«˜çš„åæ‰§è¡Œï¼‰  å½“ä¸¤ä¸ªadviceå®šä¹‰åœ¨ä¸åŒçš„aspectç±»ä½†æŒ‡å‘åŒä¸€ä¸ªç›®æ ‡æ–¹æ³•æ—¶ï¼Œé™¤éä½ åœ¨å…¶ä»–åœ°æ–¹æŒ‡å®šäº†ï¼Œä¸ç„¶æ‰§è¡Œé¡ºåºæ˜¯æ²¡æœ‰å®šä¹‰çš„ã€‚\nä½ å¯ä»¥ç›´æ¥æ§åˆ¶æ‰§è¡Œçš„ä¼˜å…ˆçº§é¡ºåº,æœ‰ä¸¤ä¸ªæ–¹å¼ï¼š\n aspectç±»å®ç°org.springframework.core.Orderedæ¥å£ aspectç±»åŠ æ³¨è§£@Order\nä¸¤ä¸ªåˆ‡é¢Ordered.getValue()(æˆ–è€…æ³¨è§£çš„value)ï¼Œè°çš„å€¼æ›´å°ï¼Œç¡çš„ä¼˜å…ˆçº§æ›´é«˜   ä»Spring Framework 5.2.7å¼€å§‹ï¼Œå¦‚æœadviceæ–¹æ³•éƒ½å®šä¹‰åœ¨åŒä¸€ä¸ªaspectç±»ä¸­å¹¶ä¸”éƒ½æŒ‡å‘åŒä¸€ä¸ªç›®æ ‡æ–¹æ³•ï¼Œé‚£ä¹ˆä»–ä»¬çš„ä¼˜å…ˆçº§æ˜¯åŸºäºä»–ä»¬çš„adviceç±»å‹çš„\næŒ‰ç…§å¦‚ä¸‹çš„é¡ºåºï¼Œä»é«˜åˆ°ä½ï¼š\n@Around,@Before,@After,@AfterReturning,@AfterThrowing\nä½†è¯·æ³¨æ„å› ä¸ºSpringçš„AspectJAfterAdviceå®ç°æ–¹å¼ï¼Œä»»ä½•åœ¨åŒä¸€ä¸ªåˆ‡é¢ç±»ä¸­çš„@AfterReturningæˆ–è€…AfterThrowingadviceæ–¹æ³•æ‰§è¡Œè¿‡åéƒ½ä¼šå»æ‰§è¡Œ@Afteradviceæ–¹æ³•\nå½“ä¸¤ä¸ªåŒæ ·ç±»å‹çš„advice(æ¯”å¦‚ï¼Œä¸¤ä¸ª@Afteradviceæ–¹æ³•)å®šä¹‰åœ¨åŒä¸€ä¸ªåˆ‡é¢ç±»ä¸­æ—¶ï¼Œå¹¶ä¸”éƒ½æŒ‡å‘åŒä¸€ä¸ªç›®æ ‡æ–¹æ³•ï¼Œè¿™ç§æƒ…å†µä¸‹é¡ºåºæ˜¯æ— æ³•å®šä¹‰çš„\nå› ä¸ºæ²¡æœ‰åŠæ³•ä»javacå·²ç»ç¼–è¯‘è¿‡çš„ç±»åå°„ä¸­è·å–æºç çš„ç”³æ˜é¡ºåº\næ‰€ä»¥å½“é‡åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œè¯·è€ƒè™‘åˆå¹¶è¿™ä¸¤ä¸ªadviceæ–¹æ³•ï¼Œæˆ–è€…æŠŠé‡å¤adviceæ–¹æ³•æå–åˆ°å¦å¤–ä¸€ä¸ªåˆ‡é¢ç±»ä¸­\n 2.5 Introductions Introductions(åœ¨AspectJä¸­å«åšç±»å‹é—´å£°æ˜) è®©åˆ‡é¢ç±»å¯ä»¥ç”³æ˜ç›®æ ‡æ–¹æ³•æ‰€åœ¨å¯¹è±¡å®ç°æŒ‡å®šæ¥å£ï¼Œè€Œä¸”æä¾›ä¸€ä¸ªæ¥å£çš„å®ç°ç±»å»ä»£è¡¨é‚£äº›å¯¹è±¡\nä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªintroductioné€šè¿‡ä½¿ç”¨@DeclareParentsæ³¨è§£ã€‚è¿™ä¸ªæ³¨è§£è¢«ç”¨æ¥ç”³æ˜åŒ¹é…çš„ç±»å‹æœ‰ä¸€ä¸ªæ–°çš„çˆ¶ç±»\nä¸¾ä¸ªä¾‹å­ï¼Œç»™å®šæ¥å£å«åšUsageTrackedç„¶åè¿™ä¸ªæ¥å£çš„å®ç°ç±»å«åšDefaultUsageTracked\nä¸‹é¢çš„åˆ‡é¢ç”³æ˜äº†æ‰€æœ‰å®ç°serviceçš„å®ç°ç±»ä¹Ÿå®ç°äº†UsageTrackedæ¥å£ï¼ˆä¾‹å¦‚é€šè¿‡JMXå…¬å¼€ç»Ÿè®¡ä¿¡æ¯ï¼‰ï¼š\n@Aspect\rpublic class UsageTracking {\r@DeclareParents(value=\u0026quot;com.xzy.myapp.service.*+\u0026quot;, defaultImpl=DefaultUsageTracked.class)\rpublic static UsageTracked mixin;\r@Before(\u0026quot;com.xyz.myapp.CommonPointcuts.businessService() \u0026amp;\u0026amp; this(usageTracked)\u0026quot;)\rpublic void recordUsage(UsageTracked usageTracked) {\rusageTracked.incrementUseCount();\r}\r}\r 2.6 åˆ‡é¢ç±»å®ä¾‹åŒ–æ¨¡å‹ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹application contextæ¥è¯´æ¯ä¸ªåˆ‡é¢ç±»éƒ½æ˜¯å•ä¾‹çš„ã€‚AspectJå°†å…¶ç§°ä½œå•å®ä¾‹æ¨¡å‹ã€‚å¯ä»¥ä½¿ç”¨å¤‡ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ¥å®šä¹‰Aspect\nSpring æ”¯æŒAspectJçš„perthiså’Œpertargetå®ä¾‹åŒ–æ¨¡å‹\næš‚ä¸æ”¯æŒpercflow,percflowbelowï¼Œå’Œpertypewithin\nä½ å¯ä»¥ç”³æ˜ä¸€ä¸ªperthisåˆ‡é¢é€šè¿‡åˆ¶å®šperthisè¯­å¥åœ¨æ³¨è§£@Aspectä¸­ï¼š\n@Aspect(\u0026quot;perthis(com.xyz.myapp.CommonPointcuts.businessService())\u0026quot;)\rpublic class MyAspect{\rprivate int someState;\r@Before(\u0026quot;com.xyz.myapp.CommonPointcuts.businessService()\u0026quot;)\rpublic void recordServiceUsage(){\r// ...\r}\r}\r åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œperthisè¯­å¥çš„ä½œç”¨å°±æ˜¯æ¯åŒ¹é…ä¸€ä¸ªserviceå¯¹è±¡å°±åˆ›å»ºä¸€ä¸ªåˆ‡é¢å®ä¾‹ã€‚å½“ä¸€ä¸ªserviceå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œåˆ‡é¢å®ä¾‹è¢«ç¬¬ä¸€æ¬¡åˆ›å»º\nå½“serviceå¯¹è±¡è¶…å‡ºèŒƒå›´æ—¶ï¼Œåˆ‡é¢å¯¹è±¡ä¹Ÿä¼šè¶…å‡ºèŒƒå›´ï¼ˆæš‚ä¸æ˜ç™½è¿™é‡Œçš„è¶…å‡ºèŒƒå›´æŒ‡çš„æ˜¯ä»€ä¹ˆï¼‰\nåœ¨åˆ‡é¢å®ä¾‹è¢«åˆ›å»ºä¹‹å‰ï¼Œé‡Œé¢çš„adviceæ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ã€‚åªè¦åˆ‡é¢å®ä¾‹è¢«åˆ›å»ºï¼Œå¹¶ä¸”serviceå¯¹è±¡ä¸ä¸€ä¸ªåˆ‡é¢å…³è”çš„æ—¶å€™ï¼Œadviceæ‰ä¼šåœ¨åŒ¹é…çš„æ—¶å€™è¿è¡Œ\npertargetå®ä¾‹åŒ–æ¨¡å‹çš„å·¥ä½œæ–¹å¼è·Ÿperthiså®Œå…¨ç›¸åŒ\n2.7 ä¸€ä¸ªå®Œæ•´çš„AOPå®ä¾‹ å½“æ‰§è¡Œä¸šåŠ¡serviceçš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¼šå› ä¸ºå¹¶å‘åŸå› å¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªå› ä¸ºè·å–æ‚²è§‚é”å¤±è´¥çš„æ“ä½œï¼‰ã€‚å¦‚æœé‡æ–°å°è¯•ï¼Œå¾ˆå¯èƒ½åœ¨ä¸‹æ¬¡å°è¯•çš„æ—¶å€™æˆåŠŸ\nå½“è¿™ç§æƒ…å†µå‡ºç°æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥æœ‰ä¸€ä¸ªæ˜æ˜¾çš„é‡è¯•æ“ä½œä»¥é¿å…å‘å®¢æˆ·ç«¯å‘é€PessimisticLockingFailureExceptionã€‚è¿™ä¸ªéœ€æ±‚å¾ˆæ˜æ˜¾è·¨è¶Šäº†å¤šä¸ªserviceï¼Œå¾ˆæ˜æ˜¾å¯ä»¥ç”¨åˆ‡é¢æ¥å®ç°\nå› ä¸ºæˆ‘ä»¬éœ€è¦å¤šæ¬¡æ‰§è¡Œproceedæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è‚¯å®šéœ€è¦around adviceï¼š\n@Aspect\rpublic class ConcurrentOperationExecutor implements Ordered {\rprivate static final int DEFAULT_MAX_RETRIES = 2;\rprivate int maxRetries = DEFAULT_MAX_RETRIES;\rprivate int order = 1;\rpublic void setMaxRetries(int maxRetries) {\rthis.maxRetries = maxRetries;\r}\rpublic int getOrder() {\rreturn this.order;\r}\rpublic void setOrder(int order) {\rthis.order = order;\r}\r@Around(\u0026quot;com.xyz.myapp.CommonPointcuts.businessService()\u0026quot;)\rpublic Object doConcurrentOperation(ProceedingJoinPoint pjp) throws Throwable {\rint numAttempts = 0;\rPessimisticLockingFailureException lockFailureException;\rdo {\rnumAttempts++;\rtry {\rreturn pjp.proceed();\r}\rcatch(PessimisticLockingFailureException ex) {\rlockFailureException = ex;\r}\r} while(numAttempts \u0026lt;= this.maxRetries);\rthrow lockFailureException;\r}\r}\r æ³¨æ„ä¸Šé¢çš„åˆ‡é¢ç±»å®ç°äº†Orderedæ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®åˆ‡é¢ç±»çš„ä¼˜å…ˆçº§æ˜¯é«˜äºäº‹åŠ¡çš„ï¼ˆæˆ‘ä»¬æƒ³æ¯æ¬¡å°è¯•éƒ½æ˜¯ä¸€ä¸ªæ–°äº‹åŠ¡ï¼‰\nmaxRetrieså’Œorderå±æ€§éƒ½ç”±Springé…ç½®\nä¸»è¦çš„æ“ä½œéƒ½å‘ç”Ÿåœ¨doConcurrentOperationaround adviceã€‚æ³¨æ„ï¼Œåœ¨å½“å‰æƒ…å†µï¼Œæˆ‘ä»¬åº”ç”¨äº†é‡è¯•é€»è¾‘åœ¨æ¯ä¸ªbusinessService()ã€‚å¦‚æœè¿è¡ŒæŠ›å‡ºPessimisticLockingFailureExceptionå¼‚å¸¸ï¼Œå°±ä¼šè¿›è¡Œé‡è¯•æ“ä½œï¼Œé™¤éé‡æ–°æ“ä½œæ¬¡æ•°å·²ç»è€—å°½ã€‚\nå¯¹åº”çš„Springé…ç½®å¦‚ä¸‹ï¼š\n\u0026lt;aop:aspectj-autoproxy/\u0026gt;\r\u0026lt;bean id=\u0026quot;concurrentOperationExecutor\u0026quot; class=\u0026quot;com.xyz.myapp.service.impl.ConcurrentOperationExecutor\u0026quot;\u0026gt;\r\u0026lt;property name=\u0026quot;maxRetries\u0026quot; value=\u0026quot;3\u0026quot;/\u0026gt;\r\u0026lt;property name=\u0026quot;order\u0026quot; value=\u0026quot;100\u0026quot;/\u0026gt;\r\u0026lt;/bean\u0026gt;\r æç‚¼aspectè®©ä»–åªæœ‰åœ¨å¹‚ç­‰æ“ä½œçš„æ—¶å€™æ‰é‡è¯•ï¼ˆå¹‚ç­‰ï¼šå‡½æ•°å¤šæ¬¡è¿è¡Œç»“æœä¸ä¸€æ¬¡è¿è¡Œç»“æœç›¸åŒï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰Idempotentæ³¨è§£ï¼š\nimport java.lang.annotation.ElementType;\rimport java.lang.annotation.Retention;\rimport java.lang.annotation.RetentionPolicy;\rimport java.lang.annotation.Target;\r@Target(ElementType.METHOD)\r@Retention(RetentionPolicy.RUNTIME)\rpublic @interface Idempotent{}\r ç°åœ¨å¯ä»¥ä½¿ç”¨Idempotentæ³¨è§£å»æ ‡æ³¨éœ€è¦é‡è¯•çš„service æ–¹æ³•ï¼ŒåŒæ—¶æˆ‘ä»¬çš„pointcutè¡¨è¾¾å¼ä¹Ÿéœ€è¦ä¿®æ”¹ï¼š\n@Around(\u0026quot;com.xyz.myapp.CommonPointcuts.businessService() \u0026amp;\u0026amp; \u0026quot; +\r\u0026quot;@annotation(com.xyz.myapp.service.Idempotent)\u0026quot;)\rpublic Object doConcurrentOperation(ProceedingJoinPoint pjp) throws Throwable {\r// ...\r}\r 3. åŸºäºæ¶æ„çš„AOPæ”¯æŒï¼ˆxmlé…ç½®å½¢å¼çš„ï¼‰ xmlé…ç½®å½¢å¼çš„AOPè·ŸåŸºäºAspectJçš„å½¢ï¼Œåªæ˜¯æ–¹å¼ä¸ä¸€æ ·ï¼Œç”¨çš„pointcutè¡¨è¾¾å¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œä¸ç»†è®²ï¼Œè¯¦ç»†å‚è€ƒæ–‡æœ«çš„å®˜æ–¹æ–‡æ¡£\n è¯¦æƒ…å‚è€ƒ Springå®˜æ–¹æ–‡æ¡£\n ","id":141,"section":"posts","summary":"1.åˆ‡é¢ç¼–ç¨‹æ ¸å¿ƒæ¦‚å¿µ åˆ‡é¢ç¼–ç¨‹Aspect-oriented Programming (AOP) AOPåªæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œè·ŸSpringæ˜¯ç‹¬ç«‹å…³ç³» æœ€å…¸å‹çš„AOPå®ç°æ¡†æ¶Aspect","tags":["spring"],"title":"Springåˆ‡é¢ç¼–ç¨‹","uri":"https://www.mingaccount.com/2017/06/spring-aop/","year":"2017"},{"content":"LocalVariableTableParameterNameDiscoverer discoverer = new LocalVariableTableParameterNameDiscoverer();\rdiscoverer.getParameterNames(method);\r è¯¦æƒ…å‚è€ƒAPIæ–‡æ¡£\n","id":142,"section":"posts","summary":"LocalVariableTableParameterNameDiscoverer discoverer = new LocalVariableTableParameterNameDiscoverer(); discoverer.getParameterNames(method); è¯¦æƒ…å‚è€ƒAPIæ–‡æ¡£","tags":["java"],"title":"æ ¹æ®Methodè·å–æ‰€æœ‰å‚æ•°å","uri":"https://www.mingaccount.com/2017/06/method-get-all-argnames/","year":"2017"},{"content":"Java, Java Script, HTML, JSON, CSV and XML org.apache.commons.lang3.StringEscapeUtils\n//ä½¿ç”¨ç¤ºä¾‹\rStringEscapeUtils.escapeCsv(\u0026quot;\u0026quot;);\rSqtringEscapeUtils.escapeXml(\u0026quot;\u0026quot;);\r  apiæ–‡æ¡£\n Regexp  æ­£åˆ™è¡¨è¾¾å¼è½¬ä¹‰æ‰€æœ‰ç‰¹æ®Šç¬¦å·\n å…¶ä»– com.google.common.escape.Escapers\nEscaper build = Escapers.builder().addEscape('$', \u0026quot; \u0026quot;).build();\rString str = build.escape(\u0026quot;$$$$\u0026quot;);\r  apiæ–‡æ¡£\n ","id":143,"section":"posts","summary":"Java, Java Script, HTML, JSON, CSV and XML org.apache.commons.lang3.StringEscapeUtils //ä½¿ç”¨ç¤ºä¾‹ StringEscapeUtils.escapeCsv(\u0026quot;\u0026quot;); SqtringEscapeUtils.escapeXml(\u0026quot;\u0026quot;); apiæ–‡æ¡£ Regexp æ­£åˆ™è¡¨è¾¾å¼è½¬ä¹‰æ‰€æœ‰ç‰¹æ®Šç¬¦å· å…¶ä»– com.google.common.escape.Escapers Escaper build = Escapers.builder().addEscape('$', \u0026quot; \u0026quot;).build(); String str = build.escape(\u0026quot;$$$$\u0026quot;); apiæ–‡æ¡£","tags":["java"],"title":"JavaString ç‰¹æ®Šç¬¦å·å¤„ç†å·¥å…·ç±»","uri":"https://www.mingaccount.com/2017/05/java-string-special-symbol-handler/","year":"2017"},{"content":"æ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ®Šç¬¦å·åŒ…æ‹¬\n\\ $ ( ) * + . [ ] ? ^ { } | -\nå®ç°ä»£ç (java)\npublic class RegexUtils {\rprivate static final String[] SPECIAL_SYMBOLS =\rnew String[]{\u0026quot;\\\\\u0026quot;, \u0026quot;$\u0026quot;, \u0026quot;(\u0026quot;, \u0026quot;)\u0026quot;, \u0026quot;*\u0026quot;, \u0026quot;+\u0026quot;, \u0026quot;.\u0026quot;, \u0026quot;[\u0026quot;, \u0026quot;]\u0026quot;, \u0026quot;?\u0026quot;, \u0026quot;^\u0026quot;, \u0026quot;{\u0026quot;, \u0026quot;}\u0026quot;, \u0026quot;|\u0026quot;, \u0026quot;-\u0026quot;};\r/**\r* è½¬ä¹‰ç›®æ ‡æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦\r* @param regex\r* @return\r*/\rpublic static String escapeSpecialSymbols(String regex) {\rfor (String specSymbol : SPECIAL_SYMBOLS) {\rString escapeSymbol = \u0026quot;\\\\\u0026quot; + specSymbol;\rregex = regex.replace(specSymbol, escapeSymbol);\r}\rreturn regex;\r}\r}\r ","id":144,"section":"posts","summary":"æ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ®Šç¬¦å·åŒ…æ‹¬ \\ $ ( ) * + . [ ] ? ^ { } | - å®ç°ä»£ç (java) public class RegexUtils { private static final String[] SPECIAL_SYMBOLS = new String[]{\u0026quot;\\\\\u0026quot;, \u0026quot;$\u0026quot;, \u0026quot;(\u0026quot;, \u0026quot;)\u0026quot;, \u0026quot;*\u0026quot;, \u0026quot;+\u0026quot;, \u0026quot;.\u0026quot;, \u0026quot;[\u0026quot;, \u0026quot;]\u0026quot;, \u0026quot;?\u0026quot;, \u0026quot;^\u0026quot;, \u0026quot;{\u0026quot;, \u0026quot;}\u0026quot;, \u0026quot;|\u0026quot;, \u0026quot;-\u0026quot;}; /** * è½¬ä¹‰ç›®æ ‡æ­£","tags":["regexp"],"title":"æ­£åˆ™è¡¨è¾¾å¼è½¬ä¹‰æ‰€æœ‰ç‰¹æ®Šç¬¦å·","uri":"https://www.mingaccount.com/2017/05/regex-escape-all-special-symbol/","year":"2017"},{"content":"Javaæ–¹æ³•å¦‚ä½•ç¼–è¯‘ int add12and13() {\rreturn addTwo(12, 13);\r}\r å°†ä¼šç¼–è¯‘ä¸ºï¼š\nMethod int add12and13()\r0 aload_0 // Push local variable 0 (this)\r1 bipush 12 // Push int constant 12\r3 bipush 13 // Push int constant 13\r5 invokevirtual #4 // Method Example.addtwo(II)I\r8 ireturn // Return int on top of operand stack;\r// it is the int result of addTwo()\r  å¼•ç”¨è‡ªå®˜æ–¹æ–‡æ¡£invoking method\n æ³¨æ„ç¬¬ä¸€æ­¥ä¼šé»˜è®¤å‹å…¥ä¸€ä¸ªthiså‚æ•°ï¼Œè¿™ä¸ªthiså‚æ•°å¯ä»¥é€‰æ‹©ç”³æ˜æˆ–è€…éšè—\nä¹Ÿå°±æ˜¯è¯´addTwoæœ‰ä¸¤ç§å£°æ˜æ–¹æ³•ï¼Œå¹¶ä¸”ä¸¤ç§éƒ½ä¸ä¼šå½±å“addTwo(12,13)çš„è°ƒç”¨ï¼š\npublic class Test{\rpublic int addTwo(int a,int b){\rreturn a + b;\r}\rpublic int addTwo(Test this,int a,int b){\rreturn a + b;\r}\r}\r æ³¨æ„ç¬¬äºŒç§å†™æ³•ï¼Œthiså¿…é¡»æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°å¹¶ä¸”ä¸èƒ½ä¿®æ”¹å‚æ•°åå’Œç±»å‹\né‚£ä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆä¸€ä¸ªå‚æ•°çš„æ–¹æ³•ï¼Œå¯ä»¥åŒ…è£…ä¸ºä¸¤ä¸ªå‚æ•°çš„BiFunctionï¼š\nimport java.util.function.BiFunction;\rpublic class User {\rpublic String test(String msg) {\rSystem.out.println(msg);\r}\r}\rpublic class UnitTest {\r@Test\rpublic void test1() {\r//ç¬¬ä¸€ä¸ªUserå‚æ•°ï¼Œä»£è¡¨äº†é»˜è®¤çš„this\rBiFunction\u0026lt;User, String, String\u0026gt; test = User::test;\r}\r}\r ","id":145,"section":"posts","summary":"Javaæ–¹æ³•å¦‚ä½•ç¼–è¯‘ int add12and13() { return addTwo(12, 13); } å°†ä¼šç¼–è¯‘ä¸ºï¼š Method int add12and13() 0 aload_0 // Push local variable 0 (this) 1 bipush 12 // Push int constant 12 3 bipush 13 // Push int constant 13 5 invokevirtual #4 // Method Example.addtwo(II)I 8 ireturn // Return int on top of operand stack; // it is the","tags":["java"],"title":"Javaæ–¹æ³•çš„é»˜è®¤å‚æ•°","uri":"https://www.mingaccount.com/2017/05/java-method-first-default-param/","year":"2017"},{"content":" project pom.xmlæ–‡ä»¶çš„é¡¶çº§å…ƒç´  modelVersion POMä½¿ç”¨çš„å¯¹è±¡æ¨¡å‹ç‰ˆæœ¬ã€‚è¿™ä¸ªæ¨¡å‹çš„ç‰ˆæœ¬å‡ ä¹ä¸æ›´æ–°ï¼Œä½œä¸ºå¿…è¦å…ƒç´ çš„åŸå› æ˜¯ç¡®ä¿ç¨³å®šæ€§ã€‚ groupId è¿™ä¸ªå…ƒç´ ä»£è¡¨åˆ›å»ºè¿™ä¸ªé¡¹ç›®çš„æœºæ„æˆ–è€…å›¢é˜Ÿçš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ä½œä¸ºé¡¹ç›®çš„å…³é”®æ ‡è¯†ç¬¦ï¼Œé€šå¸¸çš„æ¥æºæ˜¯åŸºäºæœºæ„çš„å®Œå…¨é™å®šåŸŸåã€‚ä¸¾ä¸ªä¾‹å­org.apache.maven.pluginsï¼Œæ˜¯ä¸ºæ‰€æœ‰Maven pluginè®¾è®¡çš„groupIdã€‚ artifactId è¿™ä¸ªå…ƒç´ ä»£è¡¨è¿™ä¸ªé¡¹ç›®åˆ›å»ºçš„é¦–è¦artifactçš„å”¯ä¸€åŸºç¡€åç§°ã€‚é¡¹ç›®çš„é¦–è¦artifactä¸€èˆ¬æ¥è¯´å°±æ˜¯JARæ–‡ä»¶ã€‚æ¬¡è¦çš„artifactï¼Œæ¯”å¦‚è¯´èµ„æºåŒ…ä¹Ÿä½¿ç”¨äº†artifactIdä½œä¸ºæœ€ç»ˆåç§°çš„ä¸€éƒ¨åˆ†ã€‚ä¸€ä¸ªå…¸å‹Mavenäº§å‡ºçš„artifactä¼šæœ‰è¿™æ ·çš„æ ¼å¼ï¼š-.ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œmyapp-1.0.jarï¼‰ version è¿™ä¸ªå…ƒç´ ä»£è¡¨é¡¹ç›®ç”Ÿæˆçš„artifactçš„ç‰ˆæœ¬ã€‚Mavenåœ¨ç‰ˆæœ¬ç®¡ç†é—®é¢˜ä¸Šèµ°äº†å¾ˆé•¿çš„è·¯ï¼Œä½ ä¼šç»å¸¸åœ¨ç‰ˆæœ¬ä¸­çœ‹è§SNAPSHOTç”³æ˜ç¬¦ï¼Œä»–ä»£è¡¨é¡¹ç›®è¿˜åœ¨ä¸€ä¸ªå¼€å‘çŠ¶æ€ã€‚ name è¿™ä¸ªå…ƒç´ ä»£è¡¨é¡¹ç›®çš„å±•ç¤ºåç§°ã€‚ç»å¸¸è¢«ç”¨äºMavenç”Ÿæˆçš„æ–‡æ¡£ä¸­ã€‚ url è¿™ä¸ªå…ƒç´ ä»£è¡¨é¡¹ç›®çš„ç½‘å€æ˜¯å¯ä»¥è¢«è®¿é—®åˆ°çš„ã€‚ç»å¸¸è¢«ç”¨äºMavenç”Ÿæˆçš„æ–‡æ¡£ä¸­ã€‚ properties è¿™ä¸ªå…ƒç´ åŒ…å«çš„å€¼ï¼Œå¯é€šè¿‡ç”³æ˜çš„å ä½ç¬¦åœ¨æ•´ä¸ªPOMä¸­è®¿é—®ã€‚ dependencies ä¾èµ–åˆ—è¡¨ï¼Œä»–æ˜¯POMçš„åŸºçŸ³ã€‚ build ç”³æ˜é¡¹ç›®ç›®å½•ç»“æ„å’Œç®¡ç†æ’ä»¶ã€‚   æ›´å¤šPOMå…ƒç´ å’Œè¯´æ˜ï¼Œå‚è€ƒPOM Reference\n ","id":146,"section":"posts","summary":"project pom.xmlæ–‡ä»¶çš„é¡¶çº§å…ƒç´  modelVersion POMä½¿ç”¨çš„å¯¹è±¡æ¨¡å‹ç‰ˆæœ¬ã€‚è¿™ä¸ªæ¨¡å‹çš„ç‰ˆæœ¬å‡ ä¹ä¸æ›´æ–°ï¼Œä½œä¸ºå¿…è¦å…ƒç´ çš„åŸå› æ˜¯ç¡®ä¿ç¨³å®šæ€§ã€‚ groupId è¿™ä¸ªå…ƒç´ ä»£è¡¨åˆ›å»ºè¿™ä¸ªé¡¹","tags":["maven"],"title":"pomå…ƒç´ è¯´æ˜","uri":"https://www.mingaccount.com/2017/05/pom-tag/","year":"2017"},{"content":"CAæœºæ„é¢å‘HTTPSæ‰€éœ€è¦çš„TLSè¯ä¹¦ï¼Œä¸€èˆ¬åœ¨åŸŸåæœåŠ¡å•†å¤„å°±å¯ä»¥è´­ä¹°ã€‚ä¹Ÿæœ‰å…è´¹çš„CAæä¾›å•†Let's Encrypt\n è¯¦æƒ…å‚è€ƒLet\u0026rsquo;s Encrypt\n ","id":147,"section":"posts","summary":"CAæœºæ„é¢å‘HTTPSæ‰€éœ€è¦çš„TLSè¯ä¹¦ï¼Œä¸€èˆ¬åœ¨åŸŸåæœåŠ¡å•†å¤„å°±å¯ä»¥è´­ä¹°ã€‚ä¹Ÿæœ‰å…è´¹çš„CAæä¾›å•†Let's Encrypt è¯¦æƒ…å‚è€ƒLet\u0026rsquo;s Encrypt","tags":["website build"],"title":"å…è´¹CAæœºæ„","uri":"https://www.mingaccount.com/2017/05/ca-free/","year":"2017"},{"content":"è¡¨å  mysql æ¯ä¸€ä¸ªè¡¨è‡³å°‘å¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨æ–‡ä»¶ï¼Œè€Œä¸”åå­—å¯¹åº”ï¼Œå› æ­¤è¡¨åçš„å¤§å°å†™æ•æ„Ÿè·Ÿç³»ç»Ÿæœ‰å…³ç³»ï¼Œwindowsä¸åŒºåˆ†ï¼ŒlinuxåŒºåˆ† oracle æ‰€æœ‰ä¸åœ¨åŒå¼•å·é‡Œçš„å†…å®¹éƒ½ä¼šè¢«è½¬ä¸ºå¤§å†™ï¼Œæƒ³è¦åŒºåˆ†å¤§å°å†™ï¼Œå°±ç”¨åŒå¼•å·æ‹¬èµ·æ¥  å­—æ®µå  mysql ä¸åŒºåˆ†å¤§å°å†™ oracle è·Ÿè¡¨åä¸€æ ·ï¼Œé»˜è®¤ä¼šè¢«è½¬ä¸ºå¤§å†™ï¼Œæƒ³è¦åŒºåˆ†ï¼Œéœ€è¦åŒå¼•å·   mysqlå¯ä»¥é€šè¿‡ä¿®æ”¹lower_case_table_nameså±æ€§æ¥å¿½ç•¥è¡¨åçš„å¤§å°å†™åŒºåˆ†ï¼Œå‚è€ƒMysqlè¡¨åå¿½ç•¥å¤§å°å†™\n ä½†æœ‰ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼Œmysqlçš„å¤§å°å†™å¿½ç•¥ï¼Œä¼šæŠŠæ‰€æœ‰å­—ç¬¦è½¬ä¸ºå°å†™ï¼Œè€Œoracleçš„ï¼Œåƒå‰è¾¹æ‰€è¯´çš„ä¼šæŠŠæ‰€æœ‰å­—ç¬¦è½¬ä¸ºå¤§å†™\n","id":148,"section":"posts","summary":"è¡¨å mysql æ¯ä¸€ä¸ªè¡¨è‡³å°‘å¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨æ–‡ä»¶ï¼Œè€Œä¸”åå­—å¯¹åº”ï¼Œå› æ­¤è¡¨åçš„å¤§å°å†™æ•æ„Ÿè·Ÿç³»ç»Ÿæœ‰å…³ç³»ï¼Œwindowsä¸åŒºåˆ†ï¼ŒlinuxåŒºåˆ† oracle æ‰€æœ‰ä¸åœ¨åŒå¼•å·é‡Œ","tags":["mysql","oracle"],"title":"å…³äºmysqlå’Œoracleçš„å¤§å°å†™æ•æ„Ÿ","uri":"https://www.mingaccount.com/2017/05/mysql-oracle-case-sensitive/","year":"2017"},{"content":"é»˜è®¤æƒ…å†µä¸‹mysqlçš„å¯¹æ¯”æ¡ä»¶æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„ï¼ˆlatin1_general_ci)ï¼Œæ‰€æœ‰ä¸æ•æ„Ÿçš„collateéƒ½ä»¥_ciç»“å°¾ã€‚\nè¦è®©å¯¹æ¯”æ¡ä»¶å¤§å°å†™æ•æ„Ÿï¼Œéœ€è¦å°†collateè®¾ç½®ä¸ºä»¥_csæˆ–è€…_binç»“å°¾ï¼ˆæ¯”å¦‚utf8_unicode_cså’Œutf8_binï¼‰\næ£€æŸ¥å½“å‰çš„collate ä½ å¯ä»¥æ£€æµ‹ä½ çš„æœåŠ¡ï¼Œæ•°æ®åº“å’Œè¿æ¥çš„collateï¼Œé€šè¿‡ï¼š\nmysql\u0026gt; show variables like '%collation%';\r+----------------------+-------------------+\r| Variable_name | Value |\r+----------------------+-------------------+\r| collation_connection | utf8_general_ci |\r| collation_database | latin1_swedish_ci |\r| collation_server | latin1_swedish_ci |\r+----------------------+-------------------+\r ä½ ä¹Ÿå¯ä»¥æ£€æµ‹è¡¨çš„collateï¼Œé€šè¿‡:\nmysql\u0026gt; SELECT table_schema, table_name, table_collation FROM information_schema.tables WHERE table_name = `mytable`;\r+----------------------+------------+-------------------+\r| table_schema | table_name | table_collation |\r+----------------------+------------+-------------------+\r| myschema | mytable | latin1_swedish_ci |\r æ”¹å˜ collate ä½ å¯ä»¥æ”¹å˜æ•°æ®åº“ï¼Œè¡¨ï¼Œæˆ–è€…åˆ—çš„collateä¸ºå¤§å°å†™æ•æ„Ÿï¼š\n-- Change database collation\rALTER DATABASE `databasename` DEFAULT CHARACTER SET utf8 COLLATE utf8_bin;\r-- or change table collation\rALTER TABLE `table` CONVERT TO CHARACTER SET utf8 COLLATE utf8_bin;\r-- or change column collation\rALTER TABLE `table` CHANGE `Value` `Value` VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_bin;\r ","id":149,"section":"posts","summary":"é»˜è®¤æƒ…å†µä¸‹mysqlçš„å¯¹æ¯”æ¡ä»¶æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„ï¼ˆlatin1_general_ci)ï¼Œæ‰€æœ‰ä¸æ•æ„Ÿçš„collateéƒ½ä»¥_ciç»“å°¾ã€‚ è¦è®©å¯¹æ¯”æ¡ä»¶","tags":["mysql"],"title":"Mysqlæ¡ä»¶å¯¹æ¯”å¤§å°å†™æ•æ„Ÿ","uri":"https://www.mingaccount.com/2017/05/mysql-compare-sensitive/","year":"2017"},{"content":"@SpringBootApplication(scanBasePackages=\u0026quot;com.*.*\u0026quot;)\r@EnableScheduling\r@EnableTransactionManagement\r@MapperScan(\u0026quot;com.*.**.*mapper\u0026quot;)\r@EnableConfigurationProperties({CustomConfiguration.class})\rpublic class Application {}\r  SpringBootApplication Springæ³¨è§£çš„æ‰«æè·¯å¾„ EnableScheduling å¼€å¯Springçš„å®šæ—¶ä»»åŠ¡ EnableTransactionManagement å¼€å§‹Springçš„äº‹åŠ¡ç®¡ç† MapperScan æ‰«æMyBatis Mapperç±»çš„è·¯å¾„ EnableConfigurationProperties è‡ªå®šä¹‰é…ç½®æ–‡ä»¶æ˜ å°„ç±»  ","id":150,"section":"posts","summary":"@SpringBootApplication(scanBasePackages=\u0026quot;com.*.*\u0026quot;) @EnableScheduling @EnableTransactionManagement @MapperScan(\u0026quot;com.*.**.*mapper\u0026quot;) @EnableConfigurationProperties({CustomConfiguration.class}) public class Application {} SpringBootApplication Springæ³¨è§£çš„æ‰«æè·¯å¾„ EnableScheduling å¼€å¯Springçš„å®šæ—¶ä»»åŠ¡ EnableTransactionManagement å¼€å§‹Springçš„äº‹åŠ¡ç®¡ç† MapperScan æ‰«æMyBatis Mapperç±»çš„è·¯","tags":["spring"],"title":"SpringBootå…¥å£ç±»å¸¸ç”¨æ³¨è§£","uri":"https://www.mingaccount.com/2017/05/spring-boot-entry-anno/","year":"2017"},{"content":"é€šè¿‡ä¿®æ”¹springboot application.properties\nspring.jackson.date-format=yyyy-MM-dd HH:mm:ss\rspring.jackson.time-zone=GMT+8\r ","id":151,"section":"posts","summary":"é€šè¿‡ä¿®æ”¹springboot application.properties spring.jackson.date-format=yyyy-MM-dd HH:mm:ss spring.jackson.time-zone=GMT+8","tags":["jackson","spring"],"title":"Springboot Jacksonå…¨å±€æ—¥æœŸæ ¼å¼å¤„ç†","uri":"https://www.mingaccount.com/2017/04/jackson-global-date-format/","year":"2017"},{"content":"Jacksonç®€ä»‹ Springåœ¨@RequestBodyå’Œ@ResponseBodyä¸­å¯¹å¯¹è±¡çš„ååºåˆ—åŒ–å’Œåºåˆ—åŒ–ï¼Œéƒ½æ˜¯å€ŸåŠ©Jacksonæ¥å®ç°çš„ï¼Œå¦‚æœæƒ³æ”¹å˜Springåºåˆ—åŒ–æˆ–è€…ååºåˆ—åŒ–çš„è§„åˆ™ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´Springå†…éƒ¨ObjectMapperbeançš„å±æ€§æ¥å®ç°ï¼š\n@Configuration\rpublic class JacksonConfig{\r@Bean\rpublic ObjectMapper getObjectMapper(){\rObjectMapper objectMapper = new ObjectMapper();\r//è¯¥ä¾‹å­å°†å®ä½“ç±»çš„Dateç±»å‹è·ŸæŒ‡å®šæ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²å¯¹åº”\robjectMapper.setDateFormat(new SimpleDateFormat(\u0026quot;yyyy-MM-dd HH:mm:ss\u0026quot;));\rreturn objectMapper; }\r}\r Jackson ObjectMapperçš„ä¸€èˆ¬ä½¿ç”¨\npublic void test(){\rUser user = new User();\r...\rObjectMapper mapper = new ObjectMapper();\r//åºåˆ—åŒ–\rString json = mapper.writeValueAsString(user);\r//è§£æJsonä¸ºæ ‘å½¢ç»“æ„\rJsonNode node = mapper.readTree(json);\rString name = node.get(\u0026quot;name\u0026quot;).toText();\r//è§£æJsonä¸ºæŒ‡å®šç±»çš„å¯¹è±¡\rUser user1 = mapper.readValue(json,User.class);\r}\r æ›´å¤šä½¿ç”¨æƒ…æ™¯å¯ä»¥å‚è€ƒJackson-docs\nJacksonçš„æ‰©å±•æ³¨è§£ @JsonProperty ä½œç”¨åœ¨ç±»çš„å±æ€§ä¸Šï¼Œä¸ºå…¶æ·»åŠ ä¸€ä¸ªåˆ«åï¼Œä¼šå½±å“åºåˆ—åŒ–çš„å±æ€§åç§°\npublic class User implements Serializable{\r@JsonProperty(\u0026quot;sName\u0026quot;)\rprivate String name;\r}\r {\u0026quot;sName\u0026quot;:\u0026quot;èµµå››\u0026quot;}\r @JsonIgnore ä½œç”¨åœ¨ç±»çš„å±æ€§ä¸Šï¼Œåºåˆ—åŒ–æ—¶å¿½ç•¥æŸä¸ªå±æ€§\npublic class User implements Serializable{\r@JsonIgnore\rprivate String name; }\r @JsonIgnoreProperties ä½œç”¨åœ¨ç±»ä¸Šï¼Œæ‰¹é‡å¿½ç•¥ç±»å±æ€§\n@JsonIgnoreProperties({\u0026quot;age\u0026quot;,\u0026quot;sex\u0026quot;})\rpublic class User\r æ³¨æ„ï¼Œå¦‚æœå±æ€§æœ‰åˆ«åï¼Œé‚£ä¹ˆå°±å†™åˆ«åï¼Œæ¯”å¦‚è¦å¿½ç•¥ä¹‹å‰çš„å±æ€§nameï¼Œå› ä¸ºä»–æœ‰åˆ«åï¼Œæ‰€ä»¥åº”è¯¥åœ¨@JsonIgnoreProperteisä¸­å¡«å†™ä»–çš„åˆ«åsName\n@JsonFormat ä½œç”¨åœ¨å±æ€§ä¸Šï¼Œæ ¼å¼åŒ–å±æ€§\nä¸€èˆ¬ç”¨æ¥æ ¼å¼åŒ–æ—¥æœŸ\npublic class User implements Serializable{\r@JsonFormat(pattern=\u0026quot;yyyy-MM-dd HH:mm:ss\u0026quot;)\rprivate Date date;\r}\r @JsonNaming ä½œç”¨åœ¨ç±»æˆ–è€…å±æ€§ä¸Šï¼Œæ”¹å˜åºåˆ—åŒ–å±æ€§çš„å‘½åè§„åˆ™\n@JsonNaming(PropertyNamingStrategy.SnakeCaseStrategy.class)\rpublic class User implements Serializable{\rprivate String userName;\r}\r ä¸Šé¢çš„SnakeCaseStrategyè§„åˆ™ï¼Œä¼šå°†å±æ€§userNameè½¬ä¸ºJsonå±æ€§user-name\n@JsonSerialize ä½œç”¨åœ¨ç±»ä¸Šï¼Œä»£è¡¨æŒ‡å®šè‡ªå·±çš„åºåˆ—åŒ–è§„åˆ™ç±»\n@JsonSerialize(UserSerializer.class)\rpublic class User implements Serializable{}\r ä¸‹é¢è¦å®ç°è‡ªå®šä¹‰åºåˆ—åŒ–è§„åˆ™ï¼Œéœ€è¦ç»§æ‰¿æŠ½è±¡ç±»JsonSerializer\npublic class UserSerializer extends JsonSerializer\u0026lt;User\u0026gt;{\r@Override\rpublic void serialize(User user, JsonGenerator generator, SerializerProvider provider)\rthrows IOException, JsonProcessingException {\rgenerator.writeStartObject();\rgenerator.writeStringField(\u0026quot;public-info\u0026quot;, user.getPublicInfo());\rgenerator.writeEndObject();\r}\r}\r @JsonDeserialize ä½œç”¨åœ¨ç±»ä¸Šï¼Œä»£è¡¨æŒ‡å®šè‡ªå·±çš„ååºåˆ—åŒ–è§„åˆ™ç±»\n@JsonDeserialize(UserDeserializer.class)\rpublic class User implements Serializable{}\r ä¸‹é¢è¦å®ç°è‡ªå®šä¹‰ååºåˆ—åŒ–è§„åˆ™ï¼Œéœ€è¦ç»§æ‰¿æŠ½è±¡ç±»JsonDeserializer\npbulic class UserDeserializer extends JsonDeserializer\u0026lt;User\u0026gt;{\r@Override\rpublic User deserialize(JsonParser parser, DeserializationContext context)\rthrows IOException, JsonProcessingException {\rJsonNode node = parser.getCodec().readTree(parser);\rString publicInfo = node.get(\u0026quot;public-info\u0026quot;).asText();\rUser user = new User();\ruser.setPublicInfo(publicInfo);\rreturn user;\r}\r}\r @JsonView ä½œç”¨åœ¨ç±»çš„å±æ€§ä¸Šå’Œè¿”å›Userçš„æ–¹æ³•ä¸Šï¼Œæ¯”å¦‚è¿”å›è¯¥å¯¹è±¡çš„controlleræ–¹æ³•ï¼Œ@JsonViewå¯ä»¥è®©ä¸¤ä¸ªæ–¹æ³•è™½ç„¶è¿”å›çš„åŒä¸€ä¸ªå®ä¾‹ï¼Œä½†æ˜¯å±•ç¤ºçš„å­—æ®µå´ä¸ç›¸åŒ\npublic class User implements Serializable{\r@JsonView(AllField.class)\rprivate String id;\r@JsonView(JustName.class)\rprivate String name;\r@JsonView(AllField.class)\rprivate String sex;\rpublic interface JustName{}\rpublic interface AllField extends JustName{}\r}\r ç”¨ä¸åŒæ¥å£ä»£è¡¨ä¸åŒçš„viewï¼Œä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œå¯ä»¥é¿å…ä¸€äº›é‡å¤çš„å£°æ˜\nä¸‹é¢æ˜¯è°ƒç”¨æ–¹æ³•çš„ç”³æ˜ï¼š\n@GetMapping(\u0026quot;get/name\u0026quot;)\r@ResponseBody\r@JsonView(User.JustName.class)\rpublic User getUserName(){}\r@GetMapping(\u0026quot;get/all\u0026quot;)\r@ResponseBody\r@JsonView(User.AllField.class)\rpublic User getAllUserField(){}\r å‡è®¾ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•çš„æ–¹æ³•ä½“å®Œå…¨ç›¸åŒï¼Œå› ä¸ºJsonViewçš„åŸå› ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•åªä¼šè¿”å›{\u0026quot;name\u0026quot;:\u0026quot;èµµå››\u0026quot;}ï¼Œè€Œç¬¬äºŒä¸ªæ–¹æ³•åˆ™ä¼šè¿”å›å››å“¥çš„æ‰€æœ‰ä¿¡æ¯\n æ›´å¤šjacksonæ³¨è§£å‚è€ƒjackson annotation\n Jacksonæ³›å‹ String json = \u0026quot;[{\\\u0026quot;name\\\u0026quot;:\\\u0026quot;èµµå››\\\u0026quot;}]\u0026quot;\rList\u0026lt;User\u0026gt; users = objectMapper.readValue(json,List.class);\rUser user = users.get(0);\r ä¸Šé¢çš„ä»£ç ä¼šåœ¨ç¬¬ä¸‰è¡Œçš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ï¼šlinkedHashMap cannot cast to User\nå› ä¸ºobjectMapperååºåˆ—åŒ–çš„æ—¶å€™å¹¶æ²¡æœ‰æä¾›Listçš„æ³›å‹ï¼Œjacksonå†…éƒ¨å¹¶ä¸çŸ¥é“listå­å…ƒç´ æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæ‰€ä»¥é»˜è®¤è½¬ä¸ºäº†LinkedHashMap\njacksonæä¾›äº†æ³›å‹å¤„ç†ï¼š\nJavaType type = TypeFactory.defaultInstance.constructParametricType(List.class, User.class);\rList\u0026lt;User\u0026gt; list = mapper.readValue(json, type);\r ","id":152,"section":"posts","summary":"Jacksonç®€ä»‹ Springåœ¨@RequestBodyå’Œ@ResponseBodyä¸­å¯¹å¯¹è±¡çš„ååºåˆ—åŒ–å’Œåºåˆ—åŒ–ï¼Œéƒ½æ˜¯å€ŸåŠ©Jacksonæ¥å®ç°","tags":["jackson","spring"],"title":"Jacksonä½¿ç”¨è§£æ","uri":"https://www.mingaccount.com/2017/04/jackson/","year":"2017"},{"content":"1.æ–°å»ºbanner.txtåœ¨resourcesç›®å½•ä¸‹ _/_/_/ _/ _/ _/_/_/ _/ _/ _/_/ _/ _/ _/ _/ _/_/ _/ _/ _/ _/ _/_/_/_/ _/ _/ _/ _/ _/_/_/_/ _/ _/ _/ _/ _/ _/_/ _/ _/ _/_/_/ _/ _/ _/_/_/ _/ _/ _/ _/  æ–‡æœ¬å›¾å½¢ç”Ÿæˆå™¨\n2.å¼€å…³æ§åˆ¶ @SpringBootApplication\rpublic class Application {\rpublic static void main(String[] args) {\rSpringApplication springApplication = new SpringApplication(Application.class);\r//æ§åˆ¶banneræ˜¯å¦å±•ç¤º\rspringApplication.setBannerMode(Banner.Mode.OFF);\rspringApplication.run(args);\r}\r}\r ","id":153,"section":"posts","summary":"1.æ–°å»ºbanner.txtåœ¨resourcesç›®å½•ä¸‹ _/_/_/ _/ _/ _/_/_/ _/ _/ _/_/ _/ _/ _/ _/ _/_/ _/ _/ _/ _/ _/_/_/_/ _/ _/ _/ _/ _/_/_/_/ _/ _/ _/ _/ _/ _/_/ _/ _/ _/_/_/ _/ _/ _/_/_/ _/ _/ _/ _/ æ–‡æœ¬å›¾å½¢ç”Ÿ","tags":["spring"],"title":"ä¿®æ”¹SpringBootæ—¥å¿—æ‰“å°æ—¶å€™çš„æ ‡å¿—","uri":"https://www.mingaccount.com/2017/04/modify-spring-boot-banner/","year":"2017"},{"content":"å‚è€ƒSpringå®˜ç½‘é…ç½®å‚æ•°\nå®Œæ•´åˆ—å‡ºäº†æ‰€æœ‰applicationé…ç½®æ–‡ä»¶ä¸­å¯ç”¨çš„å‚æ•°\n","id":154,"section":"posts","summary":"å‚è€ƒSpringå®˜ç½‘é…ç½®å‚æ•° å®Œæ•´åˆ—å‡ºäº†æ‰€æœ‰applicationé…ç½®æ–‡ä»¶ä¸­å¯ç”¨çš„å‚æ•°","tags":["spring"],"title":"Spring Applicationé…ç½®æ–‡ä»¶é€šç”¨å‚æ•°","uri":"https://www.mingaccount.com/2017/04/spring-properties-common-key/","year":"2017"},{"content":"æ–°å»ºæŒ‡å®šé…ç½®ç±»TestConfiguration\nè¯¥ç±»éœ€è¦çš„æ³¨è§£ï¼š\n@Configuration\r@ConfigurationProperties(prefix=\u0026quot;test\u0026quot;)\r@PropertySource(\u0026quot;classpath:test.properties\u0026quot;)\r åŒæ—¶å¯åŠ¨ç±»ä¸Šéœ€è¦å¢åŠ æ³¨è§£ï¼š\n@EnableConfigurationProperties({TestConfiguration.class})\r ","id":155,"section":"posts","summary":"æ–°å»ºæŒ‡å®šé…ç½®ç±»TestConfiguration è¯¥ç±»éœ€è¦çš„æ³¨è§£ï¼š @Configuration @ConfigurationProperties(prefix=\u0026quot;test\u0026quot;) @PropertySource(\u0026quot;classpath:test.properties\u0026quot;) åŒæ—¶å¯åŠ¨ç±»ä¸Šéœ€è¦å¢åŠ æ³¨è§£ï¼š @EnableConfigurationProperties({TestConfiguration.class})","tags":["spring"],"title":"Springè‡ªå®šä¹‰é…ç½®æ–‡ä»¶å¹¶æ˜ å°„åˆ°æŒ‡å®šç±»ä¸­","uri":"https://www.mingaccount.com/2017/01/spring-boot-external-properties/","year":"2017"},{"content":"ç®€ä»‹  ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚\n ç±»å›¾ ä»£ç  import java.util.*;\rinterface Image {\rpublic void displayImage();\r}\r//on System A class RealImage implements Image {\rprivate String filename;\rpublic RealImage(String filename) { this.filename = filename;\rloadImageFromDisk();\r}\rprivate void loadImageFromDisk() {\rSystem.out.println(\u0026quot;Loading \u0026quot; + filename);\r}\rpublic void displayImage() { System.out.println(\u0026quot;Displaying \u0026quot; + filename); }\r}\r//on System B class ProxyImage implements Image {\rprivate String filename;\rprivate Image image;\rpublic ProxyImage(String filename) { this.filename = filename; }\rpublic void displayImage() {\rif(image == null)\rimage = new RealImage(filename);\rimage.displayImage();\r}\r}\rclass ProxyExample {\rpublic static void main(String[] args) {\rImage image1 = new ProxyImage(\u0026quot;HiRes_10MB_Photo1\u0026quot;);\rImage image2 = new ProxyImage(\u0026quot;HiRes_10MB_Photo2\u0026quot;); image1.displayImage(); // loading necessary\rimage2.displayImage(); // loading necessary\r}\r}\r ","id":156,"section":"posts","summary":"ç®€ä»‹ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ ç±»å›¾ ä»£ç  import java.util.*; interface Image { public void displayImage(); } //on System A class RealImage implements Image { private String filename; public RealImage(String filename) { this.filename = filename; loadImageFromDisk(); } private void loadImageFromDisk() { System.out.println(\u0026quot;Loading \u0026quot; + filename); } public void displayImage()","tags":["design pattern"],"title":"ä»£ç†æ¨¡å¼","uri":"https://www.mingaccount.com/2017/01/proxy-pattern/","year":"2017"},{"content":"ç®€ä»‹  ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚[DP]\n åŸå‹æ¨¡å¼è¦è¡¨è¾¾çš„æ„æ€å°±æ˜¯å…‹éš†ã€‚å½“å¤šä¸ªå¯¹è±¡åªæœ‰ä¸ªåˆ«å±æ€§å€¼ä¸ä¸€æ ·æ—¶ï¼Œè¿™æ—¶newå‡ºæ¯ä¸ªå¯¹è±¡ï¼Œå†å¯¹æ¯ä¸ªå±æ€§èµ‹å€¼ï¼Œæ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ã€‚\nè¿™æ—¶åŸå‹æ¨¡å¼å°±æ˜¯å¾ˆå¥½çš„è§£å†³æ–¹å¼ï¼Œåªnewä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹å…¬å…±å±æ€§èµ‹å€¼å®Œæˆåï¼Œç›´æ¥å…‹éš†å³å¯ã€‚\nç±»å›¾ ä»£ç  /** Prototype Class **/\rpublic class Cookie implements Cloneable {\rpublic Object clone() throws CloneNotSupportedException\r{\r//In an actual implementation of this pattern you would now attach references to\r//the expensive to produce parts from the copies that are held inside the prototype.\rreturn (Cookie) super.clone();\r}\r}\r/** Concrete Prototypes to clone **/\rpublic class CoconutCookie extends Cookie { }\r/** Client Class**/\rpublic class CookieMachine\r{\rprivate Cookie cookie;//cookieå¿…é¡»æ˜¯å¯å¤åˆ¶çš„\rpublic CookieMachine(Cookie cookie) { this.cookie = cookie; } public Cookie makeCookie()\r{\rtry\r{\rreturn (Cookie) cookie.clone();\r} catch (CloneNotSupportedException e)\r{\re.printStackTrace();\r}\rreturn null;\r} public static void main(String args[]){ Cookie tempCookie = null; Cookie prot = new CoconutCookie(); CookieMachine cm = new CookieMachine(prot); //è®¾ç½®åŸå‹\rfor(int i=0; i\u0026lt;100; i++) tempCookie = cm.makeCookie();//é€šè¿‡å¤åˆ¶åŸå‹è¿”å›å¤šä¸ªcookie } }\r ","id":157,"section":"posts","summary":"ç®€ä»‹ ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚[DP] åŸå‹æ¨¡å¼è¦è¡¨è¾¾çš„æ„æ€å°±æ˜¯å…‹éš†ã€‚å½“å¤šä¸ªå¯¹è±¡åªæœ‰ä¸ªåˆ«å±æ€§å€¼ä¸ä¸€æ ·æ—¶ï¼Œ","tags":["design pattern"],"title":"åŸå‹æ¨¡å¼","uri":"https://www.mingaccount.com/2017/01/prototype-pattern/","year":"2017"},{"content":"ç®€ä»‹ ç­–ç•¥æ¨¡å¼ï¼šå®ƒå®šä¹‰äº†ç®—æ³•å®¶æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©ä»–ä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ï¼Œä¸ä¼šå½±å“åˆ°ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚\næ‰€è°“çš„ç­–ç•¥æ¨¡å¼è·Ÿç®€å•å·¥å‚æ¨¡å¼ç±»ä¼¼ï¼Œåªä¸è¿‡ç­–ç•¥æ¨¡å¼çš„Contextç±»ä¸ç®¡å¯¹è±¡çš„ç”Ÿæˆï¼Œåªå°è£…äº†ç®—æ³•çš„æ‰§è¡Œç±»ï¼Œç»™ç®—æ³•çš„æ‰§è¡Œæä¾›äº†ç»Ÿä¸€çš„å…¥å£ã€‚\nå®Œå…¨å¯ä»¥å°†å·¥å‚æ¨¡å¼è·Ÿç­–ç•¥æ¨¡å¼ç›¸ç»“åˆï¼Œä¹Ÿå°±æ˜¯è¯´Contextæ—¢è´Ÿè´£å¯¹è±¡ç”Ÿæˆï¼Œä¹Ÿè´Ÿè´£è°ƒç”¨æ–¹æ³•çš„å°è£…ã€‚\nç±»å›¾ ä»£ç  //StrategyExample test application\rclass StrategyExample {\rpublic static void main(String[] args) {\rContext context;\r// Three contexts following different strategies\rcontext = new Context(new FirstStrategy());\rcontext.execute();\rcontext = new Context(new SecondStrategy());\rcontext.execute();\rcontext = new Context(new ThirdStrategy());\rcontext.execute();\r}\r}\r// The classes that implement a concrete strategy should implement this\r// The context class uses this to call the concrete strategy\rinterface Strategy {\rvoid execute();\r}\r// Implements the algorithm using the strategy interface\rclass FirstStrategy implements Strategy {\rpublic void execute() {\rSystem.out.println(\u0026quot;Called FirstStrategy.execute()\u0026quot;);\r}\r}\rclass SecondStrategy implements Strategy {\rpublic void execute() {\rSystem.out.println(\u0026quot;Called SecondStrategy.execute()\u0026quot;);\r}\r}\rclass ThirdStrategy implements Strategy {\rpublic void execute() {\rSystem.out.println(\u0026quot;Called ThirdStrategy.execute()\u0026quot;);\r}\r}\r// Configured with a ConcreteStrategy object and maintains a reference to a Strategy object\rclass Context {\rStrategy strategy;\r// Constructor\rpublic Context(Strategy strategy) {\rthis.strategy = strategy;\r}\rpublic void execute() {\rthis.strategy.execute();\r}\r}\r ","id":158,"section":"posts","summary":"ç®€ä»‹ ç­–ç•¥æ¨¡å¼ï¼šå®ƒå®šä¹‰äº†ç®—æ³•å®¶æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©ä»–ä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ï¼Œä¸ä¼šå½±å“åˆ°ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚ æ‰€è°“çš„ç­–ç•¥æ¨¡å¼è·Ÿç®€å•å·¥å‚","tags":["design pattern"],"title":"ç­–ç•¥æ¨¡å¼","uri":"https://www.mingaccount.com/2017/01/strategy-pattern/","year":"2017"},{"content":"ç®€ä»‹  åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œå°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°æ¨¡å¼æ¯”ç”Ÿæˆå­ç±»æ›´åŠ çµæ´»ã€‚\n è£…é¥°æ¨¡å¼å¸¸ç”¨åœ¨ä¸ºä¸»ç±»æ·»åŠ ä¸€äº›ç‰¹æœ‰çš„åŠŸèƒ½çš„æ—¶å€™ã€‚è£…é¥°æ¨¡å¼å¯ä»¥åœ¨ä¸ä¿®æ”¹ä¸»ç±»çš„æƒ…å†µä¸‹å¯¹ä¸»ç±»è¿›è¡Œæ‰©å±•ï¼Œå¹¶ä¸”æ¯ä¸ªæ‰©å±•åŠŸèƒ½ä¹Ÿäº’ç›¸ç‹¬ç«‹ï¼Œä¸éœ€è¦çŸ¥é“æ•´ä¸ªæµç¨‹ã€‚\nè£…é¥°æ¨¡å¼å’Œå»ºé€ è€…æ¨¡å¼ä¸åŒï¼Œå®ƒæ˜¯å¯¹ä¸€ä¸ªä¸ç¨³å®šçš„ç»„æˆç»“æ„è¿›è¡Œå°è£…ï¼Œä»£è¡¨ç€ç»“æ„ä¸­çš„é¡ºåºï¼Œæˆå‘˜çš„å¿…è¦æ€§éƒ½ä¸ä¸€å®šï¼Œä½†æ˜¯å»ºé€ è€…æ¨¡å¼ä¸€èˆ¬æ˜¯ä¸€ä¸ªç›¸å¯¹ç¨³å®šçš„ç»“æ„ã€‚\nç±»å›¾ ä»£ç  Componentç±»\n// The Window interface class\rpublic interface Window {\rpublic void draw(); // Draws the Window\rpublic String getDescription(); // Returns a description of the Window\r}\r// implementation of a simple Window without any scrollbars\rpublic class SimpleWindow implements Window {\rpublic void draw() {\r// Draw window\r}\rpublic String getDescription() {\rreturn \u0026quot;simple window\u0026quot;;\r}\r}\r è£…é¥°è€…åŠå…¶å®ç°ç±»\n// abstract decorator class - note that it implements Window\rpublic abstract class WindowDecorator implements Window {\rprotected Window decoratedWindow; // the Window being decorated\rpublic WindowDecorator (Window decoratedWindow) {\rthis.decoratedWindow = decoratedWindow;\r}\r@Override\rpublic void draw() {\rdecoratedWindow.draw();\r}\r@Override\rpublic String getDescription() {\rreturn decoratedWindow.getDescription();\r}\r}\r// The first concrete decorator which adds vertical scrollbar functionality\rpublic class VerticalScrollBar extends WindowDecorator {\rpublic VerticalScrollBar(Window windowToBeDecorated) {\rsuper(windowToBeDecorated);\r}\r@Override\rpublic void draw() {\rsuper.draw();\rdrawVerticalScrollBar();\r}\rprivate void drawVerticalScrollBar() {\r// Draw the vertical scrollbar\r}\r@Override\rpublic String getDescription() {\rreturn super.getDescription() + \u0026quot;, including vertical scrollbars\u0026quot;;\r}\r}\r// The second concrete decorator which adds horizontal scrollbar functionality\rpublic class HorizontalScrollBar extends WindowDecorator1 {\rpublic HorizontalScrollBar (Window windowToBeDecorated) {\rsuper(windowToBeDecorated);\r}\r@Override\rpublic void draw() {\rsuper.draw();\rdrawHorizontalScrollBar();\r}\rprivate void drawHorizontalScrollBar() {\r// Draw the horizontal scrollbar\r}\r@Override\rpublic String getDescription() {\rreturn super.getDescription() + \u0026quot;, including horizontal scrollbars\u0026quot;;\r}\r}\r æµ‹è¯•ä»£ç \npublic class Main {\r// for print descriptions of the window subclasses\rstatic void printInfo(Window w) {\rSystem.out.println(\u0026quot;description:\u0026quot;+w.getDescription());\r}\rpublic static void main(String[] args) {\r// original SimpleWindow\rSimpleWindow sw = new SimpleWindow();\rprintInfo(sw);\r// HorizontalScrollBar mixed Window\rHorizontalScrollBar hbw = new HorizontalScrollBar(sw);\rprintInfo(hbw);\r// VerticalScrollBar mixed Window\rVerticalScrollBar vbw = new VerticalScrollBar(hbw);\rprintInfo(vbw);\r}\r}\r ","id":159,"section":"posts","summary":"ç®€ä»‹ åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œå°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°æ¨¡å¼æ¯”ç”Ÿæˆå­ç±»æ›´åŠ çµæ´»ã€‚ è£…é¥°æ¨¡å¼å¸¸ç”¨åœ¨ä¸ºä¸»ç±»æ·»åŠ ä¸€äº›ç‰¹æœ‰çš„åŠŸèƒ½çš„æ—¶å€™ã€‚è£…é¥°æ¨¡å¼å¯","tags":["design pattern"],"title":"è£…é¥°æ¨¡å¼","uri":"https://www.mingaccount.com/2017/01/decorator-pattern/","year":"2017"},{"content":"æ¦‚è§ˆ try-with-resourcesè¡¨è¾¾å¼å¯ä»¥è‡ªåŠ¨å…³é—­ç”³æ˜åœ¨è¡¨è¾¾å¼ä¸­çš„èµ„æºï¼Œä½†å‰ææ˜¯è¿™äº›èµ„æºç±»è¦å®ç°java.lang.AutoCloseableæˆ–è€…java.io.Closeableã€‚\nä¸‹é¢çš„ä¾‹å­ä½¿ç”¨BufferedReaderçš„å®ä¾‹è¯»å–äº†æ–‡ä»¶çš„ç¬¬ä¸€è¡Œï¼š\nstatic String readFirstLineFromFile(String path)throws IOException{\rtry(BufferedReader br=\rnew BufferedReader(new FileReader(path))){\rreturn br.readLine();\r}\r}\r å› ä¸ºBufferedReaderåœ¨try-with-resourcesè¡¨è¾¾å¼ä¸­ï¼Œå¹¶ä¸”ä»–å®ç°äº†AutoCloseableï¼Œæ„å‘³ç€ä¸ç®¡ç¨‹åºè¿è¡Œç»“æœå¦‚ä½•ï¼Œä»–éƒ½ä¼šè‡ªåŠ¨å…³é—­ã€‚\nä½†åœ¨java7ä¹‹å‰ï¼Œä½ åªæœ‰é€šè¿‡finallyæ¥å®Œæˆèµ„æºçš„å…³é—­ï¼š\nstatic String readFirstLineFromFileWithFinallyBlock(String path)\rthrows IOException {\rBufferedReader br = new BufferedReader(new FileReader(path));\rtry {\rreturn br.readLine();\r} finally {\rif (br != null) br.close();\r}\r}\r è™½ç„¶èƒ½å¤Ÿè¾¾åˆ°try-with-resourcesè¡¨è¾¾å¼åŒæ ·çš„ç›®çš„ï¼Œä½†æ˜¯å¦‚æœtryçš„ä»£ç å—å’Œfinallyéƒ½åŒæ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆfinallyçš„å¼‚å¸¸å°±ä¼šè¦†ç›–æ‰tryçš„å¼‚å¸¸ã€‚\nä½†åœ¨ä¹‹å‰çš„readFirstLineFromFileæ–¹æ³•ä¾‹å­ä¸­ï¼Œä½¿ç”¨try-with-resourcesè¡¨è¾¾å¼æ—¶ï¼Œå¦‚æœtry-with-resourcesè¡¨è¾¾å¼å’Œtryçš„ä»£ç å—åŒæ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œæœ€ç»ˆæŠ›å‡ºçš„ä¼šæ˜¯tryä»£ç å—çš„ã€‚\nä½ æœ‰å¯èƒ½åŒæ—¶åœ¨try-with-resourcesè¡¨è¾¾å¼ä¸­ç”³æ˜å¤šä¸ªèµ„æºï¼Œä¸‹é¢å°±æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œä»–è§£æzipåŒ…ä¸­çš„æ‰€æœ‰æ–‡ä»¶åï¼Œå¹¶å°†ä»–ä»¬å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚\npublic static void writeToFileZipFileContents(String zipFileName,\rString outputFileName)\rthrows java.io.IOException {\rjava.nio.charset.Charset charset =\rjava.nio.charset.StandardCharsets.US_ASCII;\rjava.nio.file.Path outputFilePath =\rjava.nio.file.Paths.get(outputFileName);\r// Open zip file and create output file with // try-with-resources statement\rtry (\rjava.util.zip.ZipFile zf =\rnew java.util.zip.ZipFile(zipFileName);\rjava.io.BufferedWriter writer = java.nio.file.Files.newBufferedWriter(outputFilePath, charset)\r) {\r// Enumerate each entry\rfor (java.util.Enumeration entries =\rzf.entries(); entries.hasMoreElements();) {\r// Get the entry name and write it to the output file\rString newLine = System.getProperty(\u0026quot;line.separator\u0026quot;);\rString zipEntryName =\r((java.util.zip.ZipEntry)entries.nextElement()).getName() +\rnewLine;\rwriter.write(zipEntryName, 0, zipEntryName.length());\r}\r}\r}\r åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåŒæ—¶ç”³æ˜äº†ä¸¤ä¸ªèµ„æºZipFileå’ŒBufferedWriterï¼Œä»–ä»¬é€šè¿‡åˆ†å·åˆ†éš”ã€‚ä¸€æ—¦ä»£ç å—æ‰§è¡Œå®Œæ¯•ï¼Œä»–ä»¬ä¼šæŒ‰ç…§BufferedWriterï¼ŒZipFileçš„é¡ºåºè¿›è¡Œå…³é—­ã€‚æ³¨æ„ï¼Œèµ„æºåˆ›å»ºçš„é¡ºåºå’Œä»–ä»¬è¢«å…³é—­çš„é¡ºåºæ˜¯ç›¸åçš„ã€‚\nä¸‹é¢çš„ä¾‹å­ä½¿ç”¨try-with-resourceså»å…³é—­ä¸€ä¸ªjava.sql.Statementèµ„æºï¼š\npublic static void viewTable(Connection con) throws SQLException {\rString query = \u0026quot;select COF_NAME, SUP_ID, PRICE, SALES, TOTAL from COFFEES\u0026quot;;\rtry (Statement stmt = con.createStatement()) {\rResultSet rs = stmt.executeQuery(query);\rwhile (rs.next()) {\rString coffeeName = rs.getString(\u0026quot;COF_NAME\u0026quot;);\rint supplierID = rs.getInt(\u0026quot;SUP_ID\u0026quot;); float price = rs.getFloat(\u0026quot;PRICE\u0026quot;);\rint sales = rs.getInt(\u0026quot;SALES\u0026quot;);\rint total = rs.getInt(\u0026quot;TOTAL\u0026quot;);\rSystem.out.println(coffeeName + \u0026quot;, \u0026quot; + supplierID + \u0026quot;, \u0026quot; + price + \u0026quot;, \u0026quot; + sales + \u0026quot;, \u0026quot; + total);\r}\r} catch (SQLException e) {\rJDBCTutorialUtilities.printSQLException(e);\r}\r}\r æ³¨æ„ï¼š try-with-resourcesè¡¨è¾¾å¼ä¹Ÿèƒ½åƒä¸€èˆ¬tryè¡¨è¾¾å¼ä¸€æ ·ç”³æ˜catchå’Œfinallyï¼Œåªä¸è¿‡ä»–ä»¬éƒ½ä¼šåœ¨try-with-resourcesèµ„æºå…³é—­ä¹‹åæ‰ä¼šè¿›è¡Œ\nè¢«å‹åˆ¶çš„å¼‚å¸¸ åœ¨æ–¹æ³•writeToFileZipFileContentsä¸­ï¼Œtry-with-resourcesè¡¨è¾¾å¼ç”³æ˜äº†ä¸¤ä¸ªèµ„æºï¼Œåœ¨å°è¯•å…³é—­è¿™ä¸¤ä¸ªèµ„æºçš„æ—¶å€™å¯èƒ½ä¼šæŠ›å‡ºä¸¤ä¸ªå¼‚å¸¸ã€‚ä½†å¦‚æœtryçš„ä»£ç å—æœ¬èº«ä¹Ÿæœ‰å¼‚å¸¸æŠ›å‡ºï¼Œé‚£ä¹ˆtry-with-resourcesè¡¨è¾¾å¼äº§ç”Ÿçš„å¼‚å¸¸å°±ä¼šè¢«å‹åˆ¶ï¼Œæƒ³æŸ¥çœ‹è¿™äº›è¢«å‹åˆ¶çš„å¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡ä»£ç å—å¼‚å¸¸çš„throwable.getSuppressedæ–¹æ³•æ¥è·å–ã€‚\nå®ç°Closeableå’ŒAutoCloseableçš„ç±» å‚è€ƒAutoCloseable å’ŒCloseable åˆ†åˆ«æŸ¥çœ‹ä»–ä»¬çš„å®ç°ç±»ã€‚Closeableç»§æ‰¿äº†AutoCloseableã€‚å½“Closeableä¸­çš„closeæ–¹æ³•å‡ºé”™æ—¶æŠ›å‡ºçš„æ˜¯IOExceptionï¼Œä½†æ˜¯AutoCloseableçš„closeæ–¹æ³•æŠ›å‡ºçš„å´æ˜¯Exceptionã€‚å› æ­¤AutoCloseableçš„å®ç°å¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´æŠ›å‡ºçš„å¼‚å¸¸ã€‚\n","id":160,"section":"posts","summary":"æ¦‚è§ˆ try-with-resourcesè¡¨è¾¾å¼å¯ä»¥è‡ªåŠ¨å…³é—­ç”³æ˜åœ¨è¡¨è¾¾å¼ä¸­çš„èµ„æºï¼Œä½†å‰ææ˜¯è¿™äº›èµ„æºç±»è¦å®ç°java.lang.AutoClos","tags":["java"],"title":"java7ç‰¹æ€§try-with-resources","uri":"https://www.mingaccount.com/2016/08/try-with-resources/","year":"2016"},{"content":" æµ‹è¯•æ•°æ®     random     24   24uixcvkjklwer     æŸ¥è¯¢sql1  SELECT random FROM table WHERE random = 24\r è¯¥sqlä¼šæŠŠä¸¤æ¡è®°å½•éƒ½æŸ¥å‡ºæ¥\n æŸ¥è¯¢sql2  SELECT random FROM table WHERE random = '24'\r è¯¥sqlåªä¼šåŒ¹é…ç¬¬ä¸€æ¡è®°å½•\n æ€»ç»“\næ¡ä»¶åˆ—ä¸ºå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¿è¯ç”¨æ¥åˆ¤æ–­çš„å¸¸é‡ä¹Ÿæ˜¯å­—ç¬¦ç±»å‹  ","id":161,"section":"posts","summary":"æµ‹è¯•æ•°æ® random 24 24uixcvkjklwer æŸ¥è¯¢sql1 SELECT random FROM table WHERE random = 24 è¯¥sqlä¼šæŠŠä¸¤æ¡è®°å½•éƒ½æŸ¥å‡ºæ¥ æŸ¥è¯¢sql2 SELECT random FROM table WHERE random = '24' è¯¥sqlåªä¼šåŒ¹é…ç¬¬ä¸€æ¡è®°å½• æ€»ç»“ æ¡ä»¶åˆ—ä¸ºå­—ç¬¦","tags":["mysql"],"title":"Mysql Whereæ¡ä»¶åˆ¤æ–­ å­—ç¬¦ä¸²å’Œæ•°å­— æ˜¯å¦ç›¸ç­‰æ—¶å­˜åœ¨çš„é—®é¢˜","uri":"https://www.mingaccount.com/2016/07/mysql-compare-string-and-number/","year":"2016"},{"content":"ç°åœ¨å¯ä»¥é€šè¿‡lombokæ³¨è§£@Builderä¸€æ­¥å®ç°\n 1.è°ƒç”¨æ•ˆæœ public class Test{\rpublic static void main(String[] args){\rStudent student = Student.builder().name(\u0026quot;å°æ˜\u0026quot;).age(15).sex(\u0026quot;ç”·\u0026quot;).build();\r}\r}\r 2.å®ç°åŸç† public class Student {\rprivate String name;\rprivate Integer age;\rprivate String sex;\rpublic static Builder builder() {\rreturn new Builder();\r}\rpublic Student(Builder builder) {\rthis.name = builder.name;\rthis.age = builder.age;\rthis.sex = builder.sex;\r}\rpublic static class Builder{\rprivate String name ;\rprivate Integer age ;\rprivate String sex;\rpublic Builder name(String name) {\rthis.name = name;\rreturn this;\r}\rpublic Builder age(Integer age) {\rthis.age = age;\rreturn this;\r}\rpublic Builder sex(String sex) {\rthis.sex = sex;\rreturn this;\r}\rpublic Student build() {\rreturn new Student(this);\r}\r}\r}\r 3.é™æ€å†…éƒ¨ç±»  é™æ€å†…éƒ¨ç±»æ— éœ€ä¾èµ–å¤–éƒ¨ç±»ï¼Œå¯ä»¥ç‹¬ç«‹å­˜åœ¨ å¤šä¸ªå¤–éƒ¨ç±»å¯ä»¥å…±äº«ä¸€ä¸ªé™æ€å†…éƒ¨ç±» æ™®é€šå†…éƒ¨ç±»ä¸èƒ½ç”³æ˜é™æ€çš„æ–¹æ³•å’Œå˜é‡ï¼Œä½†æ˜¯é™æ€å†…éƒ¨ç±»æ— é™åˆ¶  ","id":162,"section":"posts","summary":"ç°åœ¨å¯ä»¥é€šè¿‡lombokæ³¨è§£@Builderä¸€æ­¥å®ç° 1.è°ƒç”¨æ•ˆæœ public class Test{ public static void main(String[] args){ Student student = Student.builder().name(\u0026quo","tags":["java","design pattern"],"title":"å®ä½“ç±»é€šè¿‡å»ºé€ è€…æ¨¡å¼åˆ›å»º","uri":"https://www.mingaccount.com/2016/06/pojo-builder/","year":"2016"},{"content":"ç¤ºä¾‹ä»£ç  public void insert(User user){\rmapper.insert(user);\rString id = user.getId();\r}\r idä¼šèµ‹å€¼åˆ°ä¼ è¿›æ¥çš„userå¯¹è±¡ä¸­\nxml \u0026lt;insert keyProperty=\u0026quot;id\u0026quot; keyColumn=\u0026quot;id\u0026quot; useGeneratedKeys=\u0026quot;true\u0026quot;\u0026gt;\rINSERT INTO ...\r\u0026lt;/insert\u0026gt;\r keyPropertyä»£è¡¨å®ä½“ç±»ä¸­ä¸»é”®å¯¹åº”çš„æˆå‘˜å˜é‡åç§°\nkeyColumnä»£è¡¨è¡¨ä¸»é”®å­—æ®µå¯¹åº”çš„åç§°\nuserGeneratedKeysä»£è¡¨ä½¿ç”¨çš„æ˜¯è‡ªå¢id\n","id":163,"section":"posts","summary":"ç¤ºä¾‹ä»£ç  public void insert(User user){ mapper.insert(user); String id = user.getId(); } idä¼šèµ‹å€¼åˆ°ä¼ è¿›æ¥çš„userå¯¹è±¡ä¸­ xml \u0026lt;insert keyProperty=\u0026quot;id\u0026quot; keyColumn=\u0026quot;id\u0026quot; useGeneratedKeys=\u0026quot;true\u0026quot;\u0026gt; INSERT INTO ... \u0026lt;/insert\u0026gt; keyPropertyä»£è¡¨å®ä½“ç±»ä¸­ä¸»é”®å¯¹åº”çš„æˆå‘˜å˜é‡åç§° ke","tags":["mybatis"],"title":"Mybatis insertå®Œæˆåè·å–è‡ªå¢ä¸»é”®","uri":"https://www.mingaccount.com/2016/05/mybatis-get-auto-increment-id/","year":"2016"},{"content":"org.junit.Assert  assertEquals åˆ¤æ–­å¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œequalsæ–¹æ³•åˆ¤æ–­ assertSame åˆ¤æ–­å¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œ==åˆ¤æ–­ assertTrue åˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºçœŸ assertFalse åˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºå‡ assertNotNull åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ä¸ºnull assertArrayEquals åˆ¤æ–­æ•°ç»„æ˜¯å¦ç›¸ç­‰  org.skyscreamer.jsonassert.JSONAssert JSONAssertå¯å¯¹jsonè¿›è¡Œæ–­è¨€\n åˆ¤æ–­ä¸¤ä¸ªJSONå¯¹è±¡ assertEquals(\u0026hellip;boolean strict) å­—æ®µé¡ºåºä¸å½±å“ç»“æœã€‚å½“strictä¸ºfalseæ—¶ï¼Œä¸€ä¸ªjsonæ˜¯å¦å¤–ä¸€ä¸ªjsonçš„å­é›†ä¹Ÿèƒ½é€šè¿‡(æ¯”å¦‚{\u0026ldquo;id\u0026rdquo;:1}å’Œ{\u0026ldquo;id\u0026rdquo;:1,\u0026ldquo;name\u0026rdquo;:\u0026ldquo;èµµå››\u0026rdquo;}) åˆ¤æ–­ä¸¤ä¸ªJSONæ•°ç»„ assertEquals(\u0026hellip;boolean strict) æ‰€æœ‰å­å…ƒç´ å¿…é¡»å…¨åŒ¹é…ï¼Œstrictä¸ºfalseæ—¶ï¼Œå¯ä»¥å¿½ç•¥æ•°ç»„é¡ºåº  AssertJ AssertJæ˜¯ä¸€ä¸ªå¼ºå¤§çš„é“¾å¼ç»“æ„çš„æ–­è¨€ï¼Œä¸€æ®µä»£ç å¯ä»¥è¿›è¡Œå¤šä¸ªæ–­è¨€ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®˜æ–¹å®ä¾‹ï¼š\n// entry point for all assertThat methods and utility methods (e.g. entry)\rimport static org.assertj.core.api.Assertions.*;\r// basic assertions\rassertThat(frodo.getName()).isEqualTo(\u0026quot;Frodo\u0026quot;);\rassertThat(frodo).isNotEqualTo(sauron);\r// chaining string specific assertions\rassertThat(frodo.getName()).startsWith(\u0026quot;Fro\u0026quot;)\r.endsWith(\u0026quot;do\u0026quot;)\r.isEqualToIgnoringCase(\u0026quot;frodo\u0026quot;);\r// collection specific assertions (there are plenty more)\r// in the examples below fellowshipOfTheRing is a List\u0026lt;TolkienCharacter\u0026gt;\rassertThat(fellowshipOfTheRing).hasSize(9)\r.contains(frodo, sam)\r.doesNotContain(sauron);\r// as() is used to describe the test and will be shown before the error message\rassertThat(frodo.getAge()).as(\u0026quot;check %s's age\u0026quot;, frodo.getName()).isEqualTo(33);\r// exception assertion, standard style ...\rassertThatThrownBy(() -\u0026gt; { throw new Exception(\u0026quot;boom!\u0026quot;); }).hasMessage(\u0026quot;boom!\u0026quot;);\r// ... or BDD style\rThrowable thrown = catchThrowable(() -\u0026gt; { throw new Exception(\u0026quot;boom!\u0026quot;); });\rassertThat(thrown).hasMessageContaining(\u0026quot;boom\u0026quot;);\r// using the 'extracting' feature to check fellowshipOfTheRing character's names\rassertThat(fellowshipOfTheRing).extracting(TolkienCharacter::getName)\r.doesNotContain(\u0026quot;Sauron\u0026quot;, \u0026quot;Elrond\u0026quot;);\r// extracting multiple values at once grouped in tuples\rassertThat(fellowshipOfTheRing).extracting(\u0026quot;name\u0026quot;, \u0026quot;age\u0026quot;, \u0026quot;race.name\u0026quot;)\r.contains(tuple(\u0026quot;Boromir\u0026quot;, 37, \u0026quot;Man\u0026quot;),\rtuple(\u0026quot;Sam\u0026quot;, 38, \u0026quot;Hobbit\u0026quot;),\rtuple(\u0026quot;Legolas\u0026quot;, 1000, \u0026quot;Elf\u0026quot;));\r// filtering a collection before asserting\rassertThat(fellowshipOfTheRing).filteredOn(character -\u0026gt; character.getName().contains(\u0026quot;o\u0026quot;))\r.containsOnly(aragorn, frodo, legolas, boromir);\r// combining filtering and extraction (yes we can)\rassertThat(fellowshipOfTheRing).filteredOn(character -\u0026gt; character.getName().contains(\u0026quot;o\u0026quot;))\r.containsOnly(aragorn, frodo, legolas, boromir)\r.extracting(character -\u0026gt; character.getRace().getName())\r.contains(\u0026quot;Hobbit\u0026quot;, \u0026quot;Elf\u0026quot;, \u0026quot;Man\u0026quot;);\r// and many more assertions: iterable, stream, array, map, dates, path, file, numbers, predicate, optional ...\r AssertJçš„è¯­æ³•æ¯”è¾ƒç®€å•ï¼Œé€šè¿‡ideæç¤ºåŸºæœ¬éƒ½èƒ½æ‰¾åˆ°ç›®æ ‡æ–­è¨€ï¼Œæ›´å¤šå¯ä»¥å‚è€ƒAssertJå®˜æ–¹æ–‡æ¡£ å’Œ AssertJ java doc\n","id":164,"section":"posts","summary":"org.junit.Assert assertEquals åˆ¤æ–­å¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œequalsæ–¹æ³•åˆ¤æ–­ assertSame åˆ¤æ–­å¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œ==åˆ¤æ–­ assertTrue åˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºçœŸ assertFalse åˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºå‡ assertNotNull åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ä¸ºnull assertArrayEquals åˆ¤æ–­æ•°","tags":["unit-test"],"title":"Assertå¸¸ç”¨æ–¹æ³•","uri":"https://www.mingaccount.com/2016/05/assert-common-method/","year":"2016"},{"content":"ç¤ºä¾‹sql SELECT * FROM table WHERE field LIKE '%_%'\r ç›®çš„æ˜¯è·å–ä¸­é—´æœ‰ä¸‹åˆ’çº¿çš„fieldï¼Œä½†æ˜¯è¿™æ ·çš„sqlæ— æ³•è·å–åˆ°æœŸæœ›çš„ç»“æœ\né—®é¢˜åŸå›  likeè¯­å¥ä¸­é™¤äº†ç™¾åˆ†å·æ˜¯é€šé…ç¬¦ï¼Œä¸‹åˆ’çº¿ä¹Ÿæ˜¯é€šé…ç¬¦ã€‚åªæ˜¯ç™¾åˆ†å·ä»£è¡¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­—ç¬¦ï¼Œä¸‹åˆ’çº¿ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼ˆæ¯”å¦‚helloï¼Œå¯ä»¥é€šè¿‡__lloåŒ¹é…ï¼‰ã€‚å¦‚æœè¦æŠŠç™¾åˆ†å·æˆ–è€…ä¸‹åˆ’çº¿ä½œä¸ºåŒ¹é…å†…å®¹ï¼Œé‚£ä¹ˆéœ€è¦åœ¨å‰é¢åŠ ä¸Šæ–œæ ï¼š\\ï¼š\nSELECT * FROM table WHERE field LIKE '%\\_%'\r ","id":165,"section":"posts","summary":"ç¤ºä¾‹sql SELECT * FROM table WHERE field LIKE '%_%' ç›®çš„æ˜¯è·å–ä¸­é—´æœ‰ä¸‹åˆ’çº¿çš„fieldï¼Œä½†æ˜¯è¿™æ ·çš„sqlæ— æ³•è·å–åˆ°æœŸæœ›çš„ç»“æœ é—®é¢˜åŸå›  likeè¯­å¥ä¸­é™¤äº†ç™¾åˆ†å·æ˜¯é€šé…ç¬¦ï¼Œ","tags":["mysql"],"title":"Mysql Likeè¯­å¥åŒ¹é…ä¸‹åˆ’çº¿æ—¶æ— æ³•å¾—åˆ°æ­£ç¡®æ•°æ®","uri":"https://www.mingaccount.com/2016/05/mysql-like-underline/","year":"2016"},{"content":" wiki List of HTTP header fields\n ","id":166,"section":"posts","summary":"wiki List of HTTP header fields","tags":["protocol"],"title":"æ‰€æœ‰HTTPå¤´å­—æ®µ(header fields)","uri":"https://www.mingaccount.com/2016/05/http-heads/","year":"2016"},{"content":" å¸¸è§çŠ¶æ€ç    æ‰€æœ‰çŠ¶æ€ç iana all HTTP status code\nå¸¸ç”¨çŠ¶æ€ç åŠè¯´æ˜wiki List of HTTP status code\n    çŠ¶æ€ç  çŠ¶æ€ç è‹±æ–‡åç§° ä¸­æ–‡æè¿°     100 Continue ç»§ç»­ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚   101 Switching Protocols åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ°HTTPçš„æ–°ç‰ˆæœ¬åè®®   200 OK è¯·æ±‚æˆåŠŸã€‚ä¸€èˆ¬ç”¨äºGETä¸POSTè¯·æ±‚   201 Created å·²åˆ›å»ºã€‚æˆåŠŸè¯·æ±‚å¹¶åˆ›å»ºäº†æ–°çš„èµ„æº   202 Accepted å·²æ¥å—ã€‚å·²ç»æ¥å—è¯·æ±‚ï¼Œä½†æœªå¤„ç†å®Œæˆ   203 Non-Authoritative Information éæˆæƒä¿¡æ¯ã€‚è¯·æ±‚æˆåŠŸã€‚ä½†è¿”å›çš„metaä¿¡æ¯ä¸åœ¨åŸå§‹çš„æœåŠ¡å™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå‰¯æœ¬   204 No Content æ— å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†ï¼Œä½†æœªè¿”å›å†…å®¹ã€‚åœ¨æœªæ›´æ–°ç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯ç¡®ä¿æµè§ˆå™¨ç»§ç»­æ˜¾ç¤ºå½“å‰æ–‡æ¡£   205 Reset Content é‡ç½®å†…å®¹ã€‚æœåŠ¡å™¨å¤„ç†æˆåŠŸï¼Œç”¨æˆ·ç»ˆç«¯ï¼ˆä¾‹å¦‚ï¼šæµè§ˆå™¨ï¼‰åº”é‡ç½®æ–‡æ¡£è§†å›¾ã€‚å¯é€šè¿‡æ­¤è¿”å›ç æ¸…é™¤æµè§ˆå™¨çš„è¡¨å•åŸŸ   206 Partial Content éƒ¨åˆ†å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†éƒ¨åˆ†GETè¯·æ±‚   300 Multiple Choices å¤šç§é€‰æ‹©ã€‚è¯·æ±‚çš„èµ„æºå¯åŒ…æ‹¬å¤šä¸ªä½ç½®ï¼Œç›¸åº”å¯è¿”å›ä¸€ä¸ªèµ„æºç‰¹å¾ä¸åœ°å€çš„åˆ—è¡¨ç”¨äºç”¨æˆ·ç»ˆç«¯ï¼ˆä¾‹å¦‚ï¼šæµè§ˆå™¨ï¼‰é€‰æ‹©   301 Moved Permanently æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–°URIï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„URIï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–°URIã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„URIä»£æ›¿   302 Found ä¸´æ—¶ç§»åŠ¨ã€‚ä¸301ç±»ä¼¼ã€‚ä½†èµ„æºåªæ˜¯ä¸´æ—¶è¢«ç§»åŠ¨ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­ä½¿ç”¨åŸæœ‰URI   303 See Other æŸ¥çœ‹å…¶å®ƒåœ°å€ã€‚ä¸301ç±»ä¼¼ã€‚ä½¿ç”¨GETå’ŒPOSTè¯·æ±‚æŸ¥çœ‹   304 Not Modified æœªä¿®æ”¹ã€‚æ‰€è¯·æ±‚çš„èµ„æºæœªä¿®æ”¹ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç æ—¶ï¼Œä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚å®¢æˆ·ç«¯é€šå¸¸ä¼šç¼“å­˜è®¿é—®è¿‡çš„èµ„æºï¼Œé€šè¿‡æä¾›ä¸€ä¸ªå¤´ä¿¡æ¯æŒ‡å‡ºå®¢æˆ·ç«¯å¸Œæœ›åªè¿”å›åœ¨æŒ‡å®šæ—¥æœŸä¹‹åä¿®æ”¹çš„èµ„æº   305 Use Proxy ä½¿ç”¨ä»£ç†ã€‚æ‰€è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡ä»£ç†è®¿é—®   306 Unused å·²ç»è¢«åºŸå¼ƒçš„HTTPçŠ¶æ€ç    307 Temporary Redirect ä¸´æ—¶é‡å®šå‘ã€‚ä¸302ç±»ä¼¼ã€‚ä½¿ç”¨GETè¯·æ±‚é‡å®šå‘   400 Bad Request å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£   401 Unauthorized è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯   402 Payment Required ä¿ç•™ï¼Œå°†æ¥ä½¿ç”¨   403 Forbidden æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚   404 Not Found æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½®\u0026quot;æ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°\u0026quot;çš„ä¸ªæ€§é¡µé¢   405 Method Not Allowed å®¢æˆ·ç«¯è¯·æ±‚ä¸­çš„æ–¹æ³•è¢«ç¦æ­¢   406 Not Acceptable æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„å†…å®¹ç‰¹æ€§å®Œæˆè¯·æ±‚   407 Proxy Authentication Required è¯·æ±‚è¦æ±‚ä»£ç†çš„èº«ä»½è®¤è¯ï¼Œä¸401ç±»ä¼¼ï¼Œä½†è¯·æ±‚è€…åº”å½“ä½¿ç”¨ä»£ç†è¿›è¡Œæˆæƒ   408 Request Time-out æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶   409 Conflict æœåŠ¡å™¨å®Œæˆå®¢æˆ·ç«¯çš„ PUT è¯·æ±‚æ—¶å¯èƒ½è¿”å›æ­¤ä»£ç ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿäº†å†²çª   410 Gone å®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºå·²ç»ä¸å­˜åœ¨ã€‚410ä¸åŒäº404ï¼Œå¦‚æœèµ„æºä»¥å‰æœ‰ç°åœ¨è¢«æ°¸ä¹…åˆ é™¤äº†å¯ä½¿ç”¨410ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯é€šè¿‡301ä»£ç æŒ‡å®šèµ„æºçš„æ–°ä½ç½®   411 Length Required æœåŠ¡å™¨æ— æ³•å¤„ç†å®¢æˆ·ç«¯å‘é€çš„ä¸å¸¦Content-Lengthçš„è¯·æ±‚ä¿¡æ¯   412 Precondition Failed å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯çš„å…ˆå†³æ¡ä»¶é”™è¯¯   413 Request Entity Too Large ç”±äºè¯·æ±‚çš„å®ä½“è¿‡å¤§ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†ï¼Œå› æ­¤æ‹’ç»è¯·æ±‚ã€‚ä¸ºé˜²æ­¢å®¢æˆ·ç«¯çš„è¿ç»­è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šå…³é—­è¿æ¥ã€‚å¦‚æœåªæ˜¯æœåŠ¡å™¨æš‚æ—¶æ— æ³•å¤„ç†ï¼Œåˆ™ä¼šåŒ…å«ä¸€ä¸ªRetry-Afterçš„å“åº”ä¿¡æ¯   414 Request-URI Too Large è¯·æ±‚çš„URIè¿‡é•¿ï¼ˆURIé€šå¸¸ä¸ºç½‘å€ï¼‰ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†   415 Unsupported Media Type æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚é™„å¸¦çš„åª’ä½“æ ¼å¼   416 Requested range not satisfiable å®¢æˆ·ç«¯è¯·æ±‚çš„èŒƒå›´æ— æ•ˆ   417 Expectation Failed æœåŠ¡å™¨æ— æ³•æ»¡è¶³Expectçš„è¯·æ±‚å¤´ä¿¡æ¯   500 Internal Server Error æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚   501 Not Implemented æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚çš„åŠŸèƒ½ï¼Œæ— æ³•å®Œæˆè¯·æ±‚   502 Bad Gateway ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»è¿œç¨‹æœåŠ¡å™¨æ¥æ”¶åˆ°äº†ä¸€ä¸ªæ— æ•ˆçš„å“åº”   503 Service Unavailable ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„Retry-Afterå¤´ä¿¡æ¯ä¸­   504 Gateway Time-out å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚   505 HTTP Version not supported æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚çš„HTTPåè®®çš„ç‰ˆæœ¬ï¼Œæ— æ³•å®Œæˆå¤„ç†    ","id":167,"section":"posts","summary":"å¸¸è§çŠ¶æ€ç  æ‰€æœ‰çŠ¶æ€ç iana all HTTP status code å¸¸ç”¨çŠ¶æ€ç åŠè¯´æ˜wiki List of HTTP status code çŠ¶æ€ç  çŠ¶æ€ç è‹±æ–‡åç§° ä¸­æ–‡æè¿° 100 Continue ç»§ç»­ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚ 101 Switching Protocols åˆ‡æ¢åè®®","tags":["protocol"],"title":"æ‰€æœ‰HTTPçŠ¶æ€ç (status code)","uri":"https://www.mingaccount.com/2016/05/status-code/","year":"2016"},{"content":" æ‰€æœ‰çš„Content-type   å®Œæ•´åˆ—è¡¨iana media type\n  å¸¸ç”¨çš„Content-type   å¸¸ç”¨åˆ—è¡¨åŠè¯´æ˜runoob content type ** application\n application/java-archive\rapplication/EDI-X12 application/EDIFACT application/javascript application/octet-stream application/ogg application/pdf application/xhtml+xml application/x-shockwave-flash application/json application/ld+json application/xml application/zip application/x-www-form-urlencoded  ** audio\naudio/mpeg audio/x-ms-wma audio/vnd.rn-realaudio audio/x-wav  ** image\nimage/gif image/jpeg image/png image/tiff image/vnd.microsoft.icon image/x-icon image/vnd.djvu image/svg+xml  ** multipart\nmultipart/mixed multipart/alternative multipart/related (using by MHTML (HTML mail).) multipart/form-data  ** text\ntext/css text/csv text/html text/javascript (obsolete) text/plain text/xml  ** video\nvideo/mpeg video/mp4 video/quicktime video/x-ms-wmv video/x-msvideo video/x-flv video/webm  ** vnd\napplication/vnd.android.package-archive\rapplication/vnd.oasis.opendocument.text application/vnd.oasis.opendocument.spreadsheet application/vnd.oasis.opendocument.presentation application/vnd.oasis.opendocument.graphics application/vnd.ms-excel application/vnd.openxmlformats-officedocument.spreadsheetml.sheet application/vnd.ms-powerpoint application/vnd.openxmlformats-officedocument.presentationml.presentation application/msword application/vnd.openxmlformats-officedocument.wordprocessingml.document application/vnd.mozilla.xul+xml  ","id":168,"section":"posts","summary":"æ‰€æœ‰çš„Content-type å®Œæ•´åˆ—è¡¨iana media type å¸¸ç”¨çš„Content-type å¸¸ç”¨åˆ—è¡¨åŠè¯´æ˜runoob content type ** application application/java-archive application/EDI-X12 application/EDIFACT application/javascript application/octet-stream application/ogg application/pdf application/xhtml+xml application/x-shockwave-flash application/json application/ld+json application/xml application/zip","tags":["protocol"],"title":"æ‰€æœ‰Content-type(content type)","uri":"https://www.mingaccount.com/2016/05/content-type/","year":"2016"},{"content":"æ³¨é‡Šä¸­å¦‚æœè¦æŒ‡å‘ä¸€ä¸ªç±»æˆ–è€…å…¶æˆå‘˜ï¼Œç›´æ¥å†™åå­—å®¹æ˜“å‡ºé”™ï¼Œä¸”ideæ— æ³•è·³è½¬ã€‚å¯ä»¥ä½¿ç”¨{@link}æ¥å¼•ç”¨\n /**\r* {@link String#toString()} }\r* åœ¨ç±»åé¢è¿½åŠ #å·ï¼Œå¯ä»¥æŒ‡å‘ç±»çš„æˆå‘˜æ–¹æ³•æˆ–è€…å˜é‡\r**/\rpublic class Test{\r}\r ","id":169,"section":"posts","summary":"æ³¨é‡Šä¸­å¦‚æœè¦æŒ‡å‘ä¸€ä¸ªç±»æˆ–è€…å…¶æˆå‘˜ï¼Œç›´æ¥å†™åå­—å®¹æ˜“å‡ºé”™ï¼Œä¸”ideæ— æ³•è·³è½¬ã€‚å¯ä»¥ä½¿ç”¨{@link}æ¥å¼•ç”¨ /** * {@link String#toString()} } * åœ¨ç±»åé¢è¿½åŠ #å·ï¼Œå¯ä»¥æŒ‡å‘ç±»","tags":["java"],"title":"Javaæ³¨é‡Šå¼•ç”¨ç±»å’Œå…¶æˆå‘˜","uri":"https://www.mingaccount.com/2016/04/java-comment-refere-class/","year":"2016"},{"content":"ä»–ä»¬ä¹‹é—´çš„åŒºåˆ«å°±æ˜¯æ˜¯å¦èƒ½å¤ŸåŒæ—¶ä¿®æ”¹åˆ—åå’Œåˆ—çš„å®šä¹‰ã€‚\nCHANGE ä½ å¯ä»¥ä¿®æ”¹åˆ—åå’Œåˆ—å®šä¹‰\nALTER TABLE t1 CHANGE a b BIGINT NOT NULL\r MODIFY å¯ä»¥ä¿®æ”¹åˆ—å®šä¹‰ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹åˆ—å\nALTER TABLE t1 MODIFY b INT NOT NULL\r RENAME COLUMN å¯ä»¥ä¿®æ”¹åˆ—åï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹åˆ—å®šä¹‰\nALTER TABLE t1 RENAME COLUMN b TO a\r  è¯¦æƒ…å‚è€ƒdoc\n ","id":170,"section":"posts","summary":"ä»–ä»¬ä¹‹é—´çš„åŒºåˆ«å°±æ˜¯æ˜¯å¦èƒ½å¤ŸåŒæ—¶ä¿®æ”¹åˆ—åå’Œåˆ—çš„å®šä¹‰ã€‚ CHANGE ä½ å¯ä»¥ä¿®æ”¹åˆ—åå’Œåˆ—å®šä¹‰ ALTER TABLE t1 CHANGE a b BIGINT NOT NULL MODIFY å¯ä»¥ä¿®æ”¹åˆ—å®šä¹‰ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹åˆ—å ALTER TABLE t1 MODIFY b INT NOT","tags":["mysql"],"title":"Mysql modifyå’Œchangeçš„åŒºåˆ«","uri":"https://www.mingaccount.com/2016/03/mysql-modify-and-change/","year":"2016"},{"content":"æ ‡å‡†ç”³æ˜ /**\r* Describes the Request-For-Enhancement(RFE) that led\r* to the presence of the annotated API element.\r*/\rpublic @interface RequestForEnhancement {\rint id();\rString synopsis();\rString engineer() default \u0026quot;[unassigned]\u0026quot;; String date(); default \u0026quot;[unimplemented]\u0026quot;; }\r RequestForEnhancementæ³¨è§£åŒ…å«çš„æˆå‘˜å‚æ•°ï¼Œéœ€è¦é€šè¿‡æ–¹æ³•æ¥ç”³æ˜ã€‚å¦‚æœæœ‰é»˜è®¤å€¼ï¼Œå¯ä»¥é€šè¿‡defaultæ¥æŒ‡å®šã€‚\næˆå‘˜æ–¹æ³•çš„è¿”å›ç±»å‹æ˜¯æœ‰é™åˆ¶çš„ï¼Œåªèƒ½æ˜¯ï¼š\n åŸå§‹ç±»å‹ String Class enums æ³¨è§£\nè¦ä¹ˆæ˜¯ä¸Šé¢äº”ç§ç±»å‹ï¼Œè¦ä¹ˆå°±æ˜¯è¿™äº”ç§ç±»å‹çš„æ•°ç»„ï¼Œå…¶ä»–çš„éƒ½ä¸æ”¯æŒã€‚  å”¯ä¸€å‚æ•° /**\r* Associates a copyright notice with the annotated API element.\r*/\rpublic @interface Copyright {\rString value();\r}\r å¦‚æœæ³¨è§£åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå‚æ•°å¯¹åº”çš„æ–¹æ³•åç§°åº”è¯¥æ˜¯valueã€‚å¹¶ä¸”åœ¨è°ƒç”¨è¯¥æ³¨è§£æ—¶ï¼Œå¯ä»¥å¿½ç•¥å‚æ•°åç§°å’Œç­‰äºç¬¦å·ï¼š\n@Copyright(\u0026quot;2002 Yoyodyne Propulsion Systems\u0026quot;)\rpublic class OscillationOverthruster { ... }\r @Target ç”¨æ¥æŒ‡å®šæ³¨è§£ä¿®é¥°çš„ç›®æ ‡ç±»å‹ï¼Œæ¯”å¦‚åœ¨æ–¹æ³•æˆ–è€…åœ¨ç±»ä¸Šç­‰ç­‰ã€‚\n@Retention è¯¥æ³¨è§£ç”¨æ¥æŒ‡å®šæ‰€ä¿®é¥°çš„æ³¨è§£è¦ä¿ç•™å¤šé•¿æ—¶é—´ã€‚\næ³¨è§£@Retentionåªæœ‰ä¸€ä¸ªæˆå‘˜RetentionPolicyæšä¸¾ã€‚ RetentionPolicyæšä¸¾æœ‰ä¸‰ä¸ªå¸¸é‡ï¼ˆæŒ‰ç…§é¡ºåºï¼Œä¿ç•™æ—¶é—´é€’å¢ï¼‰ï¼š\n SOURCE CLASS RUNTIME  SOURCE ä»£è¡¨è¿™ä¸ªæ³¨è§£æ˜¯å¯¹ç¼–è¯‘å™¨å¯è§çš„ï¼Œä½†æ˜¯åœ¨.classæ–‡ä»¶å’Œè¿è¡Œæ—¶ä¸å¯ç”¨ã€‚ç¼–è¯‘å™¨å¸¸ç”¨è¿™ç±»æ³¨è§£æ¥æ£€æµ‹å¼‚å¸¸å’Œå±è”½è­¦å‘Šã€‚ç¼–è¯‘å™¨åœ¨ä½¿ç”¨å®Œè¿™ç±»æ³¨è§£åï¼Œä¼šç›´æ¥ä¸¢å¼ƒã€‚\nCLASS ä»£è¡¨è¿™ä¸ªæ³¨è§£ä¼šè®°å½•åˆ°.classæ–‡ä»¶ä¸­ã€‚ä½†æ˜¯è™šæ‹Ÿæœºä¸éœ€è¦åœ¨è¿è¡Œæ—¶ä¿ç•™å®ƒã€‚è¿™æ˜¯é»˜è®¤ç­–ç•¥ã€‚\nRUNTIME ä»£è¡¨è¿™ä¸ªæ³¨è§£ä¼šè®°å½•åˆ°.classæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”è™šæ‹Ÿæœºåœ¨è¿è¡Œæ—¶ä¹Ÿä¼šä¿ç•™å®ƒã€‚è¿™æ„å‘³ç€å¯ä»¥é€šè¿‡åå°„è¯»å–ã€‚\n annotation\nRetentionPolicy\n ","id":171,"section":"posts","summary":"æ ‡å‡†ç”³æ˜ /** * Describes the Request-For-Enhancement(RFE) that led * to the presence of the annotated API element. */ public @interface RequestForEnhancement { int id(); String synopsis(); String engineer() default \u0026quot;[unassigned]\u0026quot;; String date(); default \u0026quot;[unimplemented]\u0026quot;; } RequestForEnhancementæ³¨è§£åŒ…å«çš„æˆå‘˜å‚æ•°ï¼Œéœ€","tags":["java"],"title":"Javaæ³¨è§£è¯´æ˜","uri":"https://www.mingaccount.com/2016/03/annotation/","year":"2016"},{"content":"public class Test{\r/**\r** ä¸€ç§æ˜¯ç›´æ¥æŒ‡å®šåˆå§‹å€¼\r**/\rfinal String msg = \u0026quot;\u0026quot;;\r/**\r** å¦ä¸€ç§æ˜¯ä¸æŒ‡å®šåˆå§‹å€¼ï¼Œåœ¨æ„é€ æ–¹æ³•é‡Œé¢æŒ‡å®š\r** ä½†ä¸å…è®¸æ— å‚æ„é€ çš„å­˜åœ¨ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªæ„é€ æ–¹æ³•éƒ½è¦å¯¹è¯¥å˜é‡èµ‹å€¼\r**/\rfinal String msg1;\rpublic Test(String msg1){\rthis.msg1 = msg1; }\r}\r ","id":172,"section":"posts","summary":"public class Test{ /** ** ä¸€ç§æ˜¯ç›´æ¥æŒ‡å®šåˆå§‹å€¼ **/ final String msg = \u0026quot;\u0026quot;; /** ** å¦ä¸€ç§æ˜¯ä¸æŒ‡å®šåˆå§‹å€¼ï¼Œåœ¨æ„é€ æ–¹æ³•é‡Œé¢æŒ‡å®š ** ä½†ä¸å…è®¸æ— å‚æ„é€ çš„å­˜åœ¨ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªæ„é€ æ–¹æ³•éƒ½è¦å¯¹è¯¥å˜","tags":["java"],"title":"Java finalæˆå‘˜å˜é‡åˆå§‹åŒ–","uri":"https://www.mingaccount.com/2016/01/java-final-constructor/","year":"2016"},{"content":"1.Oracle 12c R1 (12.1)æ”¯æŒlimitè¯­å¥ ä»Oracle 12c R1 (12.1)ç‰ˆæœ¬å¼€å§‹ï¼Œoracleå¼€å§‹æ”¯æŒlimitè¯­å¥ï¼Œä½†æ˜¯è·Ÿç†Ÿæ‚‰çš„limit(1, 10)è¯­å¥è¿˜æ˜¯æœ‰åŒºåˆ«çš„\noracleçš„è¯­å¥æ›´å¤æ‚ï¼Œä½†æ˜¯æœ‰æ›´å¤šé€‰é¡¹èƒ½åšæ›´å¤šçš„äº‹ã€‚å‚è€ƒoracle limitå®Œæ•´çš„è¯­æ³• (å…³äºoracleå†…éƒ¨æ˜¯å¦‚ä½•å®ç°limitçš„å¯ä»¥å‚è€ƒè¿™ä¸ªå›ç­”)\né‚£ä¹ˆä¸€ä¸ªoracle limitè¯­å¥åˆ°åº•åº”è¯¥æ€ä¹ˆå†™äº†ï¼Œæ¯”å¦‚è¦å–21-30è¡Œçš„æ•°æ®ï¼š\nSELECT * FROM sometable\rORDER BY name\rOFFSET 20 ROWS FETCH NEXT 10 ROWS ONLY;\r ä¸Šé¢æ˜¯ä¸€ä¸ªç®€å•ç›´æ¥çš„ä¾‹å­ï¼Œä¸‹é¢æ˜¯å¼•ç”¨è‡ªå®˜æ–¹è¯´æ˜çš„æ›´å¤šå®ä¾‹:\n1.1 åˆå§‹åŒ– DROP TABLE rownum_order_test;\rCREATE TABLE rownum_order_test (\rval NUMBER\r);\rINSERT ALL\rINTO rownum_order_test\rINTO rownum_order_test\rSELECT level\rFROM dual\rCONNECT BY level \u0026lt;= 10;\rCOMMIT;\r è¡¨rownum_order_testé‡Œçš„å†…å®¹ï¼š\nSELECT val\rFROM rownum_order_test\rORDER BY val;\rVAL\r----------\r1\r1\r2\r2\r3\r3\r4\r4\r5\r5\r6\r6\r7\r7\r8\r8\r9\r9\r10\r10\r20 rows selected.\r 1.2 Top-N æŸ¥è¯¢ SELECT val\rFROM rownum_order_test\rORDER BY val DESC FETCH FIRST 10 ROWS ONLY;\rVAL\r----------\r10\r10\r9\r9\r8\r5 rows selected.\r 1.3 WITH TIES ä½¿ç”¨WITH TIESè¯­å¥ï¼Œåœ¨æœ€åä¸€è¡Œæœ‰é‡å¤å€¼å­˜åœ¨æ—¶ï¼Œå°†ä¼šæŠŠæœ€åä¸€è¡Œçš„é‡å¤å€¼éƒ½è¿”å›ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ç¬¬äº”è¡Œçš„å€¼æ˜¯8ï¼Œä½†æ˜¯æ ¹æ®æ’åºï¼Œæœ‰ä¸¤ä¸ªè¡Œæ•°å€¼éƒ½ä¸º8çš„ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªéƒ½ä¿ç•™\nSELECT val\rFROM rownum_order_test\rORDER BY val DESC\rFETCH FIRST 5 ROWS WITH TIES;\rVAL\r----------\r10\r10\r9\r9\r8\r8\r6 rows selected.\r 1.4 å‰ç™¾åˆ†æ¯”æ•°æ®é‡é™åˆ¶ SELECT val\rFROM rownum_order_test\rORDER BY val\rFETCH FIRST 20 PERCENT ROWS ONLY;\rVAL\r----------\r1\r1\r2\r2\r4 rows selected.\r 1.5 åˆ†é¡µ ELECT val\rFROM rownum_order_test\rORDER BY val\rOFFSET 4 ROWS FETCH NEXT 4 ROWS ONLY;\rVAL\r----------\r3\r3\r4\r4\r4 rows selected.\r ä»£è¡¨ä»OFFSET+1å¼€å§‹å–4è¡Œ\n1.6 offsetå’Œç™¾åˆ†æ¯”ç»“åˆ SELECT val\rFROM rownum_order_test\rORDER BY val\rOFFSET 4 ROWS FETCH NEXT 20 PERCENT ROWS ONLY;\rVAL\r----------\r3\r3\r4\r4\r4 rows selected.\r 2.æ—§ç‰ˆæœ¬ä¸æ”¯æŒlimitè¯­å¥ æ—§ç‰ˆæœ¬çš„oracleä¸æ”¯æŒlimitè¯­å¥ï¼Œéœ€è¦é€šè¿‡å­æŸ¥è¯¢æ¥å®ç°ï¼ŒåŸå› å¯å‚è€ƒOn ROWNUM and limiting results\n2.1 Top-N select *\rfrom ( select * from emp order by sal desc ) where ROWNUM \u0026lt;= 5;\r 2.2 åŒºé—´ select * from ( select a.*, ROWNUM rnum from ( \u0026lt;your_query_goes_here, with order by\u0026gt; ) a where ROWNUM \u0026lt;= :MAX_ROW_TO_FETCH )\rwhere rnum \u0026gt;= :MIN_ROW_TO_FETCH;\r 2.3 åŸå›  oracleåˆ†é¡µçš„å†™æ³•æ˜¾å¾—ç‰¹åˆ«è‡ƒè‚¿å’Œå¤šä½™ï¼Œä½†æ˜¯å¯¹äºæ—§ç‰ˆæœ¬æ¥è¯´æ²¡å¾—é€‰æ‹©ï¼Œè¿™ä¸ªå†™æ³•è§„é¿äº†å¾ˆå¤šæ’åºçš„é—®é¢˜å¹¶ä¸”é«˜æ•ˆ\né¦–å…ˆè¦æ˜ç™½ä¸€ä¸ªæ¦‚å¿µï¼ŒROWNUMå¹¶ä¸æ˜¯è·Ÿè¡Œç»‘å®šçš„ï¼Œä»–æ˜¯sqlæ‰§è¡Œå®Œfrom whereåï¼Œå¹¶åœ¨æ’åºå’Œèšåˆå‰ï¼Œæ¯å¾—åˆ°ä¸€ä¸ªç»“æœå°±åˆ†é…ä¸€ä¸ªROWNUM\næ‰€ä»¥åƒä¸‹é¢è¿™ç§å†™æ³•è‚¯å®šå¾—ä¸åˆ°ä»»ä½•ç»“æœ\nSELECT * FROM t\rWHERE ROWNUM \u0026gt; 1\r å½“fromè·å–åˆ°ç¬¬ä¸€è¡Œï¼Œå› ä¸ºè¿˜æ²¡æœ‰ç»è¿‡whereåˆ¤æ–­ï¼Œæ‰€ä»¥æ²¡æœ‰åˆ†é…ROWNUMï¼Œåªèƒ½è¯»å–åˆ°ROWNUMçš„é»˜è®¤å€¼1ï¼Œç„¶è€Œè¿™ä¸ªwhereæ¡ä»¶è‚¯å®šä¸èƒ½æˆç«‹ï¼Œä¹Ÿå°±æ˜¯è¯´ROWNUMæ²¡æœ‰åˆ†é…åˆ°ç¬¬ä¸€è¡Œï¼ˆåˆ†é…é€»è¾‘åŒ…å«è‡ªå¢ï¼‰ï¼Œæ°¸è¿œåˆ°ä¸äº†2ï¼Œè¯¥æŸ¥è¯¢è‚¯å®šæ²¡æœ‰ç»“æœ\n2.3.1 ä¸ºä»€ä¹ˆè¦ç”¨å­æŸ¥è¯¢ å½“ä½¿ç”¨æ’åºæ—¶ï¼Œå› ä¸ºROWNUMçš„åˆ†é…æ˜¯åœ¨æ’åºä¹‹å‰çš„ï¼Œæ‰€ä»¥æ˜¯å…ˆå¾—åˆ°10æ¡æ•°æ®ç„¶åæ’åºï¼Œè€Œä¸æ˜¯å…ˆæ’åºåå–10æ¡\nSELECT *\rFROM t WHERE ROWNUM \u0026lt;= 10\rORDER BY col DESC  éœ€è¦å°è£…ä¸€ä¸ªå­æŸ¥è¯¢åå†é™åˆ¶ROWNUM\nSELECT * FROM\r(\rSELECT *\rFROM\rt ORDER BY col DESC )\rWHERE ROWNUM \u0026lt;= 10\r 2.3.2 å¯¹Top-Nçš„ä¼˜åŒ– ä½¿ç”¨å­æŸ¥è¯¢ROWNUMçš„æ–¹å¼ï¼Œå¦å¤–ä¸€ä¸ªåŸå› æ˜¯oracleå¯¹ä»–è¿›è¡Œäº†ä¼˜åŒ–\nå¦‚æœç›´æ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œå†å¯¹ç»“æœè¿›è¡Œç­›é€‰ï¼Œåƒä¸‹é¢çš„ä¾‹å­\nSELECT *\rFROM t\rORDER BY col DESC  å½“è¡¨çš„æ•°æ®æœ‰ç™¾ä¸‡ç”šè‡³åƒä¸‡è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸ªè¡¨çš„æ‰€æœ‰æ•°æ®éƒ½è¦æ”¾åˆ°å†…å­˜ä¸­è¿›è¡Œæ’åºï¼Œå¦‚æœç”¨äºæ’åºçš„å†…å­˜æ»¡äº†ï¼Œè¿˜éœ€è¦æš‚å­˜åˆ°ç£ç›˜ä¸Šã€‚ å¤§é‡ioå’Œç£ç›˜è¯»å†™ï¼Œè€—è´¹æ—¶é—´ï¼Œå¹¶ä¸”å ç”¨èµ„æºï¼Œä»…ä»…åªæ˜¯ä¸ºäº†è·å–10è¡Œæ•°æ®\nä½¿ç”¨å­æŸ¥è¯¢ROWNUMçš„æ–¹å¼ï¼Œå¦‚ä¸‹\nSELECT * FROM\r(\rSELECT *\rFROM\rt ORDER BY col DESC )\rWHERE ROWNUM \u0026lt;= 10\r ORACLEå¯¹ä»–è¿›è¡Œäº†ä¼˜åŒ–ï¼Œåƒä¸Šé¢çš„ä¾‹å­ï¼Œå½“æŸ¥è¯¢ä¸€å¼€å§‹ï¼Œä¼šå°†æœ€å¼€å§‹çš„10ä¸ªcolå€¼ä¿å­˜åˆ°å†…å­˜ä¸­æ’åºï¼Œç„¶åè·å–ç¬¬11ä¸ªè·Ÿå†…å­˜ä¸­çš„ç¬¬10ä¸ªè¿›è¡Œæ¯”è¾ƒ\nå¦‚æœåœ¨åŒºé—´å¤–ï¼Œé‚£ä¹ˆç›´æ¥å¿½ç•¥è¿™ä¸ªå€¼ã€‚å¦‚æœåœ¨åŒºé—´å†…ï¼Œé‚£ä¹ˆåˆ é™¤åŸæœ¬ç¬¬10ä¸ªå€¼ï¼Œè¿½åŠ ç¬¬11ä¸ªï¼Œé‡æ–°è¿›è¡Œæ’åº\næŒ‰ç…§è¿™ä¸ªé€»è¾‘ï¼Œéå†æ—¶åªéœ€è¦å¯¹å†…å­˜ä¸­çš„10ä¸ªå€¼è¿›è¡Œæ’åºï¼ŒèŠ‚çœå¤§é‡èµ„æºå’Œæ—¶é—´\n2.3.3 åˆ†é¡µæ³¨æ„äº‹é¡¹ ä¸top-nçš„éšæœºæ€§ä¸ä¸€æ ·ï¼Œåˆ†é¡µéœ€è¦åŒæ ·æ¡ä»¶ä¸‹æ¯æ¬¡çš„æŸ¥è¯¢ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œä½†å¦‚æœæ’åºåˆ—æœ‰å¤§é‡çš„é‡å¤å€¼ï¼Œä¸€è‡´æ€§æ— æ³•ä¿è¯\nSELECT *\rFROM (\rSELECT a.*,ROWNUM rn FROM\r(\rSELECT *\rFROM\rt ORDER BY col DESC ) a\rWHERE ROWNUM \u0026lt;= 10\r)\rHWERE rn \u0026gt;=6\r ä¸Šé¢çš„ä¾‹å­ä¸­å¦‚æœcolåˆ—æœ‰å¤§é‡é‡å¤å€¼ï¼Œæ¯æ¬¡æŸ¥è¯¢çš„ç»“æœéƒ½ä¼šä¸ä¸€æ ·\nè§£å†³æ–¹æ¡ˆæ˜¯åœ¨order byè¯­å¥ä¸­è¿½åŠ ROWIDï¼Œå› ä¸ºROWIDåœ¨è¡¨ä¸­æ˜¯å”¯ä¸€çš„\nSELECT *\rFROM (\rSELECT a.*,ROWNUM rn FROM\r(\rSELECT *\rFROM\rt ORDER BY col DESC ,ROWID\r) a\rWHERE ROWNUM \u0026lt;= 10\r)\rHWERE rn \u0026gt;=6\r ","id":173,"section":"posts","summary":"1.Oracle 12c R1 (12.1)æ”¯æŒlimitè¯­å¥ ä»Oracle 12c R1 (12.1)ç‰ˆæœ¬å¼€å§‹ï¼Œoracleå¼€å§‹æ”¯æŒlimitè¯­å¥ï¼Œä½†æ˜¯è·Ÿç†Ÿæ‚‰çš„limit(1,","tags":["oracle"],"title":"Oracle limit é—®é¢˜","uri":"https://www.mingaccount.com/2016/01/oracle-limit/","year":"2016"}],"tags":[{"title":"api","uri":"https://www.mingaccount.com/tags/api/"},{"title":"db2","uri":"https://www.mingaccount.com/tags/db2/"},{"title":"design pattern","uri":"https://www.mingaccount.com/tags/design-pattern/"},{"title":"docker","uri":"https://www.mingaccount.com/tags/docker/"},{"title":"druid","uri":"https://www.mingaccount.com/tags/druid/"},{"title":"ehcache","uri":"https://www.mingaccount.com/tags/ehcache/"},{"title":"git","uri":"https://www.mingaccount.com/tags/git/"},{"title":"gradle","uri":"https://www.mingaccount.com/tags/gradle/"},{"title":"h2","uri":"https://www.mingaccount.com/tags/h2/"},{"title":"hadoop","uri":"https://www.mingaccount.com/tags/hadoop/"},{"title":"hive","uri":"https://www.mingaccount.com/tags/hive/"},{"title":"jackson","uri":"https://www.mingaccount.com/tags/jackson/"},{"title":"java","uri":"https://www.mingaccount.com/tags/java/"},{"title":"jenkins","uri":"https://www.mingaccount.com/tags/jenkins/"},{"title":"jooq","uri":"https://www.mingaccount.com/tags/jooq/"},{"title":"junit4","uri":"https://www.mingaccount.com/tags/junit4/"},{"title":"junit5","uri":"https://www.mingaccount.com/tags/junit5/"},{"title":"linux","uri":"https://www.mingaccount.com/tags/linux/"},{"title":"lombok","uri":"https://www.mingaccount.com/tags/lombok/"},{"title":"markdown","uri":"https://www.mingaccount.com/tags/markdown/"},{"title":"maven","uri":"https://www.mingaccount.com/tags/maven/"},{"title":"mockmvc","uri":"https://www.mingaccount.com/tags/mockmvc/"},{"title":"mybatis","uri":"https://www.mingaccount.com/tags/mybatis/"},{"title":"mysql","uri":"https://www.mingaccount.com/tags/mysql/"},{"title":"nexus","uri":"https://www.mingaccount.com/tags/nexus/"},{"title":"npl","uri":"https://www.mingaccount.com/tags/npl/"},{"title":"npm","uri":"https://www.mingaccount.com/tags/npm/"},{"title":"oracle","uri":"https://www.mingaccount.com/tags/oracle/"},{"title":"postgresql","uri":"https://www.mingaccount.com/tags/postgresql/"},{"title":"protocol","uri":"https://www.mingaccount.com/tags/protocol/"},{"title":"python","uri":"https://www.mingaccount.com/tags/python/"},{"title":"random","uri":"https://www.mingaccount.com/tags/random/"},{"title":"redis","uri":"https://www.mingaccount.com/tags/redis/"},{"title":"regexp","uri":"https://www.mingaccount.com/tags/regexp/"},{"title":"scala","uri":"https://www.mingaccount.com/tags/scala/"},{"title":"spark","uri":"https://www.mingaccount.com/tags/spark/"},{"title":"spring","uri":"https://www.mingaccount.com/tags/spring/"},{"title":"testng","uri":"https://www.mingaccount.com/tags/testng/"},{"title":"transactional","uri":"https://www.mingaccount.com/tags/transactional/"},{"title":"unit-test","uri":"https://www.mingaccount.com/tags/unit-test/"},{"title":"website build","uri":"https://www.mingaccount.com/tags/website-build/"},{"title":"windows","uri":"https://www.mingaccount.com/tags/windows/"}]}